

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Vector Autoregressions tsa.vector_ar &#8212; statsmodels 0.9.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/statsmodels_hybi_favico.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Methods for Survival and Duration Analysis" href="duration.html" />
    <link rel="prev" title="statsmodels.tsa.statespace.tools.validate_vector_shape" href="generated/statsmodels.tsa.statespace.tools.validate_vector_shape.html" />
<link rel="stylesheet" href="_static/examples.css" type="text/css" />
<link rel="stylesheet" href="_static/facebox.css" type="text/css" />
<script type="text/javascript" src="_static/scripts.js">
</script>
<script type="text/javascript" src="_static/facebox.js">
</script>
<script type="text/javascript">
$.facebox.settings.closeImage = "_static/closelabel.png"
$.facebox.settings.loadingImage = "_static/loading.gif"
</script>

  </head><body>
<div class="headerwrap">
    <div class = "header">
        
        <a href = "index.html">
<img src="_static/statsmodels_hybi_banner.png" alt="Logo"
    style="padding-left: 15px"/></a>
        
    </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="duration.html" title="Methods for Survival and Duration Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="generated/statsmodels.tsa.statespace.tools.validate_vector_shape.html" title="statsmodels.tsa.statespace.tools.validate_vector_shape"
             accesskey="P">previous</a> |</li>
<li><a href ="install.html">Install</a></li> &nbsp;|&nbsp;
<li><a href="https://groups.google.com/forum/?hl=en#!forum/pystatsmodels">Support</a></li> &nbsp;|&nbsp;
<li><a href="https://github.com/statsmodels/statsmodels/issues">Bugs</a></li> &nbsp;|&nbsp;
<li><a href="dev/index.html">Develop</a></li> &nbsp;|&nbsp;
<li><a href="examples/index.html">Examples</a></li> &nbsp;|&nbsp;
<li><a href="faq.html">FAQ</a></li> &nbsp;|&nbsp;
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            




  <span class="target" id="module-statsmodels.tsa.vector_ar.var_model"></span><div class="section" id="vector-autoregressions-tsa-vector-ar">
<span id="var"></span><h1>Vector Autoregressions <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code><a class="headerlink" href="#vector-autoregressions-tsa-vector-ar" title="Permalink to this headline">¶</a></h1>
<div class="section" id="var-p-processes">
<h2>VAR(p) processes<a class="headerlink" href="#var-p-processes" title="Permalink to this headline">¶</a></h2>
<p>We are interested in modeling a <span class="math notranslate nohighlight">\(T \times K\)</span> multivariate time series
<span class="math notranslate nohighlight">\(Y\)</span>, where <span class="math notranslate nohighlight">\(T\)</span> denotes the number of observations and <span class="math notranslate nohighlight">\(K\)</span> the
number of variables. One way of estimating relationships between the time series
and their lagged values is the <em>vector autoregression process</em>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Y_t = A_1 Y_{t-1} + \ldots + A_p Y_{t-p} + u_t\\u_t \sim {\sf Normal}(0, \Sigma_u)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(A_i\)</span> is a <span class="math notranslate nohighlight">\(K \times K\)</span> coefficient matrix.</p>
<p>We follow in large part the methods and notation of <a class="reference external" href="http://www.springer.com/gb/book/9783540401728">Lutkepohl (2005)</a>,
which we will not develop here.</p>
<div class="section" id="model-fitting">
<h3>Model fitting<a class="headerlink" href="#model-fitting" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The classes referenced below are accessible via the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">statsmodels.tsa.api</span></code> module.</p>
</div>
<p>To estimate a VAR model, one must first create the model using an <cite>ndarray</cite> of
homogeneous or structured dtype. When using a structured or record array, the
class will use the passed variable names. Otherwise they can be passed
explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"> # some example data</span>
<span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>

<span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">VAR</span><span class="p">,</span> <span class="n">DynamicVAR</span>

<span class="gp">In [5]: </span><span class="n">mdata</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">macrodata</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>

<span class="go"> # prepare the dates index</span>
<span class="gp">In [6]: </span><span class="n">dates</span> <span class="o">=</span> <span class="n">mdata</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">quarterly</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;Q&quot;</span> <span class="o">+</span> <span class="n">dates</span><span class="p">[</span><span class="s2">&quot;quarter&quot;</span><span class="p">]</span>

<span class="gp">In [8]: </span><span class="kn">from</span> <span class="nn">statsmodels.tsa.base.datetools</span> <span class="kn">import</span> <span class="n">dates_from_str</span>

<span class="gp">In [9]: </span><span class="n">quarterly</span> <span class="o">=</span> <span class="n">dates_from_str</span><span class="p">(</span><span class="n">quarterly</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">mdata</span> <span class="o">=</span> <span class="n">mdata</span><span class="p">[[</span><span class="s1">&#39;realgdp&#39;</span><span class="p">,</span><span class="s1">&#39;realcons&#39;</span><span class="p">,</span><span class="s1">&#39;realinv&#39;</span><span class="p">]]</span>

<span class="gp">In [11]: </span><span class="n">mdata</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">quarterly</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mdata</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="go"> # make a VAR model</span>
<span class="gp">In [13]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAR</span></code></a> class assumes that the passed time series are
stationary. Non-stationary or trending data can often be transformed to be
stationary by first-differencing or some other method. For direct analysis of
non-stationary time series, a standard stable VAR(p) model is not
appropriate.</p>
</div>
<p>To actually do the estimation, call the <cite>fit</cite> method with the desired lag
order. Or you can have the model select a lag order based on a standard
information criterion (see below):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gh">Out[15]: </span><span class="go"></span>
<span class="go">  Summary of Regression Results   </span>
<span class="go">==================================</span>
<span class="go">Model:                         VAR</span>
<span class="go">Method:                        OLS</span>
<span class="go">Date:           Mon, 14, May, 2018</span>
<span class="go">Time:                     21:48:15</span>
<span class="gt">--------------------------------------------------------------------</span>
<span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">Equations</span><span class="p">:</span>         <span class="mf">3.00000</span>    <span class="n">BIC</span><span class="p">:</span>                   <span class="o">-</span><span class="mf">27.5830</span>
<span class="ne">Nobs</span>:                     200.000    HQIC:                  -27.7892
<span class="n">Log</span> <span class="n">likelihood</span><span class="p">:</span>           <span class="mf">1962.57</span>    <span class="n">FPE</span><span class="p">:</span>                <span class="mf">7.42129e-13</span>
<span class="ne">AIC</span>:                     -27.9293    Det(Omega_mle):     6.69358e-13
<span class="gt">--------------------------------------------------------------------</span>
<span class="n">Results</span> <span class="k">for</span> <span class="n">equation</span> <span class="n">realgdp</span>
<span class="o">==============================================================================</span>
                 <span class="n">coefficient</span>       <span class="n">std</span><span class="o">.</span> <span class="n">error</span>           <span class="n">t</span><span class="o">-</span><span class="n">stat</span>            <span class="n">prob</span>
<span class="gt">------------------------------------------------------------------------------</span>
<span class="n">const</span>               <span class="mf">0.001527</span>         <span class="mf">0.001119</span>            <span class="mf">1.365</span>           <span class="mf">0.172</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">0.279435</span>         <span class="mf">0.169663</span>           <span class="o">-</span><span class="mf">1.647</span>           <span class="mf">0.100</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.675016</span>         <span class="mf">0.131285</span>            <span class="mf">5.142</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.033219</span>         <span class="mf">0.026194</span>            <span class="mf">1.268</span>           <span class="mf">0.205</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realgdp</span>          <span class="mf">0.008221</span>         <span class="mf">0.173522</span>            <span class="mf">0.047</span>           <span class="mf">0.962</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.290458</span>         <span class="mf">0.145904</span>            <span class="mf">1.991</span>           <span class="mf">0.047</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realinv</span>         <span class="o">-</span><span class="mf">0.007321</span>         <span class="mf">0.025786</span>           <span class="o">-</span><span class="mf">0.284</span>           <span class="mf">0.776</span>
<span class="o">==============================================================================</span>

<span class="n">Results</span> <span class="k">for</span> <span class="n">equation</span> <span class="n">realcons</span>
<span class="o">==============================================================================</span>
                 <span class="n">coefficient</span>       <span class="n">std</span><span class="o">.</span> <span class="n">error</span>           <span class="n">t</span><span class="o">-</span><span class="n">stat</span>            <span class="n">prob</span>
<span class="gt">------------------------------------------------------------------------------</span>
<span class="n">const</span>               <span class="mf">0.005460</span>         <span class="mf">0.000969</span>            <span class="mf">5.634</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">0.100468</span>         <span class="mf">0.146924</span>           <span class="o">-</span><span class="mf">0.684</span>           <span class="mf">0.494</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.268640</span>         <span class="mf">0.113690</span>            <span class="mf">2.363</span>           <span class="mf">0.018</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.025739</span>         <span class="mf">0.022683</span>            <span class="mf">1.135</span>           <span class="mf">0.257</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">0.123174</span>         <span class="mf">0.150267</span>           <span class="o">-</span><span class="mf">0.820</span>           <span class="mf">0.412</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.232499</span>         <span class="mf">0.126350</span>            <span class="mf">1.840</span>           <span class="mf">0.066</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.023504</span>         <span class="mf">0.022330</span>            <span class="mf">1.053</span>           <span class="mf">0.293</span>
<span class="o">==============================================================================</span>

<span class="n">Results</span> <span class="k">for</span> <span class="n">equation</span> <span class="n">realinv</span>
<span class="o">==============================================================================</span>
                 <span class="n">coefficient</span>       <span class="n">std</span><span class="o">.</span> <span class="n">error</span>           <span class="n">t</span><span class="o">-</span><span class="n">stat</span>            <span class="n">prob</span>
<span class="gt">------------------------------------------------------------------------------</span>
<span class="n">const</span>              <span class="o">-</span><span class="mf">0.023903</span>         <span class="mf">0.005863</span>           <span class="o">-</span><span class="mf">4.077</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">1.970974</span>         <span class="mf">0.888892</span>           <span class="o">-</span><span class="mf">2.217</span>           <span class="mf">0.027</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">4.414162</span>         <span class="mf">0.687825</span>            <span class="mf">6.418</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.225479</span>         <span class="mf">0.137234</span>            <span class="mf">1.643</span>           <span class="mf">0.100</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realgdp</span>          <span class="mf">0.380786</span>         <span class="mf">0.909114</span>            <span class="mf">0.419</span>           <span class="mf">0.675</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.800281</span>         <span class="mf">0.764416</span>            <span class="mf">1.047</span>           <span class="mf">0.295</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realinv</span>         <span class="o">-</span><span class="mf">0.124079</span>         <span class="mf">0.135098</span>           <span class="o">-</span><span class="mf">0.918</span>           <span class="mf">0.358</span>
<span class="o">==============================================================================</span>

<span class="n">Correlation</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">residuals</span>
             <span class="n">realgdp</span>  <span class="n">realcons</span>   <span class="n">realinv</span>
<span class="n">realgdp</span>     <span class="mf">1.000000</span>  <span class="mf">0.603316</span>  <span class="mf">0.750722</span>
<span class="n">realcons</span>    <span class="mf">0.603316</span>  <span class="mf">1.000000</span>  <span class="mf">0.131951</span>
<span class="n">realinv</span>     <span class="mf">0.750722</span>  <span class="mf">0.131951</span>  <span class="mf">1.000000</span>
</pre></div>
</div>
<p>Several ways to visualize the data using <cite>matplotlib</cite> are available.</p>
<p>Plotting input time series:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[16]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_plot_input.png" src="_images/var_plot_input.png" />
<p>Plotting time series autocorrelation function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">results</span><span class="o">.</span><span class="n">plot_acorr</span><span class="p">()</span>
<span class="gh">Out[17]: </span><span class="go">&lt;Figure size 1000x1000 with 9 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_plot_acorr.png" src="_images/var_plot_acorr.png" />
</div>
<div class="section" id="lag-order-selection">
<h3>Lag order selection<a class="headerlink" href="#lag-order-selection" title="Permalink to this headline">¶</a></h3>
<p>Choice of lag order can be a difficult problem. Standard analysis employs
likelihood test or information criteria-based order selection. We have
implemented the latter, accessible through the <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAR</span></code></a> class:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">model</span><span class="o">.</span><span class="n">select_order</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gh">Out[18]: </span><span class="go">&lt;statsmodels.tsa.vector_ar.var_model.LagOrderResults at 0x10c89fef0&gt;</span>
</pre></div>
</div>
<p>When calling the <cite>fit</cite> function, one can pass a maximum number of lags and the
order criterion to use for order selection:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ic</span><span class="o">=</span><span class="s1">&#39;aic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="forecasting">
<h3>Forecasting<a class="headerlink" href="#forecasting" title="Permalink to this headline">¶</a></h3>
<p>The linear predictor is the optimal h-step ahead forecast in terms of
mean-squared error:</p>
<div class="math notranslate nohighlight">
\[y_t(h) = \nu + A_1 y_t(h − 1) + \cdots + A_p y_t(h − p)\]</div>
<p>We can use the <cite>forecast</cite> function to produce this forecast. Note that we have
to specify the “initial value” for the forecast:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">lag_order</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">k_ar</span>

<span class="gp">In [21]: </span><span class="n">results</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="n">lag_order</span><span class="p">:],</span> <span class="mi">5</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go"></span>
<span class="go">array([[ 0.0062,  0.005 ,  0.0092],</span>
<span class="go">       [ 0.0043,  0.0034, -0.0024],</span>
<span class="go">       [ 0.0042,  0.0071, -0.0119],</span>
<span class="go">       [ 0.0056,  0.0064,  0.0015],</span>
<span class="go">       [ 0.0063,  0.0067,  0.0038]])</span>
</pre></div>
</div>
<p>The <cite>forecast_interval</cite> function will produce the above forecast along with
asymptotic standard errors. These can be visualized using the <cite>plot_forecast</cite>
function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">results</span><span class="o">.</span><span class="n">plot_forecast</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gh">Out[22]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_forecast.png" src="_images/var_forecast.png" />
</div>
</div>
<div class="section" id="impulse-response-analysis">
<h2>Impulse Response Analysis<a class="headerlink" href="#impulse-response-analysis" title="Permalink to this headline">¶</a></h2>
<p><em>Impulse responses</em> are of interest in econometric studies: they are the
estimated responses to a unit impulse in one of the variables. They are computed
in practice using the MA(<span class="math notranslate nohighlight">\(\infty\)</span>) representation of the VAR(p) process:</p>
<div class="math notranslate nohighlight">
\[Y_t = \mu + \sum_{i=0}^\infty \Phi_i u_{t-i}\]</div>
<p>We can perform an impulse response analysis by calling the <cite>irf</cite> function on a
<cite>VARResults</cite> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">irf</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">irf</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>These can be visualized using the <cite>plot</cite> function, in either orthogonalized or
non-orthogonalized form. Asymptotic standard errors are plotted by default at
the 95% significance level, which can be modified by the user.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Orthogonalization is done using the Cholesky decomposition of the estimated
error covariance matrix <span class="math notranslate nohighlight">\(\hat \Sigma_u\)</span> and hence interpretations may
change depending on variable ordering.</p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">irf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gh">Out[24]: </span><span class="go">&lt;Figure size 1000x1000 with 9 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_irf.png" src="_images/var_irf.png" />
<p>Note the <cite>plot</cite> function is flexible and can plot only variables of interest if
so desired:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">irf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">impulse</span><span class="o">=</span><span class="s1">&#39;realgdp&#39;</span><span class="p">)</span>
<span class="gh">Out[25]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_realgdp.png" src="_images/var_realgdp.png" />
<p>The cumulative effects <span class="math notranslate nohighlight">\(\Psi_n = \sum_{i=0}^n \Phi_i\)</span> can be plotted with
the long run effects as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">irf</span><span class="o">.</span><span class="n">plot_cum_effects</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gh">Out[26]: </span><span class="go">&lt;Figure size 1000x1000 with 9 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_irf_cum.png" src="_images/var_irf_cum.png" />
</div>
<div class="section" id="forecast-error-variance-decomposition-fevd">
<h2>Forecast Error Variance Decomposition (FEVD)<a class="headerlink" href="#forecast-error-variance-decomposition-fevd" title="Permalink to this headline">¶</a></h2>
<p>Forecast errors of component j on k in an i-step ahead forecast can be
decomposed using the orthogonalized impulse responses <span class="math notranslate nohighlight">\(\Theta_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\omega_{jk, i} = \sum_{i=0}^{h-1} (e_j^\prime \Theta_i e_k)^2 / \mathrm{MSE}_j(h)\\\mathrm{MSE}_j(h) = \sum_{i=0}^{h-1} e_j^\prime \Phi_i \Sigma_u \Phi_i^\prime e_j\end{aligned}\end{align} \]</div>
<p>These are computed via the <cite>fevd</cite> function up through a total number of steps ahead:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">fevd</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">fevd</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [28]: </span><span class="n">fevd</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">FEVD for realgdp</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    1.000000  0.000000  0.000000</span>
<span class="go">1    0.864889  0.129253  0.005858</span>
<span class="go">2    0.816725  0.177898  0.005378</span>
<span class="go">3    0.793647  0.197590  0.008763</span>
<span class="go">4    0.777279  0.208127  0.014594</span>

<span class="go">FEVD for realcons</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    0.359877  0.640123  0.000000</span>
<span class="go">1    0.358767  0.635420  0.005813</span>
<span class="go">2    0.348044  0.645138  0.006817</span>
<span class="go">3    0.319913  0.653609  0.026478</span>
<span class="go">4    0.317407  0.652180  0.030414</span>

<span class="go">FEVD for realinv</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    0.577021  0.152783  0.270196</span>
<span class="go">1    0.488158  0.293622  0.218220</span>
<span class="go">2    0.478727  0.314398  0.206874</span>
<span class="go">3    0.477182  0.315564  0.207254</span>
<span class="go">4    0.466741  0.324135  0.209124</span>
</pre></div>
</div>
<p>They can also be visualized through the returned <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.FEVD.html#statsmodels.tsa.vector_ar.var_model.FEVD" title="statsmodels.tsa.vector_ar.var_model.FEVD"><code class="xref py py-class docutils literal notranslate"><span class="pre">FEVD</span></code></a> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">results</span><span class="o">.</span><span class="n">fevd</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[29]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_fevd.png" src="_images/var_fevd.png" />
</div>
<div class="section" id="statistical-tests">
<h2>Statistical tests<a class="headerlink" href="#statistical-tests" title="Permalink to this headline">¶</a></h2>
<p>A number of different methods are provided to carry out hypothesis tests about
the model results and also the validity of the model assumptions (normality,
whiteness / “iid-ness” of errors, etc.).</p>
<div class="section" id="granger-causality">
<h3>Granger causality<a class="headerlink" href="#granger-causality" title="Permalink to this headline">¶</a></h3>
<p>One is often interested in whether a variable or group of variables is “causal”
for another variable, for some definition of “causal”. In the context of VAR
models, one can say that a set of variables are Granger-causal within one of the
VAR equations. We will not detail the mathematics or definition of Granger
causality, but leave it to the reader. The <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARResults</span></code></a> object has the
<cite>test_causality</cite> method for performing either a Wald (<span class="math notranslate nohighlight">\(\chi^2\)</span>) test or an
F-test.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">results</span><span class="o">.</span><span class="n">test_causality</span><span class="p">(</span><span class="s1">&#39;realgdp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;realinv&#39;</span><span class="p">,</span> <span class="s1">&#39;realcons&#39;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gh">Out[30]: </span><span class="go">&lt;statsmodels.tsa.vector_ar.hypothesis_test_results.CausalityTestResults at 0x10ca15978&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="normality">
<h3>Normality<a class="headerlink" href="#normality" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="whiteness-of-residuals">
<h3>Whiteness of residuals<a class="headerlink" href="#whiteness-of-residuals" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="dynamic-vector-autoregressions">
<h2>Dynamic Vector Autoregressions<a class="headerlink" href="#dynamic-vector-autoregressions" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To use this functionality, <a class="reference external" href="https://pypi.python.org/pypi/pandas">pandas</a>
must be installed. See the <a class="reference external" href="http://pandas.pydata.org">pandas documentation</a> for more information on the below data
structures.</p>
</div>
<p>One is often interested in estimating a moving-window regression on time series
data for the purposes of making forecasts throughout the data sample. For
example, we may wish to produce the series of 2-step-ahead forecasts produced by
a VAR(p) model estimated at each point in time.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [31]: </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [32]: </span><span class="kn">import</span> <span class="nn">pandas.util.testing</span> <span class="kn">as</span> <span class="nn">ptest</span>

<span class="gp">In [33]: </span><span class="n">ptest</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>

<span class="gp">In [34]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">ptest</span><span class="o">.</span><span class="n">makeTimeDataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">data</span>
<span class="gh">Out[35]: </span><span class="go"></span>
<span class="go">                    A          B          C          D</span>
<span class="go">2000-01-03   1.624345  -1.719394  -0.153236   1.301225</span>
<span class="go">2000-01-04   1.012589  -1.662273  -2.585745   0.988833</span>
<span class="go">2000-01-05   0.484417  -2.461821  -2.077760   0.717604</span>
<span class="go">2000-01-06  -0.588551  -2.753416  -2.401793   2.580517</span>
<span class="go">2000-01-07   0.276856  -3.012398  -3.912869   1.937644</span>
<span class="go">...               ...        ...        ...        ...</span>
<span class="go">2001-11-26  29.552085  14.274036  39.222558 -13.243907</span>
<span class="go">2001-11-27  30.080964  11.996738  38.589968 -12.682989</span>
<span class="go">2001-11-28  27.843878  11.927114  38.380121 -13.604648</span>
<span class="go">2001-11-29  26.736165  12.280984  40.277282 -12.957273</span>
<span class="go">2001-11-30  26.718447  12.094029  38.895890 -11.570447</span>

<span class="go">[500 rows x 4 columns]</span>

<span class="gp">In [36]: </span><span class="n">var</span> <span class="o">=</span> <span class="n">DynamicVAR</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lag_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">window_type</span><span class="o">=</span><span class="s1">&#39;expanding&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The estimated coefficients for the dynamic model are returned as a
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Panel.html#pandas.Panel" title="(in pandas v0.22.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Panel</span></code></a> object, which can allow you to easily examine, for
example, all of the model coefficients by equation or by date:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [37]: </span><span class="kn">import</span> <span class="nn">datetime</span> <span class="kn">as</span> <span class="nn">dt</span>

<span class="gp">In [38]: </span><span class="n">var</span><span class="o">.</span><span class="n">coefs</span>
<span class="gh">Out[38]: </span><span class="go"></span>
<span class="go">&lt;class &#39;pandas.core.panel.Panel&#39;&gt;</span>
<span class="go">Dimensions: 9 (items) x 489 (major_axis) x 4 (minor_axis)</span>
<span class="go">Items axis: L1.A to intercept</span>
<span class="go">Major_axis axis: 2000-01-18 00:00:00 to 2001-11-30 00:00:00</span>
<span class="go">Minor_axis axis: A to D</span>

<span class="go"> # all estimated coefficients for equation A</span>
<span class="gp">In [39]: </span><span class="n">var</span><span class="o">.</span><span class="n">coefs</span><span class="o">.</span><span class="n">minor_xs</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">                                                                                                                                                                                                                        &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="go">DatetimeIndex: 489 entries, 2000-01-18 to 2001-11-30</span>
<span class="go">Freq: B</span>
<span class="go">Data columns (total 9 columns):</span>
<span class="go">L1.A         489 non-null float64</span>
<span class="go">L1.B         489 non-null float64</span>
<span class="go">L1.C         489 non-null float64</span>
<span class="go">L1.D         489 non-null float64</span>
<span class="go">L2.A         489 non-null float64</span>
<span class="go">L2.B         489 non-null float64</span>
<span class="go">L2.C         489 non-null float64</span>
<span class="go">L2.D         489 non-null float64</span>
<span class="go">intercept    489 non-null float64</span>
<span class="go">dtypes: float64(9)</span>
<span class="go">memory usage: 58.2 KB</span>

<span class="go"> # coefficients on 11/30/2001</span>
<span class="gp">In [40]: </span><span class="n">var</span><span class="o">.</span><span class="n">coefs</span><span class="o">.</span><span class="n">major_xs</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Out[40]: </span>
<span class="go">                  A         B         C         D</span>
<span class="go">L1.A       0.971964  0.045960  0.003883  0.003822</span>
<span class="go">L1.B       0.043951  0.937964  0.000735  0.020823</span>
<span class="go">L1.C       0.038144  0.018260  0.977037  0.129287</span>
<span class="go">L1.D       0.038618  0.036180  0.052855  1.002657</span>
<span class="go">L2.A       0.013588 -0.046791  0.011558 -0.005300</span>
<span class="go">L2.B      -0.048885  0.041853  0.012185 -0.048732</span>
<span class="go">L2.C      -0.029426 -0.015238  0.011520 -0.119014</span>
<span class="go">L2.D      -0.049945 -0.025419 -0.045621 -0.019496</span>
<span class="go">intercept  0.113331  0.248795 -0.058837 -0.089302</span>
</pre></div>
</div>
<p>Dynamic forecasts for a given number of steps ahead can be produced using the
<cite>forecast</cite> function and return a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataMatrix</span></code> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">var</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[41]: </span><span class="go"></span>
<span class="go">                     A          B           C           D</span>
<span class="go">2000-01-20 -260.325888 -23.141610  104.930427 -134.489882</span>
<span class="go">2000-01-21  -52.121483 -11.566786   29.383608  -15.099109</span>
<span class="go">2000-01-24  -54.900049 -23.894858   40.470913  -19.199059</span>
<span class="go">2000-01-25   -7.493484  -4.057529    6.682707    4.301623</span>
<span class="go">2000-01-26   -6.866108  -5.065873    5.623590    0.796081</span>
<span class="go">...                ...        ...         ...         ...</span>
<span class="go">2001-11-26   31.886126  13.515527   37.618145  -11.464682</span>
<span class="go">2001-11-27   32.314633  14.237672   37.397691  -12.809727</span>
<span class="go">2001-11-28   30.896528  15.488388   38.541596  -13.129524</span>
<span class="go">2001-11-29   30.077228  15.533337   38.734096  -12.900891</span>
<span class="go">2001-11-30   30.510380  13.491615   38.088228  -12.384976</span>

<span class="go">[487 rows x 4 columns]</span>
</pre></div>
</div>
<p>The forecasts can be visualized using <cite>plot_forecast</cite>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">var</span><span class="o">.</span><span class="n">plot_forecast</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/dvar_forecast.png" src="_images/dvar_forecast.png" />
</div>
<div class="section" id="module-statsmodels.tsa.vector_ar">
<span id="class-reference"></span><h2>Class Reference<a class="headerlink" href="#module-statsmodels.tsa.vector_ar" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">var_model.VAR</span></code></a>(endog[,&nbsp;exog,&nbsp;dates,&nbsp;freq,&nbsp;…])</td>
<td>Fit VAR(p) process and do lag order selection</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARProcess.html#statsmodels.tsa.vector_ar.var_model.VARProcess" title="statsmodels.tsa.vector_ar.var_model.VARProcess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">var_model.VARProcess</span></code></a>(coefs,&nbsp;coefs_exog,&nbsp;sigma_u)</td>
<td>Class represents a known VAR(p) process</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">var_model.VARResults</span></code></a>(endog,&nbsp;endog_lagged,&nbsp;…)</td>
<td>Estimate VAR(p) process with fixed number of lags</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.irf.IRAnalysis.html#statsmodels.tsa.vector_ar.irf.IRAnalysis" title="statsmodels.tsa.vector_ar.irf.IRAnalysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">irf.IRAnalysis</span></code></a>(model[,&nbsp;P,&nbsp;periods,&nbsp;order,&nbsp;…])</td>
<td>Impulse response analysis class.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.FEVD.html#statsmodels.tsa.vector_ar.var_model.FEVD" title="statsmodels.tsa.vector_ar.var_model.FEVD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">var_model.FEVD</span></code></a>(model[,&nbsp;P,&nbsp;periods])</td>
<td>Compute and plot Forecast error variance decomposition and asymptotic standard errors</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.dynamic.DynamicVAR.html#statsmodels.tsa.vector_ar.dynamic.DynamicVAR" title="statsmodels.tsa.vector_ar.dynamic.DynamicVAR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamic.DynamicVAR</span></code></a>(data[,&nbsp;lag_order,&nbsp;…])</td>
<td>Estimates time-varying vector autoregression (VAR(p)) using equation-by-equation least squares</td>
</tr>
</tbody>
</table>
</div>
</div>





          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Vector Autoregressions <code class="docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code></a><ul>
<li><a class="reference internal" href="#var-p-processes">VAR(p) processes</a><ul>
<li><a class="reference internal" href="#model-fitting">Model fitting</a></li>
<li><a class="reference internal" href="#lag-order-selection">Lag order selection</a></li>
<li><a class="reference internal" href="#forecasting">Forecasting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#impulse-response-analysis">Impulse Response Analysis</a></li>
<li><a class="reference internal" href="#forecast-error-variance-decomposition-fevd">Forecast Error Variance Decomposition (FEVD)</a></li>
<li><a class="reference internal" href="#statistical-tests">Statistical tests</a><ul>
<li><a class="reference internal" href="#granger-causality">Granger causality</a></li>
<li><a class="reference internal" href="#normality">Normality</a></li>
<li><a class="reference internal" href="#whiteness-of-residuals">Whiteness of residuals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynamic-vector-autoregressions">Dynamic Vector Autoregressions</a></li>
<li><a class="reference internal" href="#module-statsmodels.tsa.vector_ar">Class Reference</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="generated/statsmodels.tsa.statespace.tools.validate_vector_shape.html"
                        title="previous chapter">statsmodels.tsa.statespace.tools.validate_vector_shape</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="duration.html"
                        title="next chapter">Methods for Survival and Duration Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/vector_ar.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2017, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>