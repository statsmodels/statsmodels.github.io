

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>statsmodels.stats.correlation_tools.corr_nearest_factor &#8212; statsmodels 0.9.0 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/statsmodels_hybi_favico.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="statsmodels.stats.correlation_tools.corr_thresholded" href="statsmodels.stats.correlation_tools.corr_thresholded.html" />
    <link rel="prev" title="statsmodels.stats.correlation_tools.corr_nearest" href="statsmodels.stats.correlation_tools.corr_nearest.html" />
<link rel="stylesheet" href="../_static/examples.css" type="text/css" />
<link rel="stylesheet" href="../_static/facebox.css" type="text/css" />
<script type="text/javascript" src="../_static/scripts.js">
</script>
<script type="text/javascript" src="../_static/facebox.js">
</script>
<script type="text/javascript">
$.facebox.settings.closeImage = "../_static/closelabel.png"
$.facebox.settings.loadingImage = "../_static/loading.gif"
</script>

  </head><body>
<div class="headerwrap">
    <div class = "header">
        
        <a href = "../index.html">
<img src="../_static/statsmodels_hybi_banner.png" alt="Logo"
    style="padding-left: 15px"/></a>
        
    </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="statsmodels.stats.correlation_tools.corr_thresholded.html" title="statsmodels.stats.correlation_tools.corr_thresholded"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="statsmodels.stats.correlation_tools.corr_nearest.html" title="statsmodels.stats.correlation_tools.corr_nearest"
             accesskey="P">previous</a> |</li>
<li><a href ="../install.html">Install</a></li> &nbsp;|&nbsp;
<li><a href="https://groups.google.com/forum/?hl=en#!forum/pystatsmodels">Support</a></li> &nbsp;|&nbsp;
<li><a href="https://github.com/statsmodels/statsmodels/issues">Bugs</a></li> &nbsp;|&nbsp;
<li><a href="../dev/index.html">Develop</a></li> &nbsp;|&nbsp;
<li><a href="../examples/index.html">Examples</a></li> &nbsp;|&nbsp;
<li><a href="../faq.html">FAQ</a></li> &nbsp;|&nbsp;

          <li class="nav-item nav-item-1"><a href="../stats.html" accesskey="U">Statistics <code class="docutils literal notranslate"><span class="pre">stats</span></code></a> |</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            




  <div class="section" id="statsmodels-stats-correlation-tools-corr-nearest-factor">
<h1>statsmodels.stats.correlation_tools.corr_nearest_factor<a class="headerlink" href="#statsmodels-stats-correlation-tools-corr-nearest-factor" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="statsmodels.stats.correlation_tools.corr_nearest_factor">
<code class="descclassname">statsmodels.stats.correlation_tools.</code><code class="descname">corr_nearest_factor</code><span class="sig-paren">(</span><em>corr</em>, <em>rank</em>, <em>ctol=1e-06</em>, <em>lam_min=1e-30</em>, <em>lam_max=1e+30</em>, <em>maxiter=1000</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/statsmodels/stats/correlation_tools.html#corr_nearest_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#statsmodels.stats.correlation_tools.corr_nearest_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the nearest correlation matrix with factor structure to a
given square matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>corr</strong> (<em>square array</em>) – The target matrix (to which the nearest correlation matrix is
sought).  Must be square, but need not be positive
semidefinite.</li>
<li><strong>rank</strong> (<em>positive integer</em>) – The rank of the factor structure of the solution, i.e., the
number of linearly independent columns of X.</li>
<li><strong>ctol</strong> (<em>positive real</em>) – Convergence criterion.</li>
<li><strong>lam_min</strong> (<em>float</em>) – Tuning parameter for spectral projected gradient optimization
(smallest allowed step in the search direction).</li>
<li><strong>lam_max</strong> (<em>float</em>) – Tuning parameter for spectral projected gradient optimization
(largest allowed step in the search direction).</li>
<li><strong>maxiter</strong> (<em>integer</em>) – Maximum number of iterations in spectral projected gradient
optimization.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rslt</strong> – rslt.corr is a FactoredPSDMatrix defining the estimated
correlation structure.  Other fields of <cite>rslt</cite> contain
returned values from spg_optim.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Bunch</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>A correlation matrix has factor structure if it can be written in
the form I + XX’ - diag(XX’), where X is n x k with linearly
independent columns, and with each row having sum of squares at
most equal to 1.  The approximation is made in terms of the
Frobenius norm.</p>
<p>This routine is useful when one has an approximate correlation
matrix that is not positive semidefinite, and there is need to
estimate the inverse, square root, or inverse square root of the
population correlation matrix.  The factor structure allows these
tasks to be done without constructing any n x n matrices.</p>
<p>This is a non-convex problem with no known gauranteed globally
convergent algorithm for computing the solution.  Borsdof, Higham
and Raydan (2010) compared several methods for this problem and
found the spectral projected gradient (SPG) method (used here) to
perform best.</p>
<p>The input matrix <cite>corr</cite> can be a dense numpy array or any scipy
sparse matrix.  The latter is useful if the input matrix is
obtained by thresholding a very large sample correlation matrix.
If <cite>corr</cite> is sparse, the calculations are optimized to save
memory, so no working matrix with more than 10^6 elements is
constructed.</p>
<p class="rubric">References</p>
<p>R Borsdof, N Higham, M Raydan (2010).  Computing a nearest
correlation matrix with factor structure. SIAM J Matrix Anal
Appl, 31:5, 2603-2622.
<a class="reference external" href="http://eprints.ma.man.ac.uk/1523/01/covered/MIMS_ep2009_87.pdf">http://eprints.ma.man.ac.uk/1523/01/covered/MIMS_ep2009_87.pdf</a></p>
<p class="rubric">Examples</p>
<p>Hard thresholding a correlation matrix may result in a matrix that
is not positive semidefinite.  We can approximate a hard
thresholded correlation matrix with a PSD matrix as follows, where
<cite>corr</cite> is the input correlation matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">statsmodels.stats.correlation_tools</span> <span class="k">import</span> <span class="n">corr_nearest_factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">corr</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rslt</span> <span class="o">=</span> <span class="n">corr_nearest_factor</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>





          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="statsmodels.stats.correlation_tools.corr_nearest.html"
                        title="previous chapter">statsmodels.stats.correlation_tools.corr_nearest</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="statsmodels.stats.correlation_tools.corr_thresholded.html"
                        title="next chapter">statsmodels.stats.correlation_tools.corr_thresholded</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/statsmodels.stats.correlation_tools.corr_nearest_factor.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2017, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>