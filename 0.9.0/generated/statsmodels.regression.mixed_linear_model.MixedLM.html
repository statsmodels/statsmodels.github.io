

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>statsmodels.regression.mixed_linear_model.MixedLM &#8212; statsmodels 0.9.0 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/statsmodels_hybi_favico.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="statsmodels.regression.mixed_linear_model.MixedLM.fit" href="statsmodels.regression.mixed_linear_model.MixedLM.fit.html" />
    <link rel="prev" title="Linear Mixed Effects Models" href="../mixed_linear.html" />
<link rel="stylesheet" href="../_static/examples.css" type="text/css" />
<link rel="stylesheet" href="../_static/facebox.css" type="text/css" />
<script type="text/javascript" src="../_static/scripts.js">
</script>
<script type="text/javascript" src="../_static/facebox.js">
</script>
<script type="text/javascript">
$.facebox.settings.closeImage = "../_static/closelabel.png"
$.facebox.settings.loadingImage = "../_static/loading.gif"
</script>

  </head><body>
<div class="headerwrap">
    <div class = "header">
        
        <a href = "../index.html">
<img src="../_static/statsmodels_hybi_banner.png" alt="Logo"
    style="padding-left: 15px"/></a>
        
    </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="statsmodels.regression.mixed_linear_model.MixedLM.fit.html" title="statsmodels.regression.mixed_linear_model.MixedLM.fit"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../mixed_linear.html" title="Linear Mixed Effects Models"
             accesskey="P">previous</a> |</li>
<li><a href ="../install.html">Install</a></li> &nbsp;|&nbsp;
<li><a href="https://groups.google.com/forum/?hl=en#!forum/pystatsmodels">Support</a></li> &nbsp;|&nbsp;
<li><a href="https://github.com/statsmodels/statsmodels/issues">Bugs</a></li> &nbsp;|&nbsp;
<li><a href="../dev/index.html">Develop</a></li> &nbsp;|&nbsp;
<li><a href="../examples/index.html">Examples</a></li> &nbsp;|&nbsp;
<li><a href="../faq.html">FAQ</a></li> &nbsp;|&nbsp;

          <li class="nav-item nav-item-1"><a href="../mixed_linear.html" accesskey="U">Linear Mixed Effects Models</a> |</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            




  <div class="section" id="statsmodels-regression-mixed-linear-model-mixedlm">
<h1>statsmodels.regression.mixed_linear_model.MixedLM<a class="headerlink" href="#statsmodels-regression-mixed-linear-model-mixedlm" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="statsmodels.regression.mixed_linear_model.MixedLM">
<em class="property">class </em><code class="descclassname">statsmodels.regression.mixed_linear_model.</code><code class="descname">MixedLM</code><span class="sig-paren">(</span><em>endog</em>, <em>exog</em>, <em>groups</em>, <em>exog_re=None</em>, <em>exog_vc=None</em>, <em>use_sqrt=True</em>, <em>missing='none'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/statsmodels/regression/mixed_linear_model.html#MixedLM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#statsmodels.regression.mixed_linear_model.MixedLM" title="Permalink to this definition">¶</a></dt>
<dd><p>An object specifying a linear mixed effects model.  Use the <cite>fit</cite>
method to fit the model and obtain a results object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>endog</strong> (<em>1d array-like</em>) – The dependent variable</li>
<li><strong>exog</strong> (<em>2d array-like</em>) – A matrix of covariates used to determine the
mean structure (the “fixed effects” covariates).</li>
<li><strong>groups</strong> (<em>1d array-like</em>) – A vector of labels determining the groups – data from
different groups are independent</li>
<li><strong>exog_re</strong> (<em>2d array-like</em>) – A matrix of covariates used to determine the variance and
covariance structure (the “random effects” covariates).  If
None, defaults to a random intercept for each group.</li>
<li><strong>exog_vc</strong> (<em>dict-like</em>) – A dictionary containing specifications of the variance
component terms.  See below for details.</li>
<li><strong>use_sqrt</strong> (<em>bool</em>) – If True, optimization is carried out using the lower
triangle of the square root of the random effects
covariance matrix, otherwise it is carried out using the
lower triangle of the random effects covariance matrix.</li>
<li><strong>missing</strong> (<em>string</em>) – The approach to missing data handling</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><cite>exog_vc</cite> is a dictionary of dictionaries.  Specifically,
<cite>exog_vc[a][g]</cite> is a matrix whose columns are linearly combined
using independent random coefficients.  This random term then
contributes to the variance structure of the data for group <cite>g</cite>.
The random coefficients all have mean zero, and have the same
variance.  The matrix must be <cite>m x k</cite>, where <cite>m</cite> is the number of
observations in group <cite>g</cite>.  The number of columns may differ among
the top-level groups.</p>
<p>The covariates in <cite>exog</cite>, <cite>exog_re</cite> and <cite>exog_vc</cite> may (but need
not) partially or wholly overlap.</p>
<p><cite>use_sqrt</cite> should almost always be set to True.  The main use case
for use_sqrt=False is when complicated patterns of fixed values in
the covariance structure are set (using the <cite>free</cite> argument to
<cite>fit</cite>) that cannot be expressed in terms of the Cholesky factor L.</p>
<p class="rubric">Examples</p>
<p>A basic mixed model with fixed effects for the columns of
<code class="docutils literal notranslate"><span class="pre">exog</span></code> and a random intercept for each distinct value of
<code class="docutils literal notranslate"><span class="pre">group</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">MixedLM</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>A mixed model with fixed effects for the columns of <code class="docutils literal notranslate"><span class="pre">exog</span></code> and
correlated random coefficients for the columns of <code class="docutils literal notranslate"><span class="pre">exog_re</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">MixedLM</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">exog_re</span><span class="o">=</span><span class="n">exog_re</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>A mixed model with fixed effects for the columns of <code class="docutils literal notranslate"><span class="pre">exog</span></code> and
independent random coefficients for the columns of <code class="docutils literal notranslate"><span class="pre">exog_re</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">free</span> <span class="o">=</span> <span class="n">MixedLMParams</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span>
<span class="go">                 fe_params=np.ones(exog.shape[1]),</span>
<span class="go">                 cov_re=np.eye(exog_re.shape[1]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">MixedLM</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">exog_re</span><span class="o">=</span><span class="n">exog_re</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">free</span><span class="o">=</span><span class="n">free</span><span class="p">)</span>
</pre></div>
</div>
<p>A different way to specify independent random coefficients for the
columns of <code class="docutils literal notranslate"><span class="pre">exog_re</span></code>.  In this example <code class="docutils literal notranslate"><span class="pre">groups</span></code> must be a
Pandas Series with compatible indexing with <code class="docutils literal notranslate"><span class="pre">exog_re</span></code>, and
<code class="docutils literal notranslate"><span class="pre">exog_re</span></code> has two columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vc</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vc</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="n">exog_re</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">g</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vc</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="n">exog_re</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">g</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">MixedLM</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">vcomp</span><span class="o">=</span><span class="n">vc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.fit.html#statsmodels.regression.mixed_linear_model.MixedLM.fit" title="statsmodels.regression.mixed_linear_model.MixedLM.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>([start_params,&nbsp;reml,&nbsp;niter_sa,&nbsp;do_cg,&nbsp;…])</td>
<td>Fit a linear mixed model to the data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.fit_regularized.html#statsmodels.regression.mixed_linear_model.MixedLM.fit_regularized" title="statsmodels.regression.mixed_linear_model.MixedLM.fit_regularized"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_regularized</span></code></a>([start_params,&nbsp;method,&nbsp;…])</td>
<td>Fit a model in which the fixed effects parameters are penalized.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.from_formula.html#statsmodels.regression.mixed_linear_model.MixedLM.from_formula" title="statsmodels.regression.mixed_linear_model.MixedLM.from_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_formula</span></code></a>(formula,&nbsp;data[,&nbsp;re_formula,&nbsp;…])</td>
<td>Create a Model from a formula and dataframe.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.get_fe_params.html#statsmodels.regression.mixed_linear_model.MixedLM.get_fe_params" title="statsmodels.regression.mixed_linear_model.MixedLM.get_fe_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fe_params</span></code></a>(cov_re,&nbsp;vcomp)</td>
<td>Use GLS to update the fixed effects parameter estimates.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.get_scale.html#statsmodels.regression.mixed_linear_model.MixedLM.get_scale" title="statsmodels.regression.mixed_linear_model.MixedLM.get_scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_scale</span></code></a>(fe_params,&nbsp;cov_re,&nbsp;vcomp)</td>
<td>Returns the estimated error variance based on given estimates of the slopes and random effects covariance matrix.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.group_list.html#statsmodels.regression.mixed_linear_model.MixedLM.group_list" title="statsmodels.regression.mixed_linear_model.MixedLM.group_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">group_list</span></code></a>(array)</td>
<td>Returns <cite>array</cite> split into subarrays corresponding to the grouping structure.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.hessian.html#statsmodels.regression.mixed_linear_model.MixedLM.hessian" title="statsmodels.regression.mixed_linear_model.MixedLM.hessian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hessian</span></code></a>(params)</td>
<td>Returns the model’s Hessian matrix.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.information.html#statsmodels.regression.mixed_linear_model.MixedLM.information" title="statsmodels.regression.mixed_linear_model.MixedLM.information"><code class="xref py py-obj docutils literal notranslate"><span class="pre">information</span></code></a>(params)</td>
<td>Fisher information matrix of model</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.initialize.html#statsmodels.regression.mixed_linear_model.MixedLM.initialize" title="statsmodels.regression.mixed_linear_model.MixedLM.initialize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize</span></code></a>()</td>
<td>Initialize (possibly re-initialize) a Model instance.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.loglike.html#statsmodels.regression.mixed_linear_model.MixedLM.loglike" title="statsmodels.regression.mixed_linear_model.MixedLM.loglike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loglike</span></code></a>(params[,&nbsp;profile_fe])</td>
<td>Evaluate the (profile) log-likelihood of the linear mixed effects model.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.predict.html#statsmodels.regression.mixed_linear_model.MixedLM.predict" title="statsmodels.regression.mixed_linear_model.MixedLM.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(params[,&nbsp;exog])</td>
<td>Return predicted values from a design matrix.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.score.html#statsmodels.regression.mixed_linear_model.MixedLM.score" title="statsmodels.regression.mixed_linear_model.MixedLM.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(params[,&nbsp;profile_fe])</td>
<td>Returns the score vector of the profile log-likelihood.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.score_full.html#statsmodels.regression.mixed_linear_model.MixedLM.score_full" title="statsmodels.regression.mixed_linear_model.MixedLM.score_full"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_full</span></code></a>(params,&nbsp;calc_fe)</td>
<td>Returns the score with respect to untransformed parameters.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="statsmodels.regression.mixed_linear_model.MixedLM.score_sqrt.html#statsmodels.regression.mixed_linear_model.MixedLM.score_sqrt" title="statsmodels.regression.mixed_linear_model.MixedLM.score_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_sqrt</span></code></a>(params[,&nbsp;calc_fe])</td>
<td>Returns the score with respect to transformed parameters.</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">endog_names</span></code></td>
<td>Names of endogenous variables</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">exog_names</span></code></td>
<td>Names of exogenous variables</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>





          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../mixed_linear.html"
                        title="previous chapter">Linear Mixed Effects Models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="statsmodels.regression.mixed_linear_model.MixedLM.fit.html"
                        title="next chapter">statsmodels.regression.mixed_linear_model.MixedLM.fit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/statsmodels.regression.mixed_linear_model.MixedLM.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2017, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>