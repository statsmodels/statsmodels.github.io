



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="statespace_concentrated_scale.html">
      
      
        <link rel="next" href="theta-model.html">
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>State space models - Chandrasekhar recursions - statsmodels 0.15.0 (+716)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css?v=9e56d0d2" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#State-space-models-and-the-Kalman-filter" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+716)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+716)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+716)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              State space models - Chandrasekhar recursions
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+716)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+716)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+716)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/install.rst (reference label)"><span>Installing statsmodels</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/gettingstarted.rst (reference label)"><span>Getting started</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/user-guide.rst (reference label)"><span>User Guide</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst (reference label)"><span>Examples</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples/index.rst (reference label)"><span>Examples</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#linear-regression-models (reference label)"><span>Linear Regression Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#plotting (reference label)"><span>Plotting</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#discrete-choice-models (reference label)"><span>Discrete Choice Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#nonparametric-statistics (reference label)"><span>Nonparametric Statistics</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#generalized-linear-models (reference label)"><span>Generalized Linear Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#robust-regression (reference label)"><span>Robust Regression</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#generalized-estimating-equations (reference label)"><span>Generalized Estimating Equations</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#statistics (reference label)"><span>Statistics</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#time-series-analysis (reference label)"><span>Time Series Analysis</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#state-space-models (reference label)"><span>State space models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#state-space-models-technical-notes (reference label)"><span>State space models -<wbr> Technical notes</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples/index.rst#state-space-models-technical-notes (reference label)"><span>State space models -<wbr> Technical notes</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_concentrated_scale.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_concentrated_scale.ipynb (reference label)"><span>State space models -<wbr> concentrating the scale out of the likelihood function</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb (reference label)"><span>State space models -<wbr> Chandrasekhar recursions</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb (reference label)"><span>State space models -<wbr> Chandrasekhar recursions</span></span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#State-space-models-and-the-Kalman-filter" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#state-space-models-and-the-kalman-filter (reference label)"><span>State space models and the Kalman filter</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Example:-seasonal-autoregression" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#example:-seasonal-autoregression (reference label)"><span>Example:<wbr> seasonal autoregression</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#State-space-models-and-the-Chandrasekhar-recursions" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#state-space-models-and-the-chandrasekhar-recursions (reference label)"><span>State space models and the Chandrasekhar recursions</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Convergence" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#convergence (reference label)"><span>Convergence</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Practical-example" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#practical-example (reference label)"><span>Practical example</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Aside-on-multithreaded-matrix-algebra-routines" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#aside-on-multithreaded-matrix-algebra-routines (reference label)"><span>Aside on multithreaded matrix algebra routines</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Chandrasekhar-recursions-and-the-univariate-filtering-approach" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#chandrasekhar-recursions-and-the-univariate-filtering-approach (reference label)"><span>Chandrasekhar recursions and the univariate filtering approach</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Bibliography" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#bibliography (reference label)"><span>Bibliography</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#forecasting (reference label)"><span>Forecasting</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#multivariate-methods (reference label)"><span>Multivariate Methods</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#user-notes (reference label)"><span>User Notes</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)"><span>API Reference</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/about.rst (reference label)"><span>About statsmodels</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/dev/index.rst (reference label)"><span>Developer Page</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/release/index.rst (reference label)"><span>Release Notes</span></span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#State-space-models-and-the-Kalman-filter" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#state-space-models-and-the-kalman-filter (reference label)"><span>State space models and the Kalman filter</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Example:-seasonal-autoregression" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#example:-seasonal-autoregression (reference label)"><span>Example:<wbr> seasonal autoregression</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#State-space-models-and-the-Chandrasekhar-recursions" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#state-space-models-and-the-chandrasekhar-recursions (reference label)"><span>State space models and the Chandrasekhar recursions</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Convergence" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#convergence (reference label)"><span>Convergence</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Practical-example" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#practical-example (reference label)"><span>Practical example</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Aside-on-multithreaded-matrix-algebra-routines" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#aside-on-multithreaded-matrix-algebra-routines (reference label)"><span>Aside on multithreaded matrix algebra routines</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Chandrasekhar-recursions-and-the-univariate-filtering-approach" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#chandrasekhar-recursions-and-the-univariate-filtering-approach (reference label)"><span>Chandrasekhar recursions and the univariate filtering approach</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Bibliography" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_chandrasekhar.ipynb#bibliography (reference label)"><span>Bibliography</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="State-space-models---Chandrasekhar-recursions">State space models - Chandrasekhar recursions<a class="headerlink" href="#State-space-models---Chandrasekhar-recursions" title="Link to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
</code></pre></div>
</div>
</div>
<p>Although most operations related to state space models rely on the Kalman filtering recursions, in some special cases one can use a separate method often called “Chandrasekhar recursions”. These provide an alternative way to iteratively compute the conditional moments of the state vector, and in some cases they can be substantially less computationally intensive than the Kalman filter recursions. For complete details, see the paper “Using the ‘Chandrasekhar Recursions’ for Likelihood Evaluation
of DSGE Models” (Herbst, 2015). Here we just sketch the basic idea.</p>
<h2 id="State-space-models-and-the-Kalman-filter">State space models and the Kalman filter<a class="headerlink" href="#State-space-models-and-the-Kalman-filter" title="Link to this heading">¶</a></h2>
<p>Recall that a time-invariant state space model can be written:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp;= Z \alpha_t + \varepsilon_t, \qquad \varepsilon_t \sim N(0, H) \\
\alpha_{t+1} &amp; = T \alpha_t + R \eta_t, \qquad \eta_t \sim N(0, Q) \\
\alpha_1 &amp; \sim N(a_1, P_1)
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_t\)</span> is a <span class="math notranslate nohighlight">\(p \times 1\)</span> vector and <span class="math notranslate nohighlight">\(\alpha_t\)</span> is an <span class="math notranslate nohighlight">\(m \times 1\)</span> vector.</p>
<p>Each iteration of the Kalman filter, say at time <span class="math notranslate nohighlight">\(t\)</span>, can be split into three parts:</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong>: specification of <span class="math notranslate nohighlight">\(a_t\)</span> and <span class="math notranslate nohighlight">\(P_t\)</span> that define the conditional state distribution, <span class="math notranslate nohighlight">\(\alpha_t \mid y^{t-1} \sim N(a_t, P_t)\)</span>.</p></li>
<li><p><strong>Updating</strong>: computation of <span class="math notranslate nohighlight">\(a_{t|t}\)</span> and <span class="math notranslate nohighlight">\(P_{t|t}\)</span> that define the conditional state distribution, <span class="math notranslate nohighlight">\(\alpha_t \mid y^{t} \sim N(a_{t|t}, P_{t|t})\)</span>.</p></li>
<li><p><strong>Prediction</strong>: computation of <span class="math notranslate nohighlight">\(a_{t+1}\)</span> and <span class="math notranslate nohighlight">\(P_{t+1}\)</span> that define the conditional state distribution, <span class="math notranslate nohighlight">\(\alpha_{t+1} \mid y^{t} \sim N(a_{t+1}, P_{t+1})\)</span>.</p></li>
</ol>
<p>Of course after the first iteration, the prediction part supplies the values required for initialization of the next step.</p>
<p>Focusing on the prediction step, the Kalman filter recursions yield:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
a_{t+1} &amp; = T a_{t|t} \\
P_{t+1} &amp; = T P_{t|t} T' + R Q R' \\
\end{aligned}\end{split}\]</div>
<p>where the matrices <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_{t|t}\)</span> are each <span class="math notranslate nohighlight">\(m \times m\)</span>, where <span class="math notranslate nohighlight">\(m\)</span> is the size of the state vector <span class="math notranslate nohighlight">\(\alpha\)</span>. In some cases, the state vector can become extremely large, which can imply that the matrix multiplications required to produce <span class="math notranslate nohighlight">\(P_{t+1}\)</span> can be become computationally intensive.</p>
<h2 id="Example:-seasonal-autoregression">Example: seasonal autoregression<a class="headerlink" href="#Example:-seasonal-autoregression" title="Link to this heading">¶</a></h2>
<p>As an example, notice that an AR(r) model (we use <span class="math notranslate nohighlight">\(r\)</span> here since we already used <span class="math notranslate nohighlight">\(p\)</span> as the dimension of the observation vector) can be put into state space form as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp;= \alpha_t \\
\alpha_{t+1} &amp; = T \alpha_t + R \eta_t, \qquad \eta_t \sim N(0, Q)
\end{aligned}\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
T = \begin{bmatrix}
\phi_1 &amp; \phi_2 &amp; \dots &amp; \phi_r \\
1 &amp; 0 &amp; &amp; 0 \\
\vdots &amp; \ddots &amp; &amp; \vdots \\
0 &amp;  &amp; 1 &amp; 0 \\
\end{bmatrix} \qquad
R = \begin{bmatrix}
1 \\
0 \\
\vdots \\
0
\end{bmatrix} \qquad
Q = \begin{bmatrix}
\sigma^2
\end{bmatrix}
\end{aligned}\end{split}\]</div>
<p>In an AR model with daily data that exhibits annual seasonality, we might want to fit a model that incorporates lags up to <span class="math notranslate nohighlight">\(r=365\)</span>, in which case the state vector would be at least <span class="math notranslate nohighlight">\(m = 365\)</span>. The matrices <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_{t|t}\)</span> then each have <span class="math notranslate nohighlight">\(365^2 = 133225\)</span> elements, and so most of the time spent computing the likelihood function (via the Kalman filter) can become dominated by the matrix multiplications in the prediction step.</p>
<h2 id="State-space-models-and-the-Chandrasekhar-recursions">State space models and the Chandrasekhar recursions<a class="headerlink" href="#State-space-models-and-the-Chandrasekhar-recursions" title="Link to this heading">¶</a></h2>
<p>The Chandrasekhar recursions replace equation <span class="math notranslate nohighlight">\(P_{t+1} = T P_{t|t} T' + R Q R'\)</span> with a different recursion:</p>
<div class="math notranslate nohighlight">
\[P_{t+1} = P_t + W_t M_t W_t'\]</div>
<p>but where <span class="math notranslate nohighlight">\(W_t\)</span> is a matrix with dimension <span class="math notranslate nohighlight">\(m \times p\)</span> and <span class="math notranslate nohighlight">\(M_t\)</span> is a matrix with dimension <span class="math notranslate nohighlight">\(p \times p\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the dimension of the observed vector <span class="math notranslate nohighlight">\(y_t\)</span>. These matrices themselves have recursive formulations. For more general details and for the formulas for computing <span class="math notranslate nohighlight">\(W_t\)</span> and <span class="math notranslate nohighlight">\(M_t\)</span>, see Herbst (2015).</p>
<p><strong>Important note</strong>: unlike the Kalman filter, the Chandrasekhar recursions can not be used for every state space model. In particular, the latter has the following restrictions (that are not required for the use of the former):</p>
<ul class="simple">
<li><p>The model must be time-invariant, except that time-varying intercepts are permitted.</p></li>
<li><p>Stationary initialization of the state vector must be used (this rules out all models in non-stationary components)</p></li>
<li><p>Missing data is not permitted</p></li>
</ul>
<p>To understand why this formula can imply more efficient computations, consider again the SARIMAX case, above. In this case, <span class="math notranslate nohighlight">\(p = 1\)</span>, so that <span class="math notranslate nohighlight">\(M_t\)</span> is a scalar and we can rewrite the Chandrasekhar recursion as:</p>
<div class="math notranslate nohighlight">
\[P_{t+1} = P_t + M_t \times W_t W_t'\]</div>
<p>The matrices being multiplied, <span class="math notranslate nohighlight">\(W_t\)</span>, are then of dimension <span class="math notranslate nohighlight">\(m \times 1\)</span>, and in the case <span class="math notranslate nohighlight">\(r=365\)</span>, they each only have <span class="math notranslate nohighlight">\(365\)</span> elements, rather than <span class="math notranslate nohighlight">\(365^2\)</span> elements. This implies substantially fewer computations are required to complete the prediction step.</p>
<h2 id="Convergence">Convergence<a class="headerlink" href="#Convergence" title="Link to this heading">¶</a></h2>
<p>A factor that complicates a straightforward discussion of performance implications is the well-known fact that in time-invariant models, the predicted state covariance matrix will converge to a constant matrix. This implies that there exists an <span class="math notranslate nohighlight">\(S\)</span> such that, for every <span class="math notranslate nohighlight">\(t &gt; S\)</span>, <span class="math notranslate nohighlight">\(P_t = P_{t+1}\)</span>. Once convergence has been achieved, we can eliminate the equation for <span class="math notranslate nohighlight">\(P_{t+1}\)</span> from the prediction step altogether.</p>
<p>In simple time series models, like AR(r) models, convergence is achieved fairly quickly, and this can limit the performance benefit to using the Chandrasekhar recursions. Herbst (2015) focuses instead on DSGE (Dynamic Stochastic General Equilibrium) models instead, which often have a large state vector and often a large number of periods to achieve convergence. In these cases, the performance gains can be quite substantial.</p>
<h2 id="Practical-example">Practical example<a class="headerlink" href="#Practical-example" title="Link to this heading">¶</a></h2>
<p>As a practical example, we will consider monthly data that has a clear seasonal component. In this case, we look at the inflation rate of apparel, as measured by the consumer price index. A graph of the data indicates strong seasonality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cpi_apparel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/statsmodels/smdatasets/refs/heads/main/data/statespace-chandrasekhar/CPIAPPNS.csv&quot;</span><span class="p">,</span>
    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cpi_apparel</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">cpi_apparel</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">inferred_freq</span>
<span class="n">inf_apparel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">cpi_apparel</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="mi">1200</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">inf_apparel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_chandrasekhar_10_0.png" src="../../../_images/examples_notebooks_generated_statespace_chandrasekhar_10_0.png" />
</div>
</div>
<p>We will construct two model instances. The first will be set to use the Kalman filter recursions, while the second will be set to use the Chandrasekhar recursions. This setting is controlled by the <code class="docutils literal notranslate"><span class="pre">ssm.filter_chandrasekhar</span></code> property, as shown below.</p>
<p>The model we have in mind is a seasonal autoregression, where we include the first 6 months as lags as well as the given month in each of the previous 15 years as lags. This implies that the state vector has dimension <span class="math notranslate nohighlight">\(m = 186\)</span>, which is large enough that we might expect to see some substantial performance gains by using the Chandrasekhar recursions.</p>
<p><strong>Remark</strong>: We set <code class="docutils literal notranslate"><span class="pre">tolerance=0</span></code> in each model - this has the effect of preventing the filter from ever recognizing that the prediction covariance matrix has converged. <em>This is not recommended in practice</em>. We do this here to highlight the superior performance of the Chandrasekhar recursions when they are used in every period instead of the typical Kalman filter recursions. Later, we will show the performance in a more realistic setting that we do allow for convergence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Model that will apply Kalman filter recursions</span>
<span class="n">mod_kf</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span>
    <span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">k_states</span><span class="p">)</span>

<span class="c1"># Model that will apply Chandrasekhar recursions</span>
<span class="n">mod_ch</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span>
    <span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">mod_ch</span><span class="o">.</span><span class="n">ssm</span><span class="o">.</span><span class="n">filter_chandrasekhar</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
186
</pre></div></div>
</div>
<p>We time computation of the log-likelihood function, using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">timeit</span> <span class="n">mod_kf</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">mod_ch</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_ch</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
</code></pre></div>
</div>
<p>This results in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>171 ms ± 19.7 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
85 ms ± 4.97 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre></div>
</div>
<p>The implication is that in this experiment, the Chandrasekhar recursions improved performance by about a factor of 2.</p>
<p>As we mentioned above, in the previous experiment we disabled convergence of the predicted covariance matrices, so the results there are an upper bound. Now we allow for convergence, as usual, by removing the <code class="docutils literal notranslate"><span class="pre">tolerance=0</span></code> argument:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Model that will apply Kalman filter recursions</span>
<span class="n">mod_kf</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">k_states</span><span class="p">)</span>

<span class="c1"># Model that will apply Chandrasekhar recursions</span>
<span class="n">mod_ch</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">mod_ch</span><span class="o">.</span><span class="n">ssm</span><span class="o">.</span><span class="n">filter_chandrasekhar</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
186
</pre></div></div>
</div>
<p>Again, we time computation of the log-likelihood function, using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">timeit</span> <span class="n">mod_kf</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">mod_ch</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_ch</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
</code></pre></div>
</div>
<p>This results in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>114 ms ± 7.64 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
70.5 ms ± 2.43 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre></div>
</div>
<p>The Chandrasekhar recursions still improve performance, but now only by about 33%. The reason for this is that after convergence, we no longer need to compute the predicted covariance matrices, so that for those post-convergence periods, there will be no difference in computation time between the two approaches. Below we check the period in which convergence was achieved:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_kf</span> <span class="o">=</span> <span class="n">mod_kf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Convergence at t=</span><span class="si">%d</span><span class="s2">, of T=</span><span class="si">%d</span><span class="s2"> total observations&quot;</span>
    <span class="o">%</span> <span class="p">(</span><span class="n">res_kf</span><span class="o">.</span><span class="n">filter_results</span><span class="o">.</span><span class="n">period_converged</span><span class="p">,</span> <span class="n">res_kf</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Convergence at t=186, of T=469 total observations
</pre></div></div>
</div>
<p>Since convergence happened relatively early, we are already avoiding the expensive matrix multiplications in more than half of the periods.</p>
<p>However, as mentioned above, larger DSGE models may not achieve convergence for most or all of the periods in the sample, and so we could perhaps expect to achieve performance gains more similar to the first example. In their 2019 paper “Euro area real-time density forecasting with financial or labor market frictions”, McAdam and Warne note that in their applications, “Compared with the standard Kalman filter, it is our experience that these recursions speed up the calculation of the
log-likelihood for the three models by roughly 50 percent”. This is about the same result as we found in our first example.</p>
<h2 id="Aside-on-multithreaded-matrix-algebra-routines">Aside on multithreaded matrix algebra routines<a class="headerlink" href="#Aside-on-multithreaded-matrix-algebra-routines" title="Link to this heading">¶</a></h2>
<p>The timings above are based on the Numpy installation installed via Anaconda, which uses Intel’s MKL BLAS and LAPACK libraries. These implement multithreaded processing to speed up matrix algebra, which can be particularly helpful for operations on the larger matrices we’re working with here. To get a sense of how this affects results, we could turn off multithreading by putting the following in the first cell of this notebook.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;MKL_NUM_THREADS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</code></pre></div>
</div>
<p>When we do this, the timings of the first example change to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>307 ms ± 3.08 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
97.5 ms ± 1.64 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre></div>
</div>
<p>and the timings of the second example change to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>178 ms ± 2.78 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
78.9 ms ± 950 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre></div>
</div>
<p>Both are slower, but the typical Kalman filter is affected much more.</p>
<p>This is not unexpected; the performance differential between single and multithreaded linear algebra is much greater in the typical Kalman filter case, because the whole point of the Chandrasekhar recursions is to reduce the size of the matrix operations. It means that if multithreaded linear algebra is unavailable, the Chandrasekhar recursions offer even greater performance gains.</p>
<h2 id="Chandrasekhar-recursions-and-the-univariate-filtering-approach">Chandrasekhar recursions and the univariate filtering approach<a class="headerlink" href="#Chandrasekhar-recursions-and-the-univariate-filtering-approach" title="Link to this heading">¶</a></h2>
<p>It is also possible to combine the Chandrasekhar recursions with the univariate filtering approach of Koopman and Durbin (2000), by making use of the results of Aknouche and Hamdi in their 2007 paper “Periodic Chandrasekhar recursions”. An initial implementation of this combination is included in Statsmodels. However, experiments suggest that this tends to degrade performance compared to even the usual Kalman filter. This accords with the computational savings reported for the univariate
filtering method, which suggest that savings are highest when the state vector is small relative to the observation vector.</p>
<h2 id="Bibliography">Bibliography<a class="headerlink" href="#Bibliography" title="Link to this heading">¶</a></h2>
<p>Aknouche, Abdelhakim, and Fayçal Hamdi. “Periodic Chandrasekhar recursions.” arXiv preprint arXiv:0711.3857 (2007).</p>
<p>Herbst, Edward. “Using the “Chandrasekhar Recursions” for likelihood evaluation of DSGE models.” Computational Economics 45, no. 4 (2015): 693-705.</p>
<p>Koopman, Siem J., and James Durbin. “Fast filtering and smoothing for multivariate state space models.” Journal of Time Series Analysis 21, no. 3 (2000): 281-296.</p>
<p>McAdam, Peter, and Anders Warne. “Euro area real-time density forecasting with financial or labor market frictions.” International Journal of Forecasting 35, no. 2 (2019): 580-600.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    Sep 10, 2025
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2025, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>