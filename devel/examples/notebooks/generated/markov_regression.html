


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>Markov switching dynamic regression models - statsmodels 0.15.0 (+243)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.359ec555e2989f00f.min.css?v=b000af5c" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Federal-funds-rate-with-switching-intercept" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+243)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+243)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+243)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Markov switching dynamic regression models
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+243)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+243)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+243)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        <span title="/install.rst (reference label)" class="md-ellipsis">Installing statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        <span title="/gettingstarted.rst (reference label)" class="md-ellipsis">Getting started</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        <span title="/user-guide.rst (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html"><span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        <span title="/examples/index.rst#linear-regression-models (reference label)" class="md-ellipsis">Linear Regression Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        <span title="/examples/index.rst#plotting (reference label)" class="md-ellipsis">Plotting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        <span title="/examples/index.rst#discrete-choice-models (reference label)" class="md-ellipsis">Discrete Choice Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        <span title="/examples/index.rst#nonparametric-statistics (reference label)" class="md-ellipsis">Nonparametric Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        <span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        <span title="/examples/index.rst#robust-regression (reference label)" class="md-ellipsis">Robust Regression</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        <span title="/examples/index.rst#generalized-estimating-equations (reference label)" class="md-ellipsis">Generalized Estimating Equations</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        <span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9" type="checkbox" id="__nav_4_9" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html#time-series-analysis"><span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span></a>
          
            <label for="__nav_4_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Time Series Analysis" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_9">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="autoregressions.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/autoregressions.ipynb (reference label)" class="md-ellipsis">Autoregressions</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="autoregressions.html#Forecasting" class="md-nav__link">
        <span title="/examples/notebooks/generated/autoregressions.ipynb#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="deterministics.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/deterministics.ipynb (reference label)" class="md-ellipsis">Deterministic Terms in Time Series Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_arma_0.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/tsa_arma_0.ipynb (reference label)" class="md-ellipsis">Autoregressive Moving Average <wbr>(ARMA):<wbr> Sunspots data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_arma_1.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/tsa_arma_1.ipynb (reference label)" class="md-ellipsis">Autoregressive Moving Average <wbr>(ARMA):<wbr> Artificial data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_filters.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/tsa_filters.ipynb (reference label)" class="md-ellipsis">Time Series Filters</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/examples/notebooks/generated/markov_regression.ipynb (reference label)" class="md-ellipsis">Markov switching dynamic regression models</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/examples/notebooks/generated/markov_regression.ipynb (reference label)" class="md-ellipsis">Markov switching dynamic regression models</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Federal-funds-rate-with-switching-intercept" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#federal-funds-rate-with-switching-intercept (reference label)" class="md-ellipsis">Federal funds rate with switching intercept</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Federal-funds-rate-with-switching-intercept-and-lagged-dependent-variable" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#federal-funds-rate-with-switching-intercept-and-lagged-dependent-variable (reference label)" class="md-ellipsis">Federal funds rate with switching intercept and lagged dependent variable</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Taylor-rule-with-2-or-3-regimes" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#taylor-rule-with-2-or-3-regimes (reference label)" class="md-ellipsis">Taylor rule with 2 or 3 regimes</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Switching-variances" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#switching-variances (reference label)" class="md-ellipsis">Switching variances</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="exponential_smoothing.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/exponential_smoothing.ipynb (reference label)" class="md-ellipsis">Exponential smoothing</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="exponential_smoothing.html#Simulations-and-Confidence-Intervals" class="md-nav__link">
        <span title="/examples/notebooks/generated/exponential_smoothing.ipynb#simulations-and-confidence-intervals (reference label)" class="md-ellipsis">Simulations and Confidence Intervals</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="stl_decomposition.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/stl_decomposition.ipynb (reference label)" class="md-ellipsis">Seasonal-<wbr>Trend decomposition using LOESS <wbr>(STL)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="mstl_decomposition.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/mstl_decomposition.ipynb (reference label)" class="md-ellipsis">Multiple Seasonal-<wbr>Trend decomposition using LOESS <wbr>(MSTL)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="stationarity_detrending_adf_kpss.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/stationarity_detrending_adf_kpss.ipynb (reference label)" class="md-ellipsis">Stationarity and detrending <wbr>(ADF/KPSS)</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models-technical-notes (reference label)" class="md-ellipsis">State space models -<wbr> Technical notes</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        <span title="/examples/index.rst#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        <span title="/examples/index.rst#multivariate-methods (reference label)" class="md-ellipsis">Multivariate Methods</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        <span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API Reference</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        <span title="/about.rst (reference label)" class="md-ellipsis">About statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        <span title="/dev/index.rst (reference label)" class="md-ellipsis">Developer Page</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        <span title="/release/index.rst (reference label)" class="md-ellipsis">Release Notes</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Federal-funds-rate-with-switching-intercept" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#federal-funds-rate-with-switching-intercept (reference label)" class="md-ellipsis">Federal funds rate with switching intercept</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Federal-funds-rate-with-switching-intercept-and-lagged-dependent-variable" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#federal-funds-rate-with-switching-intercept-and-lagged-dependent-variable (reference label)" class="md-ellipsis">Federal funds rate with switching intercept and lagged dependent variable</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Taylor-rule-with-2-or-3-regimes" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#taylor-rule-with-2-or-3-regimes (reference label)" class="md-ellipsis">Taylor rule with 2 or 3 regimes</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Switching-variances" class="md-nav__link">
    <span title="/examples/notebooks/generated/markov_regression.ipynb#switching-variances (reference label)" class="md-ellipsis">Switching variances</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="Markov-switching-dynamic-regression-models">Markov switching dynamic regression models<a class="headerlink" href="#Markov-switching-dynamic-regression-models" title="Link to this heading">¶</a></h1>
<p>This notebook provides an example of the use of Markov switching models in statsmodels to estimate dynamic regression models with changes in regime. It follows the examples in the Stata Markov switching documentation, which can be found at <a class="reference external" href="http://www.stata.com/manuals14/tsmswitch.pdf">http://www.stata.com/manuals14/tsmswitch.pdf</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># NBER recessions</span>
<span class="kn">from</span> <span class="nn">pandas_datareader.data</span> <span class="kn">import</span> <span class="n">DataReader</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">usrec</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span>
    <span class="s2">&quot;USREC&quot;</span><span class="p">,</span> <span class="s2">&quot;fred&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1947</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Federal-funds-rate-with-switching-intercept">Federal funds rate with switching intercept<a class="headerlink" href="#Federal-funds-rate-with-switching-intercept" title="Link to this heading">¶</a></h2>
<p>The first example models the federal funds rate as noise around a constant intercept, but where the intercept changes during different regimes. The model is simply:</p>
<div class="math notranslate nohighlight">
\[r_t = \mu_{S_t} + \varepsilon_t \qquad \varepsilon_t \sim N(0, \sigma^2)\]</div>
<p>where <span class="math notranslate nohighlight">\(S_t \in \{0, 1\}\)</span>, and the regime transitions according to</p>
<div class="math notranslate nohighlight">
\[\begin{split} P(S_t = s_t | S_{t-1} = s_{t-1}) =
\begin{bmatrix}
p_{00} &amp; p_{10} \\
1 - p_{00} &amp; 1 - p_{10}
\end{bmatrix}\end{split}\]</div>
<p>We will estimate the parameters of this model by maximum likelihood: <span class="math notranslate nohighlight">\(p_{00}, p_{10}, \mu_0, \mu_1, \sigma^2\)</span>.</p>
<p>The data used in this example can be found at <a class="reference external" href="https://www.stata-press.com/data/r14/usmacro">https://www.stata-press.com/data/r14/usmacro</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Get the federal funds rate data</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.regime_switching.tests.test_markov_regression</span> <span class="kn">import</span> <span class="n">fedfunds</span>

<span class="n">dta_fedfunds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="n">fedfunds</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1954-07-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-10-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;QS&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">dta_fedfunds</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Federal funds rate&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Fit the model</span>
<span class="c1"># (a switching mean is the default of the MarkovRegession model)</span>
<span class="n">mod_fedfunds</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovRegression</span><span class="p">(</span><span class="n">dta_fedfunds</span><span class="p">,</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">res_fedfunds</span> <span class="o">=</span> <span class="n">mod_fedfunds</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_regression_4_0.png" src="../../../_images/examples_notebooks_generated_markov_regression_4_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fedfunds</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>Markov Switching Model Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>226</td>
</tr>
<tr>
  <th>Model:</th>           <td>MarkovRegression</td> <th>  Log Likelihood     </th> <td>-508.636</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 29 Mar 2024</td> <th>  AIC                </th> <td>1027.272</td>
</tr>
<tr>
  <th>Time:</th>                <td>17:55:26</td>     <th>  BIC                </th> <td>1044.375</td>
</tr>
<tr>
  <th>Sample:</th>             <td>07-01-1954</td>    <th>  HQIC               </th> <td>1034.174</td>
</tr>
<tr>
  <th></th>                   <td>- 10-01-2010</td>   <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>approx</td>      <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 0 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>    3.7088</td> <td>    0.177</td> <td>   20.988</td> <td> 0.000</td> <td>    3.362</td> <td>    4.055</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 1 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>    9.5568</td> <td>    0.300</td> <td>   31.857</td> <td> 0.000</td> <td>    8.969</td> <td>   10.145</td>
</tr>
</table>
<table class="simpletable">
<caption>Non-switching parameters</caption>
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>sigma2</th> <td>    4.4418</td> <td>    0.425</td> <td>   10.447</td> <td> 0.000</td> <td>    3.608</td> <td>    5.275</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime transition parameters</caption>
<tr>
     <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>p[0->0]</th> <td>    0.9821</td> <td>    0.010</td> <td>   94.443</td> <td> 0.000</td> <td>    0.962</td> <td>    1.002</td>
</tr>
<tr>
  <th>p[1->0]</th> <td>    0.0504</td> <td>    0.027</td> <td>    1.876</td> <td> 0.061</td> <td>   -0.002</td> <td>    0.103</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>From the summary output, the mean federal funds rate in the first regime (the “low regime”) is estimated to be <span class="math notranslate nohighlight">\(3.7\)</span> whereas in the “high regime” it is <span class="math notranslate nohighlight">\(9.6\)</span>. Below we plot the smoothed probabilities of being in the high regime. The model suggests that the 1980’s was a time-period in which a high federal funds rate existed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fedfunds</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Probability of being in the high regime&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;Probability of being in the high regime&#39;}&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_regression_7_1.png" src="../../../_images/examples_notebooks_generated_markov_regression_7_1.png" />
</div>
</div>
<p>From the estimated transition matrix we can calculate the expected duration of a low regime versus a high regime.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res_fedfunds</span><span class="o">.</span><span class="n">expected_durations</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[55.85400626 19.85506546]
</pre></div></div>
</div>
<p>A low regime is expected to persist for about fourteen years, whereas the high regime is expected to persist for only about five years.</p>
<h2 id="Federal-funds-rate-with-switching-intercept-and-lagged-dependent-variable">Federal funds rate with switching intercept and lagged dependent variable<a class="headerlink" href="#Federal-funds-rate-with-switching-intercept-and-lagged-dependent-variable" title="Link to this heading">¶</a></h2>
<p>The second example augments the previous model to include the lagged value of the federal funds rate.</p>
<div class="math notranslate nohighlight">
\[r_t = \mu_{S_t} + r_{t-1} \beta_{S_t} + \varepsilon_t \qquad \varepsilon_t \sim N(0, \sigma^2)\]</div>
<p>where <span class="math notranslate nohighlight">\(S_t \in \{0, 1\}\)</span>, and the regime transitions according to</p>
<div class="math notranslate nohighlight">
\[\begin{split} P(S_t = s_t | S_{t-1} = s_{t-1}) =
\begin{bmatrix}
p_{00} &amp; p_{10} \\
1 - p_{00} &amp; 1 - p_{10}
\end{bmatrix}\end{split}\]</div>
<p>We will estimate the parameters of this model by maximum likelihood: <span class="math notranslate nohighlight">\(p_{00}, p_{10}, \mu_0, \mu_1, \beta_0, \beta_1, \sigma^2\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Fit the model</span>
<span class="n">mod_fedfunds2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovRegression</span><span class="p">(</span>
    <span class="n">dta_fedfunds</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">dta_fedfunds</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">res_fedfunds2</span> <span class="o">=</span> <span class="n">mod_fedfunds2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fedfunds2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>Markov Switching Model Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>225</td>
</tr>
<tr>
  <th>Model:</th>           <td>MarkovRegression</td> <th>  Log Likelihood     </th> <td>-264.711</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 29 Mar 2024</td> <th>  AIC                </th>  <td>543.421</td>
</tr>
<tr>
  <th>Time:</th>                <td>17:55:27</td>     <th>  BIC                </th>  <td>567.334</td>
</tr>
<tr>
  <th>Sample:</th>             <td>10-01-1954</td>    <th>  HQIC               </th>  <td>553.073</td>
</tr>
<tr>
  <th></th>                   <td>- 10-01-2010</td>   <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>approx</td>      <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 0 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>    0.7245</td> <td>    0.289</td> <td>    2.510</td> <td> 0.012</td> <td>    0.159</td> <td>    1.290</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.7631</td> <td>    0.034</td> <td>   22.629</td> <td> 0.000</td> <td>    0.697</td> <td>    0.829</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 1 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>   -0.0989</td> <td>    0.118</td> <td>   -0.835</td> <td> 0.404</td> <td>   -0.331</td> <td>    0.133</td>
</tr>
<tr>
  <th>x1</th>    <td>    1.0612</td> <td>    0.019</td> <td>   57.351</td> <td> 0.000</td> <td>    1.025</td> <td>    1.097</td>
</tr>
</table>
<table class="simpletable">
<caption>Non-switching parameters</caption>
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>sigma2</th> <td>    0.4783</td> <td>    0.050</td> <td>    9.642</td> <td> 0.000</td> <td>    0.381</td> <td>    0.576</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime transition parameters</caption>
<tr>
     <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>p[0->0]</th> <td>    0.6378</td> <td>    0.120</td> <td>    5.304</td> <td> 0.000</td> <td>    0.402</td> <td>    0.874</td>
</tr>
<tr>
  <th>p[1->0]</th> <td>    0.1306</td> <td>    0.050</td> <td>    2.634</td> <td> 0.008</td> <td>    0.033</td> <td>    0.228</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>There are several things to notice from the summary output:</p>
<ol class="arabic simple">
<li><p>The information criteria have decreased substantially, indicating that this model has a better fit than the previous model.</p></li>
<li><p>The interpretation of the regimes, in terms of the intercept, have switched. Now the first regime has the higher intercept and the second regime has a lower intercept.</p></li>
</ol>
<p>Examining the smoothed probabilities of the high regime state, we now see quite a bit more variability.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fedfunds2</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Probability of being in the high regime&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;Probability of being in the high regime&#39;}&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_regression_15_1.png" src="../../../_images/examples_notebooks_generated_markov_regression_15_1.png" />
</div>
</div>
<p>Finally, the expected durations of each regime have decreased quite a bit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res_fedfunds2</span><span class="o">.</span><span class="n">expected_durations</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2.76105188 7.65529154]
</pre></div></div>
</div>
<h2 id="Taylor-rule-with-2-or-3-regimes">Taylor rule with 2 or 3 regimes<a class="headerlink" href="#Taylor-rule-with-2-or-3-regimes" title="Link to this heading">¶</a></h2>
<p>We now include two additional exogenous variables - a measure of the output gap and a measure of inflation - to estimate a switching Taylor-type rule with both 2 and 3 regimes to see which fits the data better.</p>
<p>Because the models can be often difficult to estimate, for the 3-regime model we employ a search over starting parameters to improve results, specifying 20 random search repetitions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Get the additional data</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.regime_switching.tests.test_markov_regression</span> <span class="kn">import</span> <span class="n">ogap</span><span class="p">,</span> <span class="n">inf</span>

<span class="n">dta_ogap</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ogap</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1954-07-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-10-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;QS&quot;</span><span class="p">))</span>
<span class="n">dta_inf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">inf</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1954-07-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-10-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;QS&quot;</span><span class="p">))</span>

<span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">dta_fedfunds</span><span class="o">.</span><span class="n">shift</span><span class="p">(),</span> <span class="n">dta_ogap</span><span class="p">,</span> <span class="n">dta_inf</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Fit the 2-regime model</span>
<span class="n">mod_fedfunds3</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovRegression</span><span class="p">(</span><span class="n">dta_fedfunds</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<span class="n">res_fedfunds3</span> <span class="o">=</span> <span class="n">mod_fedfunds3</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Fit the 3-regime model</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">mod_fedfunds4</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovRegression</span><span class="p">(</span><span class="n">dta_fedfunds</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<span class="n">res_fedfunds4</span> <span class="o">=</span> <span class="n">mod_fedfunds4</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">search_reps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fedfunds3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>Markov Switching Model Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>222</td>
</tr>
<tr>
  <th>Model:</th>           <td>MarkovRegression</td> <th>  Log Likelihood     </th> <td>-229.256</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 29 Mar 2024</td> <th>  AIC                </th>  <td>480.512</td>
</tr>
<tr>
  <th>Time:</th>                <td>17:55:36</td>     <th>  BIC                </th>  <td>517.942</td>
</tr>
<tr>
  <th>Sample:</th>             <td>07-01-1955</td>    <th>  HQIC               </th>  <td>495.624</td>
</tr>
<tr>
  <th></th>                   <td>- 10-01-2010</td>   <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>approx</td>      <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 0 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>    0.6555</td> <td>    0.137</td> <td>    4.771</td> <td> 0.000</td> <td>    0.386</td> <td>    0.925</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.8314</td> <td>    0.033</td> <td>   24.951</td> <td> 0.000</td> <td>    0.766</td> <td>    0.897</td>
</tr>
<tr>
  <th>x2</th>    <td>    0.1355</td> <td>    0.029</td> <td>    4.609</td> <td> 0.000</td> <td>    0.078</td> <td>    0.193</td>
</tr>
<tr>
  <th>x3</th>    <td>   -0.0274</td> <td>    0.041</td> <td>   -0.671</td> <td> 0.502</td> <td>   -0.107</td> <td>    0.053</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 1 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>   -0.0945</td> <td>    0.128</td> <td>   -0.739</td> <td> 0.460</td> <td>   -0.345</td> <td>    0.156</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.9293</td> <td>    0.027</td> <td>   34.309</td> <td> 0.000</td> <td>    0.876</td> <td>    0.982</td>
</tr>
<tr>
  <th>x2</th>    <td>    0.0343</td> <td>    0.024</td> <td>    1.429</td> <td> 0.153</td> <td>   -0.013</td> <td>    0.081</td>
</tr>
<tr>
  <th>x3</th>    <td>    0.2125</td> <td>    0.030</td> <td>    7.147</td> <td> 0.000</td> <td>    0.154</td> <td>    0.271</td>
</tr>
</table>
<table class="simpletable">
<caption>Non-switching parameters</caption>
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>sigma2</th> <td>    0.3323</td> <td>    0.035</td> <td>    9.526</td> <td> 0.000</td> <td>    0.264</td> <td>    0.401</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime transition parameters</caption>
<tr>
     <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>p[0->0]</th> <td>    0.7279</td> <td>    0.093</td> <td>    7.828</td> <td> 0.000</td> <td>    0.546</td> <td>    0.910</td>
</tr>
<tr>
  <th>p[1->0]</th> <td>    0.2115</td> <td>    0.064</td> <td>    3.298</td> <td> 0.001</td> <td>    0.086</td> <td>    0.337</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fedfunds4</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>Markov Switching Model Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>222</td>
</tr>
<tr>
  <th>Model:</th>           <td>MarkovRegression</td> <th>  Log Likelihood     </th> <td>-180.806</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 29 Mar 2024</td> <th>  AIC                </th>  <td>399.611</td>
</tr>
<tr>
  <th>Time:</th>                <td>17:55:36</td>     <th>  BIC                </th>  <td>464.262</td>
</tr>
<tr>
  <th>Sample:</th>             <td>07-01-1955</td>    <th>  HQIC               </th>  <td>425.713</td>
</tr>
<tr>
  <th></th>                   <td>- 10-01-2010</td>   <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>approx</td>      <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 0 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>   -1.0250</td> <td>    0.290</td> <td>   -3.531</td> <td> 0.000</td> <td>   -1.594</td> <td>   -0.456</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.3277</td> <td>    0.086</td> <td>    3.812</td> <td> 0.000</td> <td>    0.159</td> <td>    0.496</td>
</tr>
<tr>
  <th>x2</th>    <td>    0.2036</td> <td>    0.049</td> <td>    4.152</td> <td> 0.000</td> <td>    0.107</td> <td>    0.300</td>
</tr>
<tr>
  <th>x3</th>    <td>    1.1381</td> <td>    0.081</td> <td>   13.977</td> <td> 0.000</td> <td>    0.978</td> <td>    1.298</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 1 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>   -0.0259</td> <td>    0.087</td> <td>   -0.298</td> <td> 0.765</td> <td>   -0.196</td> <td>    0.144</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.9737</td> <td>    0.019</td> <td>   50.265</td> <td> 0.000</td> <td>    0.936</td> <td>    1.012</td>
</tr>
<tr>
  <th>x2</th>    <td>    0.0341</td> <td>    0.017</td> <td>    2.030</td> <td> 0.042</td> <td>    0.001</td> <td>    0.067</td>
</tr>
<tr>
  <th>x3</th>    <td>    0.1215</td> <td>    0.022</td> <td>    5.606</td> <td> 0.000</td> <td>    0.079</td> <td>    0.164</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 2 parameters</caption>
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th> <td>    0.7346</td> <td>    0.130</td> <td>    5.632</td> <td> 0.000</td> <td>    0.479</td> <td>    0.990</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.8436</td> <td>    0.024</td> <td>   35.198</td> <td> 0.000</td> <td>    0.797</td> <td>    0.891</td>
</tr>
<tr>
  <th>x2</th>    <td>    0.1633</td> <td>    0.025</td> <td>    6.515</td> <td> 0.000</td> <td>    0.114</td> <td>    0.212</td>
</tr>
<tr>
  <th>x3</th>    <td>   -0.0499</td> <td>    0.027</td> <td>   -1.835</td> <td> 0.067</td> <td>   -0.103</td> <td>    0.003</td>
</tr>
</table>
<table class="simpletable">
<caption>Non-switching parameters</caption>
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>sigma2</th> <td>    0.1660</td> <td>    0.018</td> <td>    9.240</td> <td> 0.000</td> <td>    0.131</td> <td>    0.201</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime transition parameters</caption>
<tr>
     <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>p[0->0]</th> <td>    0.7214</td> <td>    0.117</td> <td>    6.177</td> <td> 0.000</td> <td>    0.493</td> <td>    0.950</td>
</tr>
<tr>
  <th>p[1->0]</th> <td> 4.001e-08</td> <td>      nan</td> <td>      nan</td> <td>   nan</td> <td>      nan</td> <td>      nan</td>
</tr>
<tr>
  <th>p[2->0]</th> <td>    0.0783</td> <td>    0.038</td> <td>    2.079</td> <td> 0.038</td> <td>    0.004</td> <td>    0.152</td>
</tr>
<tr>
  <th>p[0->1]</th> <td>    0.1044</td> <td>    0.095</td> <td>    1.103</td> <td> 0.270</td> <td>   -0.081</td> <td>    0.290</td>
</tr>
<tr>
  <th>p[1->1]</th> <td>    0.8259</td> <td>    0.054</td> <td>   15.208</td> <td> 0.000</td> <td>    0.719</td> <td>    0.932</td>
</tr>
<tr>
  <th>p[2->1]</th> <td>    0.2288</td> <td>    0.073</td> <td>    3.150</td> <td> 0.002</td> <td>    0.086</td> <td>    0.371</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>Due to lower information criteria, we might prefer the 3-state model, with an interpretation of low-, medium-, and high-interest rate regimes. The smoothed probabilities of each regime are plotted below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_fedfunds4</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Smoothed probability of a low-interest rate regime&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_fedfunds4</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Smoothed probability of a medium-interest rate regime&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_fedfunds4</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Smoothed probability of a high-interest rate regime&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_regression_23_0.png" src="../../../_images/examples_notebooks_generated_markov_regression_23_0.png" />
</div>
</div>
<h2 id="Switching-variances">Switching variances<a class="headerlink" href="#Switching-variances" title="Link to this heading">¶</a></h2>
<p>We can also accommodate switching variances. In particular, we consider the model</p>
<div class="math notranslate nohighlight">
\[y_t = \mu_{S_t} + y_{t-1} \beta_{S_t} + \varepsilon_t \quad \varepsilon_t \sim N(0, \sigma_{S_t}^2)\]</div>
<p>We use maximum likelihood to estimate the parameters of this model: <span class="math notranslate nohighlight">\(p_{00}, p_{10}, \mu_0, \mu_1, \beta_0, \beta_1, \sigma_0^2, \sigma_1^2\)</span>.</p>
<p>The application is to absolute returns on stocks, where the data can be found at <a class="reference external" href="https://www.stata-press.com/data/r14/snp500">https://www.stata-press.com/data/r14/snp500</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Get the federal funds rate data</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.regime_switching.tests.test_markov_regression</span> <span class="kn">import</span> <span class="n">areturns</span>

<span class="n">dta_areturns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="n">areturns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2004-05-04&quot;</span><span class="p">,</span> <span class="s2">&quot;2014-5-03&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">dta_areturns</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Absolute returns, S&amp;P500&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Fit the model</span>
<span class="n">mod_areturns</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovRegression</span><span class="p">(</span>
    <span class="n">dta_areturns</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
    <span class="n">k_regimes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="n">dta_areturns</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">switching_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">res_areturns</span> <span class="o">=</span> <span class="n">mod_areturns</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_regression_25_0.png" src="../../../_images/examples_notebooks_generated_markov_regression_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_areturns</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table class="simpletable">
<caption>Markov Switching Model Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>520</td>
</tr>
<tr>
  <th>Model:</th>           <td>MarkovRegression</td> <th>  Log Likelihood     </th> <td>-745.798</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 29 Mar 2024</td> <th>  AIC                </th> <td>1507.595</td>
</tr>
<tr>
  <th>Time:</th>                <td>17:55:41</td>     <th>  BIC                </th> <td>1541.626</td>
</tr>
<tr>
  <th>Sample:</th>             <td>05-16-2004</td>    <th>  HQIC               </th> <td>1520.926</td>
</tr>
<tr>
  <th></th>                   <td>- 04-27-2014</td>   <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>approx</td>      <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 0 parameters</caption>
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th>  <td>    0.7641</td> <td>    0.078</td> <td>    9.761</td> <td> 0.000</td> <td>    0.611</td> <td>    0.918</td>
</tr>
<tr>
  <th>x1</th>     <td>    0.0791</td> <td>    0.030</td> <td>    2.620</td> <td> 0.009</td> <td>    0.020</td> <td>    0.138</td>
</tr>
<tr>
  <th>sigma2</th> <td>    0.3476</td> <td>    0.061</td> <td>    5.694</td> <td> 0.000</td> <td>    0.228</td> <td>    0.467</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime 1 parameters</caption>
<tr>
     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>const</th>  <td>    1.9728</td> <td>    0.278</td> <td>    7.086</td> <td> 0.000</td> <td>    1.427</td> <td>    2.518</td>
</tr>
<tr>
  <th>x1</th>     <td>    0.5280</td> <td>    0.086</td> <td>    6.155</td> <td> 0.000</td> <td>    0.360</td> <td>    0.696</td>
</tr>
<tr>
  <th>sigma2</th> <td>    2.5771</td> <td>    0.405</td> <td>    6.357</td> <td> 0.000</td> <td>    1.783</td> <td>    3.372</td>
</tr>
</table>
<table class="simpletable">
<caption>Regime transition parameters</caption>
<tr>
     <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>p[0->0]</th> <td>    0.7531</td> <td>    0.063</td> <td>   11.871</td> <td> 0.000</td> <td>    0.629</td> <td>    0.877</td>
</tr>
<tr>
  <th>p[1->0]</th> <td>    0.6825</td> <td>    0.066</td> <td>   10.301</td> <td> 0.000</td> <td>    0.553</td> <td>    0.812</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>The first regime is a low-variance regime and the second regime is a high-variance regime. Below we plot the probabilities of being in the low-variance regime. Between 2008 and 2012 there does not appear to be a clear indication of one regime guiding the economy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_areturns</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Probability of being in a low-variance regime&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;Probability of being in a low-variance regime&#39;}&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_regression_28_1.png" src="../../../_images/examples_notebooks_generated_markov_regression_28_1.png" />
</div>
</div>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      Mar 29, 2024
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="tsa_filters.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Time Series Filters" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Time Series Filters
            </div>
          </div>
        </a>
      
      
        
        <a href="exponential_smoothing.html" class="md-footer__link md-footer__link--next" aria-label="Next: Exponential smoothing" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Exponential smoothing
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2023, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.2.6.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>