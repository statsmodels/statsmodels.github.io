


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>Weighted Generalized Linear Models - statsmodels 0.15.0 (+304)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.359ec555e2989f00f.min.css?v=b000af5c" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Weighted-GLM:-Poisson-response-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+304)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+304)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+304)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Weighted Generalized Linear Models
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+304)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+304)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+304)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        <span title="/install.rst (reference label)" class="md-ellipsis">Installing statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        <span title="/gettingstarted.rst (reference label)" class="md-ellipsis">Getting started</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        <span title="/user-guide.rst (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html"><span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        <span title="/examples/index.rst#linear-regression-models (reference label)" class="md-ellipsis">Linear Regression Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        <span title="/examples/index.rst#plotting (reference label)" class="md-ellipsis">Plotting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        <span title="/examples/index.rst#discrete-choice-models (reference label)" class="md-ellipsis">Discrete Choice Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        <span title="/examples/index.rst#nonparametric-statistics (reference label)" class="md-ellipsis">Nonparametric Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html#generalized-linear-models"><span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span></a>
          
            <label for="__nav_4_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Generalized Linear Models" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="glm.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/glm.ipynb (reference label)" class="md-ellipsis">Generalized Linear Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="glm_formula.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/glm_formula.ipynb (reference label)" class="md-ellipsis">Generalized Linear Models <wbr>(Formula)</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/examples/notebooks/generated/glm_weights.ipynb (reference label)" class="md-ellipsis">Weighted Generalized Linear Models</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/examples/notebooks/generated/glm_weights.ipynb (reference label)" class="md-ellipsis">Weighted Generalized Linear Models</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Weighted-GLM:-Poisson-response-data" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#weighted-glm:-poisson-response-data (reference label)" class="md-ellipsis">Weighted GLM:<wbr> Poisson response data</span>
  </a>
  
    <nav class="md-nav" aria-label="Weighted GLM: Poisson response data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Load-data" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#load-data (reference label)" class="md-ellipsis">Load data</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Condensing-and-Aggregating-observations" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#condensing-and-aggregating-observations (reference label)" class="md-ellipsis">Condensing and Aggregating observations</span>
  </a>
  
    <nav class="md-nav" aria-label="Condensing and Aggregating observations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Dataset-with-unique-observations" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#dataset-with-unique-observations (reference label)" class="md-ellipsis">Dataset with unique observations</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Dataset-with-unique-explanatory-variables-(exog)" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#dataset-with-unique-explanatory-variables-(exog) (reference label)" class="md-ellipsis">Dataset with unique explanatory variables <wbr>(exog)</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Analysis" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#analysis (reference label)" class="md-ellipsis">Analysis</span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-data" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#original-data (reference label)" class="md-ellipsis">original data</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#condensed-data-(unique-observations-with-frequencies)" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#condensed-data-(unique-observations-with-frequencies) (reference label)" class="md-ellipsis">condensed data <wbr>(unique observations with frequencies)</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#condensed-using-var_weights-instead-of-freq_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#condensed-using-var_weights-instead-of-freq_weights (reference label)" class="md-ellipsis">condensed using var_<wbr>weights instead of freq_<wbr>weights</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregated-or-averaged-data-(unique-values-of-explanatory-variables)" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#aggregated-or-averaged-data-(unique-values-of-explanatory-variables) (reference label)" class="md-ellipsis">aggregated or averaged data <wbr>(unique values of explanatory variables)</span>
  </a>
  
    <nav class="md-nav" aria-label="aggregated or averaged data (unique values of explanatory variables)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-exposure" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#using-exposure (reference label)" class="md-ellipsis">using exposure</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-var_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#using-var_weights (reference label)" class="md-ellipsis">using var_<wbr>weights</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Comparison" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#comparison (reference label)" class="md-ellipsis">Comparison</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Likelihood-Ratio-type-tests" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#likelihood-ratio-type-tests (reference label)" class="md-ellipsis">Likelihood Ratio type tests</span>
  </a>
  
    <nav class="md-nav" aria-label="Likelihood Ratio type tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-observations-and-frequency-weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#original-observations-and-frequency-weights (reference label)" class="md-ellipsis">original observations and frequency weights</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregated-data:-exposure-and-var_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#aggregated-data:-exposure-and-var_weights (reference label)" class="md-ellipsis">aggregated data:<wbr> exposure and var_<wbr>weights</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Investigating-Pearson-chi-square-statistic" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#investigating-pearson-chi-square-statistic (reference label)" class="md-ellipsis">Investigating Pearson chi-<wbr>square statistic</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Remainder" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#remainder (reference label)" class="md-ellipsis">Remainder</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="influence_glm_logit.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/influence_glm_logit.ipynb (reference label)" class="md-ellipsis">Influence Measures for GLM Logit</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="quasibinomial.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/quasibinomial.ipynb (reference label)" class="md-ellipsis">Quasi-<wbr>binomial regression</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        <span title="/examples/index.rst#robust-regression (reference label)" class="md-ellipsis">Robust Regression</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        <span title="/examples/index.rst#generalized-estimating-equations (reference label)" class="md-ellipsis">Generalized Estimating Equations</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        <span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        <span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models-technical-notes (reference label)" class="md-ellipsis">State space models -<wbr> Technical notes</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        <span title="/examples/index.rst#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        <span title="/examples/index.rst#multivariate-methods (reference label)" class="md-ellipsis">Multivariate Methods</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        <span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API Reference</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        <span title="/about.rst (reference label)" class="md-ellipsis">About statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        <span title="/dev/index.rst (reference label)" class="md-ellipsis">Developer Page</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        <span title="/release/index.rst (reference label)" class="md-ellipsis">Release Notes</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Weighted-GLM:-Poisson-response-data" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#weighted-glm:-poisson-response-data (reference label)" class="md-ellipsis">Weighted GLM:<wbr> Poisson response data</span>
  </a>
  
    <nav class="md-nav" aria-label="Weighted GLM: Poisson response data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Load-data" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#load-data (reference label)" class="md-ellipsis">Load data</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Condensing-and-Aggregating-observations" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#condensing-and-aggregating-observations (reference label)" class="md-ellipsis">Condensing and Aggregating observations</span>
  </a>
  
    <nav class="md-nav" aria-label="Condensing and Aggregating observations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Dataset-with-unique-observations" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#dataset-with-unique-observations (reference label)" class="md-ellipsis">Dataset with unique observations</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Dataset-with-unique-explanatory-variables-(exog)" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#dataset-with-unique-explanatory-variables-(exog) (reference label)" class="md-ellipsis">Dataset with unique explanatory variables <wbr>(exog)</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Analysis" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#analysis (reference label)" class="md-ellipsis">Analysis</span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-data" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#original-data (reference label)" class="md-ellipsis">original data</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#condensed-data-(unique-observations-with-frequencies)" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#condensed-data-(unique-observations-with-frequencies) (reference label)" class="md-ellipsis">condensed data <wbr>(unique observations with frequencies)</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#condensed-using-var_weights-instead-of-freq_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#condensed-using-var_weights-instead-of-freq_weights (reference label)" class="md-ellipsis">condensed using var_<wbr>weights instead of freq_<wbr>weights</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregated-or-averaged-data-(unique-values-of-explanatory-variables)" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#aggregated-or-averaged-data-(unique-values-of-explanatory-variables) (reference label)" class="md-ellipsis">aggregated or averaged data <wbr>(unique values of explanatory variables)</span>
  </a>
  
    <nav class="md-nav" aria-label="aggregated or averaged data (unique values of explanatory variables)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-exposure" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#using-exposure (reference label)" class="md-ellipsis">using exposure</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-var_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#using-var_weights (reference label)" class="md-ellipsis">using var_<wbr>weights</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Comparison" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#comparison (reference label)" class="md-ellipsis">Comparison</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Likelihood-Ratio-type-tests" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#likelihood-ratio-type-tests (reference label)" class="md-ellipsis">Likelihood Ratio type tests</span>
  </a>
  
    <nav class="md-nav" aria-label="Likelihood Ratio type tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-observations-and-frequency-weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#original-observations-and-frequency-weights (reference label)" class="md-ellipsis">original observations and frequency weights</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregated-data:-exposure-and-var_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#aggregated-data:-exposure-and-var_weights (reference label)" class="md-ellipsis">aggregated data:<wbr> exposure and var_<wbr>weights</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Investigating-Pearson-chi-square-statistic" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#investigating-pearson-chi-square-statistic (reference label)" class="md-ellipsis">Investigating Pearson chi-<wbr>square statistic</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Remainder" class="md-nav__link">
    <span title="/examples/notebooks/generated/glm_weights.ipynb#remainder (reference label)" class="md-ellipsis">Remainder</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="Weighted-Generalized-Linear-Models">Weighted Generalized Linear Models<a class="headerlink" href="#Weighted-Generalized-Linear-Models" title="Link to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</code></pre></div>
</div>
</div>
<h2 id="Weighted-GLM:-Poisson-response-data">Weighted GLM: Poisson response data<a class="headerlink" href="#Weighted-GLM:-Poisson-response-data" title="Link to this heading">¶</a></h2>
<h3 id="Load-data">Load data<a class="headerlink" href="#Load-data" title="Link to this heading">¶</a></h3>
<p>In this example, we’ll use the affair dataset using a handful of exogenous variables to predict the extra-marital affair rate.</p>
<p>Weights will be generated to show that <code class="docutils literal notranslate"><span class="pre">freq_weights</span></code> are equivalent to repeating records of data. On the other hand, <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> is equivalent to aggregating data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fair</span><span class="o">.</span><span class="n">NOTE</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
::

    Number of observations: 6366
    Number of variables: 9
    Variable name definitions:

        rate_marriage   : How rate marriage, 1 = very poor, 2 = poor, 3 = fair,
                        4 = good, 5 = very good
        age             : Age
        yrs_married     : No. years married. Interval approximations. See
                        original paper for detailed explanation.
        children        : No. children
        religious       : How relgious, 1 = not, 2 = mildly, 3 = fairly,
                        4 = strongly
        educ            : Level of education, 9 = grade school, 12 = high
                        school, 14 = some college, 16 = college graduate,
                        17 = some graduate school, 20 = advanced degree
        occupation      : 1 = student, 2 = farming, agriculture; semi-skilled,
                        or unskilled worker; 3 = white-colloar; 4 = teacher
                        counselor social worker, nurse; artist, writers;
                        technician, skilled worker, 5 = managerial,
                        administrative, business, 6 = professional with
                        advanced degree
        occupation_husb : Husband&#39;s occupation. Same as occupation.
        affairs         : measure of time spent in extramarital affairs

    See the original paper for more details.

</pre></div></div>
</div>
<p>Load the data into a pandas dataframe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fair</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
</code></pre></div>
</div>
</div>
<p>The dependent (endogenous) variable is <code class="docutils literal notranslate"><span class="pre">affairs</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rate_marriage</th>
      <th>age</th>
      <th>yrs_married</th>
      <th>children</th>
      <th>religious</th>
      <th>educ</th>
      <th>occupation</th>
      <th>occupation_husb</th>
      <th>affairs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
      <td>6366.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.109645</td>
      <td>29.082862</td>
      <td>9.009425</td>
      <td>1.396874</td>
      <td>2.426170</td>
      <td>14.209865</td>
      <td>3.424128</td>
      <td>3.850141</td>
      <td>0.705374</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.961430</td>
      <td>6.847882</td>
      <td>7.280120</td>
      <td>1.433471</td>
      <td>0.878369</td>
      <td>2.178003</td>
      <td>0.942399</td>
      <td>1.346435</td>
      <td>2.203374</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>17.500000</td>
      <td>0.500000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>9.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.000000</td>
      <td>22.000000</td>
      <td>2.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>12.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.000000</td>
      <td>27.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>14.000000</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5.000000</td>
      <td>32.000000</td>
      <td>16.500000</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>16.000000</td>
      <td>4.000000</td>
      <td>5.000000</td>
      <td>0.484848</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
      <td>42.000000</td>
      <td>23.000000</td>
      <td>5.500000</td>
      <td>4.000000</td>
      <td>20.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>57.599991</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rate_marriage</th>
      <th>age</th>
      <th>yrs_married</th>
      <th>children</th>
      <th>religious</th>
      <th>educ</th>
      <th>occupation</th>
      <th>occupation_husb</th>
      <th>affairs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>32.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>17.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>0.111111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>27.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.230769</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>22.0</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.400000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the following we will work mostly with Poisson. While using decimal affairs works, we convert them to integers to have a count distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span><span class="p">[</span><span class="s2">&quot;affairs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;affairs&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rate_marriage</th>
      <th>age</th>
      <th>yrs_married</th>
      <th>children</th>
      <th>religious</th>
      <th>educ</th>
      <th>occupation</th>
      <th>occupation_husb</th>
      <th>affairs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>32.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>17.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>27.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>22.0</td>
      <td>2.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;affairs&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.6775054979579014
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;affairs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([4313,  934,  488,  180,  130,  172,    7,   21,   67,    2,    0,
          0,   17,    0,    0,    0,    3,   12,    8,    0,    0,    0,
          0,    0,    2,    2,    2,    3,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    1,    1,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    1])
</pre></div></div>
</div>
<h2 id="Condensing-and-Aggregating-observations">Condensing and Aggregating observations<a class="headerlink" href="#Condensing-and-Aggregating-observations" title="Link to this heading">¶</a></h2>
<p>We have 6366 observations in our original dataset. When we consider only some selected variables, then we have fewer unique observations. In the following we combine observations in two ways, first we combine observations that have values for all variables identical, and secondly we combine observations that have the same explanatory variables.</p>
<h3 id="Dataset-with-unique-observations">Dataset with unique observations<a class="headerlink" href="#Dataset-with-unique-observations" title="Link to this heading">¶</a></h3>
<p>We use pandas’s groupby to combine identical observations and create a new variable <code class="docutils literal notranslate"><span class="pre">freq</span></code> that count how many observation have the values in the corresponding row.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data2</span><span class="p">[</span><span class="s2">&quot;const&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dc</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;affairs rate_marriage age yrs_married const&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;affairs rate_marriage age yrs_married&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">dc</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;const&quot;</span><span class="p">:</span> <span class="s2">&quot;freq&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">dc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(476, 5)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>affairs</th>
      <th>rate_marriage</th>
      <th>age</th>
      <th>yrs_married</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.5</td>
      <td>0.5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>22.0</td>
      <td>2.5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>2.5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>6.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>9.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h3 id="Dataset-with-unique-explanatory-variables-(exog)">Dataset with unique explanatory variables (exog)<a class="headerlink" href="#Dataset-with-unique-explanatory-variables-(exog)" title="Link to this heading">¶</a></h3>
<p>For the next dataset we combine observations that have the same values of the explanatory variables. However, because the response variable can differ among combined observations, we compute the mean and the sum of the response variable for all combined observations.</p>
<p>We use again pandas <code class="docutils literal notranslate"><span class="pre">groupby</span></code> to combine observations and to create the new variables. We also flatten the <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> into a simple index.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">gr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;affairs rate_marriage age yrs_married&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="s2">&quot;rate_marriage age yrs_married&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">df_a</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">merge_tuple</span><span class="p">(</span><span class="n">tpl</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tpl</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">tpl</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tpl</span>


<span class="n">df_a</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_a</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">merge_tuple</span><span class="p">)</span>
<span class="n">df_a</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_a</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(130, 6)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rate_marriage</th>
      <th>age</th>
      <th>yrs_married</th>
      <th>affairs_mean</th>
      <th>affairs_sum</th>
      <th>affairs_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>17.5</td>
      <td>0.5</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>22.0</td>
      <td>2.5</td>
      <td>3.900000</td>
      <td>39.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>27.0</td>
      <td>2.5</td>
      <td>3.400000</td>
      <td>17.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>27.0</td>
      <td>6.0</td>
      <td>0.900000</td>
      <td>9.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>27.0</td>
      <td>9.0</td>
      <td>1.333333</td>
      <td>4.0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>After combining observations with have a dataframe <code class="docutils literal notranslate"><span class="pre">dc</span></code> with 467 unique observations, and a dataframe <code class="docutils literal notranslate"><span class="pre">df_a</span></code> with 130 observations with unique values of the explanatory variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of rows: </span><span class="se">\n</span><span class="s2">original, with unique observations, with unique exog&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dc</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
number of rows:
original, with unique observations, with unique exog
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(6366, 476, 130)
</pre></div></div>
</div>
<h2 id="Analysis">Analysis<a class="headerlink" href="#Analysis" title="Link to this heading">¶</a></h2>
<p>In the following, we compare the GLM-Poisson results of the original data with models of the combined observations where the multiplicity or aggregation is given by weights or exposure.</p>
<h3 id="original-data">original data<a class="headerlink" href="#original-data" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs ~ rate_marriage + age + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">res_o</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_o</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:                affairs   No. Observations:                 6366
Model:                            GLM   Df Residuals:                     6362
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -10351.
Date:                Fri, 31 May 2024   Deviance:                       15375.
Time:                        13:29:20   Pearson chi2:                 3.23e+04
No. Iterations:                     6   Pseudo R-squ. (CS):             0.2420
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_o</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">/</span> <span class="n">res_o</span><span class="o">.</span><span class="n">df_resid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.078702313363214
</pre></div></div>
</div>
<h3 id="condensed-data-(unique-observations-with-frequencies)">condensed data (unique observations with frequencies)<a class="headerlink" href="#condensed-data-(unique-observations-with-frequencies)" title="Link to this heading">¶</a></h3>
<p>Combining identical observations and using frequency weights to take into account the multiplicity of observations produces exactly the same results. Some results attribute will differ when we want to have information about the observation and not about the aggregate of all identical observations. For example, residuals do not take <code class="docutils literal notranslate"><span class="pre">freq_weights</span></code> into account.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs ~ rate_marriage + age + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">dc</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">freq_weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_f</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_f</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:                affairs   No. Observations:                  476
Model:                            GLM   Df Residuals:                     6362
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -10351.
Date:                Fri, 31 May 2024   Deviance:                       15375.
Time:                        13:29:20   Pearson chi2:                 3.23e+04
No. Iterations:                     6   Pseudo R-squ. (CS):             0.9754
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_f</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">/</span> <span class="n">res_f</span><span class="o">.</span><span class="n">df_resid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.078702313363196
</pre></div></div>
</div>
<h3 id="condensed-using-var_weights-instead-of-freq_weights">condensed using <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> instead of <code class="docutils literal notranslate"><span class="pre">freq_weights</span></code><a class="headerlink" href="#condensed-using-var_weights-instead-of-freq_weights" title="Link to this heading">¶</a></h3>
<p>Next, we compare <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> to <code class="docutils literal notranslate"><span class="pre">freq_weights</span></code>. It is a common practice to incorporate <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> when the endogenous variable reflects averages and not identical observations. I do not see a theoretical reason why it produces the same results (in general).</p>
<p>This produces the same results but <code class="docutils literal notranslate"><span class="pre">df_resid</span></code> differs the <code class="docutils literal notranslate"><span class="pre">freq_weights</span></code> example because <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> do not change the number of effective observations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs ~ rate_marriage + age + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">dc</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">var_weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_fv</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_fv</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:                affairs   No. Observations:                  476
Model:                            GLM   Df Residuals:                      472
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -10351.
Date:                Fri, 31 May 2024   Deviance:                       15375.
Time:                        13:29:20   Pearson chi2:                 3.23e+04
No. Iterations:                     6   Pseudo R-squ. (CS):             0.9754
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>
<p>Dispersion computed from the results is incorrect because of wrong <code class="docutils literal notranslate"><span class="pre">df_resid</span></code>. It is correct if we use the original <code class="docutils literal notranslate"><span class="pre">df_resid</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_fv</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">/</span> <span class="n">res_fv</span><span class="o">.</span><span class="n">df_resid</span><span class="p">,</span> <span class="n">res_f</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">/</span> <span class="n">res_f</span><span class="o">.</span><span class="n">df_resid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(68.45488160512002, 5.078702313363196)
</pre></div></div>
</div>
<h3 id="aggregated-or-averaged-data-(unique-values-of-explanatory-variables)">aggregated or averaged data (unique values of explanatory variables)<a class="headerlink" href="#aggregated-or-averaged-data-(unique-values-of-explanatory-variables)" title="Link to this heading">¶</a></h3>
<p>For these cases we combine observations that have the same values of the explanatory variables. The corresponding response variable is either a sum or an average.</p>
<h4 id="using-exposure">using <code class="docutils literal notranslate"><span class="pre">exposure</span></code><a class="headerlink" href="#using-exposure" title="Link to this heading">¶</a></h4>
<p>If our dependent variable is the sum of the responses of all combined observations, then under the Poisson assumption the distribution remains the same but we have varying <code class="docutils literal notranslate"><span class="pre">exposure</span></code> given by the number of individuals that are represented by one aggregated observation.</p>
<p>The parameter estimates and covariance of parameters are the same with the original data, but log-likelihood, deviance and Pearson chi-squared differ</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs_sum ~ rate_marriage + age + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_a</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">exposure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df_a</span><span class="p">[</span><span class="s2">&quot;affairs_count&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_e</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_e</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:            affairs_sum   No. Observations:                  130
Model:                            GLM   Df Residuals:                      126
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -740.75
Date:                Fri, 31 May 2024   Deviance:                       967.46
Time:                        13:29:20   Pearson chi2:                     926.
No. Iterations:                     6   Pseudo R-squ. (CS):              1.000
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">/</span> <span class="n">res_e</span><span class="o">.</span><span class="n">df_resid</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
7.35078910917951
</pre></div></div>
</div>
<h4 id="using-var_weights">using var_weights<a class="headerlink" href="#using-var_weights" title="Link to this heading">¶</a></h4>
<p>We can also use the mean of all combined values of the dependent variable. In this case the variance will be related to the inverse of the total exposure reflected by one combined observation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs_mean ~ rate_marriage + age + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_a</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">var_weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df_a</span><span class="p">[</span><span class="s2">&quot;affairs_count&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_a</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_a</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:           affairs_mean   No. Observations:                  130
Model:                            GLM   Df Residuals:                      126
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -5954.2
Date:                Fri, 31 May 2024   Deviance:                       967.46
Time:                        13:29:20   Pearson chi2:                     926.
No. Iterations:                     5   Pseudo R-squ. (CS):              1.000
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>
<h3 id="Comparison">Comparison<a class="headerlink" href="#Comparison" title="Link to this heading">¶</a></h3>
<p>We saw in the summary prints above that <code class="docutils literal notranslate"><span class="pre">params</span></code> and <code class="docutils literal notranslate"><span class="pre">cov_params</span></code> with associated Wald inference agree across versions. We summarize this in the following comparing individual results attributes across versions.</p>
<p>Parameter estimates <code class="docutils literal notranslate"><span class="pre">params</span></code>, standard errors of the parameters <code class="docutils literal notranslate"><span class="pre">bse</span></code> and <code class="docutils literal notranslate"><span class="pre">pvalues</span></code> of the parameters for the tests that the parameters are zeros all agree. However, the likelihood and goodness-of-fit statistics, <code class="docutils literal notranslate"><span class="pre">llf</span></code>, <code class="docutils literal notranslate"><span class="pre">deviance</span></code> and <code class="docutils literal notranslate"><span class="pre">pearson_chi2</span></code> only partially agree. Specifically, the aggregated version do not agree with the results using the original data.</p>
<p><strong>Warning</strong>: The behavior of <code class="docutils literal notranslate"><span class="pre">llf</span></code>, <code class="docutils literal notranslate"><span class="pre">deviance</span></code> and <code class="docutils literal notranslate"><span class="pre">pearson_chi2</span></code> might still change in future versions.</p>
<p>Both the sum and average of the response variable for unique values of the explanatory variables have a proper likelihood interpretation. However, this interpretation is not reflected in these three statistics. Computationally this might be due to missing adjustments when aggregated data is used. However, theoretically we can think in these cases, especially for <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> of the misspecified case when likelihood analysis is inappropriate and the results should be interpreted as
quasi-likelihood estimates. There is an ambiguity in the definition of <code class="docutils literal notranslate"><span class="pre">var_weights</span></code> because they can be used for averages with correctly specified likelihood as well as for variance adjustments in the quasi-likelihood case. We are currently not trying to match the likelihood specification. However, in the next section we show that likelihood ratio type tests still produce the same result for all aggregation versions when we assume that the underlying model is correctly specified.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">results_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">res_o</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_e</span><span class="p">,</span> <span class="n">res_a</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;res_o res_f res_e res_a&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">params</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results_all</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>res_o</th>
      <th>res_f</th>
      <th>res_e</th>
      <th>res_a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>2.715533</td>
      <td>2.715533</td>
      <td>2.715533</td>
      <td>2.715533</td>
    </tr>
    <tr>
      <th>rate_marriage</th>
      <td>-0.495180</td>
      <td>-0.495180</td>
      <td>-0.495180</td>
      <td>-0.495180</td>
    </tr>
    <tr>
      <th>age</th>
      <td>-0.029914</td>
      <td>-0.029914</td>
      <td>-0.029914</td>
      <td>-0.029914</td>
    </tr>
    <tr>
      <th>yrs_married</th>
      <td>-0.010763</td>
      <td>-0.010763</td>
      <td>-0.010763</td>
      <td>-0.010763</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">bse</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results_all</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>res_o</th>
      <th>res_f</th>
      <th>res_e</th>
      <th>res_a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.107360</td>
      <td>0.107360</td>
      <td>0.107360</td>
      <td>0.107360</td>
    </tr>
    <tr>
      <th>rate_marriage</th>
      <td>0.011874</td>
      <td>0.011874</td>
      <td>0.011874</td>
      <td>0.011874</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.004471</td>
      <td>0.004471</td>
      <td>0.004471</td>
      <td>0.004471</td>
    </tr>
    <tr>
      <th>yrs_married</th>
      <td>0.004294</td>
      <td>0.004294</td>
      <td>0.004294</td>
      <td>0.004294</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">pvalues</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results_all</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>res_o</th>
      <th>res_f</th>
      <th>res_e</th>
      <th>res_a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>3.756282e-141</td>
      <td>3.756280e-141</td>
      <td>3.756282e-141</td>
      <td>3.756282e-141</td>
    </tr>
    <tr>
      <th>rate_marriage</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>age</th>
      <td>2.221918e-11</td>
      <td>2.221918e-11</td>
      <td>2.221918e-11</td>
      <td>2.221918e-11</td>
    </tr>
    <tr>
      <th>yrs_married</th>
      <td>1.219200e-02</td>
      <td>1.219200e-02</td>
      <td>1.219200e-02</td>
      <td>1.219200e-02</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([[</span><span class="n">r</span><span class="o">.</span><span class="n">llf</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">deviance</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results_all</span><span class="p">]),</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;llf&quot;</span><span class="p">,</span> <span class="s2">&quot;deviance&quot;</span><span class="p">,</span> <span class="s2">&quot;pearson chi2&quot;</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>res_o</th>
      <th>res_f</th>
      <th>res_e</th>
      <th>res_a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>llf</th>
      <td>-10350.913296</td>
      <td>-10350.913296</td>
      <td>-740.748534</td>
      <td>-5954.219866</td>
    </tr>
    <tr>
      <th>deviance</th>
      <td>15374.679054</td>
      <td>15374.679054</td>
      <td>967.455734</td>
      <td>967.455734</td>
    </tr>
    <tr>
      <th>pearson chi2</th>
      <td>32310.704118</td>
      <td>32310.704118</td>
      <td>926.199428</td>
      <td>926.199428</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h3 id="Likelihood-Ratio-type-tests">Likelihood Ratio type tests<a class="headerlink" href="#Likelihood-Ratio-type-tests" title="Link to this heading">¶</a></h3>
<p>We saw above that likelihood and related statistics do not agree between the aggregated and original, individual data. We illustrate in the following that likelihood ratio test and difference in deviance agree across versions, however Pearson chi-squared does not.</p>
<p>As before: This is not sufficiently clear yet and could change.</p>
<p>As a test case we drop the <code class="docutils literal notranslate"><span class="pre">age</span></code> variable and compute the likelihood ratio type statistics as difference between reduced or constrained and full or unconstrained model.</p>
<h4 id="original-observations-and-frequency-weights">original observations and frequency weights<a class="headerlink" href="#original-observations-and-frequency-weights" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs ~ rate_marriage + yrs_married&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">res_o2</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1"># print(res_f2.summary())</span>
<span class="n">res_o2</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">-</span> <span class="n">res_o</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_o2</span><span class="o">.</span><span class="n">deviance</span> <span class="o">-</span> <span class="n">res_o</span><span class="o">.</span><span class="n">deviance</span><span class="p">,</span> <span class="n">res_o2</span><span class="o">.</span><span class="n">llf</span> <span class="o">-</span> <span class="n">res_o</span><span class="o">.</span><span class="n">llf</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(52.91343161907935, 45.726693322505525, -22.863346661251853)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs ~ rate_marriage + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">dc</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">freq_weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_f2</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1"># print(res_f2.summary())</span>
<span class="n">res_f2</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">-</span> <span class="n">res_f</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_f2</span><span class="o">.</span><span class="n">deviance</span> <span class="o">-</span> <span class="n">res_f</span><span class="o">.</span><span class="n">deviance</span><span class="p">,</span> <span class="n">res_f2</span><span class="o">.</span><span class="n">llf</span> <span class="o">-</span> <span class="n">res_f</span><span class="o">.</span><span class="n">llf</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(52.913431618650066, 45.726693322507344, -22.863346661253672)
</pre></div></div>
</div>
<h4 id="aggregated-data:-exposure-and-var_weights">aggregated data: <code class="docutils literal notranslate"><span class="pre">exposure</span></code> and <code class="docutils literal notranslate"><span class="pre">var_weights</span></code><a class="headerlink" href="#aggregated-data:-exposure-and-var_weights" title="Link to this heading">¶</a></h4>
<p>Note: LR test agrees with original observations, <code class="docutils literal notranslate"><span class="pre">pearson_chi2</span></code> differs and has the wrong sign.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs_sum ~ rate_marriage + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_a</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">exposure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df_a</span><span class="p">[</span><span class="s2">&quot;affairs_count&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_e2</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res_e2</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">-</span> <span class="n">res_e</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">deviance</span> <span class="o">-</span> <span class="n">res_e</span><span class="o">.</span><span class="n">deviance</span><span class="p">,</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">llf</span> <span class="o">-</span> <span class="n">res_e</span><span class="o">.</span><span class="n">llf</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-31.618527525103445, 45.72669332250598, -22.863346661252763)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">glm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span>
    <span class="s2">&quot;affairs_mean ~ rate_marriage + yrs_married&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_a</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
    <span class="n">var_weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df_a</span><span class="p">[</span><span class="s2">&quot;affairs_count&quot;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">res_a2</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res_a2</span><span class="o">.</span><span class="n">pearson_chi2</span> <span class="o">-</span> <span class="n">res_a</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">deviance</span> <span class="o">-</span> <span class="n">res_a</span><span class="o">.</span><span class="n">deviance</span><span class="p">,</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">llf</span> <span class="o">-</span> <span class="n">res_a</span><span class="o">.</span><span class="n">llf</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-31.61852752510788, 45.72669332250621, -22.863346661252763)
</pre></div></div>
</div>
<h3 id="Investigating-Pearson-chi-square-statistic">Investigating Pearson chi-square statistic<a class="headerlink" href="#Investigating-Pearson-chi-square-statistic" title="Link to this heading">¶</a></h3>
<p>First, we do some sanity checks that there are no basic bugs in the computation of <code class="docutils literal notranslate"><span class="pre">pearson_chi2</span></code> and <code class="docutils literal notranslate"><span class="pre">resid_pearson</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e2</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_e</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">resid_pearson</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">(</span>
    <span class="n">res_e</span><span class="o">.</span><span class="n">resid_pearson</span> <span class="o">**</span> <span class="mi">2</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(894.5809002315148, 926.1994277566182, 894.5809002315148, 926.199427756618)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">res_e</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_e</span><span class="o">.</span><span class="n">mu</span><span class="p">)[</span>
    <span class="p">:</span><span class="mi">5</span>
<span class="p">],</span> <span class="n">res_e</span><span class="o">.</span><span class="n">mu</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-2.815935518950797e-13,
 array([ 5.42753476, 46.42940306, 19.98971769, 38.50138978, 11.18341883]),
 array([ 5.42753476, 46.42940306, 19.98971769, 38.50138978, 11.18341883]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">res_e</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">res_e</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_e</span><span class="o">.</span><span class="n">mu</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
926.1994277566182
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[33]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">mu</span><span class="p">)[</span>
    <span class="p">:</span><span class="mi">5</span>
<span class="p">],</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">mu</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[33]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-2.361188168064333e-14,
 array([ 4.77165474, 44.4026604 , 22.2013302 , 39.14749309, 10.54229538]),
 array([ 4.77165474, 44.4026604 , 22.2013302 , 39.14749309, 10.54229538]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[34]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">mu</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[34]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
894.5809002315148
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[35]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">(</span><span class="n">res_e</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[35]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(51204.85737832321, 47104.64779595939)
</pre></div></div>
</div>
<p>One possible reason for the incorrect sign is that we are subtracting quadratic terms that are divided by different denominators. In some related cases, the recommendation in the literature is to use a common denominator. We can compare pearson chi-squared statistic using the same variance assumption in the full and reduced model.</p>
<p>In this case we obtain the same pearson chi2 scaled difference between reduced and full model across all versions. (Issue <a class="reference external" href="https://github.com/statsmodels/statsmodels/issues/3616">#3616</a> is intended to track this further.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[36]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">res_e</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[36]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
44.43314175121899
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[37]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_a2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">res_a</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_a2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">var_weights</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[37]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
44.43314175121923
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[38]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_f2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">res_f</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_f2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_f2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">res_f2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">freq_weights</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[38]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
44.43314175122017
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[39]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_o2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">res_o</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_o2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_o2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[39]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
44.43314175121962
</pre></div></div>
</div>
<h2 id="Remainder">Remainder<a class="headerlink" href="#Remainder" title="Link to this heading">¶</a></h2>
<p>The remainder of the notebook just contains some additional checks and can be ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[40]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exposure</span><span class="p">)[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df_a</span><span class="p">[</span><span class="s2">&quot;affairs_count&quot;</span><span class="p">])[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[40]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 1., 10.,  5., 10.,  3.]), array([ 1, 10,  5, 10,  3]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[41]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e2</span><span class="o">.</span><span class="n">resid_pearson</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">res_e</span><span class="o">.</span><span class="n">resid_pearson</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[41]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-9.664817945858474
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[42]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e2</span><span class="o">.</span><span class="n">mu</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[42]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 4.77165474, 44.4026604 , 22.2013302 , 39.14749309, 10.54229538])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[43]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_a2</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_a</span><span class="o">.</span><span class="n">pearson_chi2</span><span class="p">,</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">resid_pearson</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">res_a</span><span class="o">.</span><span class="n">resid_pearson</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[43]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(894.5809002315161, 926.199427756624, -42.34720713518717, -32.68238918932538)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[44]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_a2</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_a2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">var_weights</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[44]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
894.5809002315161
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[45]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_a</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_a</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">res_a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">var_weights</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[45]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
926.199427756624
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[46]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="p">(</span><span class="n">res_a</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">resid_response</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">res_a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">res_a2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">res_a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">var_weights</span>
<span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[46]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
850.1477584802967
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[47]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_e</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">res_e2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[47]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 0., 39., 17.,  9.,  4.]), array([ 0., 39., 17.,  9.,  4.]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[48]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[48]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([0.        , 3.9       , 3.4       , 0.9       , 1.33333333]),
 array([0.        , 3.9       , 3.4       , 0.9       , 1.33333333]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[49]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exposure</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[49]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0., 39., 17.,  9.,  4.])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[50]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">res_a2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">var_weights</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[50]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0., 39., 17.,  9.,  4.])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[51]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mf">27.19530754604785</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mf">29.083798806764687</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[51]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.8390448369994542e-07, 6.931421143170174e-08)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[52]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_o</span><span class="o">.</span><span class="n">pvalues</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[52]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Intercept        3.756282e-141
rate_marriage     0.000000e+00
age               2.221918e-11
yrs_married       1.219200e-02
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[53]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res_e2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_e</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:            affairs_sum   No. Observations:                  130
Model:                            GLM   Df Residuals:                      127
Model Family:                 Poisson   Df Model:                            2
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -763.61
Date:                Fri, 31 May 2024   Deviance:                       1013.2
Time:                        13:29:21   Pearson chi2:                     895.
No. Iterations:                     6   Pseudo R-squ. (CS):              1.000
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.0754      0.050     41.512      0.000       1.977       2.173
rate_marriage    -0.4947      0.012    -41.743      0.000      -0.518      -0.471
yrs_married      -0.0360      0.002    -17.542      0.000      -0.040      -0.032
=================================================================================
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:            affairs_sum   No. Observations:                  130
Model:                            GLM   Df Residuals:                      126
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -740.75
Date:                Fri, 31 May 2024   Deviance:                       967.46
Time:                        13:29:21   Pearson chi2:                     926.
No. Iterations:                     6   Pseudo R-squ. (CS):              1.000
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[54]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res_f2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_f</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:                affairs   No. Observations:                  476
Model:                            GLM   Df Residuals:                     6363
Model Family:                 Poisson   Df Model:                            2
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -10374.
Date:                Fri, 31 May 2024   Deviance:                       15420.
Time:                        13:29:21   Pearson chi2:                 3.24e+04
No. Iterations:                     6   Pseudo R-squ. (CS):             0.9729
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.0754      0.050     41.512      0.000       1.977       2.173
rate_marriage    -0.4947      0.012    -41.743      0.000      -0.518      -0.471
yrs_married      -0.0360      0.002    -17.542      0.000      -0.040      -0.032
=================================================================================
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:                affairs   No. Observations:                  476
Model:                            GLM   Df Residuals:                     6362
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -10351.
Date:                Fri, 31 May 2024   Deviance:                       15375.
Time:                        13:29:21   Pearson chi2:                 3.23e+04
No. Iterations:                     6   Pseudo R-squ. (CS):             0.9754
Covariance Type:            nonrobust
=================================================================================
                    coef    std err          z      P&gt;|z|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept         2.7155      0.107     25.294      0.000       2.505       2.926
rate_marriage    -0.4952      0.012    -41.702      0.000      -0.518      -0.472
age              -0.0299      0.004     -6.691      0.000      -0.039      -0.021
yrs_married      -0.0108      0.004     -2.507      0.012      -0.019      -0.002
=================================================================================
</pre></div></div>
</div>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      May 31, 2024
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="glm_formula.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Generalized Linear Models (Formula)" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Generalized Linear Models (Formula)
            </div>
          </div>
        </a>
      
      
        
        <a href="influence_glm_logit.html" class="md-footer__link md-footer__link--next" aria-label="Next: Influence Measures for GLM Logit" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Influence Measures for GLM Logit
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2023, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>