



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="statespace_sarimax_internet.html">
      
      
        <link rel="next" href="statespace_dfm_coincident.html">
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>SARIMAX and ARIMA: Frequently Asked Questions (FAQ) - statsmodels 0.15.0 (+622)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.96fe8683ff2bd71e9.min.css?v=13adf062" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+622)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+622)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+622)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SARIMAX and ARIMA: Frequently Asked Questions (FAQ)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+622)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+622)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+622)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/install.rst (reference label)">Installing statsmodels</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/gettingstarted.rst (reference label)">Getting started</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/user-guide.rst (reference label)">User Guide</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst (reference label)">Examples</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples/index.rst (reference label)">Examples</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#linear-regression-models (reference label)">Linear Regression Models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#plotting (reference label)">Plotting</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#discrete-choice-models (reference label)">Discrete Choice Models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#nonparametric-statistics (reference label)">Nonparametric Statistics</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#generalized-linear-models (reference label)">Generalized Linear Models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#robust-regression (reference label)">Robust Regression</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#generalized-estimating-equations (reference label)">Generalized Estimating Equations</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#statistics (reference label)">Statistics</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#time-series-analysis (reference label)">Time Series Analysis</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html#state-space-models" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#state-space-models (reference label)">State space models</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples/index.rst#state-space-models (reference label)">State space models</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_sarimax_stata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_sarimax_stata.ipynb (reference label)">SARIMAX:<wbr> Introduction</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_sarimax_internet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_sarimax_internet.ipynb (reference label)">SARIMAX:<wbr> Model selection, missing data</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb (reference label)">SARIMAX and ARIMA:<wbr> Frequently Asked Questions <wbr>(FAQ)</span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb (reference label)">SARIMAX and ARIMA:<wbr> Frequently Asked Questions <wbr>(FAQ)</span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#comparing-trends-and-exogenous-variables-in-sarimax,-arima-and-autoreg (reference label)">Comparing trends and exogenous variables in SARIMAX, ARIMA and Auto<wbr>Reg</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comparing trends and exogenous variables in SARIMAX, ARIMA and AutoReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Differences-between-trend-and-exog-in-SARIMAX" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#differences-between-trend-and-exog-in-sarimax (reference label)">Differences between trend and exog in SARIMAX</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-exog-in-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#using-exog-in-sarimax-and-arima (reference label)">Using exog in SARIMAX and ARIMA</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using exog in SARIMAX and ARIMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SARIMAX" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#sarimax (reference label)">SARIMAX</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#arima (reference label)">ARIMA</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exog-in-AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#exog-in-autoreg (reference label)">exog in Auto<wbr>Reg</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="exog in AutoReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#autoreg (reference label)">Auto<wbr>Reg</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-the-correct-DGP-with-AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#using-the-correct-dgp-with-autoreg (reference label)">Using the correct DGP with Auto<wbr>Reg</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using the correct DGP with AutoReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#AutoReg-with-correct-DGP" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#autoreg-with-correct-dgp (reference label)">Auto<wbr>Reg with correct DGP</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#reconstructing-residuals,-fitted-values-and-forecasts-in-sarimax-and-arima (reference label)">Reconstructing residuals, fitted values and forecasts in SARIMAX and ARIMA</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconstructing residuals, fitted values and forecasts in SARIMAX and ARIMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Prediction-with-MA-components" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#prediction-with-ma-components (reference label)">Prediction with MA components</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Prediction-differences-in-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#prediction-differences-in-sarimax-and-arima (reference label)">Prediction differences in SARIMAX and ARIMA</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Initial-residuals-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#initial-residuals-sarimax-and-arima (reference label)">Initial residuals SARIMAX and ARIMA</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_dfm_coincident.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_dfm_coincident.ipynb (reference label)">Dynamic factors and coincident indices</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_structural_harvey_jaeger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_structural_harvey_jaeger.ipynb (reference label)">Detrending, Stylized Facts and the Business Cycle</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_cycles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_cycles.ipynb (reference label)">Trends and cycles in unemployment</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_arma_0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_arma_0.ipynb (reference label)">Autoregressive Moving Average <wbr>(ARMA):<wbr> Sunspots data</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_seasonal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_seasonal.ipynb (reference label)">Seasonality in time series data</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_fixed_params.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_fixed_params.ipynb (reference label)">Estimating or specifying parameters in state space models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_tvpvar_mcmc_cfa.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb (reference label)">TVP-<wbr>VAR, MCMC, and sparse simulation smoothing</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_news.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_news.ipynb (reference label)">Forecasting, updating datasets, and the “news”</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_custom_models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/statespace_custom_models.ipynb (reference label)">Custom statespace models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="ets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/ets.ipynb (reference label)">ETS models</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#state-space-models-technical-notes (reference label)">State space models -<wbr> Technical notes</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#forecasting (reference label)">Forecasting</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#multivariate-methods (reference label)">Multivariate Methods</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#user-notes (reference label)">User Notes</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)">API Reference</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/about.rst (reference label)">About statsmodels</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/dev/index.rst (reference label)">Developer Page</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/release/index.rst (reference label)">Release Notes</span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#comparing-trends-and-exogenous-variables-in-sarimax,-arima-and-autoreg (reference label)">Comparing trends and exogenous variables in SARIMAX, ARIMA and Auto<wbr>Reg</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comparing trends and exogenous variables in SARIMAX, ARIMA and AutoReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Differences-between-trend-and-exog-in-SARIMAX" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#differences-between-trend-and-exog-in-sarimax (reference label)">Differences between trend and exog in SARIMAX</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-exog-in-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#using-exog-in-sarimax-and-arima (reference label)">Using exog in SARIMAX and ARIMA</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using exog in SARIMAX and ARIMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SARIMAX" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#sarimax (reference label)">SARIMAX</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#arima (reference label)">ARIMA</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exog-in-AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#exog-in-autoreg (reference label)">exog in Auto<wbr>Reg</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="exog in AutoReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#autoreg (reference label)">Auto<wbr>Reg</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-the-correct-DGP-with-AutoReg" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#using-the-correct-dgp-with-autoreg (reference label)">Using the correct DGP with Auto<wbr>Reg</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using the correct DGP with AutoReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#AutoReg-with-correct-DGP" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#autoreg-with-correct-dgp (reference label)">Auto<wbr>Reg with correct DGP</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#reconstructing-residuals,-fitted-values-and-forecasts-in-sarimax-and-arima (reference label)">Reconstructing residuals, fitted values and forecasts in SARIMAX and ARIMA</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconstructing residuals, fitted values and forecasts in SARIMAX and ARIMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Prediction-with-MA-components" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#prediction-with-ma-components (reference label)">Prediction with MA components</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Prediction-differences-in-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#prediction-differences-in-sarimax-and-arima (reference label)">Prediction differences in SARIMAX and ARIMA</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Initial-residuals-SARIMAX-and-ARIMA" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb#initial-residuals-sarimax-and-arima (reference label)">Initial residuals SARIMAX and ARIMA</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="SARIMAX-and-ARIMA:-Frequently-Asked-Questions-(FAQ)">SARIMAX and ARIMA: Frequently Asked Questions (FAQ)<a class="headerlink" href="#SARIMAX-and-ARIMA:-Frequently-Asked-Questions-(FAQ)" title="Link to this heading">¶</a></h1>
<p>This notebook contains explanations for frequently asked questions.</p>
<ul class="simple">
<li><p>Comparing trends and exogenous variables in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></p></li>
<li><p>Reconstructing residuals, fitted values and forecasts in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></p></li>
<li><p>Initial residuals in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></p></li>
</ul>
<h2 id="Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg">Comparing trends and exogenous variables in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> are formally OLS with ARMA errors. A basic AR(1) in the OLS with ARMA errors is described as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \delta + \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>In large samples, <span class="math notranslate nohighlight">\(\hat{\delta}\stackrel{p}{\rightarrow} E[Y]\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> uses a different representation, so that the model when estimated using <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \phi + \rho Y_{t-1} + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>This is the same representation that is used when the model is estimated using OLS (<code class="docutils literal notranslate"><span class="pre">AutoReg</span></code>). In large samples, <span class="math notranslate nohighlight">\(\hat{\phi}\stackrel{p}{\rightarrow} E[Y](1-\rho)\)</span>.</p>
<p>In the next cell, we simulate a large sample and verify that these relationship hold in practice.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">20210819</span><span class="p">)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">5200</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">SARIMAX</span><span class="p">,</span> <span class="n">AutoReg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.arima.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
</code></pre></div>
</div>
</div>
<p>The three models are specified and estimated in the next cell. An AR(0) is included as a reference. The AR(0) is identical using all three estimators.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ar0_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">sarimax_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">arima_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">autoreg_res</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>The table below contains the estimated parameter in the model, the estimated AR(1) coefficient, and the long-run mean which is either equal to the estimated parameters (AR(0) or <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>), or depends on the ratio of the intercept to 1 minus the AR(1) parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">intercept</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ar0_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">sarimax_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">arima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">autoreg_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">rho_hat</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sarimax_res</span><span class="p">,</span> <span class="n">arima_res</span><span class="p">,</span> <span class="n">autoreg_res</span><span class="p">)]</span>
<span class="n">long_run</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ar0_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">sarimax_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sarimax_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="n">arima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">autoreg_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">autoreg_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="p">]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AR(0)&quot;</span><span class="p">,</span> <span class="s2">&quot;SARIMAX&quot;</span><span class="p">,</span> <span class="s2">&quot;ARIMA&quot;</span><span class="p">,</span> <span class="s2">&quot;AutoReg&quot;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span><span class="n">intercept</span><span class="p">,</span> <span class="n">rho_hat</span><span class="p">,</span> <span class="n">long_run</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;delta-or-phi&quot;</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="s2">&quot;long-run mean&quot;</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR(0)</th>
      <th>SARIMAX</th>
      <th>ARIMA</th>
      <th>AutoReg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>delta-or-phi</th>
      <td>9.7745</td>
      <td>1.985714</td>
      <td>9.774498</td>
      <td>1.985790</td>
    </tr>
    <tr>
      <th>rho</th>
      <td>0.0000</td>
      <td>0.796846</td>
      <td>0.796875</td>
      <td>0.796882</td>
    </tr>
    <tr>
      <th>long-run mean</th>
      <td>9.7745</td>
      <td>9.774424</td>
      <td>9.774498</td>
      <td>9.776537</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h3 id="Differences-between-trend-and-exog-in-SARIMAX">Differences between trend and exog in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code><a class="headerlink" href="#Differences-between-trend-and-exog-in-SARIMAX" title="Link to this heading">¶</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> includes <code class="docutils literal notranslate"><span class="pre">exog</span></code> variables, then the <code class="docutils literal notranslate"><span class="pre">exog</span></code> are treated as OLS regressors, so that the model estimated is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t - X_t \beta &amp; = \delta + \rho (Y_{t-1} - X_{t-1}\beta) + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>In the next example, we omit the trend and instead include a column of 1, which produces a model that is equivalent, in large samples, to the case with no exogenous regressor and <code class="docutils literal notranslate"><span class="pre">trend=&quot;c&quot;</span></code>. Here the estimated value of <code class="docutils literal notranslate"><span class="pre">const</span></code> matches the value estimated using <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. This happens since both exog in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and the trend in <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> are treated as linear regression models with ARMA errors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">sarimax_exog_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sarimax_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:               SARIMAX(1, 0, 0)   Log Likelihood               -7068.656
Date:                Mon, 24 Mar 2025   AIC                          14143.311
Time:                        09:25:52   BIC                          14162.863
Sample:                             0   HQIC                         14150.164
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          9.7745      0.069    141.177      0.000       9.639       9.910
ar.L1          0.7969      0.009     93.691      0.000       0.780       0.814
sigma2         0.9894      0.020     49.921      0.000       0.951       1.028
===================================================================================
Ljung-Box (L1) (Q):                   0.42   Jarque-Bera (JB):                 0.08
Prob(Q):                              0.51   Prob(JB):                         0.96
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.47   Kurtosis:                         2.99
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<h3 id="Using-exog-in-SARIMAX-and-ARIMA">Using <code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Using-exog-in-SARIMAX-and-ARIMA" title="Link to this heading">¶</a></h3>
<p>While <code class="docutils literal notranslate"><span class="pre">exog</span></code> are treated the same in both models, the intercept continues to differ. Below we add an exogenous regressor to <code class="docutils literal notranslate"><span class="pre">y</span></code> and then fit the model using all three methods. The data generating process is now</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \delta + X_t \beta + \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">full_x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">full_x</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
<span class="n">y</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">sarimax_exog_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">arima_exog_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>Examining the parameter tables, we see that the parameter estimates on <code class="docutils literal notranslate"><span class="pre">x1</span></code> are identical while the estimates of the <code class="docutils literal notranslate"><span class="pre">intercept</span></code> continue to differ due to the differences in the treatment of trends in these estimators.</p>
<h4 id="SARIMAX"><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code><a class="headerlink" href="#SARIMAX" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_params</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_csv</span><span class="p">()),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">print_params</span><span class="p">(</span><span class="n">sarimax_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>intercept</th>
      <td>1.9849</td>
      <td>0.085</td>
      <td>23.484</td>
      <td>0.0</td>
      <td>1.819</td>
      <td>2.151</td>
    </tr>
    <tr>
      <th>x1</th>
      <td>3.0231</td>
      <td>0.011</td>
      <td>277.150</td>
      <td>0.0</td>
      <td>3.002</td>
      <td>3.044</td>
    </tr>
    <tr>
      <th>ar.L1</th>
      <td>0.7969</td>
      <td>0.009</td>
      <td>93.735</td>
      <td>0.0</td>
      <td>0.780</td>
      <td>0.814</td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td>0.9886</td>
      <td>0.020</td>
      <td>49.941</td>
      <td>0.0</td>
      <td>0.950</td>
      <td>1.027</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h4 id="ARIMA"><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#ARIMA" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">print_params</span><span class="p">(</span><span class="n">arima_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>const</th>
      <td>9.7741</td>
      <td>0.069</td>
      <td>141.201</td>
      <td>0.0</td>
      <td>9.638</td>
      <td>9.910</td>
    </tr>
    <tr>
      <th>x1</th>
      <td>3.0231</td>
      <td>0.011</td>
      <td>277.140</td>
      <td>0.0</td>
      <td>3.002</td>
      <td>3.044</td>
    </tr>
    <tr>
      <th>ar.L1</th>
      <td>0.7969</td>
      <td>0.009</td>
      <td>93.728</td>
      <td>0.0</td>
      <td>0.780</td>
      <td>0.814</td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td>0.9886</td>
      <td>0.020</td>
      <td>49.941</td>
      <td>0.0</td>
      <td>0.950</td>
      <td>1.027</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h3 id="exog-in-AutoReg"><code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#exog-in-AutoReg" title="Link to this heading">¶</a></h3>
<p>When using <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> to estimate a model using OLS, the model differs from both <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. The <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> specification with exogenous variables is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \phi + \rho Y_{t-1} + X_{t}\beta + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>This specification is not equivalent to the specification estimated in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. Here the difference is non-trivial, and naive estimation on the same time series results in different parameter values, even in large samples (and the limit). Estimating this model changes the parameter estimates on the AR(1) coefficient.</p>
<h4 id="AutoReg"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#AutoReg" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">autoreg_exog_res</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">autoreg_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>const</th>
      <td>7.9714</td>
      <td>0.064</td>
      <td>124.525</td>
      <td>0.0</td>
      <td>7.846</td>
      <td>8.097</td>
    </tr>
    <tr>
      <th>y.L1</th>
      <td>0.1838</td>
      <td>0.006</td>
      <td>29.890</td>
      <td>0.0</td>
      <td>0.172</td>
      <td>0.196</td>
    </tr>
    <tr>
      <th>x1</th>
      <td>3.0311</td>
      <td>0.021</td>
      <td>142.513</td>
      <td>0.0</td>
      <td>2.989</td>
      <td>3.073</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The key difference can be seen by writing the model in lag operator notation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
(1-\phi L ) Y_t &amp; = X_{t}\beta + \eta_t \Rightarrow \\
Y_t &amp; = (1-\phi L )^{-1}\left(X_{t}\beta + \eta_t\right) \\
Y_t &amp; = \sum_{i=0}^{\infty} \phi^i \left(X_{t-i}\beta + \eta_{t-i}\right)
\end{align}\end{split}\]</div>
<p>where it is is assumed that <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span>. Here we see that <span class="math notranslate nohighlight">\(Y_t\)</span> depends on all lagged values of <span class="math notranslate nohighlight">\(X_t\)</span> and <span class="math notranslate nohighlight">\(\eta_t\)</span>. This differs from the specification estimated by <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>, which can be seen to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t - X_t \beta &amp; = \delta + \rho (Y_{t-1} - X_{t-1}\beta) + \eta_t \\
\left(1-\rho L \right)\left(Y_t - X_t  \beta\right) &amp; = \delta +  \eta_t \\
Y_t - X_t  \beta &amp; = \frac{\delta}{1-\rho} +  \left(1-\rho L \right)^{-1}\eta_t \\
Y_t - X_t  \beta &amp; = \frac{\delta}{1-\rho} +  \sum_{i=0}^\infty \rho^i \eta_{t-i} \\
Y_t  &amp; = \frac{\delta}{1-\rho} + X_t  \beta +  \sum_{i=0}^\infty \rho^i \eta_{t-i} \\
\end{align}\end{split}\]</div>
<p>In this specification, <span class="math notranslate nohighlight">\(Y_t\)</span> only depends on <span class="math notranslate nohighlight">\(X_t\)</span> and no other lags.</p>
<h3 id="Using-the-correct-DGP-with-AutoReg">Using the correct DGP with <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#Using-the-correct-DGP-with-AutoReg" title="Link to this heading">¶</a></h3>
<p>Simulating the process that is estimated in <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> shows that the parameters are recovered from the true model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">eta</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">)</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">full_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</code></pre></div>
</div>
</div>
<h4 id="AutoReg-with-correct-DGP"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> with correct DGP<a class="headerlink" href="#AutoReg-with-correct-DGP" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">autoreg_alt_exog_res</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">autoreg_alt_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>const</th>
      <td>1.9870</td>
      <td>0.030</td>
      <td>66.526</td>
      <td>0.0</td>
      <td>1.928</td>
      <td>2.046</td>
    </tr>
    <tr>
      <th>y.L1</th>
      <td>0.7968</td>
      <td>0.003</td>
      <td>300.382</td>
      <td>0.0</td>
      <td>0.792</td>
      <td>0.802</td>
    </tr>
    <tr>
      <th>x1</th>
      <td>3.0263</td>
      <td>0.014</td>
      <td>217.034</td>
      <td>0.0</td>
      <td>2.999</td>
      <td>3.054</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h2 id="Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA">Reconstructing residuals, fitted values and forecasts in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA" title="Link to this heading">¶</a></h2>
<p>In models that contain only autoregressive terms, trends and exogenous variables, fitted values and forecasts can be easily reconstructed once the maximum lag length in the model has been reached. In practice, this means after <span class="math notranslate nohighlight">\((P+D)s+p+d\)</span> periods. Earlier predictions and residuals are harder to reconstruct since the model builds the best prediction for <span class="math notranslate nohighlight">\(Y_t|Y_{t-1},Y_{t-2},...\)</span>. When the number of lags of <span class="math notranslate nohighlight">\(Y\)</span> is less than the autoregressive order, then the expression for the
optimal prediction differs from the model. For example, when predicting the very first value, <span class="math notranslate nohighlight">\(Y_1\)</span>, there is no information available from the history of <span class="math notranslate nohighlight">\(Y\)</span>, and so the best prediction is the unconditional mean. In the case of an AR(1), the second prediction will follow the model, so that when using <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>, the prediction is</p>
<div class="math notranslate nohighlight">
\[Y_2 = \hat{\delta} + \hat{\rho} \left(Y_1 - \hat{\delta}\right)\]</div>
<p>since <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> treats both exogenous and trend terms as regression with ARMA errors.</p>
<p>This can be seen in the next set of cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">arima_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">arima_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>const</th>
      <td>9.9346</td>
      <td>0.222</td>
      <td>44.667</td>
      <td>0.0</td>
      <td>9.499</td>
      <td>10.371</td>
    </tr>
    <tr>
      <th>ar.L1</th>
      <td>0.7957</td>
      <td>0.009</td>
      <td>92.515</td>
      <td>0.0</td>
      <td>0.779</td>
      <td>0.813</td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td>10.3015</td>
      <td>0.204</td>
      <td>50.496</td>
      <td>0.0</td>
      <td>9.902</td>
      <td>10.701</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">arima_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.93458658, 10.91088035, 11.80415747])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">delta_hat</span><span class="p">,</span> <span class="n">rho_hat</span> <span class="o">=</span> <span class="n">arima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta_hat</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(10.910880346250012)
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> treats trend terms differently, and so the one-step forecast from a model estimated using <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> is</p>
<div class="math notranslate nohighlight">
\[Y_2 = \hat\delta + \hat\rho Y_1\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">sarima_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">sarima_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>intercept</th>
      <td>2.0283</td>
      <td>0.097</td>
      <td>20.841</td>
      <td>0.0</td>
      <td>1.838</td>
      <td>2.219</td>
    </tr>
    <tr>
      <th>ar.L1</th>
      <td>0.7959</td>
      <td>0.009</td>
      <td>92.536</td>
      <td>0.0</td>
      <td>0.779</td>
      <td>0.813</td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td>10.3007</td>
      <td>0.204</td>
      <td>50.500</td>
      <td>0.0</td>
      <td>9.901</td>
      <td>10.700</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">sarima_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.93588659, 10.91128867, 11.80469658])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">delta_hat</span><span class="p">,</span> <span class="n">rho_hat</span> <span class="o">=</span> <span class="n">sarima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(10.911288670367867)
</pre></div></div>
</div>
<h3 id="Prediction-with-MA-components">Prediction with MA components<a class="headerlink" href="#Prediction-with-MA-components" title="Link to this heading">¶</a></h3>
<p>When a model contains a MA component, the prediction is more complicated since errors are never directly observable. The prediction is still <span class="math notranslate nohighlight">\(Y_t|Y_{t-1},Y_{t-2},...\)</span>, and when the MA component is invertible, then the optimal prediction can be represented as a <span class="math notranslate nohighlight">\(t\)</span>-lag AR process. When <span class="math notranslate nohighlight">\(t\)</span> is large, this should be very close to the prediction as if the errors were observable. For short lags, this can differ markedly.</p>
<p>In the next cell we simulate an MA(1) process, and fit an MA model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>

<span class="n">ma_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">ma_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>z</th>
      <th>P&gt;|z|</th>
      <th>[0.025</th>
      <th>0.975]</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>const</th>
      <td>9.9185</td>
      <td>0.025</td>
      <td>391.129</td>
      <td>0.0</td>
      <td>9.869</td>
      <td>9.968</td>
    </tr>
    <tr>
      <th>ma.L1</th>
      <td>0.8025</td>
      <td>0.009</td>
      <td>93.864</td>
      <td>0.0</td>
      <td>0.786</td>
      <td>0.819</td>
    </tr>
    <tr>
      <th>sigma2</th>
      <td>0.9904</td>
      <td>0.020</td>
      <td>49.925</td>
      <td>0.0</td>
      <td>0.951</td>
      <td>1.029</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We start by looking at predictions near the beginning of the sample corresponding <code class="docutils literal notranslate"><span class="pre">y[1]</span></code>, …, <code class="docutils literal notranslate"><span class="pre">y[5]</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 8.57011015,  9.19907188,  8.96971353,  9.78987115, 11.11984478])
</pre></div></div>
</div>
<p>and the corresponding residuals that are needed to produce the “direct” forecasts</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-2.7621904 , -1.12255005, -1.33557621, -0.17206944,  1.5634041 ])
</pre></div></div>
</div>
<p>Using the model parameters, we can produce the “direct” forecasts using the MA(1) specification</p>
<div class="math notranslate nohighlight">
\[\hat Y_t = \hat\delta + \hat\rho \hat\epsilon_{t-1}\]</div>
<p>We see that these are not especially close to the actual model predictions for the initial forecasts, but that the gap quickly reduces.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">delta_hat</span><span class="p">,</span> <span class="n">rho_hat</span> <span class="o">=</span> <span class="n">ma_res</span><span class="o">.</span><span class="n">params</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">direct</span> <span class="o">=</span> <span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">direct</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 7.70168405,  9.01756049,  8.84659855,  9.7803589 , 11.17314527])
</pre></div></div>
</div>
<p>The difference is nearly a standard deviation for the first but declines as the index increases.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">direct</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.8684261 ,  0.18151139,  0.12311499,  0.00951225, -0.05330049])
</pre></div></div>
</div>
<p>We next look at the end of the sample and the final three predictions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.79692804, 10.51272714, 10.55855562])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.15142355,  0.74049384,  0.79759816])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">direct</span> <span class="o">=</span> <span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">direct</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.79692804, 10.51272714, 10.55855562])
</pre></div></div>
</div>
<p>The “direct” forecasts are identical. This happens since the effect of the short sample has disappeared by the end of the sample (In practice it is negligible by observations 100 or so, and numerically absent by around observation 160).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">direct</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0., 0., 0.])
</pre></div></div>
</div>
<p>The same principle applies in more complicated model that include multiple lags or seasonal term - predictions in AR models are simple once the effective lag length has been reached, while predictions in models that contains MA components are only simple once the maximum root of the MA lag polynomial is sufficiently small so that the residuals are close to the true residuals.</p>
<h3 id="Prediction-differences-in-SARIMAX-and-ARIMA">Prediction differences in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Prediction-differences-in-SARIMAX-and-ARIMA" title="Link to this heading">¶</a></h3>
<p>The formulas used to make predictions from <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> models differ in one key aspect - <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> treats all trend terms, e.g, the intercept or time trend, as part of the exogenous regressors. For example, an AR(1) model with an intercept and linear time trend estimated using <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> has the specification</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t - \delta_0 - \delta_1 t &amp; = \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t
\end{align*}\end{split}\]</div>
<p>When the same model is estimated using <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, the specification is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t &amp; = \epsilon_t \\
\epsilon_t &amp; =  \delta_0 + \delta_1 t  + \rho \epsilon_{t-1} + \eta_t
\end{align*}\end{split}\]</div>
<p>The differences are more apparent when the model contains exogenous regressors, <span class="math notranslate nohighlight">\(X_t\)</span>. The <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> specification is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t - \delta_0 - \delta_1 t - X_t \beta &amp; = \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t \\
           &amp; = \rho \left(Y_{t-1} - \delta_0 - \delta_1 (t-1) - X_{t-1} \beta\right) + \eta_t
\end{align*}\end{split}\]</div>
<p>while the <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> specification is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t &amp; =  X_t \beta + \epsilon_t \\
\epsilon_t &amp; =  \delta_0 + \delta_1 t  + \rho \epsilon_{t-1} + \eta_t \\
           &amp; = \delta_0 + \delta_1 t  + \rho \left(Y_{t-1} - X_{t-1}\beta\right) + \eta_t
\end{align*}\end{split}\]</div>
<p>The key difference between these two is that the intercept and the trend are effectively equivalent to exogenous regressions in <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> while they are more like standard ARMA terms in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>.</p>
<p>The next cell simulates an ARX with a time trend using the specification in <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and estimates the parameters using both estimators.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">delta0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">delta1</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">epsilon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">delta0</span> <span class="o">+</span> <span class="n">delta1</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">full_x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">110</span><span class="p">,</span> <span class="n">delta1</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">arx_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;ct&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;ct&quot;</span><span class="p">)</span>
<span class="n">start</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span>
<span class="n">sarimax_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">start_params</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bfgs&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.16/x64/lib/python3.10/site-packages/scipy/optimize/_optimize.py:1313: OptimizeWarning: Desired error not necessarily achieved due to precision loss.
  res = _minimize_bfgs(f, x0, args, fprime, callback=callback, **opts)
/opt/hostedtoolcache/Python/3.10.16/x64/lib/python3.10/site-packages/statsmodels/base/model.py:612: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&#34;Maximum Likelihood optimization failed to &#34;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Current function value: 1.413691
         Iterations: 43
         Function evaluations: 72
         Gradient evaluations: 62
</pre></div></div>
</div>
<p>The two estimators fit similarly, although there is a small difference in the log-likelihood. This is a numerical issue and should not materially affect the predictions. Importantly the two trend parameters, <code class="docutils literal notranslate"><span class="pre">const</span></code> and <code class="docutils literal notranslate"><span class="pre">x1</span></code> (unfortunately named for the time trend), differ between the two. The other parameters are effectively identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">arx_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:                 ARIMA(1, 0, 0)   Log Likelihood               -7069.171
Date:                Mon, 24 Mar 2025   AIC                          14148.343
Time:                        09:26:16   BIC                          14180.928
Sample:                             0   HQIC                         14159.763
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const        109.2112      0.137    796.186      0.000     108.942     109.480
x1             0.5000   4.78e-05   1.05e+04      0.000       0.500       0.500
x2             2.0495      0.011    187.517      0.000       2.028       2.071
ar.L1          0.7965      0.009     93.669      0.000       0.780       0.813
sigma2         0.9897      0.020     49.854      0.000       0.951       1.029
===================================================================================
Ljung-Box (L1) (Q):                   0.33   Jarque-Bera (JB):                 0.15
Prob(Q):                              0.57   Prob(JB):                         0.93
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.53   Kurtosis:                         3.00
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">sarimax_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:               SARIMAX(1, 0, 0)   Log Likelihood               -7068.457
Date:                Mon, 24 Mar 2025   AIC                          14146.914
Time:                        09:26:16   BIC                          14179.500
Sample:                             0   HQIC                         14158.335
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
intercept     22.7438      0.929     24.481      0.000      20.923      24.565
drift          0.1019      0.004     23.985      0.000       0.094       0.110
x1             2.0230      0.011    185.290      0.000       2.002       2.044
ar.L1          0.7963      0.008     93.745      0.000       0.780       0.813
sigma2         0.9894      0.020     49.899      0.000       0.951       1.028
===================================================================================
Ljung-Box (L1) (Q):                   0.47   Jarque-Bera (JB):                 0.13
Prob(Q):                              0.49   Prob(JB):                         0.94
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.47   Kurtosis:                         3.00
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<h2 id="Initial-residuals-SARIMAX-and-ARIMA">Initial residuals <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Initial-residuals-SARIMAX-and-ARIMA" title="Link to this heading">¶</a></h2>
<p>Residuals for observations before the maximal model order, which depends on the AR, MA, Seasonal AR, Seasonal MA and differencing parameters, are not reliable and should not be used for performance assessment. In general, in an ARIMA with orders <span class="math notranslate nohighlight">\((p,d,q)\times(P,D,Q,s)\)</span>, the formula for residuals that are less well behaved is:</p>
<div class="math notranslate nohighlight">
\[\max((P+D)s+p+d,Qs+q)\]</div>
<p>We can simulate some data from an ARIMA(1,0,0)(1,0,0,12) and examine the residuals.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[33]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">psi</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="o">+</span> <span class="n">psi</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">12</span><span class="p">]</span>
        <span class="o">-</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">psi</span><span class="p">)</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">13</span><span class="p">]</span>
        <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</code></pre></div>
</div>
</div>
<p>With a large sample, the parameter estimates are very close to the DGP parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[34]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                                    SARIMAX Results
========================================================================================
Dep. Variable:                                y   No. Observations:                 5000
Model:             ARIMA(1, 0, 0)x(1, 0, 0, 12)   Log Likelihood               -7076.266
Date:                          Mon, 24 Mar 2025   AIC                          14160.532
Time:                                  09:26:23   BIC                          14186.600
Sample:                                       0   HQIC                         14169.668
                                         - 5000
Covariance Type:                            opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const         19.8586      0.043    458.609      0.000      19.774      19.943
ar.L1          0.7972      0.008     93.925      0.000       0.781       0.814
ar.S.L12      -0.6044      0.011    -53.280      0.000      -0.627      -0.582
sigma2         0.9914      0.020     49.899      0.000       0.952       1.030
===================================================================================
Ljung-Box (L1) (Q):                   0.50   Jarque-Bera (JB):                 0.11
Prob(Q):                              0.48   Prob(JB):                         0.95
Heteroskedasticity (H):               0.96   Skew:                            -0.01
Prob(H) (two-sided):                  0.40   Kurtosis:                         2.99
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>We can first examine the initial 13 residuals by plotting against the actual shocks in the model. While there is a correspondence, it is fairly weak and the correlation is much less than 1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[35]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">13</span><span class="p">],</span> <span class="n">eta</span><span class="p">[</span><span class="mi">200</span> <span class="p">:</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">13</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_63_0.png" src="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_63_0.png" />
</div>
</div>
<p>Looking at the next 24 residuals and shocks, we see there is nearly perfect correlation. This is expected in large samples once the less accurate residuals are ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[36]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">37</span><span class="p">],</span> <span class="n">eta</span><span class="p">[</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">13</span> <span class="p">:</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">37</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_65_0.png" src="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_65_0.png" />
</div>
</div>
<p>Next, we simulate an ARIMA(1,1,0), and include a time trend.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[37]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">20210819</span><span class="p">)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">5200</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rho</span><span class="p">)</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">epsilon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</code></pre></div>
</div>
</div>
<p>Again the parameter estimates are very close to the DGP parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[38]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:                 ARIMA(1, 1, 0)   Log Likelihood               -7067.739
Date:                Mon, 24 Mar 2025   AIC                          14141.479
Time:                        09:26:24   BIC                          14161.030
Sample:                             0   HQIC                         14148.331
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
x1             1.7747      0.069     25.642      0.000       1.639       1.910
ar.L1          0.7968      0.009     93.658      0.000       0.780       0.813
sigma2         0.9896      0.020     49.908      0.000       0.951       1.028
===================================================================================
Ljung-Box (L1) (Q):                   0.43   Jarque-Bera (JB):                 0.09
Prob(Q):                              0.51   Prob(JB):                         0.96
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.47   Kurtosis:                         2.99
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>The residuals are not accurate, and the first residual is approximately 500. The others are closer, although in this model the first 2 should usually be ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[39]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[39]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 5.08403002e+02, -1.58904197e+00, -1.54902446e+00,  1.04992617e-01,
        1.33644383e+00])
</pre></div></div>
</div>
<p>The reason why the first residual is so large is that the optimal prediction of this value is the mean of the difference, which is 1.77. Once the first value is known, the second value makes use of the first value in its prediction and the prediction is substantially closer to the truth.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[40]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[40]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([  1.77472562, 511.95355128, 510.87392196, 508.85708934,
       509.03356182, 511.85245439])
</pre></div></div>
</div>
<p>It is worth noting that the results class contains two parameters than can be helpful in understanding which residuals are problematic, <code class="docutils literal notranslate"><span class="pre">loglikelihood_burn</span></code> and <code class="docutils literal notranslate"><span class="pre">nobs_diffuse</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[41]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">loglikelihood_burn</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">nobs_diffuse</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[41]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 0)
</pre></div></div>
</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    Mar 24, 2025
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2025, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>