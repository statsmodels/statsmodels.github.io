



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="stl_decomposition.html">
      
      
        <link rel="next" href="stationarity_detrending_adf_kpss.html">
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>Multiple Seasonal-Trend decomposition using LOESS (MSTL) - statsmodels 0.15.0 (+841)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css?v=9e56d0d2" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#MSTL-applied-to-a-toy-dataset" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+841)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+841)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+841)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Multiple Seasonal-Trend decomposition using LOESS (MSTL)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+841)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+841)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+841)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/install.rst (reference label)"><span>Installing statsmodels</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/gettingstarted.rst (reference label)"><span>Getting started</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/user-guide.rst (reference label)"><span>User Guide</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst (reference label)"><span>Examples</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples/index.rst (reference label)"><span>Examples</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#linear-regression-models (reference label)"><span>Linear Regression Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#plotting (reference label)"><span>Plotting</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#discrete-choice-models (reference label)"><span>Discrete Choice Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#nonparametric-statistics (reference label)"><span>Nonparametric Statistics</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#generalized-linear-models (reference label)"><span>Generalized Linear Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#robust-regression (reference label)"><span>Robust Regression</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#generalized-estimating-equations (reference label)"><span>Generalized Estimating Equations</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#statistics (reference label)"><span>Statistics</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html#time-series-analysis" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#time-series-analysis (reference label)"><span>Time Series Analysis</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples/index.rst#time-series-analysis (reference label)"><span>Time Series Analysis</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="autoregressions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/autoregressions.ipynb (reference label)"><span>Autoregressions</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="autoregressions.html#Forecasting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/autoregressions.ipynb#forecasting (reference label)"><span>Forecasting</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="autoregressive_distributed_lag.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/autoregressive_distributed_lag.ipynb (reference label)"><span>Autoregressive Distributed Lag <wbr>(ARDL) models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="deterministics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/deterministics.ipynb (reference label)"><span>Deterministic Terms in Time Series Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_arma_0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/tsa_arma_0.ipynb (reference label)"><span>Autoregressive Moving Average <wbr>(ARMA):<wbr> Sunspots data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_arma_1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/tsa_arma_1.ipynb (reference label)"><span>Autoregressive Moving Average <wbr>(ARMA):<wbr> Artificial data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_filters.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/tsa_filters.ipynb (reference label)"><span>Time Series Filters</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="markov_regression.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/markov_regression.ipynb (reference label)"><span>Markov switching dynamic regression models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="markov_autoregression.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/markov_autoregression.ipynb (reference label)"><span>Markov switching autoregression models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="exponential_smoothing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/exponential_smoothing.ipynb (reference label)"><span>Exponential smoothing</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="exponential_smoothing.html#Simulations-and-Confidence-Intervals" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/exponential_smoothing.ipynb#simulations-and-confidence-intervals (reference label)"><span>Simulations and Confidence Intervals</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="stl_decomposition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/stl_decomposition.ipynb (reference label)"><span>Seasonal-<wbr>Trend decomposition using LOESS <wbr>(STL)</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/mstl_decomposition.ipynb (reference label)"><span>Multiple Seasonal-<wbr>Trend decomposition using LOESS <wbr>(MSTL)</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/mstl_decomposition.ipynb (reference label)"><span>Multiple Seasonal-<wbr>Trend decomposition using LOESS <wbr>(MSTL)</span></span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#MSTL-applied-to-a-toy-dataset" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#mstl-applied-to-a-toy-dataset (reference label)"><span>MSTL applied to a toy dataset</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MSTL applied to a toy dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Create-a-toy-dataset-with-multiple-seasonalities" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#create-a-toy-dataset-with-multiple-seasonalities (reference label)"><span>Create a toy dataset with multiple seasonalities</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Decompose-the-toy-dataset-with-MSTL" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#decompose-the-toy-dataset-with-mstl (reference label)"><span>Decompose the toy dataset with MSTL</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#MSTL-applied-to-electricity-demand-dataset" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#mstl-applied-to-electricity-demand-dataset (reference label)"><span>MSTL applied to electricity demand dataset</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MSTL applied to electricity demand dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Prepare-the-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#prepare-the-data (reference label)"><span>Prepare the data</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Decompose-electricity-demand-using-MSTL" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#decompose-electricity-demand-using-mstl (reference label)"><span>Decompose electricity demand using MSTL</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="stationarity_detrending_adf_kpss.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/notebooks/generated/stationarity_detrending_adf_kpss.ipynb (reference label)"><span>Stationarity and detrending <wbr>(ADF/KPSS)</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#state-space-models (reference label)"><span>State space models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#state-space-models-technical-notes (reference label)"><span>State space models -<wbr> Technical notes</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#forecasting (reference label)"><span>Forecasting</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#multivariate-methods (reference label)"><span>Multivariate Methods</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/index.rst#user-notes (reference label)"><span>User Notes</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)"><span>API Reference</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/about.rst (reference label)"><span>About statsmodels</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/dev/index.rst (reference label)"><span>Developer Page</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/release/index.rst (reference label)"><span>Release Notes</span></span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#MSTL-applied-to-a-toy-dataset" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#mstl-applied-to-a-toy-dataset (reference label)"><span>MSTL applied to a toy dataset</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MSTL applied to a toy dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Create-a-toy-dataset-with-multiple-seasonalities" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#create-a-toy-dataset-with-multiple-seasonalities (reference label)"><span>Create a toy dataset with multiple seasonalities</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Decompose-the-toy-dataset-with-MSTL" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#decompose-the-toy-dataset-with-mstl (reference label)"><span>Decompose the toy dataset with MSTL</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#MSTL-applied-to-electricity-demand-dataset" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#mstl-applied-to-electricity-demand-dataset (reference label)"><span>MSTL applied to electricity demand dataset</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MSTL applied to electricity demand dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Prepare-the-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#prepare-the-data (reference label)"><span>Prepare the data</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Decompose-electricity-demand-using-MSTL" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/notebooks/generated/mstl_decomposition.ipynb#decompose-electricity-demand-using-mstl (reference label)"><span>Decompose electricity demand using MSTL</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="Multiple-Seasonal-Trend-decomposition-using-LOESS-(MSTL)">Multiple Seasonal-Trend decomposition using LOESS (MSTL)<a class="headerlink" href="#Multiple-Seasonal-Trend-decomposition-using-LOESS-(MSTL)" title="Link to this heading">¶</a></h1>
<p>This notebook illustrates the use of <code class="docutils literal notranslate"><span class="pre">MSTL</span></code> [1] to decompose a time series into a: trend component, multiple seasonal components, and a residual component. MSTL uses STL (Seasonal-Trend decomposition using LOESS) to iteratively extract seasonal components from a time series. The key inputs into <code class="docutils literal notranslate"><span class="pre">MSTL</span></code> are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">periods</span></code> - The period of each seasonal component (e.g., for hourly data with daily and weekly seasonality we would have: <code class="docutils literal notranslate"><span class="pre">periods=(24,</span> <span class="pre">24*7)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">windows</span></code> - The lengths of each seasonal smoother with respect to each period. If these are large then the seasonal component will show less variability over time. Must be odd. If <code class="docutils literal notranslate"><span class="pre">None</span></code> a set of default values determined by experiments in the original paper [1] are used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lmbda</span></code> - The lambda parameter for a Box-Cox transformation prior to decomposition. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then no transformation is done. If <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> then an appropriate value for lambda is automatically selected from the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterate</span></code> - Number of iterations to use to refine the seasonal component.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stl_kwargs</span></code> - All the other parameters which can be passed to STL (e.g., <code class="docutils literal notranslate"><span class="pre">robust</span></code>, <code class="docutils literal notranslate"><span class="pre">seasonal_deg</span></code>, etc.). See <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.seasonal.STL.html">STL docs</a>.</p></li>
</ul>
<p>[1] <a class="reference external" href="https://arxiv.org/pdf/2107.13462.pdf">K. Bandura, R.J. Hyndman, and C. Bergmeir (2021) MSTL: A Seasonal-Trend Decomposition Algorithm for Time Series with Multiple Seasonal Patterns. arXiv preprint arXiv:2107.13462.</a></p>
<p>Note there are some key differences in this implementation to <a class="reference external" href="https://arxiv.org/pdf/2107.13462.pdf">1</a>. Missing data must be handled outside of the <code class="docutils literal notranslate"><span class="pre">MSTL</span></code> class. The algorithm proposed in the paper handles a case when there is no seasonality. This implementation assumes that there is at least one seasonal component.</p>
<p>First we import the required packages, prepare the graphics environment, and prepare the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_matplotlib_converters</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">MSTL</span><span class="p">,</span> <span class="n">DecomposeResult</span>

<span class="n">register_matplotlib_converters</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;figure&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="MSTL-applied-to-a-toy-dataset">MSTL applied to a toy dataset<a class="headerlink" href="#MSTL-applied-to-a-toy-dataset" title="Link to this heading">¶</a></h2>
<h3 id="Create-a-toy-dataset-with-multiple-seasonalities">Create a toy dataset with multiple seasonalities<a class="headerlink" href="#Create-a-toy-dataset-with-multiple-seasonalities" title="Link to this heading">¶</a></h3>
<p>We create a time series with hourly frequency that has a daily and weekly seasonality which follow a sine wave. We demonstrate a more real world example later in the notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">daily_seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">weekly_seasonality</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">daily_seasonality</span> <span class="o">+</span> <span class="n">weekly_seasonality</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00</th>
      <td>1.000036</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00</th>
      <td>2.471341</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00</th>
      <td>3.518896</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00</th>
      <td>6.104726</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00</th>
      <td>7.952626</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Let’s plot the time series</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_mstl_decomposition_9_1.png" src="../../../_images/examples_notebooks_generated_mstl_decomposition_9_1.png" />
</div>
</div>
<h3 id="Decompose-the-toy-dataset-with-MSTL">Decompose the toy dataset with MSTL<a class="headerlink" href="#Decompose-the-toy-dataset-with-MSTL" title="Link to this heading">¶</a></h3>
<p>Let’s use MSTL to decompose the time series into a trend component, daily and weekly seasonal component, and residual component.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mstl</span> <span class="o">=</span> <span class="n">MSTL</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mstl</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>If the input is a pandas dataframe then the output for the seasonal component is a dataframe. The period for each component is reflect in the column names.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seasonal_24</th>
      <th>seasonal_168</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00</th>
      <td>1.107902</td>
      <td>0.206568</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00</th>
      <td>2.676055</td>
      <td>0.756448</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00</th>
      <td>3.408187</td>
      <td>0.571561</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00</th>
      <td>3.661173</td>
      <td>3.438481</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00</th>
      <td>4.374196</td>
      <td>3.816740</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ax</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_mstl_decomposition_15_0.png" src="../../../_images/examples_notebooks_generated_mstl_decomposition_15_0.png" />
</div>
</div>
<p>We see that the hourly and weekly seasonal components have been extracted.</p>
<p>Any of the STL parameters other than <code class="docutils literal notranslate"><span class="pre">period</span></code> and <code class="docutils literal notranslate"><span class="pre">seasonal</span></code> (as they are set by <code class="docutils literal notranslate"><span class="pre">periods</span></code> and <code class="docutils literal notranslate"><span class="pre">windows</span></code> in <code class="docutils literal notranslate"><span class="pre">MSTL</span></code>) can also be set by passing arg:value pairs as a dictionary to <code class="docutils literal notranslate"><span class="pre">stl_kwargs</span></code> (we will show that in an example now).</p>
<p>Here we show that we can still set the trend smoother of STL via <code class="docutils literal notranslate"><span class="pre">trend</span></code> and order of the polynomial for the seasonal fit via <code class="docutils literal notranslate"><span class="pre">seasonal_deg</span></code>. We will also explicitly set the <code class="docutils literal notranslate"><span class="pre">windows</span></code>, <code class="docutils literal notranslate"><span class="pre">seasonal_deg</span></code>, and <code class="docutils literal notranslate"><span class="pre">iterate</span></code> parameter explicitly. We will get a worse fit but this is just an example of how to pass these parameters to the <code class="docutils literal notranslate"><span class="pre">MSTL</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mstl</span> <span class="o">=</span> <span class="n">MSTL</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">periods</span><span class="o">=</span><span class="p">[</span>
        <span class="mi">24</span><span class="p">,</span>
        <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
    <span class="p">],</span>  <span class="c1"># The periods and windows must be the same length and will correspond to one another.</span>
    <span class="n">windows</span><span class="o">=</span><span class="p">[</span>
        <span class="mi">101</span><span class="p">,</span>
        <span class="mi">101</span><span class="p">,</span>
    <span class="p">],</span>  <span class="c1"># Setting this large along with `seasonal_deg=0` will force the seasonality to be periodic.</span>
    <span class="n">iterate</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">stl_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;trend&quot;</span><span class="p">:</span> <span class="mi">1001</span><span class="p">,</span>  <span class="c1"># Setting this large will force the trend to be smoother.</span>
        <span class="s2">&quot;seasonal_deg&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Means the seasonal smoother is fit with a moving average.</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mstl</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_mstl_decomposition_18_0.png" src="../../../_images/examples_notebooks_generated_mstl_decomposition_18_0.png" />
</div>
</div>
<h2 id="MSTL-applied-to-electricity-demand-dataset">MSTL applied to electricity demand dataset<a class="headerlink" href="#MSTL-applied-to-electricity-demand-dataset" title="Link to this heading">¶</a></h2>
<h3 id="Prepare-the-data">Prepare the data<a class="headerlink" href="#Prepare-the-data" title="Link to this heading">¶</a></h3>
<p>We will use the Victoria electricity demand dataset found here: <a class="reference external" href="https://github.com/tidyverts/tsibbledata/tree/master/data-raw/vic_elec">https://github.com/tidyverts/tsibbledata/tree/master/data-raw/vic_elec</a>. This dataset is used in the <a class="reference external" href="https://arxiv.org/pdf/2107.13462.pdf">original MSTL paper [1]</a>. It is the total electricity demand at a half hourly granularity for the state of Victora in Australia from 2002 to the start of 2015. A more detailed description of the dataset can be found <a class="reference external" href="https://rdrr.io/cran/tsibbledata/man/vic_elec.html">here</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/tidyverts/tsibbledata/master/data-raw/vic_elec/VIC2015/demand.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Period</th>
      <th>OperationalLessIndustrial</th>
      <th>Industrial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37257</td>
      <td>1</td>
      <td>3535.867064</td>
      <td>1086.132936</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37257</td>
      <td>2</td>
      <td>3383.499028</td>
      <td>1088.500972</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37257</td>
      <td>3</td>
      <td>3655.527552</td>
      <td>1084.472448</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37257</td>
      <td>4</td>
      <td>3510.446636</td>
      <td>1085.553364</td>
    </tr>
    <tr>
      <th>4</th>
      <td>37257</td>
      <td>5</td>
      <td>3294.697156</td>
      <td>1081.302844</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The date are integers representing the number of days from an origin date. The origin date for this dataset is determined from <a class="reference external" href="https://github.com/tidyverts/tsibbledata/blob/master/data-raw/vic_elec/vic_elec.R">here</a> and <a class="reference external" href="https://robjhyndman.com/hyndsight/electrictsibbles/">here</a> and is “1899-12-30”. The <code class="docutils literal notranslate"><span class="pre">Period</span></code> integers refer to 30 minute intervals in a 24 hour day, hence there are 48 for each day.</p>
<p>Let’s extract the date and date-time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1899-12-30&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;days&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Period&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>We will be interested in <code class="docutils literal notranslate"><span class="pre">OperationalLessIndustrial</span></code> which is the electricity demand excluding the demand from certain high energy industrial users. We will resample the data to hourly and filter the data to the same time period as <a class="reference external" href="https://arxiv.org/pdf/2107.13462.pdf">original MSTL paper [1]</a> which is the first 149 days of the year 2012.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">timeseries</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;ds&quot;</span><span class="p">,</span> <span class="s2">&quot;OperationalLessIndustrial&quot;</span><span class="p">]]</span>
<span class="n">timeseries</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;ds&quot;</span><span class="p">,</span>
    <span class="s2">&quot;y&quot;</span><span class="p">,</span>
<span class="p">]</span>  <span class="c1"># Rename to OperationalLessIndustrial to y for simplicity.</span>

<span class="c1"># Filter for first 149 days of 2012.</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">start_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;149D&quot;</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">timeseries</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">timeseries</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">end_date</span><span class="p">)</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="n">timeseries</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c1"># Resample to hourly</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="n">timeseries</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;ds&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">timeseries</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
    </tr>
    <tr>
      <th>ds</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-01 00:00:00</th>
      <td>7926.529376</td>
    </tr>
    <tr>
      <th>2012-01-01 01:00:00</th>
      <td>7901.826990</td>
    </tr>
    <tr>
      <th>2012-01-01 02:00:00</th>
      <td>7255.721350</td>
    </tr>
    <tr>
      <th>2012-01-01 03:00:00</th>
      <td>6792.503352</td>
    </tr>
    <tr>
      <th>2012-01-01 04:00:00</th>
      <td>6635.984460</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h3 id="Decompose-electricity-demand-using-MSTL">Decompose electricity demand using MSTL<a class="headerlink" href="#Decompose-electricity-demand-using-MSTL" title="Link to this heading">¶</a></h3>
<p>Let’s apply MSTL to this dataset.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">stl_kwargs</span></code> are set to give results close to <a class="reference external" href="https://arxiv.org/pdf/2107.13462.pdf">[1]</a> which used R and therefore has a slightly different default settings for the underlying <code class="docutils literal notranslate"><span class="pre">STL</span></code> parameters. It would be rare to manually set <code class="docutils literal notranslate"><span class="pre">inner_iter</span></code> and <code class="docutils literal notranslate"><span class="pre">outer_iter</span></code> explicitly in practice.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mstl</span> <span class="o">=</span> <span class="n">MSTL</span><span class="p">(</span>
    <span class="n">timeseries</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
    <span class="n">periods</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">],</span>
    <span class="n">iterate</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">stl_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;seasonal_deg&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;inner_iter&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;outer_iter&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mstl</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>  <span class="c1"># Use .fit() to perform and return the decomposition</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_mstl_decomposition_30_0.png" src="../../../_images/examples_notebooks_generated_mstl_decomposition_30_0.png" />
</div>
</div>
<p>The multiple seasonal components are stored as a pandas dataframe in the <code class="docutils literal notranslate"><span class="pre">seasonal</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seasonal_24</th>
      <th>seasonal_168</th>
    </tr>
    <tr>
      <th>ds</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-01 00:00:00</th>
      <td>-1685.986297</td>
      <td>-161.807086</td>
    </tr>
    <tr>
      <th>2012-01-01 01:00:00</th>
      <td>-1591.640845</td>
      <td>-229.788887</td>
    </tr>
    <tr>
      <th>2012-01-01 02:00:00</th>
      <td>-2192.989492</td>
      <td>-260.121300</td>
    </tr>
    <tr>
      <th>2012-01-01 03:00:00</th>
      <td>-2442.169359</td>
      <td>-388.484499</td>
    </tr>
    <tr>
      <th>2012-01-01 04:00:00</th>
      <td>-2357.492551</td>
      <td>-660.245476</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Let’s inspect the seasonal components in a bit more detail and look at the first few days and weeks to examine the daily and weekly seasonality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="p">[</span><span class="s2">&quot;seasonal_24&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;seasonal_24&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Daily seasonality&quot;</span><span class="p">)</span>

<span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="p">[</span><span class="s2">&quot;seasonal_168&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;seasonal_168&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Weekly seasonality&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_mstl_decomposition_34_0.png" src="../../../_images/examples_notebooks_generated_mstl_decomposition_34_0.png" />
</div>
</div>
<p>We can see that the daily seasonality of electricity demand is well captured. This is the first few days in January so during the summer months in Australia there is a peak in the afternoon most likely due to air conditioning use.</p>
<p>For the weekly seasonality we can see that there is less usage during the weekends.</p>
<p>One of the advantages of MSTL is that is allows us to capture seasonality which changes over time. So let’s look at the seasonality during cooler months in May.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">5</span>
<span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="s2">&quot;seasonal_24&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;seasonal_24&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Daily seasonality&quot;</span><span class="p">)</span>

<span class="n">res</span><span class="o">.</span><span class="n">seasonal</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="s2">&quot;seasonal_168&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;seasonal_168&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Weekly seasonality&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_mstl_decomposition_36_0.png" src="../../../_images/examples_notebooks_generated_mstl_decomposition_36_0.png" />
</div>
</div>
<p>Now we can see an additional peak in the evening! This could be related to heating and lighting now required in the evenings. So this makes sense. We see that main weekly pattern of lower demand over the weekends continue.</p>
<p>The other components can also be extracted from the <code class="docutils literal notranslate"><span class="pre">trend</span></code> and <code class="docutils literal notranslate"><span class="pre">resid</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">trend</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># trend component</span>
<span class="n">display</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># residual component</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ds
2012-01-01 00:00:00    10373.942662
2012-01-01 01:00:00    10363.488489
2012-01-01 02:00:00    10353.037721
2012-01-01 03:00:00    10342.590527
2012-01-01 04:00:00    10332.147100
Freq: h, Name: trend, dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ds
2012-01-01 00:00:00   -599.619903
2012-01-01 01:00:00   -640.231767
2012-01-01 02:00:00   -644.205579
2012-01-01 03:00:00   -719.433316
2012-01-01 04:00:00   -678.424613
Freq: h, Name: resid, dtype: float64
</pre></div></div>
</div>
<p>And that’s it! Using MSTL we can perform time series decompostion on a multi-seasonal time series!</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    Nov 06, 2025
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2025, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>