


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>TVP-VAR, MCMC, and sparse simulation smoothing - statsmodels 0.15.0 (+313)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.e0b5691b38cca82da.min.css?v=b1736040" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Background" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+313)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+313)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+313)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TVP-VAR, MCMC, and sparse simulation smoothing
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+313)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+313)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+313)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        <span title="/install.rst (reference label)" class="md-ellipsis">Installing statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        <span title="/gettingstarted.rst (reference label)" class="md-ellipsis">Getting started</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        <span title="/user-guide.rst (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html"><span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        <span title="/examples/index.rst#linear-regression-models (reference label)" class="md-ellipsis">Linear Regression Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        <span title="/examples/index.rst#plotting (reference label)" class="md-ellipsis">Plotting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        <span title="/examples/index.rst#discrete-choice-models (reference label)" class="md-ellipsis">Discrete Choice Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        <span title="/examples/index.rst#nonparametric-statistics (reference label)" class="md-ellipsis">Nonparametric Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        <span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        <span title="/examples/index.rst#robust-regression (reference label)" class="md-ellipsis">Robust Regression</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        <span title="/examples/index.rst#generalized-estimating-equations (reference label)" class="md-ellipsis">Generalized Estimating Equations</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        <span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        <span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html#state-space-models"><span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span></a>
          
            <label for="__nav_4_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="State space models" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_sarimax_stata.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_sarimax_stata.ipynb (reference label)" class="md-ellipsis">SARIMAX:<wbr> Introduction</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_sarimax_internet.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_sarimax_internet.ipynb (reference label)" class="md-ellipsis">SARIMAX:<wbr> Model selection, missing data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_sarimax_faq.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_sarimax_faq.ipynb (reference label)" class="md-ellipsis">SARIMAX and ARIMA:<wbr> Frequently Asked Questions <wbr>(FAQ)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_dfm_coincident.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_dfm_coincident.ipynb (reference label)" class="md-ellipsis">Dynamic factors and coincident indices</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_structural_harvey_jaeger.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_structural_harvey_jaeger.ipynb (reference label)" class="md-ellipsis">Detrending, Stylized Facts and the Business Cycle</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_cycles.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_cycles.ipynb (reference label)" class="md-ellipsis">Trends and cycles in unemployment</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_arma_0.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_arma_0.ipynb (reference label)" class="md-ellipsis">Autoregressive Moving Average <wbr>(ARMA):<wbr> Sunspots data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_seasonal.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_seasonal.ipynb (reference label)" class="md-ellipsis">Seasonality in time series data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_fixed_params.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_fixed_params.ipynb (reference label)" class="md-ellipsis">Estimating or specifying parameters in state space models</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb (reference label)" class="md-ellipsis">TVP-<wbr>VAR, MCMC, and sparse simulation smoothing</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb (reference label)" class="md-ellipsis">TVP-<wbr>VAR, MCMC, and sparse simulation smoothing</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Background" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#background (reference label)" class="md-ellipsis">Background</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Implementation-in-Statsmodels" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#implementation-in-statsmodels (reference label)" class="md-ellipsis">Implementation in Statsmodels</span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation in Statsmodels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Local-level-model" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#local-level-model (reference label)" class="md-ellipsis">Local level model</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Updating-the-model's-parameters" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#updating-the-model&#39;s-parameters (reference label)" class="md-ellipsis">Updating the model’s parameters</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Application:-Bayesian-analysis-of-a-TVP-VAR-model-by-MCMC" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#application:-bayesian-analysis-of-a-tvp-var-model-by-mcmc (reference label)" class="md-ellipsis">Application:<wbr> Bayesian analysis of a TVP-<wbr>VAR model by MCMC</span>
  </a>
  
    <nav class="md-nav" aria-label="Application: Bayesian analysis of a TVP-VAR model by MCMC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TVP-VAR-model" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#tvp-var-model (reference label)" class="md-ellipsis">TVP-<wbr>VAR model</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TVP-VAR-model-in-Statsmodels" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#tvp-var-model-in-statsmodels (reference label)" class="md-ellipsis">TVP-<wbr>VAR model in Statsmodels</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Preliminary-investigation-with-ad-hoc-parameters-in-H,-Q" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#preliminary-investigation-with-ad-hoc-parameters-in-h,-q (reference label)" class="md-ellipsis">Preliminary investigation with ad-<wbr>hoc parameters in H, Q</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Bayesian-estimation-via-MCMC" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#bayesian-estimation-via-mcmc (reference label)" class="md-ellipsis">Bayesian estimation via MCMC</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Appendix:-performance" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#appendix:-performance (reference label)" class="md-ellipsis">Appendix:<wbr> performance</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Bibliography" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#bibliography (reference label)" class="md-ellipsis">Bibliography</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_news.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_news.ipynb (reference label)" class="md-ellipsis">Forecasting, updating datasets, and the “news”</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="statespace_custom_models.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/statespace_custom_models.ipynb (reference label)" class="md-ellipsis">Custom statespace models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="ets.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/ets.ipynb (reference label)" class="md-ellipsis">ETS models</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models-technical-notes (reference label)" class="md-ellipsis">State space models -<wbr> Technical notes</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        <span title="/examples/index.rst#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        <span title="/examples/index.rst#multivariate-methods (reference label)" class="md-ellipsis">Multivariate Methods</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        <span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API Reference</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        <span title="/about.rst (reference label)" class="md-ellipsis">About statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        <span title="/dev/index.rst (reference label)" class="md-ellipsis">Developer Page</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        <span title="/release/index.rst (reference label)" class="md-ellipsis">Release Notes</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Background" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#background (reference label)" class="md-ellipsis">Background</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Implementation-in-Statsmodels" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#implementation-in-statsmodels (reference label)" class="md-ellipsis">Implementation in Statsmodels</span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation in Statsmodels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Local-level-model" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#local-level-model (reference label)" class="md-ellipsis">Local level model</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Updating-the-model's-parameters" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#updating-the-model&#39;s-parameters (reference label)" class="md-ellipsis">Updating the model’s parameters</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Application:-Bayesian-analysis-of-a-TVP-VAR-model-by-MCMC" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#application:-bayesian-analysis-of-a-tvp-var-model-by-mcmc (reference label)" class="md-ellipsis">Application:<wbr> Bayesian analysis of a TVP-<wbr>VAR model by MCMC</span>
  </a>
  
    <nav class="md-nav" aria-label="Application: Bayesian analysis of a TVP-VAR model by MCMC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TVP-VAR-model" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#tvp-var-model (reference label)" class="md-ellipsis">TVP-<wbr>VAR model</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TVP-VAR-model-in-Statsmodels" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#tvp-var-model-in-statsmodels (reference label)" class="md-ellipsis">TVP-<wbr>VAR model in Statsmodels</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Preliminary-investigation-with-ad-hoc-parameters-in-H,-Q" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#preliminary-investigation-with-ad-hoc-parameters-in-h,-q (reference label)" class="md-ellipsis">Preliminary investigation with ad-<wbr>hoc parameters in H, Q</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Bayesian-estimation-via-MCMC" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#bayesian-estimation-via-mcmc (reference label)" class="md-ellipsis">Bayesian estimation via MCMC</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Appendix:-performance" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#appendix:-performance (reference label)" class="md-ellipsis">Appendix:<wbr> performance</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Bibliography" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_tvpvar_mcmc_cfa.ipynb#bibliography (reference label)" class="md-ellipsis">Bibliography</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="TVP-VAR,-MCMC,-and-sparse-simulation-smoothing">TVP-VAR, MCMC, and sparse simulation smoothing<a class="headerlink" href="#TVP-VAR,-MCMC,-and-sparse-simulation-smoothing" title="Link to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">invwishart</span><span class="p">,</span> <span class="n">invgamma</span>

<span class="c1"># Get the macro dataset</span>
<span class="n">dta</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">macrodata</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="n">dta</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1959Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;2009Q3&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;QS&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Background">Background<a class="headerlink" href="#Background" title="Link to this heading">¶</a></h2>
<p>Bayesian analysis of linear Gaussian state space models via Markov chain Monte Carlo (MCMC) methods has become both commonplace and relatively straightforward in recent years, due especially to advances in sampling from the joint posterior of the unobserved state vector conditional on the data and model parameters (see especially Carter and Kohn (1994), de Jong and Shephard (1995), and Durbin and Koopman (2002)). This is particularly useful for Gibbs sampling MCMC approaches.</p>
<p>While these procedures make use of the forward/backward application of the recursive Kalman filter and smoother, another recent line of research takes a different approach and constructs the posterior joint distribution of the entire vector of states at once - see in particular Chan and Jeliazkov (2009) for an econometric time series treatment and McCausland et al. (2011) for a more general survey. In particular, the posterior mean and precision matrix are constructed explicitly, with the latter
a sparse band matrix. Advantage is then taken of efficient algorithms for Cholesky factorization of sparse band matrices; this reduces memory costs and can improve performance. Following McCausland et al. (2011), we refer to this method as the “Cholesky Factor Algorithm” (CFA) approach.</p>
<p>The CFA-based simulation smoother has some advantages and some drawbacks compared to that based on the more typical Kalman filter and smoother (KFS).</p>
<p><strong>Advantages of CFA</strong>:</p>
<ul class="simple">
<li><p>Derivation of the joint posterior distribution is relatively straightforward and easy to understand.</p></li>
<li><p>In some cases can be both faster and less memory-intensive than the KFS approach</p>
<ul>
<li><p>In the Appendix at the end of this notebook, we briefly discuss the performance of the two simulation smoothers for the TVP-VAR model. In summary: simple tests on a single machine suggest that for the TVP-VAR model, the CFA and KFS implementations in Statsmodels have about the same runtimes, while both implementations are about twice as fast as the replication code, written in Matlab, provided by Chan and Jeliazkov (2009).</p></li>
</ul>
</li>
</ul>
<p><strong>Drawbacks of CFA</strong>:</p>
<p>The main drawback is that this method has not (at least so far) reached the generality of the KFS approach. For example:</p>
<ul class="simple">
<li><p>It can not be used with models that have reduced-rank error terms in the observation or state equations.</p>
<ul>
<li><p>One implication of this is that the typical state space model trick of including identities in the state equation to accommodate, for example, higher-order lags in autoregressive models is not applicable. These models can still be handled by the CFA approach, but at the cost of requiring a slightly different implementation for each lag that is included.</p></li>
<li><p>As an example, standard ways of representing ARMA and VARMA processes in state space form do include identities in the observation and/or state equations, and so the basic formulas presented in Chan and Jeliazkov (2009) do not apply immediately to these models.</p></li>
</ul>
</li>
<li><p>Less flexibility is available in the state initialization / prior.</p></li>
</ul>
<h2 id="Implementation-in-Statsmodels">Implementation in Statsmodels<a class="headerlink" href="#Implementation-in-Statsmodels" title="Link to this heading">¶</a></h2>
<p>A CFA simulation smoother along the lines of the basic formulas presented in Chan and Jeliazkov (2009) has been implemented in Statsmodels.</p>
<p><strong>Notes</strong>:</p>
<ul class="simple">
<li><p>Therefore, the CFA simulation smoother in Statsmodels so-far only supports the case that the state transition is truly a first-order Markov process (i.e. it does not support a p-th order Markov process that has been stacked using identities into a first-order process).</p></li>
<li><p>By contrast, the KFS smoother in Statsmodels is fully general any can be used for any state space model, including those with stacked p-th order Markov processes or other identities in the observation and state equations.</p></li>
</ul>
<p>Either a KFS or the CFA simulation smoothers can be constructed from a state space model using the <code class="docutils literal notranslate"><span class="pre">simulation_smoother</span></code> method. To show the basic idea, we first consider a simple example.</p>
<h3 id="Local-level-model">Local level model<a class="headerlink" href="#Local-level-model" title="Link to this heading">¶</a></h3>
<p>A local level model decomposes an observed series <span class="math notranslate nohighlight">\(y_t\)</span> into a persistent trend <span class="math notranslate nohighlight">\(\mu_t\)</span> and a transitory error component</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp; = \mu_t + \varepsilon_t, \qquad \varepsilon_t \sim N(0, \sigma_\text{irregular}^2) \\
\mu_t &amp; = \mu_{t-1} + \eta_t, \quad ~ \eta_t \sim N(0, \sigma_\text{level}^2)
\end{aligned}\end{split}\]</div>
<p>This model satisfies the requirements of the CFA simulation smoother because both the observation error term <span class="math notranslate nohighlight">\(\varepsilon_t\)</span> and the state innovation term <span class="math notranslate nohighlight">\(\eta_t\)</span> are non-degenerate - that is, their covariance matrices are full rank.</p>
<p>We apply this model to inflation, and consider simulating draws from the posterior of the joint state vector. That is, we are interested in sampling from</p>
<div class="math notranslate nohighlight">
\[p(\mu^t \mid y^t, \sigma_\text{irregular}^2, \sigma_\text{level}^2)\]</div>
<p>where we define <span class="math notranslate nohighlight">\(\mu^t \equiv (\mu_1, \dots, \mu_T)'\)</span> and <span class="math notranslate nohighlight">\(y^t \equiv (y_1, \dots, y_T)'\)</span>.</p>
<p>In Statsmodels, the local level model falls into the more general class of “unobserved components” models, and can be constructed as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Construct a local level model for inflation</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">dta</span><span class="o">.</span><span class="n">infl</span><span class="p">,</span> <span class="s1">&#39;llevel&#39;</span><span class="p">)</span>

<span class="c1"># Fit the model&#39;s parameters (sigma2_varepsilon and sigma2_eta)</span>
<span class="c1"># via maximum likelihood</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Create simulation smoother objects</span>
<span class="n">sim_kfs</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">simulation_smoother</span><span class="p">()</span>              <span class="c1"># default method is KFS</span>
<span class="n">sim_cfa</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">simulation_smoother</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cfa&#39;</span><span class="p">)</span>  <span class="c1"># can specify CFA method</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            2     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.40814D+00    |proj g|=  1.27979D-01

At iterate    5    f=  2.24982D+00    |proj g|=  9.50561D-04

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    2      7      9      1     0     0   2.953D-07   2.250D+00
  F =   2.2498167187365663

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
sigma2.irregular    3.373368
sigma2.level        0.744712
dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<p>The simulation smoother objects <code class="docutils literal notranslate"><span class="pre">sim_kfs</span></code> and <code class="docutils literal notranslate"><span class="pre">sim_cfa</span></code> have <code class="docutils literal notranslate"><span class="pre">simulate</span></code> methods that perform simulation smoothing. Each time that <code class="docutils literal notranslate"><span class="pre">simulate</span></code> is called, the <code class="docutils literal notranslate"><span class="pre">simulated_state</span></code> attribute will be re-populated with a new simulated draw from the posterior.</p>
<p>Below, we construct 20 simulated paths for the trend, using the KFS and CFA approaches, where the simulation is at the maximum likelihood parameter estimates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">nsimulations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">simulated_state_kfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mod</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="n">nsimulations</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">dta</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">simulated_state_cfa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mod</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="n">nsimulations</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">dta</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsimulations</span><span class="p">):</span>
    <span class="c1"># Apply KFS simulation smoothing</span>
    <span class="n">sim_kfs</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="c1"># Save the KFS simulated state</span>
    <span class="n">simulated_state_kfs</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_kfs</span><span class="o">.</span><span class="n">simulated_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Apply CFA simulation smoothing</span>
    <span class="n">sim_cfa</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="c1"># Save the CFA simulated state</span>
    <span class="n">simulated_state_cfa</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_cfa</span><span class="o">.</span><span class="n">simulated_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<p>Plotting the observed data and the simulations created using each method below, it is not too hard to see that these two methods are doing the same thing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Plot the inflation data along with simulated trends</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot data and KFS simulations</span>
<span class="n">dta</span><span class="o">.</span><span class="n">infl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simulations based on KFS approach, MLE parameters&#39;</span><span class="p">)</span>
<span class="n">simulated_state_kfs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Plot data and CFA simulations</span>
<span class="n">dta</span><span class="o">.</span><span class="n">infl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simulations based on CFA approach, MLE parameters&#39;</span><span class="p">)</span>
<span class="n">simulated_state_cfa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add a legend, clean up layout</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Simulated state&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_9_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_9_0.png" />
</div>
</div>
<h3 id="Updating-the-model's-parameters">Updating the model’s parameters<a class="headerlink" href="#Updating-the-model's-parameters" title="Link to this heading">¶</a></h3>
<p>The simulation smoothers are tied to the model instance, here the variable <code class="docutils literal notranslate"><span class="pre">mod</span></code>. Whenever the model instance is updated with new parameters, the simulation smoothers will take those new parameters into account in future calls to the <code class="docutils literal notranslate"><span class="pre">simulate</span></code> method.</p>
<p>This is convenient for MCMC algorithms, which repeatedly (a) update the model’s parameters, (b) draw a sample of the state vector, and then (c) draw new values for the model’s parameters.</p>
<p>Here we will change the model to a different parameterization that yields a smoother trend, and show how the simulated values change (for brevity we only show the simulations from the KFS approach, but simulations from the CFA approach would be the same).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Update the model&#39;s parameterization to one that attributes more</span>
<span class="c1"># variation in inflation to the observation error and so has less</span>
<span class="c1"># variation in the trend component</span>
<span class="n">mod</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>

<span class="c1"># Plot simulations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsimulations</span><span class="p">):</span>
    <span class="n">sim_kfs</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dta</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sim_kfs</span><span class="o">.</span><span class="n">simulated_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulated state&#39;</span><span class="p">)</span>

<span class="c1"># Plot data</span>
<span class="n">dta</span><span class="o">.</span><span class="n">infl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add title, legend, clean up layout</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simulations with alternative parameterization yielding a smoother trend&#39;</span><span class="p">)</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_11_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_11_0.png" />
</div>
</div>
<h2 id="Application:-Bayesian-analysis-of-a-TVP-VAR-model-by-MCMC">Application: Bayesian analysis of a TVP-VAR model by MCMC<a class="headerlink" href="#Application:-Bayesian-analysis-of-a-TVP-VAR-model-by-MCMC" title="Link to this heading">¶</a></h2>
<p>One of the applications that Chan and Jeliazkov (2009) consider is the time-varying parameters vector autoregression (TVP-VAR) model, estimated with Bayesian Gibb sampling (MCMC) methods. They apply this to model the co-movements in four macroeconomic time series:</p>
<ul class="simple">
<li><p>Real GDP growth</p></li>
<li><p>Inflation</p></li>
<li><p>Unemployment rate</p></li>
<li><p>Short-term interest rates</p></li>
</ul>
<p>We will replicate their example, using a very similar dataset that is included in Statsmodels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Subset to the four variables of interest</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dta</span><span class="p">[[</span><span class="s1">&#39;realgdp&#39;</span><span class="p">,</span> <span class="s1">&#39;cpi&#39;</span><span class="p">,</span> <span class="s1">&#39;unemp&#39;</span><span class="p">,</span> <span class="s1">&#39;tbilrate&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span> <span class="s1">&#39;inf&#39;</span><span class="p">,</span> <span class="s1">&#39;unemp&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]</span>

<span class="c1"># Convert to real GDP growth and CPI inflation rates</span>
<span class="n">y</span><span class="p">[[</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span> <span class="s1">&#39;inf&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">[[</span><span class="s1">&#39;gdp&#39;</span><span class="p">,</span> <span class="s1">&#39;inf&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Evolution of macroeconomic variables included in TVP-VAR exercise&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_13_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_13_0.png" />
</div>
</div>
<h3 id="TVP-VAR-model">TVP-VAR model<a class="headerlink" href="#TVP-VAR-model" title="Link to this heading">¶</a></h3>
<p><strong>Note</strong>: this section is based on Chan and Jeliazkov (2009) section 3.1, which can be consulted for additional details.</p>
<p>The usual (time-invariant) VAR(1) model is typically written:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
y_t &amp; = \mu + \Phi y_{t-1} + \varepsilon_t, \qquad \varepsilon_t \sim N(0, H)
\end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_t\)</span> is a <span class="math notranslate nohighlight">\(p \times 1\)</span> vector of variables observed at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(H\)</span> is a covariance matrix.</p>
<p>The TVP-VAR(1) model generalizes this to allow the coefficients to vary over time according. Stacking all the parameters into a vector according to <span class="math notranslate nohighlight">\(\alpha_t = \text{vec}([\mu_t : \Phi_t])\)</span>, where <span class="math notranslate nohighlight">\(\text{vec}\)</span> denotes the operation that stacks columns of a matrix into a vector, we model their evolution over time according to:</p>
<div class="math notranslate nohighlight">
\[\alpha_{i,t+1} = \alpha_{i, t} + \eta_{i,t}, \qquad \eta_{i, t} \sim N(0, \sigma_i^2)\]</div>
<p>In other words, each parameter evolves independently according to a random walk.</p>
<p>Note that there are <span class="math notranslate nohighlight">\(p\)</span> coefficients in <span class="math notranslate nohighlight">\(\mu_t\)</span> and <span class="math notranslate nohighlight">\(p^2\)</span> coefficients in <span class="math notranslate nohighlight">\(\Phi_t\)</span>, so the full state vector <span class="math notranslate nohighlight">\(\alpha\)</span> is shaped <span class="math notranslate nohighlight">\(p * (p + 1) \times 1\)</span>.</p>
<p>Putting the TVP-VAR(1) model into state-space form is relatively straightforward, and in fact we just have to re-write the observation equation into SUR form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp; = Z_t \alpha_t + \varepsilon_t, \qquad \varepsilon_t \sim N(0, H) \\
\alpha_{t+1} &amp; = \alpha_t + \eta_t, \qquad \eta_t \sim N(0, \text{diag}(\{\sigma_i^2\}))
\end{aligned}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}Z_t = \begin{bmatrix}
1 &amp; y_{t-1}' &amp; 0 &amp; \dots &amp; &amp;  0 \\
0 &amp; 0 &amp; 1 &amp; y_{t-1}' &amp;  &amp; 0 \\
\vdots &amp; &amp; &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; y_{t-1}'  \\
\end{bmatrix}\end{split}\]</div>
<p>As long as <span class="math notranslate nohighlight">\(H\)</span> is full rank and each of the variances <span class="math notranslate nohighlight">\(\sigma_i^2\)</span> is non-zero, the model satisfies the requirements of the CFA simulation smoother.</p>
<p>We also need to specify the initialization / prior for the initial state, <span class="math notranslate nohighlight">\(\alpha_1\)</span>. Here we will follow Chan and Jeliazkov (2009) in using <span class="math notranslate nohighlight">\(\alpha_1 \sim N(0, 5 I)\)</span>, although we could also model it as diffuse.</p>
<p>Aside from the time-varying coefficients <span class="math notranslate nohighlight">\(\alpha_t\)</span>, the other parameters that we will need to estimate are terms in the covariance matrix <span class="math notranslate nohighlight">\(H\)</span> and the random walk variances <span class="math notranslate nohighlight">\(\sigma_i^2\)</span>.</p>
<h3 id="TVP-VAR-model-in-Statsmodels">TVP-VAR model in Statsmodels<a class="headerlink" href="#TVP-VAR-model-in-Statsmodels" title="Link to this heading">¶</a></h3>
<p>Constructing this model programatically in Statsmodels is also relatively straightforward, since there are basically four steps:</p>
<ol class="arabic simple">
<li><p>Create a new <code class="docutils literal notranslate"><span class="pre">TVPVAR</span></code> class as a subclass of <code class="docutils literal notranslate"><span class="pre">sm.tsa.statespace.MLEModel</span></code></p></li>
<li><p>Fill in the fixed values of the state space system matrices</p></li>
<li><p>Specify the initialization of <span class="math notranslate nohighlight">\(\alpha_1\)</span></p></li>
<li><p>Create a method for updating the state space system matrices with new values of the covariance matrix <span class="math notranslate nohighlight">\(H\)</span> and the random walk variances <span class="math notranslate nohighlight">\(\sigma_i^2\)</span>.</p></li>
</ol>
<p>To do this, first note that the general state space representation used by Statsmodels is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp; = d_t + Z_t \alpha_t + \varepsilon_t, \qquad \varepsilon_t \sim N(0, H_t) \\
\alpha_{t+1} &amp; = c_t + T_t \alpha_t + R_t \eta_t, \qquad \eta_t \sim N(0, Q_t) \\
\end{aligned}\end{split}\]</div>
<p>Then the TVP-VAR(1) model implies the following specializations:</p>
<ul class="simple">
<li><p>The intercept terms are zero, i.e. <span class="math notranslate nohighlight">\(c_t = d_t = 0\)</span></p></li>
<li><p>The design matrix <span class="math notranslate nohighlight">\(Z_t\)</span> is time-varying but its values are fixed as described above (i.e. its values contain ones and lags of <span class="math notranslate nohighlight">\(y_t\)</span>)</p></li>
<li><p>The observation covariance matrix is not time-varying, i.e. <span class="math notranslate nohighlight">\(H_t = H_{t+1} = H\)</span></p></li>
<li><p>The transition matrix is not time-varying and is equal to the identity matrix, i.e. <span class="math notranslate nohighlight">\(T_t = T_{t+1} = I\)</span></p></li>
<li><p>The selection matrix <span class="math notranslate nohighlight">\(R_t\)</span> is not time-varying and is also equal to the identity matrix, i.e. <span class="math notranslate nohighlight">\(R_t = R_{t+1} = I\)</span></p></li>
<li><p>The state covariance matrix <span class="math notranslate nohighlight">\(Q_t\)</span> is not time-varying and is diagonal, i.e. <span class="math notranslate nohighlight">\(Q_t = Q_{t+1} = \text{diag}(\{\sigma_i^2\})\)</span></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># 1. Create a new TVPVAR class as a subclass of sm.tsa.statespace.MLEModel</span>
<span class="k">class</span> <span class="nc">TVPVAR</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">statespace</span><span class="o">.</span><span class="n">MLEModel</span><span class="p">):</span>
    <span class="c1"># Steps 2-3 are best done in the class &quot;constructor&quot;, i.e. the __init__ method</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># Create a matrix with [y_t&#39; : y_{t-1}&#39;] for t = 2, ..., T</span>
        <span class="n">augmented</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">lagmat</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">original</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">use_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Separate into y_t and z_t = [1 : y_{t-1}&#39;]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">y_t</span> <span class="o">=</span> <span class="n">augmented</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="n">p</span><span class="p">]</span>
        <span class="n">z_t</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">augmented</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">p</span><span class="p">:])</span>

        <span class="c1"># Recall that the length of the state vector is p * (p + 1)</span>
        <span class="n">k_states</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">z_t</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="n">k_states</span><span class="p">)</span>

        <span class="c1"># Note that the state space system matrices default to contain zeros,</span>
        <span class="c1"># so we don&#39;t need to explicitly set c_t = d_t = 0.</span>

        <span class="c1"># Construct the design matrix Z_t</span>
        <span class="c1"># Notes:</span>
        <span class="c1"># -&gt; self.k_endog = p is the dimension of the observed vector</span>
        <span class="c1"># -&gt; self.k_states = p * (p + 1) is the dimension of the observed vector</span>
        <span class="c1"># -&gt; self.nobs = T is the number of observations in y_t</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;design&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_states</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;design&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">z_t</span><span class="o">.</span><span class="n">T</span>

        <span class="c1"># Construct the transition matrix T = I</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;transition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">k_states</span><span class="p">)</span>

        <span class="c1"># Construct the selection matrix R = I</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;selection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">k_states</span><span class="p">)</span>

        <span class="c1"># Step 3: Initialize the state vector as alpha_1 ~ N(0, 5I)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssm</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="s1">&#39;known&#39;</span><span class="p">,</span> <span class="n">stationary_cov</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_states</span><span class="p">))</span>

    <span class="c1"># Step 4. Create a method that we can call to update H and Q</span>
    <span class="k">def</span> <span class="nf">update_variances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_cov</span><span class="p">,</span> <span class="n">state_cov_diag</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;obs_cov&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obs_cov</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;state_cov&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">state_cov_diag</span><span class="p">)</span>

    <span class="c1"># Finally, it can be convenient to define human-readable names for</span>
    <span class="c1"># each element of the state vector. These will be available in output</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">state_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_endog</span><span class="p">):</span>
            <span class="n">endog_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endog_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">state_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">[</span><span class="s1">&#39;intercept.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">endog_name</span><span class="p">]</span> <span class="o">+</span>
                <span class="p">[</span><span class="s1">&#39;L1.</span><span class="si">%s</span><span class="s1">-&gt;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">other_name</span><span class="p">,</span> <span class="n">endog_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">other_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endog_names</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">state_names</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>The above class defined the state space model for any given dataset. Now we need to create a specific instance of it with the dataset that we created earlier containing real GDP growth, inflation, unemployment, and interest rates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Create an instance of our TVPVAR class with our observed dataset y</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">TVPVAR</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h3 id="Preliminary-investigation-with-ad-hoc-parameters-in-H,-Q">Preliminary investigation with ad-hoc parameters in H, Q<a class="headerlink" href="#Preliminary-investigation-with-ad-hoc-parameters-in-H,-Q" title="Link to this heading">¶</a></h3>
<p>In our analysis below, we will need to begin our MCMC iterations with some initial parameterization. Following Chan and Jeliazkov (2009) we will set <span class="math notranslate nohighlight">\(H\)</span> to be the sample covariance matrix of our dataset, and we will set <span class="math notranslate nohighlight">\(\sigma_i^2 = 0.01\)</span> for each <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Before discussing the MCMC scheme that will allow us to make inferences about the model, first we can consider the output of the model when simply plugging in these initial parameters. To fill in these parameters, we use the <code class="docutils literal notranslate"><span class="pre">update_variances</span></code> method that we defined earlier and then perform Kalman filtering and smoothing conditional on those parameters.</p>
<p><strong>Warning: This exercise is just by way of explanation - we must wait for the output of the MCMC exercise to study the actual implications of the model in a meaningful way</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">initial_obs_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">initial_state_cov_diag</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span> <span class="o">*</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_states</span>

<span class="c1"># Update H and Q</span>
<span class="n">mod</span><span class="o">.</span><span class="n">update_variances</span><span class="p">(</span><span class="n">initial_obs_cov</span><span class="p">,</span> <span class="n">initial_state_cov_diag</span><span class="p">)</span>

<span class="c1"># Perform Kalman filtering and smoothing</span>
<span class="c1"># (the [] is just an empty list that in some models might contain</span>
<span class="c1"># additional parameters. Here, we don&#39;t have any additional parameters</span>
<span class="c1"># so we just pass an empty list)</span>
<span class="n">initial_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">smooth</span><span class="p">([])</span>
</code></pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">initial_res</span></code> variable contains the output of Kalman filtering and smoothing, conditional on those initial parameters. In particular, we may be interested in the “smoothed states”, which are <span class="math notranslate nohighlight">\(E[\alpha_t \mid y^t, H, \{\sigma_i^2\}]\)</span>.</p>
<p>First, lets create a function that graphs the coefficients over time, separated into the equations for equation of the observed variables.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_coefficients_by_equation</span><span class="p">(</span><span class="n">states</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># The way we defined Z_t implies that the first 5 elements of the</span>
    <span class="c1"># state vector correspond to the first variable in y_t, which is GDP growth</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">states</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GDP growth&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># The next 5 elements correspond to inflation</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">states</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Inflation rate&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

    <span class="c1"># The next 5 elements correspond to unemployment</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">states</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Unemployment equation&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># The last 5 elements correspond to the interest rate</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">states</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Interest rate equation&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

    <span class="k">return</span> <span class="n">ax</span>
</code><br/></pre></div>
</div>
</div>
<p>Now, we are interested in the smoothed states, which are available in the <code class="docutils literal notranslate"><span class="pre">states.smoothed</span></code> attribute out our results object <code class="docutils literal notranslate"><span class="pre">initial_res</span></code>.</p>
<p>As the graph below shows, the initial parameterization implies substantial time-variation in some of the coefficients.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Here, for illustration purposes only, we plot the time-varying</span>
<span class="c1"># coefficients conditional on an ad-hoc parameterization</span>

<span class="c1"># Recall that `initial_res` contains the Kalman filtering and smoothing,</span>
<span class="c1"># and the `states.smoothed` attribute contains the smoothed states</span>
<span class="n">plot_coefficients_by_equation</span><span class="p">(</span><span class="n">initial_res</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">smoothed</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_27_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_27_0.png" />
</div>
</div>
<h3 id="Bayesian-estimation-via-MCMC">Bayesian estimation via MCMC<a class="headerlink" href="#Bayesian-estimation-via-MCMC" title="Link to this heading">¶</a></h3>
<p>We will now implement the Gibbs sampler scheme described in Chan and Jeliazkov (2009), Algorithm 2.</p>
<p>We use the following (conditionally conjugate) priors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
H &amp; \sim \mathcal{IW}(\nu_1^0, S_1^0) \\
\sigma_i^2 &amp; \sim \mathcal{IG} \left ( \frac{\nu_{i2}^0}{2}, \frac{S_{i2}^0}{2} \right )
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{IW}\)</span> denotes the inverse-Wishart distribution and <span class="math notranslate nohighlight">\(\mathcal{IG}\)</span> denotes the inverse-Gamma distribution. We set the prior hyperparameters as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
v_1^0 = T + 3, &amp; \quad S_1^0 = I \\
v_{i2}^0 = 6, &amp; \quad S_{i2}^0 = 0.01 \qquad \text{for each} ~ i\\
\end{aligned}\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Prior hyperparameters</span>

<span class="c1"># Prior for obs. cov. is inverse-Wishart(v_1^0=k + 3, S10=I)</span>
<span class="n">v10</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_endog</span> <span class="o">+</span> <span class="mi">3</span>
<span class="n">S10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">k_endog</span><span class="p">)</span>

<span class="c1"># Prior for state cov. variances is inverse-Gamma(v_{i2}^0 / 2 = 3, S+{i2}^0 / 2 = 0.005)</span>
<span class="n">vi20</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">Si20</span> <span class="o">=</span> <span class="mf">0.01</span>
</code></pre></div>
</div>
</div>
<p>Before running the MCMC iterations, there are a couple of practical steps:</p>
<ol class="arabic simple">
<li><p>Create arrays to store the draws of our state vector, observation covariance matrix, and state error variances.</p></li>
<li><p>Put the initial values for H and Q (described above) into the storage vectors</p></li>
<li><p>Construct the simulation smoother object associated with our <code class="docutils literal notranslate"><span class="pre">TVPVAR</span></code> instance to make draws of the state vector</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Gibbs sampler setup</span>
<span class="n">niter</span> <span class="o">=</span> <span class="mi">11000</span>
<span class="n">nburn</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># 1. Create storage arrays</span>
<span class="n">store_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">niter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_states</span><span class="p">))</span>
<span class="n">store_obs_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">niter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_endog</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_endog</span><span class="p">))</span>
<span class="n">store_state_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">niter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_states</span><span class="p">))</span>

<span class="c1"># 2. Put in the initial values</span>
<span class="n">store_obs_cov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_obs_cov</span>
<span class="n">store_state_cov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_state_cov_diag</span>
<span class="n">mod</span><span class="o">.</span><span class="n">update_variances</span><span class="p">(</span><span class="n">store_obs_cov</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">store_state_cov</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># 3. Construct posterior samplers</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">simulation_smoother</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cfa&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>As before, we could have used either the simulation smoother based on the Kalman filter and smoother or that based on the Cholesky Factor Algorithm.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
    <span class="n">mod</span><span class="o">.</span><span class="n">update_variances</span><span class="p">(</span><span class="n">store_obs_cov</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">store_state_cov</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

    <span class="c1"># 1. Sample states</span>
    <span class="n">store_states</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">simulated_state</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># 2. Simulate obs cov</span>
    <span class="n">fitted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mod</span><span class="p">[</span><span class="s1">&#39;design&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">store_states</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">])[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">resid</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">endog</span> <span class="o">-</span> <span class="n">fitted</span>
    <span class="n">store_obs_cov</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">invwishart</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">v10</span> <span class="o">+</span> <span class="n">mod</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="n">S10</span> <span class="o">+</span> <span class="n">resid</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">resid</span><span class="p">)</span>

    <span class="c1"># 3. Simulate state cov variances</span>
    <span class="n">resid</span> <span class="o">=</span> <span class="n">store_states</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">store_states</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">resid</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">k_states</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">invgamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">((</span><span class="n">vi20</span> <span class="o">+</span> <span class="n">mod</span><span class="o">.</span><span class="n">nobs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="n">Si20</span> <span class="o">+</span> <span class="n">sse</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">store_state_cov</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">rv</span>
</code></pre></div>
</div>
</div>
<p>After removing a number of initial draws, the remaining draws from the posterior allow us to conduct inference. Below, we plot the posterior mean of the time-varying regression coefficients.</p>
<p>(<strong>Note</strong>: these plots are different from those in Figure 1 of the published version of Chan and Jeliazkov (2009), but they are very similar to those produced by the Matlab replication code available at <a class="reference external" href="http://joshuachan.org/code/code_TVPVAR.html">http://joshuachan.org/code/code_TVPVAR.html</a>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Collect the posterior means of each time-varying coefficient</span>
<span class="n">states_posterior_mean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">store_states</span><span class="p">[</span><span class="n">nburn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">index</span><span class="o">=</span><span class="n">mod</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">mod</span><span class="o">.</span><span class="n">state_names</span><span class="p">)</span>

<span class="c1"># Plot these means over time</span>
<span class="n">plot_coefficients_by_equation</span><span class="p">(</span><span class="n">states_posterior_mean</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_35_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_35_0.png" />
</div>
</div>
<p>Python also has a number of libraries to assist with exploring Bayesian models. Here we’ll just use the <a class="reference external" href="https://arviz-devs.github.io/arviz/index.html">arviz</a> package to explore the credible intervals of each of the covariance and variance parameters, although it makes available a much wider set of tools for analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>

<span class="c1"># Collect the observation error covariance parameters</span>
<span class="n">az_obs_cov</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">convert_to_inference_data</span><span class="p">({</span>
    <span class="p">(</span><span class="s1">&#39;Var[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="n">mod</span><span class="o">.</span><span class="n">endog_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="k">else</span>
     <span class="s1">&#39;Cov[</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">endog_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mod</span><span class="o">.</span><span class="n">endog_names</span><span class="p">[</span><span class="n">j</span><span class="p">])):</span>
    <span class="n">store_obs_cov</span><span class="p">[</span><span class="n">nburn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">k_endog</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">k_endog</span><span class="p">)})</span>

<span class="c1"># Plot the credible intervals</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="n">az_obs_cov</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_37_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_37_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Collect the state innovation variance parameters</span>
<span class="n">az_state_cov</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">convert_to_inference_data</span><span class="p">({</span>
    <span class="sa">r</span><span class="s1">&#39;$\sigma^2$[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="n">mod</span><span class="o">.</span><span class="n">state_names</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">store_state_cov</span><span class="p">[</span><span class="n">nburn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:,</span> <span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">k_states</span><span class="p">)})</span>

<span class="c1"># Plot the credible intervals</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="n">az_state_cov</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_38_0.png" src="../../../_images/examples_notebooks_generated_statespace_tvpvar_mcmc_cfa_38_0.png" />
</div>
</div>
<h2 id="Appendix:-performance">Appendix: performance<a class="headerlink" href="#Appendix:-performance" title="Link to this heading">¶</a></h2>
<p>Finally, we run a few simple tests to compare the performance of the KFS and CFA simulation smoothers by using the <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> Jupyter notebook magic.</p>
<p>One caveat is that the KFS simulation smoother can produce a variety of output beyond just simulations of the posterior state vector, and these additional computations could bias the results. To make the results comparable, we will tell the KFS simulation smoother to only compute simulations of the state by using the <code class="docutils literal notranslate"><span class="pre">simulation_output</span></code> argument.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.simulation_smoother</span> <span class="kn">import</span> <span class="n">SIMULATION_STATE</span>

<span class="n">sim_cfa</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">simulation_smoother</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cfa&#39;</span><span class="p">)</span>
<span class="n">sim_kfs</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">simulation_smoother</span><span class="p">(</span><span class="n">simulation_output</span><span class="o">=</span><span class="n">SIMULATION_STATE</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>Then we can use the following code to perform a basic timing exercise:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">timeit</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">r</span> <span class="mi">3</span> <span class="n">sim_cfa</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="o">%</span><span class="n">timeit</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">r</span> <span class="mi">3</span> <span class="n">sim_kfs</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
</code></pre></div>
</div>
<p>On the machine this was tested on, this resulted in the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>2.06 ms ± 26.5 µs per loop (mean ± std. dev. of 3 runs, 10000 loops each)
2.02 ms ± 68.4 µs per loop (mean ± std. dev. of 3 runs, 10000 loops each)
</code></pre></div>
</div>
<p>These results suggest that - at least for this model - there are not noticeable computational gains from the CFA approach relative to the KFS approach. However, this does not rule out the following:</p>
<ol class="arabic simple">
<li><p>The Statsmodels implementation of the CFA simulation smoother could possibly be further optimized</p></li>
<li><p>The CFA approach may only show improvement for certain models (for example with a large number of <code class="docutils literal notranslate"><span class="pre">endog</span></code> variables)</p></li>
</ol>
<p>One simple way to take a first pass at assessing the first possibility is to compare the runtime of the Statsmodels implementation of the CFA simulation smoother to the Matlab implementation in the replication codes of Chan and Jeliazkov (2009), available at <a class="reference external" href="http://joshuachan.org/code/code_TVPVAR.html">http://joshuachan.org/code/code_TVPVAR.html</a>.</p>
<p>While the Statsmodels version of the CFA simulation smoother is written in Cython and compiled to C code, the Matlab version takes advantage of the Matlab’s sparse matrix capabilities. As a result, even though it is not compiled code, we might expect it to have relatively good performance.</p>
<p>On the machine this was tested on, the Matlab version typically ran the MCMC loop with 11,000 iterations in 70-75 seconds, while the MCMC loop in this notebook using the Statsmodels CFA simulation smoother (see above), also with 11,0000 iterations, ran in 40-45 seconds. This is some evidence that the Statsmodels implementation of the CFA smoother already performs relatively well (although it does not rule out that there are additional gains possible).</p>
<h2 id="Bibliography">Bibliography<a class="headerlink" href="#Bibliography" title="Link to this heading">¶</a></h2>
<p>Carter, Chris K., and Robert Kohn. “On Gibbs sampling for state space models.” Biometrika 81, no. 3 (1994): 541-553.</p>
<p>Chan, Joshua CC, and Ivan Jeliazkov. “Efficient simulation and integrated likelihood estimation in state space models.” International Journal of Mathematical Modelling and Numerical Optimisation 1, no. 1-2 (2009): 101-120.</p>
<p>De Jong, Piet, and Neil Shephard. “The simulation smoother for time series models.” Biometrika 82, no. 2 (1995): 339-350.</p>
<p>Durbin, James, and Siem Jan Koopman. “A simple and efficient simulation smoother for state space time series analysis.” Biometrika 89, no. 3 (2002): 603-616.</p>
<p>McCausland, William J., Shirley Miller, and Denis Pelletier. “Simulation smoothing for state–space models: A computational efficiency analysis.” Computational Statistics &amp; Data Analysis 55, no. 1 (2011): 199-212.</p>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      Jul 08, 2024
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="statespace_fixed_params.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Estimating or specifying parameters in state space models" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Estimating or specifying parameters in state space models
            </div>
          </div>
        </a>
      
      
        
        <a href="statespace_news.html" class="md-footer__link md-footer__link--next" aria-label="Next: Forecasting, updating datasets, and the “news”" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Forecasting, updating datasets, and the “news”
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2023, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>