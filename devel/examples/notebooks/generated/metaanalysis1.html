


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>Meta-Analysis in statsmodels - statsmodels 0.15.0 (+296)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.359ec555e2989f00f.min.css?v=b000af5c" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+296)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+296)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+296)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Meta-Analysis in statsmodels
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+296)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+296)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+296)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        <span title="/install.rst (reference label)" class="md-ellipsis">Installing statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        <span title="/gettingstarted.rst (reference label)" class="md-ellipsis">Getting started</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        <span title="/user-guide.rst (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html"><span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        <span title="/examples/index.rst#linear-regression-models (reference label)" class="md-ellipsis">Linear Regression Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        <span title="/examples/index.rst#plotting (reference label)" class="md-ellipsis">Plotting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        <span title="/examples/index.rst#discrete-choice-models (reference label)" class="md-ellipsis">Discrete Choice Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        <span title="/examples/index.rst#nonparametric-statistics (reference label)" class="md-ellipsis">Nonparametric Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        <span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        <span title="/examples/index.rst#robust-regression (reference label)" class="md-ellipsis">Robust Regression</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        <span title="/examples/index.rst#generalized-estimating-equations (reference label)" class="md-ellipsis">Generalized Estimating Equations</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" type="checkbox" id="__nav_4_8" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html#statistics"><span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span></a>
          
            <label for="__nav_4_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Statistics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_8">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="interactions_anova.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/interactions_anova.ipynb (reference label)" class="md-ellipsis">Interactions and ANOVA</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="stats_poisson.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/stats_poisson.ipynb (reference label)" class="md-ellipsis">Statistics and inference for one and two sample Poisson rates</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="stats_rankcompare.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/stats_rankcompare.ipynb (reference label)" class="md-ellipsis">Rank comparison:<wbr> two independent samples</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/examples/notebooks/generated/metaanalysis1.ipynb (reference label)" class="md-ellipsis">Meta-<wbr>Analysis in statsmodels</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/examples/notebooks/generated/metaanalysis1.ipynb (reference label)" class="md-ellipsis">Meta-<wbr>Analysis in statsmodels</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Example" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#example (reference label)" class="md-ellipsis">Example</span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estimate-effect-size-standardized-mean-difference" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#estimate-effect-size-standardized-mean-difference (reference label)" class="md-ellipsis">estimate effect size standardized mean difference</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-one-step-chi2,-DerSimonian-Laird-estimate-for-random-effects-variance-tau" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#using-one-step-chi2,-dersimonian-laird-estimate-for-random-effects-variance-tau (reference label)" class="md-ellipsis">Using one-<wbr>step chi2, Der<wbr>Simonian-<wbr>Laird estimate for random effects variance tau</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-iterated,-Paule-Mandel-estimate-for-random-effects-variance-tau" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#using-iterated,-paule-mandel-estimate-for-random-effects-variance-tau (reference label)" class="md-ellipsis">Using iterated, Paule-<wbr>Mandel estimate for random effects variance tau</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Example-Kacker-interlaboratory-mean" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#example-kacker-interlaboratory-mean (reference label)" class="md-ellipsis">Example Kacker interlaboratory mean</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Meta-analysis-of-proportions" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#meta-analysis-of-proportions (reference label)" class="md-ellipsis">Meta-<wbr>analysis of proportions</span>
  </a>
  
    <nav class="md-nav" aria-label="Meta-analysis of proportions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#changing-data-to-have-positive-random-effects-variance" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#changing-data-to-have-positive-random-effects-variance (reference label)" class="md-ellipsis">changing data to have positive random effects variance</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Replicate-fixed-effect-analysis-using-GLM-with-var_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#replicate-fixed-effect-analysis-using-glm-with-var_weights (reference label)" class="md-ellipsis">Replicate fixed effect analysis using GLM with var_<wbr>weights</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Mantel-Hanszel-odds-ratio-using-contingency-tables" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#mantel-hanszel-odds-ratio-using-contingency-tables (reference label)" class="md-ellipsis">Mantel-<wbr>Hanszel odds-<wbr>ratio using contingency tables</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="mediation_survival.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/mediation_survival.ipynb (reference label)" class="md-ellipsis">Mediation analysis with duration data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb (reference label)" class="md-ellipsis">Treatment effects under conditional independence</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html#All-methods-in-TreatmentEffect" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb#all-methods-in-treatmenteffect (reference label)" class="md-ellipsis">All methods in Treatment<wbr>Effect</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html#Results-in-Stata" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb#results-in-stata (reference label)" class="md-ellipsis">Results in Stata</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html#Treatment-effect-on-the-treated" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb#treatment-effect-on-the-treated (reference label)" class="md-ellipsis">Treatment effect on the treated</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="copula.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/copula.ipynb (reference label)" class="md-ellipsis">Copula -<wbr> Multivariate joint distribution</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        <span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models-technical-notes (reference label)" class="md-ellipsis">State space models -<wbr> Technical notes</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        <span title="/examples/index.rst#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        <span title="/examples/index.rst#multivariate-methods (reference label)" class="md-ellipsis">Multivariate Methods</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        <span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API Reference</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        <span title="/about.rst (reference label)" class="md-ellipsis">About statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        <span title="/dev/index.rst (reference label)" class="md-ellipsis">Developer Page</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        <span title="/release/index.rst (reference label)" class="md-ellipsis">Release Notes</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Example" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#example (reference label)" class="md-ellipsis">Example</span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estimate-effect-size-standardized-mean-difference" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#estimate-effect-size-standardized-mean-difference (reference label)" class="md-ellipsis">estimate effect size standardized mean difference</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-one-step-chi2,-DerSimonian-Laird-estimate-for-random-effects-variance-tau" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#using-one-step-chi2,-dersimonian-laird-estimate-for-random-effects-variance-tau (reference label)" class="md-ellipsis">Using one-<wbr>step chi2, Der<wbr>Simonian-<wbr>Laird estimate for random effects variance tau</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Using-iterated,-Paule-Mandel-estimate-for-random-effects-variance-tau" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#using-iterated,-paule-mandel-estimate-for-random-effects-variance-tau (reference label)" class="md-ellipsis">Using iterated, Paule-<wbr>Mandel estimate for random effects variance tau</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Example-Kacker-interlaboratory-mean" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#example-kacker-interlaboratory-mean (reference label)" class="md-ellipsis">Example Kacker interlaboratory mean</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Meta-analysis-of-proportions" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#meta-analysis-of-proportions (reference label)" class="md-ellipsis">Meta-<wbr>analysis of proportions</span>
  </a>
  
    <nav class="md-nav" aria-label="Meta-analysis of proportions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#changing-data-to-have-positive-random-effects-variance" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#changing-data-to-have-positive-random-effects-variance (reference label)" class="md-ellipsis">changing data to have positive random effects variance</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Replicate-fixed-effect-analysis-using-GLM-with-var_weights" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#replicate-fixed-effect-analysis-using-glm-with-var_weights (reference label)" class="md-ellipsis">Replicate fixed effect analysis using GLM with var_<wbr>weights</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Mantel-Hanszel-odds-ratio-using-contingency-tables" class="md-nav__link">
    <span title="/examples/notebooks/generated/metaanalysis1.ipynb#mantel-hanszel-odds-ratio-using-contingency-tables (reference label)" class="md-ellipsis">Mantel-<wbr>Hanszel odds-<wbr>ratio using contingency tables</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="Meta-Analysis-in-statsmodels">Meta-Analysis in statsmodels<a class="headerlink" href="#Meta-Analysis-in-statsmodels" title="Link to this heading">¶</a></h1>
<p>Statsmodels include basic methods for meta-analysis. This notebook illustrates the current usage.</p>
<p>Status: The results have been verified against R meta and metafor packages. However, the API is still experimental and will still change. Some options for additional methods that are available in R meta and metafor are missing.</p>
<p>The support for meta-analysis has 3 parts:</p>
<ul class="simple">
<li><p>effect size functions: this currently includes <code class="docutils literal notranslate"><span class="pre">effectsize_smd</span></code> computes effect size and their standard errors for standardized mean difference,
<code class="docutils literal notranslate"><span class="pre">effectsize_2proportions</span></code> computes effect sizes for comparing two independent proportions using risk difference, (log) risk ratio, (log) odds-ratio or arcsine square root transformation</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">combine_effects</span></code> computes fixed and random effects estimate for the overall mean or effect. The returned results instance includes a forest plot function.</p></li>
<li><p>helper functions to estimate the random effect variance, tau-squared</p></li>
</ul>
<p>The estimate of the overall effect size in <code class="docutils literal notranslate"><span class="pre">combine_effects</span></code> can also be performed using WLS or GLM with var_weights.</p>
<p>Finally, the meta-analysis functions currently do not include the Mantel-Hanszel method. However, the fixed effects results can be computed directly using <code class="docutils literal notranslate"><span class="pre">StratifiedTable</span></code> as illustrated below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span><span class="p">,</span> <span class="n">optimize</span>

<span class="kn">from</span> <span class="nn">statsmodels.regression.linear_model</span> <span class="kn">import</span> <span class="n">WLS</span>
<span class="kn">from</span> <span class="nn">statsmodels.genmod.generalized_linear_model</span> <span class="kn">import</span> <span class="n">GLM</span>

<span class="kn">from</span> <span class="nn">statsmodels.stats.meta_analysis</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">effectsize_smd</span><span class="p">,</span>
    <span class="n">effectsize_2proportions</span><span class="p">,</span>
    <span class="n">combine_effects</span><span class="p">,</span>
    <span class="n">_fit_tau_iterative</span><span class="p">,</span>
    <span class="n">_fit_tau_mm</span><span class="p">,</span>
    <span class="n">_fit_tau_iter_mm</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># increase line length for pandas</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.width&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Example">Example<a class="headerlink" href="#Example" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Carroll&quot;</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Grant&quot;</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">65</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Peck&quot;</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Donat&quot;</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Stewart&quot;</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Young&quot;</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">85</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">colnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_t&quot;</span><span class="p">,</span> <span class="s2">&quot;sd_t&quot;</span><span class="p">,</span> <span class="s2">&quot;n_t&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_c&quot;</span><span class="p">,</span> <span class="s2">&quot;sd_c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_c&quot;</span><span class="p">]</span>
<span class="n">rownames</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
<span class="n">dframe1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>
<span class="n">rownames</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Carroll&#39;, &#39;Grant&#39;, &#39;Peck&#39;, &#39;Donat&#39;, &#39;Stewart&#39;, &#39;Young&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mean2</span><span class="p">,</span> <span class="n">sd2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">,</span> <span class="n">mean1</span><span class="p">,</span> <span class="n">sd1</span><span class="p">,</span> <span class="n">nobs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
    <span class="n">dframe1</span><span class="p">[[</span><span class="s2">&quot;mean_t&quot;</span><span class="p">,</span> <span class="s2">&quot;sd_t&quot;</span><span class="p">,</span> <span class="s2">&quot;n_t&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_c&quot;</span><span class="p">,</span> <span class="s2">&quot;sd_c&quot;</span><span class="p">,</span> <span class="s2">&quot;n_c&quot;</span><span class="p">]]</span>
<span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">rownames</span> <span class="o">=</span> <span class="n">dframe1</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">]</span>
<span class="n">rownames</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Carroll&#39;, &#39;Grant&#39;, &#39;Peck&#39;, &#39;Donat&#39;, &#39;Stewart&#39;, &#39;Young&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nobs1</span> <span class="o">+</span> <span class="n">nobs2</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([120, 130,  80, 400,  95, 170])
</pre></div></div>
</div>
<h3 id="estimate-effect-size-standardized-mean-difference">estimate effect size standardized mean difference<a class="headerlink" href="#estimate-effect-size-standardized-mean-difference" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span> <span class="o">=</span> <span class="n">effectsize_smd</span><span class="p">(</span><span class="n">mean2</span><span class="p">,</span> <span class="n">sd2</span><span class="p">,</span> <span class="n">nobs2</span><span class="p">,</span> <span class="n">mean1</span><span class="p">,</span> <span class="n">sd1</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h3 id="Using-one-step-chi2,-DerSimonian-Laird-estimate-for-random-effects-variance-tau">Using one-step chi2, DerSimonian-Laird estimate for random effects variance tau<a class="headerlink" href="#Using-one-step-chi2,-DerSimonian-Laird-estimate-for-random-effects-variance-tau" title="Link to this heading">¶</a></h3>
<p>Method option for random effect <code class="docutils literal notranslate"><span class="pre">method_re=&quot;chi2&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">method_re=&quot;dl&quot;</span></code>, both names are accepted. This is commonly referred to as the DerSimonian-Laird method, it is based on a moment estimator based on pearson chi2 from the fixed effects estimate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res3</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="n">rownames</span><span class="p">)</span>
<span class="c1"># TODO: we still need better information about conf_int of individual samples</span>
<span class="c1"># We don&#39;t have enough information in the model for individual confidence intervals</span>
<span class="c1"># if those are not based on normal distribution.</span>
<span class="n">res3</span><span class="o">.</span><span class="n">conf_int_samples</span><span class="p">(</span><span class="n">nobs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nobs1</span> <span class="o">+</span> <span class="n">nobs2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res3</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                        eff    sd_eff    ci_low    ci_upp      w_fe      w_re
Carroll            0.094524  0.182680 -0.267199  0.456248  0.123885  0.157529
Grant              0.277356  0.176279 -0.071416  0.626129  0.133045  0.162828
Peck               0.366546  0.225573 -0.082446  0.815538  0.081250  0.126223
Donat              0.664385  0.102748  0.462389  0.866381  0.391606  0.232734
Stewart            0.461808  0.208310  0.048203  0.875413  0.095275  0.137949
Young              0.185165  0.153729 -0.118312  0.488641  0.174939  0.182736
fixed effect       0.414961  0.064298  0.249677  0.580245  1.000000       NaN
random effect      0.358486  0.105462  0.087388  0.629583       NaN  1.000000
fixed effect wls   0.414961  0.099237  0.159864  0.670058  1.000000       NaN
random effect wls  0.358486  0.090328  0.126290  0.590682       NaN  1.000000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res3</span><span class="o">.</span><span class="n">cache_ci</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(0.05,
  True): (array([-0.26719942, -0.07141628, -0.08244568,  0.46238908,  0.04820269,
         -0.1183121 ]), array([0.45624817, 0.62612908, 0.81553838, 0.86638112, 0.87541326,
         0.48864139]))}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res3</span><span class="o">.</span><span class="n">method_re</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;chi2&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">res3</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_13_0.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_13_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res3</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="n">rownames</span><span class="p">)</span>
<span class="c1"># TODO: we still need better information about conf_int of individual samples</span>
<span class="c1"># We don&#39;t have enough information in the model for individual confidence intervals</span>
<span class="c1"># if those are not based on normal distribution.</span>
<span class="n">res3</span><span class="o">.</span><span class="n">conf_int_samples</span><span class="p">(</span><span class="n">nobs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nobs1</span> <span class="o">+</span> <span class="n">nobs2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res3</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                        eff    sd_eff    ci_low    ci_upp      w_fe      w_re
Carroll            0.094524  0.182680 -0.263521  0.452570  0.123885  0.157529
Grant              0.277356  0.176279 -0.068144  0.622857  0.133045  0.162828
Peck               0.366546  0.225573 -0.075569  0.808662  0.081250  0.126223
Donat              0.664385  0.102748  0.463002  0.865768  0.391606  0.232734
Stewart            0.461808  0.208310  0.053527  0.870089  0.095275  0.137949
Young              0.185165  0.153729 -0.116139  0.486468  0.174939  0.182736
fixed effect       0.414961  0.064298  0.288939  0.540984  1.000000       NaN
random effect      0.358486  0.105462  0.151785  0.565187       NaN  1.000000
fixed effect wls   0.414961  0.099237  0.220460  0.609462  1.000000       NaN
random effect wls  0.358486  0.090328  0.181446  0.535526       NaN  1.000000
</pre></div></div>
</div>
<h3 id="Using-iterated,-Paule-Mandel-estimate-for-random-effects-variance-tau">Using iterated, Paule-Mandel estimate for random effects variance tau<a class="headerlink" href="#Using-iterated,-Paule-Mandel-estimate-for-random-effects-variance-tau" title="Link to this heading">¶</a></h3>
<p>The method commonly referred to as Paule-Mandel estimate is a method of moment estimate for the random effects variance that iterates between mean and variance estimate until convergence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res4</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span>
    <span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;iterated&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="n">rownames</span>
<span class="p">)</span>
<span class="n">res4_df</span> <span class="o">=</span> <span class="n">res4</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;method RE:&quot;</span><span class="p">,</span> <span class="n">res4</span><span class="o">.</span><span class="n">method_re</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res4</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">res4</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
method RE: iterated
                        eff    sd_eff    ci_low    ci_upp      w_fe      w_re
Carroll            0.094524  0.182680 -0.263521  0.452570  0.123885  0.152619
Grant              0.277356  0.176279 -0.068144  0.622857  0.133045  0.159157
Peck               0.366546  0.225573 -0.075569  0.808662  0.081250  0.116228
Donat              0.664385  0.102748  0.463002  0.865768  0.391606  0.257767
Stewart            0.461808  0.208310  0.053527  0.870089  0.095275  0.129428
Young              0.185165  0.153729 -0.116139  0.486468  0.174939  0.184799
fixed effect       0.414961  0.064298  0.288939  0.540984  1.000000       NaN
random effect      0.366419  0.092390  0.185338  0.547500       NaN  1.000000
fixed effect wls   0.414961  0.099237  0.220460  0.609462  1.000000       NaN
random effect wls  0.366419  0.092390  0.185338  0.547500       NaN  1.000000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_16_1.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_16_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[ ]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<h2 id="Example-Kacker-interlaboratory-mean">Example Kacker interlaboratory mean<a class="headerlink" href="#Example-Kacker-interlaboratory-mean" title="Link to this heading">¶</a></h2>
<p>In this example the effect size is the mean of measurements in a lab. We combine the estimates from several labs to estimate and overall average.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">61.00</span><span class="p">,</span> <span class="mf">61.40</span><span class="p">,</span> <span class="mf">62.21</span><span class="p">,</span> <span class="mf">62.30</span><span class="p">,</span> <span class="mf">62.34</span><span class="p">,</span> <span class="mf">62.60</span><span class="p">,</span> <span class="mf">62.70</span><span class="p">,</span> <span class="mf">62.84</span><span class="p">,</span> <span class="mf">65.90</span><span class="p">])</span>
<span class="n">var_eff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.2025</span><span class="p">,</span> <span class="mf">1.2100</span><span class="p">,</span> <span class="mf">0.0900</span><span class="p">,</span> <span class="mf">0.2025</span><span class="p">,</span> <span class="mf">0.3844</span><span class="p">,</span> <span class="mf">0.5625</span><span class="p">,</span> <span class="mf">0.0676</span><span class="p">,</span> <span class="mf">0.0225</span><span class="p">,</span> <span class="mf">1.8225</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">rownames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PTB&quot;</span><span class="p">,</span> <span class="s2">&quot;NMi&quot;</span><span class="p">,</span> <span class="s2">&quot;NIMC&quot;</span><span class="p">,</span> <span class="s2">&quot;KRISS&quot;</span><span class="p">,</span> <span class="s2">&quot;LGC&quot;</span><span class="p">,</span> <span class="s2">&quot;NRC&quot;</span><span class="p">,</span> <span class="s2">&quot;IRMM&quot;</span><span class="p">,</span> <span class="s2">&quot;NIST&quot;</span><span class="p">,</span> <span class="s2">&quot;LNE&quot;</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res2_DL</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;dl&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="n">rownames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;method RE:&quot;</span><span class="p">,</span> <span class="n">res2_DL</span><span class="o">.</span><span class="n">method_re</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res2_DL</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">res2_DL</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
method RE: dl
                         eff    sd_eff     ci_low     ci_upp      w_fe      w_re
PTB                61.000000  0.450000  60.118016  61.881984  0.057436  0.123113
NMi                61.400000  1.100000  59.244040  63.555960  0.009612  0.040314
NIMC               62.210000  0.300000  61.622011  62.797989  0.129230  0.159749
KRISS              62.300000  0.450000  61.418016  63.181984  0.057436  0.123113
LGC                62.340000  0.620000  61.124822  63.555178  0.030257  0.089810
NRC                62.600000  0.750000  61.130027  64.069973  0.020677  0.071005
IRMM               62.700000  0.260000  62.190409  63.209591  0.172052  0.169810
NIST               62.840000  0.150000  62.546005  63.133995  0.516920  0.194471
LNE                65.900000  1.350000  63.254049  68.545951  0.006382  0.028615
fixed effect       62.583397  0.107846  62.334704  62.832090  1.000000       NaN
random effect      62.390139  0.245750  61.823439  62.956838       NaN  1.000000
fixed effect wls   62.583397  0.189889  62.145512  63.021282  1.000000       NaN
random effect wls  62.390139  0.294776  61.710384  63.069893       NaN  1.000000
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/statsmodels/stats/meta_analysis.py:105: UserWarning: `use_t=True` requires `nobs` for each sample or `ci_func`. Using normal distribution for confidence interval of individual samples.
  warnings.warn(msg)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_20_2.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_20_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res2_PM</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;pm&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="n">rownames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;method RE:&quot;</span><span class="p">,</span> <span class="n">res2_PM</span><span class="o">.</span><span class="n">method_re</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res2_PM</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">res2_PM</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
method RE: pm
                         eff    sd_eff     ci_low     ci_upp      w_fe      w_re
PTB                61.000000  0.450000  60.118016  61.881984  0.057436  0.125857
NMi                61.400000  1.100000  59.244040  63.555960  0.009612  0.059656
NIMC               62.210000  0.300000  61.622011  62.797989  0.129230  0.143658
KRISS              62.300000  0.450000  61.418016  63.181984  0.057436  0.125857
LGC                62.340000  0.620000  61.124822  63.555178  0.030257  0.104850
NRC                62.600000  0.750000  61.130027  64.069973  0.020677  0.090122
IRMM               62.700000  0.260000  62.190409  63.209591  0.172052  0.147821
NIST               62.840000  0.150000  62.546005  63.133995  0.516920  0.156980
LNE                65.900000  1.350000  63.254049  68.545951  0.006382  0.045201
fixed effect       62.583397  0.107846  62.334704  62.832090  1.000000       NaN
random effect      62.407620  0.338030  61.628120  63.187119       NaN  1.000000
fixed effect wls   62.583397  0.189889  62.145512  63.021282  1.000000       NaN
random effect wls  62.407620  0.338030  61.628120  63.187120       NaN  1.000000
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/statsmodels/stats/meta_analysis.py:105: UserWarning: `use_t=True` requires `nobs` for each sample or `ci_func`. Using normal distribution for confidence interval of individual samples.
  warnings.warn(msg)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_21_2.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_21_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[ ]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<h2 id="Meta-analysis-of-proportions">Meta-analysis of proportions<a class="headerlink" href="#Meta-analysis-of-proportions" title="Link to this heading">¶</a></h2>
<p>In the following example the random effect variance tau is estimated to be zero. I then change two counts in the data, so the second example has random effects variance greater than zero.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">io</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ss</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">    study,nei,nci,e1i,c1i,e2i,c2i,e3i,c3i,e4i,c4i</span>
<span class="s2">    1,19,22,16.0,20.0,11,12,4.0,8.0,4,3</span>
<span class="s2">    2,34,35,22.0,22.0,18,12,15.0,8.0,15,6</span>
<span class="s2">    3,72,68,44.0,40.0,21,15,10.0,3.0,3,0</span>
<span class="s2">    4,22,20,19.0,12.0,14,5,5.0,4.0,2,3</span>
<span class="s2">    5,70,32,62.0,27.0,42,13,26.0,6.0,15,5</span>
<span class="s2">    6,183,94,130.0,65.0,80,33,47.0,14.0,30,11</span>
<span class="s2">    7,26,50,24.0,30.0,13,18,5.0,10.0,3,9</span>
<span class="s2">    8,61,55,51.0,44.0,37,30,19.0,19.0,11,15</span>
<span class="s2">    9,36,25,30.0,17.0,23,12,13.0,4.0,10,4</span>
<span class="s2">    10,45,35,43.0,35.0,19,14,8.0,4.0,6,0</span>
<span class="s2">    11,246,208,169.0,139.0,106,76,67.0,42.0,51,35</span>
<span class="s2">    12,386,141,279.0,97.0,170,46,97.0,21.0,73,8</span>
<span class="s2">    13,59,32,56.0,30.0,34,17,21.0,9.0,20,7</span>
<span class="s2">    14,45,15,42.0,10.0,18,3,9.0,1.0,9,1</span>
<span class="s2">    15,14,18,14.0,18.0,13,14,12.0,13.0,9,12</span>
<span class="s2">    16,26,19,21.0,15.0,12,10,6.0,4.0,5,1</span>
<span class="s2">    17,74,75,,,42,40,,,23,30&quot;&quot;&quot;</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span>
<span class="n">df_12y</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[[</span><span class="s2">&quot;e2i&quot;</span><span class="p">,</span> <span class="s2">&quot;nei&quot;</span><span class="p">,</span> <span class="s2">&quot;c2i&quot;</span><span class="p">,</span> <span class="s2">&quot;nci&quot;</span><span class="p">]]</span>
<span class="c1"># TODO: currently 1 is reference, switch labels</span>
<span class="n">count1</span><span class="p">,</span> <span class="n">nobs1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">nobs2</span> <span class="o">=</span> <span class="n">df_12y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span>
<span class="n">dta</span> <span class="o">=</span> <span class="n">df_12y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span> <span class="o">=</span> <span class="n">effectsize_2proportions</span><span class="p">(</span><span class="o">*</span><span class="n">dta</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s2">&quot;rd&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 0.03349282,  0.18655462,  0.07107843,  0.38636364,  0.19375   ,
         0.08609464,  0.14      ,  0.06110283,  0.15888889,  0.02222222,
         0.06550969,  0.11417337,  0.04502119,  0.2       ,  0.15079365,
        -0.06477733,  0.03423423]),
 array([0.02409958, 0.01376482, 0.00539777, 0.01989341, 0.01096641,
        0.00376814, 0.01422338, 0.00842011, 0.01639261, 0.01227827,
        0.00211165, 0.00219739, 0.01192067, 0.016     , 0.0143398 ,
        0.02267994, 0.0066352 ]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res5</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span>
    <span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;iterated&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>  <span class="c1"># , row_names=rownames)</span>
<span class="n">res5_df</span> <span class="o">=</span> <span class="n">res5</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;method RE:&quot;</span><span class="p">,</span> <span class="n">res5</span><span class="o">.</span><span class="n">method_re</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RE variance tau2:&quot;</span><span class="p">,</span> <span class="n">res5</span><span class="o">.</span><span class="n">tau2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res5</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">res5</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
method RE: iterated
RE variance tau2: 0
                        eff    sd_eff    ci_low    ci_upp      w_fe      w_re
0                  0.033493  0.155240 -0.270773  0.337758  0.017454  0.017454
1                  0.186555  0.117324 -0.043395  0.416505  0.030559  0.030559
2                  0.071078  0.073470 -0.072919  0.215076  0.077928  0.077928
3                  0.386364  0.141044  0.109922  0.662805  0.021145  0.021145
4                  0.193750  0.104721 -0.011499  0.398999  0.038357  0.038357
5                  0.086095  0.061385 -0.034218  0.206407  0.111630  0.111630
6                  0.140000  0.119262 -0.093749  0.373749  0.029574  0.029574
7                  0.061103  0.091761 -0.118746  0.240951  0.049956  0.049956
8                  0.158889  0.128034 -0.092052  0.409830  0.025660  0.025660
9                  0.022222  0.110807 -0.194956  0.239401  0.034259  0.034259
10                 0.065510  0.045953 -0.024556  0.155575  0.199199  0.199199
11                 0.114173  0.046876  0.022297  0.206049  0.191426  0.191426
12                 0.045021  0.109182 -0.168971  0.259014  0.035286  0.035286
13                 0.200000  0.126491 -0.047918  0.447918  0.026290  0.026290
14                 0.150794  0.119749 -0.083910  0.385497  0.029334  0.029334
15                -0.064777  0.150599 -0.359945  0.230390  0.018547  0.018547
16                 0.034234  0.081457 -0.125418  0.193887  0.063395  0.063395
fixed effect       0.096212  0.020509  0.056014  0.136410  1.000000       NaN
random effect      0.096212  0.020509  0.056014  0.136410       NaN  1.000000
fixed effect wls   0.096212  0.016521  0.063831  0.128593  1.000000       NaN
random effect wls  0.096212  0.016521  0.063831  0.128593       NaN  1.000000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_28_1.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_28_1.png" />
</div>
</div>
<h3 id="changing-data-to-have-positive-random-effects-variance">changing data to have positive random effects variance<a class="headerlink" href="#changing-data-to-have-positive-random-effects-variance" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">dta_c</span> <span class="o">=</span> <span class="n">dta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">dta_c</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">dta_c</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">22</span>
<span class="n">dta_c</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 18,  19,  12,  22],
       [ 22,  34,  12,  35],
       [ 21,  72,  15,  68],
       [ 14,  22,   5,  20],
       [ 42,  70,  13,  32],
       [ 80, 183,  33,  94],
       [ 13,  26,  18,  50],
       [ 37,  61,  30,  55],
       [ 23,  36,  12,  25],
       [ 19,  45,  14,  35],
       [106, 246,  76, 208],
       [170, 386,  46, 141],
       [ 34,  59,  17,  32],
       [ 18,  45,   3,  15],
       [ 13,  14,  14,  18],
       [ 12,  26,  10,  19],
       [ 42,  74,  40,  75]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span> <span class="o">=</span> <span class="n">effectsize_2proportions</span><span class="p">(</span><span class="o">*</span><span class="n">dta_c</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s2">&quot;rd&quot;</span><span class="p">)</span>
<span class="n">res5</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span>
    <span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;iterated&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>  <span class="c1"># , row_names=rownames)</span>
<span class="n">res5_df</span> <span class="o">=</span> <span class="n">res5</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;method RE:&quot;</span><span class="p">,</span> <span class="n">res5</span><span class="o">.</span><span class="n">method_re</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res5</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">res5</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
method RE: iterated
                        eff    sd_eff    ci_low    ci_upp      w_fe      w_re
0                  0.401914  0.117873  0.170887  0.632940  0.029850  0.038415
1                  0.304202  0.114692  0.079410  0.528993  0.031529  0.040258
2                  0.071078  0.073470 -0.072919  0.215076  0.076834  0.081017
3                  0.386364  0.141044  0.109922  0.662805  0.020848  0.028013
4                  0.193750  0.104721 -0.011499  0.398999  0.037818  0.046915
5                  0.086095  0.061385 -0.034218  0.206407  0.110063  0.102907
6                  0.140000  0.119262 -0.093749  0.373749  0.029159  0.037647
7                  0.061103  0.091761 -0.118746  0.240951  0.049255  0.058097
8                  0.158889  0.128034 -0.092052  0.409830  0.025300  0.033270
9                  0.022222  0.110807 -0.194956  0.239401  0.033778  0.042683
10                 0.065510  0.045953 -0.024556  0.155575  0.196403  0.141871
11                 0.114173  0.046876  0.022297  0.206049  0.188739  0.139144
12                 0.045021  0.109182 -0.168971  0.259014  0.034791  0.043759
13                 0.200000  0.126491 -0.047918  0.447918  0.025921  0.033985
14                 0.150794  0.119749 -0.083910  0.385497  0.028922  0.037383
15                -0.064777  0.150599 -0.359945  0.230390  0.018286  0.024884
16                 0.034234  0.081457 -0.125418  0.193887  0.062505  0.069751
fixed effect       0.110252  0.020365  0.070337  0.150167  1.000000       NaN
random effect      0.117633  0.024913  0.068804  0.166463       NaN  1.000000
fixed effect wls   0.110252  0.022289  0.066567  0.153937  1.000000       NaN
random effect wls  0.117633  0.024913  0.068804  0.166463       NaN  1.000000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_31_1.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_31_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res5</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">res5_df</span> <span class="o">=</span> <span class="n">res5</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;method RE:&quot;</span><span class="p">,</span> <span class="n">res5</span><span class="o">.</span><span class="n">method_re</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res5</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">res5</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
method RE: chi2
                        eff    sd_eff    ci_low    ci_upp      w_fe      w_re
0                  0.401914  0.117873  0.170887  0.632940  0.029850  0.036114
1                  0.304202  0.114692  0.079410  0.528993  0.031529  0.037940
2                  0.071078  0.073470 -0.072919  0.215076  0.076834  0.080779
3                  0.386364  0.141044  0.109922  0.662805  0.020848  0.025973
4                  0.193750  0.104721 -0.011499  0.398999  0.037818  0.044614
5                  0.086095  0.061385 -0.034218  0.206407  0.110063  0.105901
6                  0.140000  0.119262 -0.093749  0.373749  0.029159  0.035356
7                  0.061103  0.091761 -0.118746  0.240951  0.049255  0.056098
8                  0.158889  0.128034 -0.092052  0.409830  0.025300  0.031063
9                  0.022222  0.110807 -0.194956  0.239401  0.033778  0.040357
10                 0.065510  0.045953 -0.024556  0.155575  0.196403  0.154854
11                 0.114173  0.046876  0.022297  0.206049  0.188739  0.151236
12                 0.045021  0.109182 -0.168971  0.259014  0.034791  0.041435
13                 0.200000  0.126491 -0.047918  0.447918  0.025921  0.031761
14                 0.150794  0.119749 -0.083910  0.385497  0.028922  0.035095
15                -0.064777  0.150599 -0.359945  0.230390  0.018286  0.022976
16                 0.034234  0.081457 -0.125418  0.193887  0.062505  0.068449
fixed effect       0.110252  0.020365  0.070337  0.150167  1.000000       NaN
random effect      0.115580  0.023557  0.069410  0.161751       NaN  1.000000
fixed effect wls   0.110252  0.022289  0.066567  0.153937  1.000000       NaN
random effect wls  0.115580  0.024241  0.068068  0.163093       NaN  1.000000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_metaanalysis1_32_1.png" src="../../../_images/examples_notebooks_generated_metaanalysis1_32_1.png" />
</div>
</div>
<h3 id="Replicate-fixed-effect-analysis-using-GLM-with-var_weights">Replicate fixed effect analysis using GLM with var_weights<a class="headerlink" href="#Replicate-fixed-effect-analysis-using-GLM-with-var_weights" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">combine_effects</span></code> computes weighted average estimates which can be replicated using GLM with var_weights or with WLS. The <code class="docutils literal notranslate"><span class="pre">scale</span></code> option in <code class="docutils literal notranslate"><span class="pre">GLM.fit</span></code> can be used to replicate fixed meta-analysis with fixed and with HKSJ/WLS scale</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.genmod.generalized_linear_model</span> <span class="kn">import</span> <span class="n">GLM</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span> <span class="o">=</span> <span class="n">effectsize_2proportions</span><span class="p">(</span><span class="o">*</span><span class="n">dta_c</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">combine_effects</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">var_eff</span><span class="p">,</span> <span class="n">method_re</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">res_frame</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_frame</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                        eff    sd_eff    ci_low    ci_upp  w_fe  w_re
fixed effect       0.428037  0.090287  0.251076  0.604997   1.0   NaN
random effect      0.429520  0.091377  0.250425  0.608615   NaN   1.0
fixed effect wls   0.428037  0.090798  0.250076  0.605997   1.0   NaN
random effect wls  0.429520  0.091595  0.249997  0.609044   NaN   1.0
</pre></div></div>
</div>
<p>We need to fix scale=1 in order to replicate standard errors for the usual meta-analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">weights</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">var_eff</span>
<span class="n">mod_glm</span> <span class="o">=</span> <span class="n">GLM</span><span class="p">(</span><span class="n">eff</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eff</span><span class="p">)),</span> <span class="n">var_weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="n">res_glm</span> <span class="o">=</span> <span class="n">mod_glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_glm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.4280      0.090      4.741      0.000       0.251       0.605
==============================================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># check results</span>
<span class="n">res_glm</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">res_glm</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span> <span class="o">-</span> <span class="n">res_frame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="s2">&quot;fixed effect&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ci_low&quot;</span><span class="p">,</span> <span class="s2">&quot;ci_upp&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array(1.), array([[-5.55111512e-17,  0.00000000e+00]]))
</pre></div></div>
</div>
<p>Using HKSJ variance adjustment in meta-analysis is equivalent to estimating the scale using pearson chi2, which is also the default for the gaussian family.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res_glm</span> <span class="o">=</span> <span class="n">mod_glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s2">&quot;x2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_glm</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.4280      0.091      4.714      0.000       0.250       0.606
==============================================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># check results</span>
<span class="n">res_glm</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">res_glm</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span> <span class="o">-</span> <span class="n">res_frame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="s2">&quot;fixed effect&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ci_low&quot;</span><span class="p">,</span> <span class="s2">&quot;ci_upp&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.0113358914264383, array([[-0.00100017,  0.00100017]]))
</pre></div></div>
</div>
<h3 id="Mantel-Hanszel-odds-ratio-using-contingency-tables">Mantel-Hanszel odds-ratio using contingency tables<a class="headerlink" href="#Mantel-Hanszel-odds-ratio-using-contingency-tables" title="Link to this heading">¶</a></h3>
<p>The fixed effect for the log-odds-ratio using the Mantel-Hanszel can be directly computed using StratifiedTable.</p>
<p>We need to create a 2 x 2 x k contingency table to be used with <code class="docutils literal notranslate"><span class="pre">StratifiedTable</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">t</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">dta_c</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">nt</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">nc</span> <span class="o">-</span> <span class="n">c</span><span class="p">])</span>
<span class="n">ctables</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ctables</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[18,  1],
       [12, 10]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[31]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([18,  1, 12, 10])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">dta_c</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[32]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([18, 19, 12, 22])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[33]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">statsmodels.stats.api</span> <span class="k">as</span> <span class="nn">smstats</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[34]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">st</span> <span class="o">=</span> <span class="n">smstats</span><span class="o">.</span><span class="n">StratifiedTable</span><span class="p">(</span><span class="n">ctables</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<p>compare pooled log-odds-ratio and standard error to R meta package</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[35]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">st</span><span class="o">.</span><span class="n">logodds_pooled</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">logodds_pooled</span> <span class="o">-</span> <span class="mf">0.4428186730553189</span>  <span class="c1"># R meta</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[35]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.4428186730553187, -2.220446049250313e-16)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[36]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">st</span><span class="o">.</span><span class="n">logodds_pooled_se</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">logodds_pooled_se</span> <span class="o">-</span> <span class="mf">0.08928560091027186</span>  <span class="c1"># R meta</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[36]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.08928560091027186, 0.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[37]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">st</span><span class="o">.</span><span class="n">logodds_pooled_confint</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[37]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.2678221109331691, 0.6178152351774683)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[38]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">test_equal_odds</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pvalue      0.34496419319878724
statistic   17.64707987033203
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[39]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">test_null_odds</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pvalue      6.615053645964153e-07
statistic   24.724136624311814
</pre></div></div>
</div>
<p>check conversion to stratified contingency table</p>
<p>Row sums of each table are the sample sizes for treatment and control experiments</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[40]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">ctables</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[40]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 19,  34,  72,  22,  70, 183,  26,  61,  36,  45, 246, 386,  59,
         45,  14,  26,  74],
       [ 22,  35,  68,  20,  32,  94,  50,  55,  25,  35, 208, 141,  32,
         15,  18,  19,  75]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[41]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">nt</span><span class="p">,</span> <span class="n">nc</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[41]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 19,  34,  72,  22,  70, 183,  26,  61,  36,  45, 246, 386,  59,
         45,  14,  26,  74]),
 array([ 22,  35,  68,  20,  32,  94,  50,  55,  25,  35, 208, 141,  32,
         15,  18,  19,  75]))
</pre></div></div>
</div>
<p><strong>Results from R meta package</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>&gt; res_mb_hk = metabin(e2i, nei, c2i, nci, data=dat2, sm=&quot;OR&quot;, Q.Cochrane=FALSE, method=&quot;MH&quot;, method.tau=&quot;DL&quot;, hakn=FALSE, backtransf=FALSE)
&gt; res_mb_hk
     logOR            95%-CI %W(fixed) %W(random)
1   2.7081 [ 0.5265; 4.8896]       0.3        0.7
2   1.2567 [ 0.2658; 2.2476]       2.1        3.2
3   0.3749 [-0.3911; 1.1410]       5.4        5.4
4   1.6582 [ 0.3245; 2.9920]       0.9        1.8
5   0.7850 [-0.0673; 1.6372]       3.5        4.4
6   0.3617 [-0.1528; 0.8762]      12.1       11.8
7   0.5754 [-0.3861; 1.5368]       3.0        3.4
8   0.2505 [-0.4881; 0.9892]       6.1        5.8
9   0.6506 [-0.3877; 1.6889]       2.5        3.0
10  0.0918 [-0.8067; 0.9903]       4.5        3.9
11  0.2739 [-0.1047; 0.6525]      23.1       21.4
12  0.4858 [ 0.0804; 0.8911]      18.6       18.8
13  0.1823 [-0.6830; 1.0476]       4.6        4.2
14  0.9808 [-0.4178; 2.3795]       1.3        1.6
15  1.3122 [-1.0055; 3.6299]       0.4        0.6
16 -0.2595 [-1.4450; 0.9260]       3.1        2.3
17  0.1384 [-0.5076; 0.7844]       8.5        7.6

Number of studies combined: k = 17

                      logOR           95%-CI    z  p-value
Fixed effect model   0.4428 [0.2678; 0.6178] 4.96 &lt; 0.0001
Random effects model 0.4295 [0.2504; 0.6086] 4.70 &lt; 0.0001

Quantifying heterogeneity:
 tau^2 = 0.0017 [0.0000; 0.4589]; tau = 0.0410 [0.0000; 0.6774];
 I^2 = 1.1% [0.0%; 51.6%]; H = 1.01 [1.00; 1.44]

Test of heterogeneity:
     Q d.f. p-value
 16.18   16  0.4404

Details on meta-analytical method:
- Mantel-Haenszel method
- DerSimonian-Laird estimator for tau^2
- Jackson method for confidence interval of tau^2 and tau

&gt; res_mb_hk$TE.fixed
[1] 0.4428186730553189
&gt; res_mb_hk$seTE.fixed
[1] 0.08928560091027186
&gt; c(res_mb_hk$lower.fixed, res_mb_hk$upper.fixed)
[1] 0.2678221109331694 0.6178152351774684
</code></pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[42]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                   Estimate   LCB    UCB
-----------------------------------------
Pooled odds           1.557   1.307 1.855
Pooled log odds       0.443   0.268 0.618
Pooled risk ratio     1.270

                 Statistic P-value
-----------------------------------
Test of OR=1        24.724   0.000
Test constant OR    17.647   0.345

-----------------------
Number of tables   17
Min n              32
Max n             527
Avg n             139
Total n          2362
-----------------------
</pre></div></div>
</div>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      May 25, 2024
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="stats_rankcompare.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Rank comparison: two independent samples" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Rank comparison: two independent samples
            </div>
          </div>
        </a>
      
      
        
        <a href="mediation_survival.html" class="md-footer__link md-footer__link--next" aria-label="Next: Mediation analysis with duration data" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Mediation analysis with duration data
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2023, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>