


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>Statistics and inference for one and two sample Poisson rates - statsmodels 0.15.0 (+28)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.9dcb20399d0097661.min.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#One-sample-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+28)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+28)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+28)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Statistics and inference for one and two sample Poisson rates
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+28)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+28)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+28)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        <span title="/install.rst (reference label)" class="md-ellipsis">Installing statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        <span title="/gettingstarted.rst (reference label)" class="md-ellipsis">Getting started</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        <span title="/user-guide.rst (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html"><span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        <span title="/examples/index.rst#linear-regression-models (reference label)" class="md-ellipsis">Linear Regression Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        <span title="/examples/index.rst#plotting (reference label)" class="md-ellipsis">Plotting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        <span title="/examples/index.rst#discrete-choice-models (reference label)" class="md-ellipsis">Discrete Choice Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        <span title="/examples/index.rst#nonparametric-statistics (reference label)" class="md-ellipsis">Nonparametric Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        <span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        <span title="/examples/index.rst#robust-regression (reference label)" class="md-ellipsis">Robust Regression</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        <span title="/examples/index.rst#generalized-estimating-equations (reference label)" class="md-ellipsis">Generalized Estimating Equations</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" type="checkbox" id="__nav_4_8" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html#statistics"><span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span></a>
          
            <label for="__nav_4_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Statistics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_8">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="interactions_anova.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/interactions_anova.ipynb (reference label)" class="md-ellipsis">Interactions and ANOVA</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/examples/notebooks/generated/stats_poisson.ipynb (reference label)" class="md-ellipsis">Statistics and inference for one and two sample Poisson rates</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/examples/notebooks/generated/stats_poisson.ipynb (reference label)" class="md-ellipsis">Statistics and inference for one and two sample Poisson rates</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#One-sample-functions" class="md-nav__link">
    <span title="/examples/notebooks/generated/stats_poisson.ipynb#one-sample-functions (reference label)" class="md-ellipsis">One sample functions</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Two-sample-functions" class="md-nav__link">
    <span title="/examples/notebooks/generated/stats_poisson.ipynb#two-sample-functions (reference label)" class="md-ellipsis">Two sample functions</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Power" class="md-nav__link">
    <span title="/examples/notebooks/generated/stats_poisson.ipynb#power (reference label)" class="md-ellipsis">Power</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="stats_rankcompare.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/stats_rankcompare.ipynb (reference label)" class="md-ellipsis">Rank comparison:<wbr> two independent samples</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="metaanalysis1.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/metaanalysis1.ipynb (reference label)" class="md-ellipsis">Meta-<wbr>Analysis in statsmodels</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="mediation_survival.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/mediation_survival.ipynb (reference label)" class="md-ellipsis">Mediation analysis with duration data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb (reference label)" class="md-ellipsis">Treatment effects under conditional independence</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html#All-methods-in-TreatmentEffect" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb#all-methods-in-treatmenteffect (reference label)" class="md-ellipsis">All methods in Treatment<wbr>Effect</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html#Results-in-Stata" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb#results-in-stata (reference label)" class="md-ellipsis">Results in Stata</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="treatment_effect.html#Treatment-effect-on-the-treated" class="md-nav__link">
        <span title="/examples/notebooks/generated/treatment_effect.ipynb#treatment-effect-on-the-treated (reference label)" class="md-ellipsis">Treatment effect on the treated</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="copula.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/copula.ipynb (reference label)" class="md-ellipsis">Copula -<wbr> Multivariate joint distribution</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        <span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models-technical-notes (reference label)" class="md-ellipsis">State space models -<wbr> Technical notes</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        <span title="/examples/index.rst#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        <span title="/examples/index.rst#multivariate-methods (reference label)" class="md-ellipsis">Multivariate Methods</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#user-notes" class="md-nav__link">
        <span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API Reference</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        <span title="/about.rst (reference label)" class="md-ellipsis">About statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        <span title="/dev/index.rst (reference label)" class="md-ellipsis">Developer Page</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        <span title="/release/index.rst (reference label)" class="md-ellipsis">Release Notes</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#One-sample-functions" class="md-nav__link">
    <span title="/examples/notebooks/generated/stats_poisson.ipynb#one-sample-functions (reference label)" class="md-ellipsis">One sample functions</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Two-sample-functions" class="md-nav__link">
    <span title="/examples/notebooks/generated/stats_poisson.ipynb#two-sample-functions (reference label)" class="md-ellipsis">Two sample functions</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Power" class="md-nav__link">
    <span title="/examples/notebooks/generated/stats_poisson.ipynb#power (reference label)" class="md-ellipsis">Power</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="Statistics-and-inference-for-one-and-two-sample-Poisson-rates">Statistics and inference for one and two sample Poisson rates<a class="headerlink" href="#Statistics-and-inference-for-one-and-two-sample-Poisson-rates" title="Permalink to this heading">¶</a></h1>
<p>Author: Josef Perktold</p>
<p>This notebook provides a brief overview of hypothesis tests, confidence intervals and other statistics for Poisson rates in one and two sample case. See docstrings for more options and additional details.</p>
<p>All functions in <code class="docutils literal notranslate"><span class="pre">statsmodels.stats.rates</span></code> take summary statistics of the data as arguments. Those are counts of events and number of observations or total exposure. Some functions for Poisson have an option for excess dispersion. Functions for negative binomial, NB2, require the dispersion parameter. Excess dispersion and dispersion parameter need to be provided by the user and can be estimated from the original data with GLM-Poisson and discrete NegativeBinomial model, respectively.</p>
<p>Note, some parts are still experimental and will likely change, some features are still missing and will be added in future versions.</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#One-sample-functions"><span class="std std-ref">One sample functions</span></a></div>
<div class="line"><a class="reference internal" href="#Two-sample-functions"><span class="std std-ref">Two sample functions</span></a></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_allclose</span>
<span class="kn">import</span> <span class="nn">statsmodels.stats.rates</span> <span class="k">as</span> <span class="nn">smr</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.rates</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="c1"># functions for 1 sample</span>
    <span class="n">test_poisson</span><span class="p">,</span>
    <span class="n">confint_poisson</span><span class="p">,</span>
    <span class="n">tolerance_int_poisson</span><span class="p">,</span>
    <span class="n">confint_quantile_poisson</span><span class="p">,</span>

    <span class="c1"># functions for 2 sample</span>
    <span class="n">test_poisson_2indep</span><span class="p">,</span>
    <span class="n">etest_poisson_2indep</span><span class="p">,</span>
    <span class="n">confint_poisson_2indep</span><span class="p">,</span>
    <span class="n">tost_poisson_2indep</span><span class="p">,</span>
    <span class="n">nonequivalence_poisson_2indep</span><span class="p">,</span>

    <span class="c1"># power functions</span>
    <span class="n">power_poisson_ratio_2indep</span><span class="p">,</span>
    <span class="n">power_poisson_diff_2indep</span><span class="p">,</span>
    <span class="n">power_equivalence_poisson_2indep</span><span class="p">,</span>
    <span class="n">power_negbin_ratio_2indep</span><span class="p">,</span>
    <span class="n">power_equivalence_neginb_2indep</span><span class="p">,</span>

    <span class="c1"># list of statistical methods</span>
    <span class="n">method_names_poisson_1samp</span><span class="p">,</span>
    <span class="n">method_names_poisson_2indep</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="One-sample-functions">One sample functions<a class="headerlink" href="#One-sample-functions" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line">The main functions for one sample Poisson rates currently are test_poisson and confint_poisson. Both have several methods available, most of them are consistent between hypothesis test and confidence interval. Two additional functions are available for tolerance intervals and for confidence intervals of quantiles.</div>
<div class="line">See docstrings for details.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">514.775</span>
<span class="n">count1</span> <span class="o">/</span> <span class="n">n1</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.11655577679568745
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">test_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;midp-c&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = nan
pvalue = 0.23913820865664664
distribution = &#39;Poisson&#39;
method = &#39;midp-c&#39;
alternative = &#39;two-sided&#39;
rate = 0.11655577679568745
nobs = 514.775
tuple = (nan, 0.23913820865664664)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">confint_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;midp-c&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0897357524941493, 0.1490015282355224)
</pre></div></div>
</div>
<p>The available methods for hypothesis tests and confidence interval are available in the dictionary <code class="docutils literal notranslate"><span class="pre">method_names_poisson_1samp</span></code>. See docstring for details.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">method_names_poisson_1samp</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;test&#39;: [&#39;wald&#39;,
  &#39;score&#39;,
  &#39;exact-c&#39;,
  &#39;midp-c&#39;,
  &#39;waldccv&#39;,
  &#39;sqrt-a&#39;,
  &#39;sqrt-v&#39;,
  &#39;sqrt&#39;],
 &#39;confint&#39;: [&#39;wald&#39;,
  &#39;score&#39;,
  &#39;exact-c&#39;,
  &#39;midp-c&#39;,
  &#39;jeff&#39;,
  &#39;waldccv&#39;,
  &#39;sqrt-a&#39;,
  &#39;sqrt-v&#39;,
  &#39;sqrt&#39;,
  &#39;sqrt-cent&#39;,
  &#39;sqrt-centcc&#39;]}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">method_names_poisson_1samp</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]:</span>
    <span class="n">tst</span> <span class="o">=</span> <span class="n">test_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">meth</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                       <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-12s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">meth</span><span class="p">,</span> <span class="n">tst</span><span class="o">.</span><span class="n">pvalue</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
wald         0.2712232025335152
score        0.23489608509894766
exact-c      0.2654698417416039
midp-c       0.23913820865664664
waldccv      0.27321266612309003
sqrt-a       0.25489746088635834
sqrt-v       0.2281700763432699
sqrt         0.2533006997208508
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">method_names_poisson_1samp</span><span class="p">[</span><span class="s2">&quot;confint&quot;</span><span class="p">]:</span>
    <span class="n">tst</span> <span class="o">=</span> <span class="n">confint_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">meth</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-12s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">meth</span><span class="p">,</span> <span class="n">tst</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
wald         (0.08706363801159746, 0.14604791557977745)
score        (0.0905597500576385, 0.15001420714831387)
exact-c      (0.08894433674907924, 0.15003038882355074)
midp-c       (0.0897357524941493, 0.1490015282355224)
jeff         (0.08979284758964944, 0.14893677466593855)
waldccv      (0.08694100904696915, 0.14617054454440576)
sqrt-a       (0.08883721953786133, 0.14800553586080228)
sqrt-v       (0.08975547672311084, 0.14897854470462502)
sqrt         (0.08892923891524183, 0.14791351648342183)
sqrt-cent    (0.08883721953786133, 0.1480055358608023)
sqrt-centcc  (0.0879886777703761, 0.1490990831089978)
</pre></div></div>
</div>
<p>Two additional functions are currently available for one sample poisson rates, <code class="docutils literal notranslate"><span class="pre">tolerance_int_poisson</span></code> for tolerance intervals and <code class="docutils literal notranslate"><span class="pre">confint_quantile_poisson</span></code> for confidence intervals of Poisson quantiles.</p>
<p>Tolerance intervals are similar to prediction intervals that combine the randomness of a new observation and uncertainty about the estimated Poisson rate. If the rate were known, then we can compute a Poisson interval for a new observation using the inverse cdf at the given rate. The tolerance interval adds uncertainty about the rate by using the confidence interval for the rate estimate.</p>
<div class="line-block">
<div class="line">A tolerance interval is specified by two probabilities, <code class="docutils literal notranslate"><span class="pre">prob</span></code> is the coverage of the Poisson interval, <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is the confidence level for the confidence interval of the rate estimate.</div>
<div class="line">Note, that probabilities cannot be exactly equal to the nominal probabilites because counts are discrete random variables. The properties of the intervals are specified in term of inequalities, coverage is at least <code class="docutils literal notranslate"><span class="pre">prob</span></code>, coverage of the confidence interval of the estimated rate is at least <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">alpha</span></code>. However, most methods will not guarantee that the coverage inequalities hold in small samples even if the distribution is correctly specified.</div>
</div>
<p>In the following example, we can expect to observe between 4 and 23 events if the total exposure or number of observations is 100, at given coverage <code class="docutils literal notranslate"><span class="pre">prob</span></code> and confidence level <code class="docutils literal notranslate"><span class="pre">alpha</span></code>. The tolerance interval is larger than the Poisson interval at the observed rate, (5, 19), because the tolerance interval takes uncertainty about the parameter estimate into account.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">exposure_new</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">tolerance_int_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">exposure_new</span><span class="o">=</span><span class="n">exposure_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4.0, 23.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">stats</span><span class="o">.</span><span class="n">poisson</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">count1</span> <span class="o">/</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">exposure_new</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5.0, 19.0)
</pre></div></div>
</div>
<p>Aside: We can force the tolerance interval to ignore parameter uncertainty by specifying <code class="docutils literal notranslate"><span class="pre">alpha=1</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">tolerance_int_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">exposure_new</span><span class="o">=</span><span class="n">exposure_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5.0, 19.0)
</pre></div></div>
</div>
<p>The last function returns a confidence interval for a Poisson quantile. A quantile is the inverse of the cdf function, named <code class="docutils literal notranslate"><span class="pre">ppf</span></code> in scipy.stats distributions.</p>
<p>The following example shows the confidence interval for the upper bound of the Poisson interval at cdf probability 0.975. The upper confidence limit using the one-tail coverage probability is the same as the upper limit of the tolerance interval.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">confint_quantile_poisson</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">exposure_new</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(15.0, 23.0)
</pre></div></div>
</div>
<h2 id="Two-sample-functions">Two sample functions<a class="headerlink" href="#Two-sample-functions" title="Permalink to this heading">¶</a></h2>
<p>Statistical function for two samples can compare the rates by either the ratio or the difference. Default is comparing the rates ratio.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">etest</span></code> functions can be directly accessed through <code class="docutils literal notranslate"><span class="pre">test_poisson_2indep</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">514.775</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">543.087</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">test_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;etest-score&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = 3.4174018390002145
pvalue = 0.0005672617581628009
distribution = &#39;poisson&#39;
compare = &#39;ratio&#39;
method = &#39;etest-score&#39;
alternative = &#39;two-sided&#39;
rates = (0.11655577679568745, 0.055239768213932575)
ratio = 2.10999757175465
diff = 0.06131600858175487
value = 1
rates_cmle = None
ratio_null = 1
tuple = (3.4174018390002145, 0.0005672617581628009)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">confint_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
                       <span class="n">compare</span><span class="o">=</span><span class="s2">&quot;ratio&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.3659624311981189, 3.2593061483872257)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">confint_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
                       <span class="n">compare</span><span class="o">=</span><span class="s2">&quot;diff&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.026579645509259224, 0.0989192191413259)
</pre></div></div>
</div>
<p>The two sample test function, <code class="docutils literal notranslate"><span class="pre">test_poisson_2indep</span></code>, has a <code class="docutils literal notranslate"><span class="pre">value</span></code> option to specify null hypothesis that do not specify equality. This is useful for superiority and noninferiority testing with one-sided alternatives.</p>
<p>As an example, the following test tests the two-sided null hypothesis that the rates ratio is 2. The pvalue for this hypothesis is 0.81 and we cannot reject that the first rate is twice the second rate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">test_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;etest-score&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = 0.23946504079843253
pvalue = 0.813504857205675
distribution = &#39;poisson&#39;
compare = &#39;ratio&#39;
method = &#39;etest-score&#39;
alternative = &#39;two-sided&#39;
rates = (0.11655577679568745, 0.055239768213932575)
ratio = 2.10999757175465
diff = 0.06131600858175487
value = 2
rates_cmle = None
ratio_null = 2
tuple = (0.23946504079843253, 0.813504857205675)
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">method_names_poisson_2indep</span></code> dictionary shows which methods are available when comparing two samples by either rates ratio or rates difference.</p>
<p>We can use the dictionary to compute p-values and confidence intervals using all available methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">method_names_poisson_2indep</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;test&#39;: {&#39;ratio&#39;: [&#39;wald&#39;,
   &#39;score&#39;,
   &#39;score-log&#39;,
   &#39;wald-log&#39;,
   &#39;exact-cond&#39;,
   &#39;cond-midp&#39;,
   &#39;sqrt&#39;,
   &#39;etest-score&#39;,
   &#39;etest-wald&#39;],
  &#39;diff&#39;: [&#39;wald&#39;, &#39;score&#39;, &#39;waldccv&#39;, &#39;etest-score&#39;, &#39;etest-wald&#39;]},
 &#39;confint&#39;: {&#39;ratio&#39;: [&#39;waldcc&#39;,
   &#39;score&#39;,
   &#39;score-log&#39;,
   &#39;wald-log&#39;,
   &#39;sqrtcc&#39;,
   &#39;mover&#39;],
  &#39;diff&#39;: [&#39;wald&#39;, &#39;score&#39;, &#39;waldccv&#39;, &#39;mover&#39;]}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">compare</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ratio&quot;</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">method_names_poisson_2indep</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">][</span><span class="n">compare</span><span class="p">]:</span>
        <span class="n">tst</span> <span class="o">=</span> <span class="n">test_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">method</span><span class="o">=</span><span class="n">meth</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="n">compare</span><span class="p">,</span>
                                  <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   </span><span class="si">%-12s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">meth</span><span class="p">,</span> <span class="n">tst</span><span class="o">.</span><span class="n">pvalue</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ratio
   wald         0.0007120093285061108
   score        0.0006322188820470972
   score-log    0.0003992519661848979
   wald-log     0.0008399438093390379
   exact-cond   0.0006751826586863219
   cond-midp    0.0005572624066190538
   sqrt         0.0005700355621795108
   etest-score  0.0005672617581628009
   etest-wald   0.0006431446124897875
diff
   wald         0.0007120093285061094
   score        0.0006322188820470944
   waldccv      0.0007610462660136599
   etest-score  0.000567261758162795
   etest-wald   0.0006431446124897808
</pre></div></div>
</div>
<p>In a similar way we can compute confidence intervals for the rate ratio and rate difference for all currently available methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">compare</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ratio&quot;</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">method_names_poisson_2indep</span><span class="p">[</span><span class="s2">&quot;confint&quot;</span><span class="p">][</span><span class="n">compare</span><span class="p">]:</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="n">confint_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span>
                                  <span class="n">method</span><span class="o">=</span><span class="n">meth</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="n">compare</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   </span><span class="si">%-12s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">meth</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ratio
   waldcc       (1.354190544703406, 3.233964238781885)
   score        (1.3659624311981189, 3.2593061483872257)
   score-log    (1.3903411228996467, 3.4348249508085043)
   wald-log     (1.3612801263025065, 3.2705169691290763)
   sqrtcc       (1.29635711135392, 3.132234781692197)
   mover        (1.3614682485833316, 3.258622814678696)
diff
   wald         (0.02581223514639487, 0.09681978201711487)
   score        (0.026579645509259224, 0.0989192191413259)
   waldccv      (0.025618973109117968, 0.09701304405439178)
   mover        (0.026193641039269785, 0.09864127183950336)
</pre></div></div>
</div>
<p>We have two additional functions for hypothesis tests that specify interval hypothesis, <code class="docutils literal notranslate"><span class="pre">tost_poisson_2indep</span></code> and <code class="docutils literal notranslate"><span class="pre">nonequivalence_poisson_2indep</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TOST</span></code> function implements equivalence tests where the alternative hypothesis specifies that the two rates are within an interval of each other.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">nonequivalence</span></code> tests implements a test where the alternative specifies that the two rates differ by at least a given nonzero value. This is also often called a minimum effect test. This test uses two one-sided tests similar to TOST however with null and alternative hypothesis reversed compared to the equivalence test.</p>
<p>Both functions delegate to <code class="docutils literal notranslate"><span class="pre">test_poisson_2indep</span></code> and, therefore, the same <code class="docutils literal notranslate"><span class="pre">method</span></code> options are available.</p>
<p>The following equivalence test specifies the alternative hypothesis that the rate ratio is between 0.8 and 1/0.8. The observed rate ratio is 0.89. The pvalue is 0.107 and we cannot reject the null hypothesis in favor of the alternative hypothesis that the two rates are equivalent at the given margins. Thus the hypothesis test does not provide evidence that the two rates are equivalent.</p>
<p>In the second example we test equivalence in the rate difference, where equivalence is defined by margins (-0.04, 0.04). The pvalue is around 0.2 and the test does not support that the two rates are equivalent.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><code><span class="n">low</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">upp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">low</span>

<span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">2000</span>

<span class="n">tost_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">upp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = 1.2403473458920846
pvalue = 0.10742347370282446
method = &#39;score&#39;
compare = &#39;ratio&#39;
equiv_limits = (0.8, 1.25)
results_larger = &lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
    statistic = 1.2403473458920846
    pvalue = 0.10742347370282446
    distribution = &#39;normal&#39;
    compare = &#39;ratio&#39;
    method = &#39;score&#39;
    alternative = &#39;larger&#39;
    rates = (0.2, 0.225)
    ratio = 0.888888888888889
    diff = -0.024999999999999994
    value = 0.8
    rates_cmle = None
    ratio_null = 0.8
    tuple = (1.2403473458920846, 0.10742347370282446)
results_smaller = &lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
    statistic = -4.0311288741492755
    pvalue = 2.7754797240370253e-05
    distribution = &#39;normal&#39;
    compare = &#39;ratio&#39;
    method = &#39;score&#39;
    alternative = &#39;smaller&#39;
    rates = (0.2, 0.225)
    ratio = 0.888888888888889
    diff = -0.024999999999999994
    value = 1.25
    rates_cmle = None
    ratio_null = 1.25
    tuple = (-4.0311288741492755, 2.7754797240370253e-05)
title = &#39;Equivalence test for 2 independent Poisson rates&#39;
tuple = (1.2403473458920846, 0.10742347370282446)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">upp</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="n">upp</span>
<span class="n">tost_poisson_2indep</span><span class="p">(</span><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">upp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="s1">&#39;diff&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = 0.8575203124598336
pvalue = 0.19557869693808477
method = &#39;score&#39;
compare = &#39;diff&#39;
equiv_limits = (-0.04, 0.04)
results_larger = &lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
    statistic = 0.8575203124598336
    pvalue = 0.19557869693808477
    distribution = &#39;normal&#39;
    compare = &#39;diff&#39;
    method = &#39;score&#39;
    alternative = &#39;larger&#39;
    rates = (0.2, 0.225)
    ratio = 0.888888888888889
    diff = -0.024999999999999994
    value = -0.04
    rates_cmle = (0.19065363652113884, 0.23065363652113885)
    ratio_null = None
    tuple = (0.8575203124598336, 0.19557869693808477)
results_smaller = &lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
    statistic = -3.4807277010355238
    pvalue = 0.00025002679047994814
    distribution = &#39;normal&#39;
    compare = &#39;diff&#39;
    method = &#39;score&#39;
    alternative = &#39;smaller&#39;
    rates = (0.2, 0.225)
    ratio = 0.888888888888889
    diff = -0.024999999999999994
    value = 0.04
    rates_cmle = (0.24581855699051405, 0.20581855699051405)
    ratio_null = None
    tuple = (-3.4807277010355238, 0.00025002679047994814)
title = &#39;Equivalence test for 2 independent Poisson rates&#39;
tuple = (0.8575203124598336, 0.19557869693808477)
</pre></div></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">nonequivalence_poisson_2indep</span></code> tests the alternative hypothesis that the two rates differ by a non-neglibile amount.</p>
<p>In the following example, the alternative hypothesis specifies that the rate ratio is outside the interval (0.95, 1/0.95). The null hypothesis is that the ratio ratio is in the interval. If the test rejects the null hypothesis, then it provides evidence that the rate ratio differ by more than the unimportant amount specified by the interval limits.</p>
<p>A note on the relationship between point hypothesis test and interval hypothesis test in large samples. The point null hypothesis of test_poisson_2indep will reject any small deviation from the null hypothesis if the null hypothesis does not hold exactly and the sample size is large enough. The nonequivalence or minimum effect test will not reject the null hypothesis in large samples (sample approaches infinite) if rates differ by not more than the specified neglibible amount.</p>
<p>In the example neither the point nor the interval null hypothesis are rejected. We do not have enough evidence to say that the rates are statistically different. Following that, we increase the sample size 20 times while keeping observed rates constant. In this case, the point null hypothesis test is rejected, the pvalue is 0.01, while the interval null hypothesis is not rejected, the pvalue is equal to 1.</p>
<p>Note: The nonequivalence test is in general conservative, its size is bounded by alpha, but in the large sample limit with fixed nonequivalence margins the size approaches alpha / 2. If the nonequivalence interval shrinks to a single point, then the nonequivalence test is the same as the point hypothesis test. (see docstring)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">count1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">count2</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">2000</span>
<span class="n">low</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">upp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">low</span>
<span class="n">nf</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">nonequivalence_poisson_2indep</span><span class="p">(</span><span class="n">count1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">count2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">upp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = -1.1654330934961301
pvalue = 1.0232437381644721
method = &#39;score&#39;
results_larger = &lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
    statistic = 0.02913582733740325
    pvalue = 0.5116218690822361
    distribution = &#39;normal&#39;
    compare = &#39;ratio&#39;
    method = &#39;score&#39;
    alternative = &#39;smaller&#39;
    rates = (0.2, 0.21)
    ratio = 0.9523809523809524
    diff = -0.009999999999999981
    value = 0.95
    rates_cmle = None
    ratio_null = 0.95
    tuple = (0.02913582733740325, 0.5116218690822361)
results_smaller = &lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
    statistic = -1.1654330934961301
    pvalue = 0.8780781359377093
    distribution = &#39;normal&#39;
    compare = &#39;ratio&#39;
    method = &#39;score&#39;
    alternative = &#39;larger&#39;
    rates = (0.2, 0.21)
    ratio = 0.9523809523809524
    diff = -0.009999999999999981
    value = 1.0526315789473684
    rates_cmle = None
    ratio_null = 1.0526315789473684
    tuple = (-1.1654330934961301, 0.8780781359377093)
title = &#39;Equivalence test for 2 independent Poisson rates&#39;
tuple = (-1.1654330934961301, 1.0232437381644721)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">test_poisson_2indep</span><span class="p">(</span><span class="n">count1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">count2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;statsmodels.stats.base.HolderTuple&#39;&gt;
statistic = -0.5679618342470648
pvalue = 0.5700608835629815
distribution = &#39;normal&#39;
compare = &#39;ratio&#39;
method = &#39;score&#39;
alternative = &#39;two-sided&#39;
rates = (0.2, 0.21)
ratio = 0.9523809523809524
diff = -0.009999999999999981
value = 1
rates_cmle = None
ratio_null = 1
tuple = (-0.5679618342470648, 0.5700608835629815)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">nf</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">nonequivalence_poisson_2indep</span><span class="p">(</span><span class="n">count1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">count2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">upp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.1036704302254083
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">test_poisson_2indep</span><span class="p">(</span><span class="n">count1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">count2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n2</span> <span class="o">*</span> <span class="n">nf</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.01108516638060269
</pre></div></div>
</div>
<h2 id="Power">Power<a class="headerlink" href="#Power" title="Permalink to this heading">¶</a></h2>
<p>Statsmodels has limited support for computing statistical power for the comparison of 2 sample Poisson and Negative Binomial rates. Those are based on Zhu and Lakkis and Zhu for ratio comparisons for both distributions, and basic normal based comparison for the Poisson rate difference. Other methods that correspond more closely to the available methods in the hypothesis test function, especially Gu, are not yet available.</p>
<p>The available functions are</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">power_poisson_ratio_2indep</span>
<span class="n">power_equivalence_poisson_2indep</span>
<span class="n">power_negbin_ratio_2indep</span>
<span class="n">power_equivalence_neginb_2indep</span>

<span class="n">power_poisson_diff_2indep</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;function statsmodels.stats.rates.power_poisson_diff_2indep(rate1, rate2, nobs1, nobs_ratio=1, alpha=0.05, value=0, method_var=&#39;score&#39;, alternative=&#39;two-sided&#39;, return_results=True)&gt;
</pre></div></div>
</div>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      Jun 29, 2023
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="interactions_anova.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Interactions and ANOVA" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Interactions and ANOVA
            </div>
          </div>
        </a>
      
      
        
        <a href="stats_rankcompare.html" class="md-footer__link md-footer__link--next" aria-label="Next: Rank comparison: two independent samples" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Rank comparison: two independent samples
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2023, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.0.1.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.1b5b7a2d5891aec19.min.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js"></script>
    
  </body>
</html>