


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../_static/favicon.ico">
    
    
  
      
        <title>Forecasting in statsmodels - statsmodels 0.15.0 (+331)</title>
      
    
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    
      
        
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_immaterial_theme.3625f807144f53acf.min.css?v=fbfc4466" />
        <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
        <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
        <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Basic-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+331)" class="md-header__button md-logo" aria-label="statsmodels 0.15.0 (+331)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            statsmodels 0.15.0 (+331)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Forecasting in statsmodels
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="statsmodels 0.15.0 (+331)" class="md-nav__button md-logo" aria-label="statsmodels 0.15.0 (+331)" data-md-component="logo">
      <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt="logo">
    </a>
    statsmodels 0.15.0 (+331)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install.html" class="md-nav__link">
        <span title="/install.rst (reference label)" class="md-ellipsis">Installing statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gettingstarted.html" class="md-nav__link">
        <span title="/gettingstarted.rst (reference label)" class="md-ellipsis">Getting started</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide.html" class="md-nav__link">
        <span title="/user-guide.rst (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html"><span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst (reference label)" class="md-ellipsis">Examples</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#linear-regression-models" class="md-nav__link">
        <span title="/examples/index.rst#linear-regression-models (reference label)" class="md-ellipsis">Linear Regression Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#plotting" class="md-nav__link">
        <span title="/examples/index.rst#plotting (reference label)" class="md-ellipsis">Plotting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">
        <span title="/examples/index.rst#discrete-choice-models (reference label)" class="md-ellipsis">Discrete Choice Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">
        <span title="/examples/index.rst#nonparametric-statistics (reference label)" class="md-ellipsis">Nonparametric Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">
        <span title="/examples/index.rst#generalized-linear-models (reference label)" class="md-ellipsis">Generalized Linear Models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#robust-regression" class="md-nav__link">
        <span title="/examples/index.rst#robust-regression (reference label)" class="md-ellipsis">Robust Regression</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">
        <span title="/examples/index.rst#generalized-estimating-equations (reference label)" class="md-ellipsis">Generalized Estimating Equations</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#statistics" class="md-nav__link">
        <span title="/examples/index.rst#statistics (reference label)" class="md-ellipsis">Statistics</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#time-series-analysis" class="md-nav__link">
        <span title="/examples/index.rst#time-series-analysis (reference label)" class="md-ellipsis">Time Series Analysis</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models (reference label)" class="md-ellipsis">State space models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">
        <span title="/examples/index.rst#state-space-models-technical-notes (reference label)" class="md-ellipsis">State space models -<wbr> Technical notes</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#forecasting" class="md-nav__link">
        <span title="/examples/index.rst#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html#multivariate-methods" class="md-nav__link">
        <span title="/examples/index.rst#multivariate-methods (reference label)" class="md-ellipsis">Multivariate Methods</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_14" type="checkbox" id="__nav_4_14" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../index.html#user-notes"><span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span></a>
          
            <label for="__nav_4_14">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="User Notes" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_14">
          <span class="md-nav__icon md-icon"></span>
          <span title="/examples/index.rst#user-notes (reference label)" class="md-ellipsis">User Notes</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="contrasts.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/contrasts.ipynb (reference label)" class="md-ellipsis">Contrasts Overview</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="formulas.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/formulas.ipynb (reference label)" class="md-ellipsis">Formulas:<wbr> Fitting models using R-<wbr>style formulas</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="predict.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/predict.ipynb (reference label)" class="md-ellipsis">Prediction <wbr>(out of sample)</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/examples/notebooks/generated/statespace_forecasting.ipynb (reference label)" class="md-ellipsis">Forecasting in statsmodels</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/examples/notebooks/generated/statespace_forecasting.ipynb (reference label)" class="md-ellipsis">Forecasting in statsmodels</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Basic-example" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#basic-example (reference label)" class="md-ellipsis">Basic example</span>
  </a>
  
    <nav class="md-nav" aria-label="Basic example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Constructing-and-estimating-the-model" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#constructing-and-estimating-the-model (reference label)" class="md-ellipsis">Constructing and estimating the model</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Forecasting" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Specifying-the-number-of-forecasts" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#specifying-the-number-of-forecasts (reference label)" class="md-ellipsis">Specifying the number of forecasts</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Plotting-the-data,-forecasts,-and-confidence-intervals" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#plotting-the-data,-forecasts,-and-confidence-intervals (reference label)" class="md-ellipsis">Plotting the data, forecasts, and confidence intervals</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Note-on-what-to-expect-from-forecasts" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#note-on-what-to-expect-from-forecasts (reference label)" class="md-ellipsis">Note on what to expect from forecasts</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Prediction-vs-Forecasting" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#prediction-vs-forecasting (reference label)" class="md-ellipsis">Prediction vs Forecasting</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Cross-validation" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#cross-validation (reference label)" class="md-ellipsis">Cross validation</span>
  </a>
  
    <nav class="md-nav" aria-label="Cross validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Example" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#example (reference label)" class="md-ellipsis">Example</span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Using-extend" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#using-extend (reference label)" class="md-ellipsis">Using extend</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Indexes" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#indexes (reference label)" class="md-ellipsis">Indexes</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="generic_mle.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/generic_mle.ipynb (reference label)" class="md-ellipsis">Maximum Likelihood Estimation <wbr>(Generic models)</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="tsa_dates.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/tsa_dates.ipynb (reference label)" class="md-ellipsis">Dates in timeseries models</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="chi2_fitting.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/chi2_fitting.ipynb (reference label)" class="md-ellipsis">Least squares fitting of models to data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="distributed_estimation.html" class="md-nav__link">
        <span title="/examples/notebooks/generated/distributed_estimation.ipynb (reference label)" class="md-ellipsis">Distributed Estimation</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API Reference</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about.html" class="md-nav__link">
        <span title="/about.rst (reference label)" class="md-ellipsis">About statsmodels</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/index.html" class="md-nav__link">
        <span title="/dev/index.rst (reference label)" class="md-ellipsis">Developer Page</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/index.html" class="md-nav__link">
        <span title="/release/index.rst (reference label)" class="md-ellipsis">Release Notes</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Basic-example" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#basic-example (reference label)" class="md-ellipsis">Basic example</span>
  </a>
  
    <nav class="md-nav" aria-label="Basic example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Constructing-and-estimating-the-model" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#constructing-and-estimating-the-model (reference label)" class="md-ellipsis">Constructing and estimating the model</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Forecasting" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#forecasting (reference label)" class="md-ellipsis">Forecasting</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Specifying-the-number-of-forecasts" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#specifying-the-number-of-forecasts (reference label)" class="md-ellipsis">Specifying the number of forecasts</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Plotting-the-data,-forecasts,-and-confidence-intervals" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#plotting-the-data,-forecasts,-and-confidence-intervals (reference label)" class="md-ellipsis">Plotting the data, forecasts, and confidence intervals</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Note-on-what-to-expect-from-forecasts" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#note-on-what-to-expect-from-forecasts (reference label)" class="md-ellipsis">Note on what to expect from forecasts</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Prediction-vs-Forecasting" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#prediction-vs-forecasting (reference label)" class="md-ellipsis">Prediction vs Forecasting</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Cross-validation" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#cross-validation (reference label)" class="md-ellipsis">Cross validation</span>
  </a>
  
    <nav class="md-nav" aria-label="Cross validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Example" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#example (reference label)" class="md-ellipsis">Example</span>
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Using-extend" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#using-extend (reference label)" class="md-ellipsis">Using extend</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Indexes" class="md-nav__link">
    <span title="/examples/notebooks/generated/statespace_forecasting.ipynb#indexes (reference label)" class="md-ellipsis">Indexes</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="Forecasting-in-statsmodels">Forecasting in statsmodels<a class="headerlink" href="#Forecasting-in-statsmodels" title="Link to this heading">¶</a></h1>
<p>This notebook describes forecasting using time series models in statsmodels.</p>
<p><strong>Note</strong>: this notebook applies only to the state space model classes, which are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sm.tsa.SARIMAX</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sm.tsa.UnobservedComponents</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sm.tsa.VARMAX</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sm.tsa.DynamicFactor</span></code></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">macrodata</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">macrodata</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="n">macrodata</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;1959Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;2009Q3&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Basic-example">Basic example<a class="headerlink" href="#Basic-example" title="Link to this heading">¶</a></h2>
<p>A simple example is to use an AR(1) model to forecast inflation. Before forecasting, let’s take a look at the series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">endog</span> <span class="o">=</span> <span class="n">macrodata</span><span class="p">[</span><span class="s1">&#39;infl&#39;</span><span class="p">]</span>
<span class="n">endog</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_forecasting_3_1.png" src="../../../_images/examples_notebooks_generated_statespace_forecasting_3_1.png" />
</div>
</div>
<h3 id="Constructing-and-estimating-the-model">Constructing and estimating the model<a class="headerlink" href="#Constructing-and-estimating-the-model" title="Link to this heading">¶</a></h3>
<p>The next step is to formulate the econometric model that we want to use for forecasting. In this case, we will use an AR(1) model via the <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> class in statsmodels.</p>
<p>After constructing the model, we need to estimate its parameters. This is done using the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method. The <code class="docutils literal notranslate"><span class="pre">summary</span></code> method produces several convenient tables showing the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Construct the model</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="c1"># Estimate the parameters</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.32873D+00    |proj g|=  8.23649D-03

At iterate    5    f=  2.32864D+00    |proj g|=  1.41994D-03

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      8     10      1     0     0   5.820D-06   2.329D+00
  F =   2.3286389358138617

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
                               SARIMAX Results
==============================================================================
Dep. Variable:                   infl   No. Observations:                  203
Model:               SARIMAX(1, 0, 0)   Log Likelihood                -472.714
Date:                Thu, 15 Aug 2024   AIC                            951.427
Time:                        20:24:59   BIC                            961.367
Sample:                    03-31-1959   HQIC                           955.449
                         - 09-30-2009
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
intercept      1.3962      0.254      5.488      0.000       0.898       1.895
ar.L1          0.6441      0.039     16.482      0.000       0.568       0.721
sigma2         6.1519      0.397     15.487      0.000       5.373       6.930
===================================================================================
Ljung-Box (L1) (Q):                   8.43   Jarque-Bera (JB):                68.45
Prob(Q):                              0.00   Prob(JB):                         0.00
Heteroskedasticity (H):               1.47   Skew:                            -0.22
Prob(H) (two-sided):                  0.12   Kurtosis:                         5.81
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<h3 id="Forecasting">Forecasting<a class="headerlink" href="#Forecasting" title="Link to this heading">¶</a></h3>
<p>Out-of-sample forecasts are produced using the <code class="docutils literal notranslate"><span class="pre">forecast</span></code> or <code class="docutils literal notranslate"><span class="pre">get_forecast</span></code> methods from the results object.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">forecast</span></code> method gives only point forecasts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># The default is to get a one-step-ahead forecast:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2009Q4    3.68921
Freq: Q-DEC, dtype: float64
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">get_forecast</span></code> method is more general, and also allows constructing confidence intervals.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Here we construct a more complete results object.</span>
<span class="n">fcast_res1</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">()</span>

<span class="c1"># Most results are collected in the `summary_frame` attribute.</span>
<span class="c1"># Here we specify that we want a confidence level of 90%</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fcast_res1</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.10</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
infl       mean   mean_se  mean_ci_lower  mean_ci_upper
2009Q4  3.68921  2.480302      -0.390523       7.768943
</pre></div></div>
</div>
<p>The default confidence level is 95%, but this can be controlled by setting the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> parameter, where the confidence level is defined as <span class="math notranslate nohighlight">\((1 - \alpha) \times 100\%\)</span>. In the example above, we specified a confidence level of 90%, using <code class="docutils literal notranslate"><span class="pre">alpha=0.10</span></code>.</p>
<h3 id="Specifying-the-number-of-forecasts">Specifying the number of forecasts<a class="headerlink" href="#Specifying-the-number-of-forecasts" title="Link to this heading">¶</a></h3>
<p>Both of the functions <code class="docutils literal notranslate"><span class="pre">forecast</span></code> and <code class="docutils literal notranslate"><span class="pre">get_forecast</span></code> accept a single argument indicating how many forecasting steps are desired. One option for this argument is always to provide an integer describing the number of steps ahead you want.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2009Q4    3.689210
2010Q1    3.772434
Freq: Q-DEC, Name: predicted_mean, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fcast_res2</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Note: since we did not specify the alpha parameter, the</span>
<span class="c1"># confidence level is at the default, 95%</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fcast_res2</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
infl        mean   mean_se  mean_ci_lower  mean_ci_upper
2009Q4  3.689210  2.480302      -1.172092       8.550512
2010Q1  3.772434  2.950274      -2.009996       9.554865
</pre></div></div>
</div>
<p>However, <strong>if your data included a Pandas index with a defined frequency</strong> (see the section at the end on Indexes for more information), then you can alternatively specify the date through which you want forecasts to be produced:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="s1">&#39;2010Q2&#39;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2009Q4    3.689210
2010Q1    3.772434
2010Q2    3.826039
Freq: Q-DEC, Name: predicted_mean, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fcast_res3</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="s1">&#39;2010Q2&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fcast_res3</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
infl        mean   mean_se  mean_ci_lower  mean_ci_upper
2009Q4  3.689210  2.480302      -1.172092       8.550512
2010Q1  3.772434  2.950274      -2.009996       9.554865
2010Q2  3.826039  3.124571      -2.298008       9.950087
</pre></div></div>
</div>
<h3 id="Plotting-the-data,-forecasts,-and-confidence-intervals">Plotting the data, forecasts, and confidence intervals<a class="headerlink" href="#Plotting-the-data,-forecasts,-and-confidence-intervals" title="Link to this heading">¶</a></h3>
<p>Often it is useful to plot the data, the forecasts, and the confidence intervals. There are many ways to do this, but here’s one example</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Plot the data (here we are subsetting it to get a better look at the forecasts)</span>
<span class="n">endog</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1999&#39;</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Construct the forecasts</span>
<span class="n">fcast</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="s1">&#39;2011Q4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">()</span>
<span class="n">fcast</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">fcast</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fcast</span><span class="p">[</span><span class="s1">&#39;mean_ci_lower&#39;</span><span class="p">],</span> <span class="n">fcast</span><span class="p">[</span><span class="s1">&#39;mean_ci_upper&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_forecasting_20_0.png" src="../../../_images/examples_notebooks_generated_statespace_forecasting_20_0.png" />
</div>
</div>
<h3 id="Note-on-what-to-expect-from-forecasts">Note on what to expect from forecasts<a class="headerlink" href="#Note-on-what-to-expect-from-forecasts" title="Link to this heading">¶</a></h3>
<p>The forecast above may not look very impressive, as it is almost a straight line. This is because this is a very simple, univariate forecasting model. Nonetheless, keep in mind that these simple forecasting models can be extremely competitive.</p>
<h2 id="Prediction-vs-Forecasting">Prediction vs Forecasting<a class="headerlink" href="#Prediction-vs-Forecasting" title="Link to this heading">¶</a></h2>
<p>The results objects also contain two methods that all for both in-sample fitted values and out-of-sample forecasting. They are <code class="docutils literal notranslate"><span class="pre">predict</span></code> and <code class="docutils literal notranslate"><span class="pre">get_prediction</span></code>. The <code class="docutils literal notranslate"><span class="pre">predict</span></code> method only returns point predictions (similar to <code class="docutils literal notranslate"><span class="pre">forecast</span></code>), while the <code class="docutils literal notranslate"><span class="pre">get_prediction</span></code> method also returns additional results (similar to <code class="docutils literal notranslate"><span class="pre">get_forecast</span></code>).</p>
<p>In general, if your interest is out-of-sample forecasting, it is easier to stick to the <code class="docutils literal notranslate"><span class="pre">forecast</span></code> and <code class="docutils literal notranslate"><span class="pre">get_forecast</span></code> methods.</p>
<h2 id="Cross-validation">Cross validation<a class="headerlink" href="#Cross-validation" title="Link to this heading">¶</a></h2>
<p><strong>Note</strong>: some of the functions used in this section were first introduced in statsmodels v0.11.0.</p>
<p>A common use case is to cross-validate forecasting methods by performing h-step-ahead forecasts recursively using the following process:</p>
<ol class="arabic simple">
<li><p>Fit model parameters on a training sample</p></li>
<li><p>Produce h-step-ahead forecasts from the end of that sample</p></li>
<li><p>Compare forecasts against test dataset to compute error rate</p></li>
<li><p>Expand the sample to include the next observation, and repeat</p></li>
</ol>
<p>Economists sometimes call this a pseudo-out-of-sample forecast evaluation exercise, or time-series cross-validation.</p>
<h3 id="Example">Example<a class="headerlink" href="#Example" title="Link to this heading">¶</a></h3>
<p>We will conduct a very simple exercise of this sort using the inflation dataset above. The full dataset contains 203 observations, and for expositional purposes we’ll use the first 80% as our training sample and only consider one-step-ahead forecasts.</p>
<p>A single iteration of the above procedure looks like the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Step 1: fit model parameters w/ training sample</span>
<span class="n">training_obs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">endog</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">training_endog</span> <span class="o">=</span> <span class="n">endog</span><span class="p">[:</span><span class="n">training_obs</span><span class="p">]</span>
<span class="n">training_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span>
    <span class="n">training_endog</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">training_res</span> <span class="o">=</span> <span class="n">training_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Print the estimated parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="n">training_res</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.23132D+00    |proj g|=  1.09171D-02

At iterate    5    f=  2.23109D+00    |proj g|=  3.93608D-05

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      6      8      1     0     0   7.066D-07   2.231D+00
  F =   2.2310884444664758

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
intercept    1.162076
ar.L1        0.724242
sigma2       5.051600
dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Step 2: produce one-step-ahead forecasts</span>
<span class="n">fcast</span> <span class="o">=</span> <span class="n">training_res</span><span class="o">.</span><span class="n">forecast</span><span class="p">()</span>

<span class="c1"># Step 3: compute root mean square forecasting error</span>
<span class="n">true</span> <span class="o">=</span> <span class="n">endog</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">fcast</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">true</span> <span class="o">-</span> <span class="n">fcast</span>

<span class="c1"># Print out the results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">true</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">),</span>
                 <span class="n">fcast</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;forecast&#39;</span><span class="p">),</span>
                 <span class="n">error</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        true  forecast    error
1999Q3  3.35   2.55262  0.79738
</pre></div></div>
</div>
<p>To add on another observation, we can use the <code class="docutils literal notranslate"><span class="pre">append</span></code> or <code class="docutils literal notranslate"><span class="pre">extend</span></code> results methods. Either method can produce the same forecasts, but they differ in the other results that are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">append</span></code> is the more complete method. It always stores results for all training observations, and it optionally allows refitting the model parameters given the new observations (note that the default is <em>not</em> to refit the parameters).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extend</span></code> is a faster method that may be useful if the training sample is very large. It <em>only</em> stores results for the new observations, and it does not allow refitting the model parameters (i.e. you have to use the parameters estimated on the previous sample).</p></li>
</ul>
<p>If your training sample is relatively small (less than a few thousand observations, for example) or if you want to compute the best possible forecasts, then you should use the <code class="docutils literal notranslate"><span class="pre">append</span></code> method. However, if that method is infeasible (for example, because you have a very large training sample) or if you are okay with slightly suboptimal forecasts (because the parameter estimates will be slightly stale), then you can consider the <code class="docutils literal notranslate"><span class="pre">extend</span></code> method.</p>
<p>A second iteration, using the <code class="docutils literal notranslate"><span class="pre">append</span></code> method and refitting the parameters, would go as follows (note again that the default for <code class="docutils literal notranslate"><span class="pre">append</span></code> does not refit the parameters, but we have overridden that with the <code class="docutils literal notranslate"><span class="pre">refit=True</span></code> argument):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Step 1: append a new observation to the sample and refit the parameters</span>
<span class="n">append_res</span> <span class="o">=</span> <span class="n">training_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">endog</span><span class="p">[</span><span class="n">training_obs</span><span class="p">:</span><span class="n">training_obs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Print the re-estimated parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="n">append_res</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.22839D+00    |proj g|=  2.38555D-03

At iterate    5    f=  2.22838D+00    |proj g|=  9.80105D-08

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      5      8      1     0     0   9.801D-08   2.228D+00
  F =   2.2283821699856410

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
intercept    1.171544
ar.L1        0.723152
sigma2       5.024580
dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<p>Notice that these estimated parameters are slightly different than those we originally estimated. With the new results object, <code class="docutils literal notranslate"><span class="pre">append_res</span></code>, we can compute forecasts starting from one observation further than the previous call:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Step 2: produce one-step-ahead forecasts</span>
<span class="n">fcast</span> <span class="o">=</span> <span class="n">append_res</span><span class="o">.</span><span class="n">forecast</span><span class="p">()</span>

<span class="c1"># Step 3: compute root mean square forecasting error</span>
<span class="n">true</span> <span class="o">=</span> <span class="n">endog</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">fcast</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">true</span> <span class="o">-</span> <span class="n">fcast</span>

<span class="c1"># Print out the results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">true</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">),</span>
                 <span class="n">fcast</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;forecast&#39;</span><span class="p">),</span>
                 <span class="n">error</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        true  forecast     error
1999Q4  2.85  3.594102 -0.744102
</pre></div></div>
</div>
<p>Putting it altogether, we can perform the recursive forecast evaluation exercise as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Setup forecasts</span>
<span class="n">nforecasts</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">forecasts</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Get the number of initial training observations</span>
<span class="n">nobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">endog</span><span class="p">)</span>
<span class="n">n_init_training</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nobs</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Create model for initial training sample, fit parameters</span>
<span class="n">training_endog</span> <span class="o">=</span> <span class="n">endog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">n_init_training</span><span class="p">]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">training_endog</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Save initial forecast</span>
<span class="n">forecasts</span><span class="p">[</span><span class="n">training_endog</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">nforecasts</span><span class="p">)</span>

<span class="c1"># Step through the rest of the sample</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_init_training</span><span class="p">,</span> <span class="n">nobs</span><span class="p">):</span>
    <span class="c1"># Update the results by appending the next observation</span>
    <span class="n">updated_endog</span> <span class="o">=</span> <span class="n">endog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">t</span><span class="p">:</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_endog</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Save the new set of forecasts</span>
    <span class="n">forecasts</span><span class="p">[</span><span class="n">updated_endog</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">nforecasts</span><span class="p">)</span>

<span class="c1"># Combine all forecasts into a dataframe</span>
<span class="n">forecasts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">forecasts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.23132D+00    |proj g|=  1.09171D-02

At iterate    5    f=  2.23109D+00    |proj g|=  3.93608D-05
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      6      8      1     0     0   7.066D-07   2.231D+00
  F =   2.2310884444664758

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
          1999Q2    1999Q3    1999Q4    2000Q1    2000Q2
1999Q3  2.552620       NaN       NaN       NaN       NaN
1999Q4  3.010790  3.588286       NaN       NaN       NaN
2000Q1  3.342616  3.760863  3.226165       NaN       NaN
2000Q2       NaN  3.885850  3.498599  3.885225       NaN
2000Q3       NaN       NaN  3.695908  3.975918  4.196649
</pre></div></div>
</div>
<p>We now have a set of three forecasts made at each point in time from 1999Q2 through 2009Q3. We can construct the forecast errors by subtracting each forecast from the actual value of <code class="docutils literal notranslate"><span class="pre">endog</span></code> at that point.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Construct the forecast errors</span>
<span class="n">forecast_errors</span> <span class="o">=</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">column</span><span class="p">:</span> <span class="n">endog</span> <span class="o">-</span> <span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forecast_errors</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          1999Q2    1999Q3    1999Q4    2000Q1    2000Q2
1999Q3  0.797380       NaN       NaN       NaN       NaN
1999Q4 -0.160790 -0.738286       NaN       NaN       NaN
2000Q1  0.417384 -0.000863  0.533835       NaN       NaN
2000Q2       NaN  0.304150  0.691401  0.304775       NaN
2000Q3       NaN       NaN -0.925908 -1.205918 -1.426649
</pre></div></div>
</div>
<p>To evaluate our forecasts, we often want to look at a summary value like the root mean square error. Here we can compute that for each horizon by first flattening the forecast errors so that they are indexed by horizon and then computing the root mean square error fore each horizon.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Reindex the forecasts by horizon rather than by date</span>
<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">column</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">flattened</span> <span class="o">=</span> <span class="n">forecast_errors</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">flatten</span><span class="p">)</span>
<span class="n">flattened</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">flattened</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;horizon&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flattened</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           1999Q2    1999Q3    1999Q4    2000Q1    2000Q2
horizon
1        0.797380 -0.738286  0.533835  0.304775 -1.426649
2       -0.160790 -0.000863  0.691401 -1.205918 -0.311464
3        0.417384  0.304150 -0.925908 -0.151602 -2.384952
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Compute the root mean square error</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="p">(</span><span class="n">flattened</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
horizon
1    3.292700
2    3.421808
3    3.280012
dtype: float64
</pre></div></div>
</div>
<h4 id="Using-extend">Using <code class="docutils literal notranslate"><span class="pre">extend</span></code><a class="headerlink" href="#Using-extend" title="Link to this heading">¶</a></h4>
<p>We can check that we get similar forecasts if we instead use the <code class="docutils literal notranslate"><span class="pre">extend</span></code> method, but that they are not exactly the same as when we use <code class="docutils literal notranslate"><span class="pre">append</span></code> with the <code class="docutils literal notranslate"><span class="pre">refit=True</span></code> argument. This is because <code class="docutils literal notranslate"><span class="pre">extend</span></code> does not re-estimate the parameters given the new observation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Setup forecasts</span>
<span class="n">nforecasts</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">forecasts</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Get the number of initial training observations</span>
<span class="n">nobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">endog</span><span class="p">)</span>
<span class="n">n_init_training</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nobs</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Create model for initial training sample, fit parameters</span>
<span class="n">training_endog</span> <span class="o">=</span> <span class="n">endog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">n_init_training</span><span class="p">]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">training_endog</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Save initial forecast</span>
<span class="n">forecasts</span><span class="p">[</span><span class="n">training_endog</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">nforecasts</span><span class="p">)</span>

<span class="c1"># Step through the rest of the sample</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_init_training</span><span class="p">,</span> <span class="n">nobs</span><span class="p">):</span>
    <span class="c1"># Update the results by appending the next observation</span>
    <span class="n">updated_endog</span> <span class="o">=</span> <span class="n">endog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">t</span><span class="p">:</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">updated_endog</span><span class="p">)</span>

    <span class="c1"># Save the new set of forecasts</span>
    <span class="n">forecasts</span><span class="p">[</span><span class="n">updated_endog</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">nforecasts</span><span class="p">)</span>

<span class="c1"># Combine all forecasts into a dataframe</span>
<span class="n">forecasts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">forecasts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.23132D+00    |proj g|=  1.09171D-02

At iterate    5    f=  2.23109D+00    |proj g|=  3.93608D-05

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      6      8      1     0     0   7.066D-07   2.231D+00
  F =   2.2310884444664758

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          1999Q2    1999Q3    1999Q4    2000Q1    2000Q2
1999Q3  2.552620       NaN       NaN       NaN       NaN
1999Q4  3.010790  3.588286       NaN       NaN       NaN
2000Q1  3.342616  3.760863  3.226165       NaN       NaN
2000Q2       NaN  3.885850  3.498599  3.885225       NaN
2000Q3       NaN       NaN  3.695908  3.975918  4.196649
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Construct the forecast errors</span>
<span class="n">forecast_errors</span> <span class="o">=</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">column</span><span class="p">:</span> <span class="n">endog</span> <span class="o">-</span> <span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">forecast_errors</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          1999Q2    1999Q3    1999Q4    2000Q1    2000Q2
1999Q3  0.797380       NaN       NaN       NaN       NaN
1999Q4 -0.160790 -0.738286       NaN       NaN       NaN
2000Q1  0.417384 -0.000863  0.533835       NaN       NaN
2000Q2       NaN  0.304150  0.691401  0.304775       NaN
2000Q3       NaN       NaN -0.925908 -1.205918 -1.426649
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Reindex the forecasts by horizon rather than by date</span>
<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">column</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">flattened</span> <span class="o">=</span> <span class="n">forecast_errors</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">flatten</span><span class="p">)</span>
<span class="n">flattened</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">flattened</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;horizon&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flattened</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           1999Q2    1999Q3    1999Q4    2000Q1    2000Q2
horizon
1        0.797380 -0.738286  0.533835  0.304775 -1.426649
2       -0.160790 -0.000863  0.691401 -1.205918 -0.311464
3        0.417384  0.304150 -0.925908 -0.151602 -2.384952
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Compute the root mean square error</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="p">(</span><span class="n">flattened</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
horizon
1    3.292700
2    3.421808
3    3.280012
dtype: float64
</pre></div></div>
</div>
<p>By not re-estimating the parameters, our forecasts are slightly worse (the root mean square error is higher at each horizon). However, the process is faster, even with only 200 datapoints. Using the <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code> cell magic on the cells above, we found a runtime of 570ms using <code class="docutils literal notranslate"><span class="pre">extend</span></code> versus 1.7s using <code class="docutils literal notranslate"><span class="pre">append</span></code> with <code class="docutils literal notranslate"><span class="pre">refit=True</span></code>. (Note that using <code class="docutils literal notranslate"><span class="pre">extend</span></code> is also faster than using <code class="docutils literal notranslate"><span class="pre">append</span></code> with <code class="docutils literal notranslate"><span class="pre">refit=False</span></code>).</p>
<h2 id="Indexes">Indexes<a class="headerlink" href="#Indexes" title="Link to this heading">¶</a></h2>
<p>Throughout this notebook, we have been making use of Pandas date indexes with an associated frequency. As you can see, this index marks our data as at a quarterly frequency, between 1959Q1 and 2009Q3.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">endog</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PeriodIndex([&#39;1959Q1&#39;, &#39;1959Q2&#39;, &#39;1959Q3&#39;, &#39;1959Q4&#39;, &#39;1960Q1&#39;, &#39;1960Q2&#39;,
             &#39;1960Q3&#39;, &#39;1960Q4&#39;, &#39;1961Q1&#39;, &#39;1961Q2&#39;,
             ...
             &#39;2007Q2&#39;, &#39;2007Q3&#39;, &#39;2007Q4&#39;, &#39;2008Q1&#39;, &#39;2008Q2&#39;, &#39;2008Q3&#39;,
             &#39;2008Q4&#39;, &#39;2009Q1&#39;, &#39;2009Q2&#39;, &#39;2009Q3&#39;],
            dtype=&#39;period[Q-DEC]&#39;, length=203)
</pre></div></div>
</div>
<p>In most cases, if your data has an associated data/time index with a defined frequency (like quarterly, monthly, etc.), then it is best to make sure your data is a Pandas series with the appropriate index. Here are three examples of this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[24]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Annual frequency, using a PeriodIndex</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">endog1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">endog1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PeriodIndex([&#39;2000&#39;, &#39;2001&#39;, &#39;2002&#39;, &#39;2003&#39;], dtype=&#39;period[Y-DEC]&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[25]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Quarterly frequency, using a DatetimeIndex</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;QS&#39;</span><span class="p">)</span>
<span class="n">endog2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">endog2</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-04-01&#39;, &#39;2000-07-01&#39;, &#39;2000-10-01&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;QS-JAN&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[26]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Monthly frequency, using a DatetimeIndex</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span>
<span class="n">endog3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">endog3</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DatetimeIndex([&#39;2000-01-31&#39;, &#39;2000-02-29&#39;, &#39;2000-03-31&#39;, &#39;2000-04-30&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;ME&#39;)
</pre></div></div>
</div>
<p>In fact, if your data has an associated date/time index, it is best to use that even if does not have a defined frequency. An example of that kind of index is as follows - notice that it has <code class="docutils literal notranslate"><span class="pre">freq=None</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[27]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">([</span>
    <span class="s1">&#39;2000-01-01 10:08am&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-01 11:32am&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2000-01-01 5:32pm&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-01-02 6:15am&#39;</span><span class="p">])</span>
<span class="n">endog4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">endog4</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DatetimeIndex([&#39;2000-01-01 10:08:00&#39;, &#39;2000-01-01 11:32:00&#39;,
               &#39;2000-01-01 17:32:00&#39;, &#39;2000-01-02 06:15:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div></div>
</div>
<p>You can still pass this data to statsmodels’ model classes, but you will get the following warning, that no frequency data was found:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[28]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">endog4</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            2     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  1.37900D-01    |proj g|=  4.66940D-01

At iterate    5    f=  1.32476D-01    |proj g|=  6.00136D-06

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    2      5     10      1     0     0   6.001D-06   1.325D-01
  F =  0.13247641992895681

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/statsmodels/tsa/base/tsa_model.py:465: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
  self._init_dates(dates, freq)
/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/statsmodels/tsa/base/tsa_model.py:465: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
  self._init_dates(dates, freq)
 This problem is unconstrained.
</pre></div></div>
</div>
<p>What this means is that you cannot specify forecasting steps by dates, and the output of the <code class="docutils literal notranslate"><span class="pre">forecast</span></code> and <code class="docutils literal notranslate"><span class="pre">get_forecast</span></code> methods will not have associated dates. The reason is that without a given frequency, there is no way to determine what date each forecast should be assigned to. In the example above, there is no pattern to the date/time stamps of the index, so there is no way to determine what the next date/time should be (should it be in the morning of 2000-01-02? the afternoon? or
maybe not until 2000-01-03?).</p>
<p>For example, if we forecast one-step-ahead:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/statsmodels/tsa/base/tsa_model.py:829: FutureWarning: No supported index is available. In the next version, calling this method in a model without a supported index will result in an exception.
  return get_prediction_index(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[29]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4    0.011866
dtype: float64
</pre></div></div>
</div>
<p>The index associated with the new forecast is <code class="docutils literal notranslate"><span class="pre">4</span></code>, because if the given data had an integer index, that would be the next value. A warning is given letting the user know that the index is not a date/time index.</p>
<p>If we try to specify the steps of the forecast using a date, we will get the following exception:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>KeyError: &#39;The `end` argument could not be matched to a location related to the index of the data.&#39;
</code></pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[30]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Here we&#39;ll catch the exception to prevent printing too much of</span>
<span class="c1"># the exception trace output in this notebook</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">res</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="s1">&#39;2000-01-03&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;The `end` argument could not be matched to a location related to the index of the data.&#39;
</pre></div></div>
</div>
<p>Ultimately there is nothing wrong with using data that does not have an associated date/time frequency, or even using data that has no index at all, like a Numpy array. However, if you can use a Pandas series with an associated frequency, you’ll have more options for specifying your forecasts and get back results with a more useful index.</p>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      Aug 15, 2024
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="predict.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Prediction (out of sample)" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Prediction (out of sample)
            </div>
          </div>
        </a>
      
      
        
        <a href="generic_mle.html" class="md-footer__link md-footer__link--next" aria-label="Next: Maximum Likelihood Estimation (Generic models)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Maximum Likelihood Estimation (Generic models)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2009-2023, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.3.7.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/statsmodels/statsmodels/" target="_blank" rel="noopener" title="Source on github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://pypi.org/project/statsmodels/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://doi.org/10.5281/zenodo.593847" target="_blank" rel="noopener" title="doi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions-v3.json"}}</script>
    
      
        <script src="../../../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>