

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>statsmodels.graphics.gofplots &#8212; statsmodels v0.10.2 documentation</title>
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/statsmodels_hybi_favico.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<link rel="stylesheet" href="../../../_static/examples.css" type="text/css" />
<link rel="stylesheet" href="../../../_static/facebox.css" type="text/css" />
<script type="text/javascript" src="../../../_static/scripts.js">
</script>
<script type="text/javascript" src="../../../_static/facebox.js">
</script>
<script type="text/javascript">
$.facebox.settings.closeImage = "../../../_static/closelabel.png"
$.facebox.settings.loadingImage = "../../../_static/loading.gif"
</script>

<script>
$(document).ready(function() {
  $.getJSON("../../../../versions.json", function(versions) {
    var dropdown = document.createElement("div");
    dropdown.className = "dropdown";
    var button = document.createElement("button");
    button.className = "dropbtn";
    button.innerHTML = "Other Versions";
    var content = document.createElement("div");
    content.className = "dropdown-content";
    dropdown.appendChild(button);
    dropdown.appendChild(content);
    $(".header").prepend(dropdown);
    for (var i = 0; i < versions.length; i++) {
      if (versions[i].substring(0, 1) == "v") {
        versions[i] = [versions[i], versions[i].substring(1)];
      } else {
        versions[i] = [versions[i], versions[i]];
      };
    };
    for (var i = 0; i < versions.length; i++) {
      var a = document.createElement("a");
      a.innerHTML = versions[i][1];
      a.href = "../../../../" + versions[i][0] + "/index.html";
      a.title = versions[i][1];
      $(".dropdown-content").append(a);
    };
  });
});
</script>


  </head><body>
<div class="headerwrap">
    <div class = "header">
        
        <a href = "../../../index.html">
<img src="../../../_static/statsmodels_hybi_banner.png" alt="Logo"
    style="padding-left: 15px"/></a>
        
    </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
<li><a href ="../../../install.html">Install</a></li> &nbsp;|&nbsp;
<li><a href="https://groups.google.com/forum/?hl=en#!forum/pystatsmodels">Support</a></li> &nbsp;|&nbsp;
<li><a href="https://github.com/statsmodels/statsmodels/issues">Bugs</a></li> &nbsp;|&nbsp;
<li><a href="../../../dev/index.html">Develop</a></li> &nbsp;|&nbsp;
<li><a href="../../../examples/index.html">Examples</a></li> &nbsp;|&nbsp;
<li><a href="../../../faq.html">FAQ</a></li> &nbsp;|&nbsp;

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> |</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            




  <h1>Source code for statsmodels.graphics.gofplots</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">statsmodels.compat.python</span> <span class="k">import</span> <span class="n">lzip</span><span class="p">,</span> <span class="n">string_types</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>

<span class="kn">from</span> <span class="nn">statsmodels.regression.linear_model</span> <span class="k">import</span> <span class="n">OLS</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.tools</span> <span class="k">import</span> <span class="n">add_constant</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.decorators</span> <span class="k">import</span> <span class="n">cache_readonly</span>
<span class="kn">from</span> <span class="nn">statsmodels.distributions</span> <span class="k">import</span> <span class="n">ECDF</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">utils</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;qqplot&#39;</span><span class="p">,</span> <span class="s1">&#39;qqplot_2samples&#39;</span><span class="p">,</span> <span class="s1">&#39;qqline&#39;</span><span class="p">,</span> <span class="s1">&#39;ProbPlot&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="ProbPlot"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.html#statsmodels.graphics.gofplots.ProbPlot">[docs]</a><span class="k">class</span> <span class="nc">ProbPlot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for convenient construction of Q-Q, P-P, and probability plots.</span>

<span class="sd">    Can take arguments specifying the parameters for dist or fit them</span>
<span class="sd">    automatically. (See fit under kwargs.)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array-like</span>
<span class="sd">        1d data array</span>
<span class="sd">    dist : A scipy.stats or statsmodels distribution</span>
<span class="sd">        Compare x against dist. The default is</span>
<span class="sd">        scipy.stats.distributions.norm (a standard normal).</span>
<span class="sd">    distargs : tuple</span>
<span class="sd">        A tuple of arguments passed to dist to specify it fully</span>
<span class="sd">        so dist.ppf may be called. distargs must not contain loc</span>
<span class="sd">        or scale. These values must be passed using the loc or</span>
<span class="sd">        scale inputs.</span>
<span class="sd">    a : float</span>
<span class="sd">        Offset for the plotting position of an expected order</span>
<span class="sd">        statistic, for example. The plotting positions are given</span>
<span class="sd">        by (i - a)/(nobs - 2*a + 1) for i in range(0,nobs+1)</span>
<span class="sd">    loc : float</span>
<span class="sd">        Location parameter for dist</span>
<span class="sd">    scale : float</span>
<span class="sd">        Scale parameter for dist</span>
<span class="sd">    fit : boolean</span>
<span class="sd">        If fit is false, loc, scale, and distargs are passed to the</span>
<span class="sd">        distribution. If fit is True then the parameters for dist</span>
<span class="sd">        are fit automatically using dist.fit. The quantiles are formed</span>
<span class="sd">        from the standardized data, after subtracting the fitted loc</span>
<span class="sd">        and dividing by the fitted scale.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats.probplot</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1) Depends on matplotlib.</span>
<span class="sd">    2) If `fit` is True then the parameters are fit using the</span>
<span class="sd">        distribution&#39;s `fit()` method.</span>
<span class="sd">    3) The call signatures for the `qqplot`, `ppplot`, and `probplot`</span>
<span class="sd">        methods are similar, so examples 1 through 4 apply to all</span>
<span class="sd">        three methods.</span>
<span class="sd">    4) The three plotting methods are summarized below:</span>
<span class="sd">        ppplot : Probability-Probability plot</span>
<span class="sd">            Compares the sample and theoretical probabilities (percentiles).</span>
<span class="sd">        qqplot : Quantile-Quantile plot</span>
<span class="sd">            Compares the sample and theoretical quantiles</span>
<span class="sd">        probplot : Probability plot</span>
<span class="sd">            Same as a Q-Q plot, however probabilities are shown in the scale of</span>
<span class="sd">            the theoretical distribution (x-axis) and the y-axis contains</span>
<span class="sd">            unscaled quantiles of the sample data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The first example shows a Q-Q plot for regression residuals</span>

<span class="sd">    &gt;&gt;&gt; # example 1</span>
<span class="sd">    &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">    &gt;&gt;&gt; from matplotlib import pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; data = sm.datasets.longley.load(as_pandas=False)</span>
<span class="sd">    &gt;&gt;&gt; data.exog = sm.add_constant(data.exog)</span>
<span class="sd">    &gt;&gt;&gt; model = sm.OLS(data.endog, data.exog)</span>
<span class="sd">    &gt;&gt;&gt; mod_fit = model.fit()</span>
<span class="sd">    &gt;&gt;&gt; res = mod_fit.resid # residuals</span>
<span class="sd">    &gt;&gt;&gt; probplot = sm.ProbPlot(res)</span>
<span class="sd">    &gt;&gt;&gt; fig = probplot.qqplot()</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 1 - qqplot - residuals of OLS fit&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    qqplot of the residuals against quantiles of t-distribution with 4</span>
<span class="sd">    degrees of freedom:</span>

<span class="sd">    &gt;&gt;&gt; # example 2</span>
<span class="sd">    &gt;&gt;&gt; import scipy.stats as stats</span>
<span class="sd">    &gt;&gt;&gt; probplot = sm.ProbPlot(res, stats.t, distargs=(4,))</span>
<span class="sd">    &gt;&gt;&gt; fig = probplot.qqplot()</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 2 - qqplot - residuals against quantiles of t-dist&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    qqplot against same as above, but with mean 3 and std 10:</span>

<span class="sd">    &gt;&gt;&gt; # example 3</span>
<span class="sd">    &gt;&gt;&gt; probplot = sm.ProbPlot(res, stats.t, distargs=(4,), loc=3, scale=10)</span>
<span class="sd">    &gt;&gt;&gt; fig = probplot.qqplot()</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 3 - qqplot - resids vs quantiles of t-dist&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    Automatically determine parameters for t distribution including the</span>
<span class="sd">    loc and scale:</span>

<span class="sd">    &gt;&gt;&gt; # example 4</span>
<span class="sd">    &gt;&gt;&gt; probplot = sm.ProbPlot(res, stats.t, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; fig = probplot.qqplot(line=&#39;45&#39;)</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 4 - qqplot - resids vs. quantiles of fitted t-dist&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    A second `ProbPlot` object can be used to compare two separate sample</span>
<span class="sd">    sets by using the `other` kwarg in the `qqplot` and `ppplot` methods.</span>

<span class="sd">    &gt;&gt;&gt; # example 5</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; x = np.random.normal(loc=8.25, scale=2.75, size=37)</span>
<span class="sd">    &gt;&gt;&gt; y = np.random.normal(loc=8.75, scale=3.25, size=37)</span>
<span class="sd">    &gt;&gt;&gt; pp_x = sm.ProbPlot(x, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; pp_y = sm.ProbPlot(y, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; fig = pp_x.qqplot(line=&#39;45&#39;, other=pp_y)</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 5 - qqplot - compare two sample sets&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    In qqplot, sample size of `other` can be equal or larger than the first.</span>
<span class="sd">    In case of larger, size of `other` samples will be reduced to match the</span>
<span class="sd">    size of the first by interpolation</span>

<span class="sd">    &gt;&gt;&gt; # example 6</span>
<span class="sd">    &gt;&gt;&gt; x = np.random.normal(loc=8.25, scale=2.75, size=37)</span>
<span class="sd">    &gt;&gt;&gt; y = np.random.normal(loc=8.75, scale=3.25, size=57)</span>
<span class="sd">    &gt;&gt;&gt; pp_x = sm.ProbPlot(x, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; pp_y = sm.ProbPlot(y, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; fig = pp_x.qqplot(line=&#39;45&#39;, other=pp_y)</span>
<span class="sd">    &gt;&gt;&gt; title = &#39;Ex. 6 - qqplot - compare different sample sizes&#39;</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(title)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    In ppplot, sample size of `other` and the first can be different. `other`</span>
<span class="sd">    will be used to estimate an empirical cumulative distribution function</span>
<span class="sd">    (ECDF). ECDF(x) will be plotted against p(x)=0.5/n, 1.5/n, ..., (n-0.5)/n</span>
<span class="sd">    where x are sorted samples from the first.</span>

<span class="sd">    &gt;&gt;&gt; # example 7</span>
<span class="sd">    &gt;&gt;&gt; x = np.random.normal(loc=8.25, scale=2.75, size=37)</span>
<span class="sd">    &gt;&gt;&gt; y = np.random.normal(loc=8.75, scale=3.25, size=57)</span>
<span class="sd">    &gt;&gt;&gt; pp_x = sm.ProbPlot(x, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; pp_y = sm.ProbPlot(y, fit=True)</span>
<span class="sd">    &gt;&gt;&gt; fig = pp_y.ppplot(line=&#39;45&#39;, other=pp_x)</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 7A- ppplot - compare two sample sets, other=pp_x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; fig = pp_x.ppplot(line=&#39;45&#39;, other=pp_y)</span>
<span class="sd">    &gt;&gt;&gt; h = plt.title(&#39;Ex. 7B- ppplot - compare two sample sets, other=pp_y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    The following plot displays some options, follow the link to see the</span>
<span class="sd">    code.</span>

<span class="sd">    .. plot:: plots/graphics_gofplots_qqplot.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">distargs</span><span class="o">=</span><span class="p">(),</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nobs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distargs</span> <span class="o">=</span> <span class="n">distargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span>
                                 <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">distargs</span> <span class="ow">or</span> <span class="n">loc</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">scale</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="o">*</span><span class="n">distargs</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">distargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">da</span><span class="p">)</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">distargs</span><span class="p">])</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;dist(</span><span class="si">{distargs}</span><span class="s1">, loc=</span><span class="si">{loc}</span><span class="s1">, scale=</span><span class="si">{scale}</span><span class="s1">)&#39;</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distargs</span><span class="o">=</span><span class="n">distargs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Initializing the distribution failed.  This &#39;</span>
                                <span class="s1">&#39;can occur if distargs contains loc or scale. &#39;</span>
                                <span class="s1">&#39;The distribution initialization command &#39;</span>
                                <span class="s1">&#39;is:</span><span class="se">\n</span><span class="si">{cmd}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmd</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

        <span class="c1"># propertes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="ProbPlot.theoretical_percentiles"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.theoretical_percentiles.html#statsmodels.graphics.gofplots.ProbPlot.theoretical_percentiles">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">theoretical_percentiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Theoretical percentiles&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">plotting_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProbPlot.theoretical_quantiles"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.theoretical_quantiles.html#statsmodels.graphics.gofplots.ProbPlot.theoretical_quantiles">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">theoretical_quantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Theoretical quantiles&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theoretical_percentiles</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> requires more parameters to &#39;</span> \
                  <span class="s1">&#39;compute ppf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;failed to compute the ppf of </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="ProbPlot.sorted_data"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.sorted_data.html#statsmodels.graphics.gofplots.ProbPlot.sorted_data">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">sorted_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sorted data&quot;&quot;&quot;</span>
        <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sorted_data</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sorted_data</span></div>

<div class="viewcode-block" id="ProbPlot.sample_quantiles"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.sample_quantiles.html#statsmodels.graphics.gofplots.ProbPlot.sample_quantiles">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">sample_quantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sample quantiles&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted_data</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorted_data</span></div>

<div class="viewcode-block" id="ProbPlot.sample_percentiles"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.sample_percentiles.html#statsmodels.graphics.gofplots.ProbPlot.sample_percentiles">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">sample_percentiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sample percentiles&quot;&quot;&quot;</span>
        <span class="n">quantiles</span> <span class="o">=</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted_data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProbPlot.ppplot"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.ppplot.html#statsmodels.graphics.gofplots.ProbPlot.ppplot">[docs]</a>    <span class="k">def</span> <span class="nf">ppplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">plotkwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        P-P plot of the percentiles (probabilities) of x versus the</span>
<span class="sd">        probabilities (percetiles) of a distribution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xlabel : str or None, optional</span>
<span class="sd">            User-provided lables for the x-axis. If None (default),</span>
<span class="sd">            other values are used depending on the status of the kwarg `other`.</span>
<span class="sd">        ylabel : str or None, optional</span>
<span class="sd">            User-provided lables for the y-axis. If None (default),</span>
<span class="sd">            other values are used depending on the status of the kwarg `other`.</span>
<span class="sd">        line : str {&#39;45&#39;, &#39;s&#39;, &#39;r&#39;, q&#39;} or None, optional</span>
<span class="sd">            Options for the reference line to which the data is compared:</span>

<span class="sd">                - &#39;45&#39;: 45-degree line</span>
<span class="sd">                - &#39;s&#39;: standardized line, the expected order statistics are</span>
<span class="sd">                  scaled by the standard deviation of the given sample and have</span>
<span class="sd">                  the mean added to them</span>
<span class="sd">                - &#39;r&#39;: A regression line is fit</span>
<span class="sd">                - &#39;q&#39;: A line is fit through the quartiles.</span>
<span class="sd">                - None: by default no reference line is added to the plot.</span>

<span class="sd">        other : ProbPlot, array-like, or None, optional</span>
<span class="sd">            If provided, ECDF(x) will be plotted against p(x) where x are</span>
<span class="sd">            sorted samples from `self`. ECDF is an empirical cumulative</span>
<span class="sd">            distribution function estimated from `other` and</span>
<span class="sd">            p(x) = 0.5/n, 1.5/n, ..., (n-0.5)/n where n is the number of</span>
<span class="sd">            samples in `self`. If an array-object is provided, it will be</span>
<span class="sd">            turned into a `ProbPlot` instance default parameters. If not</span>
<span class="sd">            provided (default), `self.dist(x)` is be plotted against p(x).</span>

<span class="sd">        ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">            If given, this subplot is used to plot in instead of a new figure</span>
<span class="sd">            being created.</span>
<span class="sd">        **plotkwargs : additional matplotlib arguments to be passed to the</span>
<span class="sd">            `plot` command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib figure instance</span>
<span class="sd">            If `ax` is None, the created figure.  Otherwise the figure to which</span>
<span class="sd">            `ax` is connected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">check_other</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ProbPlot</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">check_other</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">ProbPlot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

            <span class="n">p_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theoretical_percentiles</span>
            <span class="n">ecdf_x</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">sample_quantiles</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_quantiles</span><span class="p">)</span>

            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_do_plot</span><span class="p">(</span><span class="n">p_x</span><span class="p">,</span> <span class="n">ecdf_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Probabilities of 2nd Sample&#39;</span>
            <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Probabilities of 1st Sample&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_do_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theoretical_percentiles</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">sample_percentiles</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Theoretical Probabilities&quot;</span>
            <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Sample Probabilities&quot;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ProbPlot.qqplot"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.qqplot.html#statsmodels.graphics.gofplots.ProbPlot.qqplot">[docs]</a>    <span class="k">def</span> <span class="nf">qqplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">plotkwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Q-Q plot of the quantiles of x versus the quantiles/ppf of a</span>
<span class="sd">        distribution or the quantiles of another `ProbPlot` instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xlabel, ylabel : str or None, optional</span>
<span class="sd">            User-provided lables for the x-axis and y-axis. If None (default),</span>
<span class="sd">            other values are used depending on the status of the kwarg `other`.</span>
<span class="sd">        line : str {&#39;45&#39;, &#39;s&#39;, &#39;r&#39;, q&#39;} or None, optional</span>
<span class="sd">            Options for the reference line to which the data is compared:</span>

<span class="sd">            - &#39;45&#39; - 45-degree line</span>
<span class="sd">            - &#39;s&#39; - standardized line, the expected order statistics are scaled</span>
<span class="sd">              by the standard deviation of the given sample and have the mean</span>
<span class="sd">              added to them</span>
<span class="sd">            - &#39;r&#39; - A regression line is fit</span>
<span class="sd">            - &#39;q&#39; - A line is fit through the quartiles.</span>
<span class="sd">            - None - by default no reference line is added to the plot.</span>

<span class="sd">        other : `ProbPlot` instance, array-like, or None, optional</span>
<span class="sd">            If provided, the sample quantiles of this `ProbPlot` instance are</span>
<span class="sd">            plotted against the sample quantiles of the `other` `ProbPlot`</span>
<span class="sd">            instance. Sample size of `other` must be equal or larger than</span>
<span class="sd">            this `ProbPlot` instance. If the sample size is larger, sample</span>
<span class="sd">            quantiles of `other` will be interpolated to match the sample size</span>
<span class="sd">            of this `ProbPlot` instance. If an array-like object is provided,</span>
<span class="sd">            it will be turned into a `ProbPlot` instance using default</span>
<span class="sd">            parameters. If not provided (default), the theoretical quantiles</span>
<span class="sd">            are used.</span>
<span class="sd">        ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">            If given, this subplot is used to plot in instead of a new figure</span>
<span class="sd">            being created.</span>
<span class="sd">        **plotkwargs : additional matplotlib arguments to be passed to the</span>
<span class="sd">            `plot` command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib figure instance</span>
<span class="sd">            If `ax` is None, the created figure.  Otherwise the figure to which</span>
<span class="sd">            `ax` is connected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">check_other</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ProbPlot</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">check_other</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">ProbPlot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

            <span class="n">s_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_quantiles</span>
            <span class="n">s_other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">sample_quantiles</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_other</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample size of `other` must be equal or &quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot;larger than this `ProbPlot` instance&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_other</span><span class="p">):</span>
                <span class="c1"># Use quantiles of the smaller set and interpolate quantiles of</span>
                <span class="c1"># the larger data set</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">plotting_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
                <span class="n">s_other</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mstats</span><span class="o">.</span><span class="n">mquantiles</span><span class="p">(</span><span class="n">s_other</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_do_plot</span><span class="p">(</span><span class="n">s_other</span><span class="p">,</span> <span class="n">s_self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Quantiles of 2nd Sample&#39;</span>
            <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Quantiles of 1st Sample&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_do_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theoretical_quantiles</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">sample_quantiles</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Theoretical Quantiles&quot;</span>
            <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Sample Quantiles&quot;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ProbPlot.probplot"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.ProbPlot.probplot.html#statsmodels.graphics.gofplots.ProbPlot.probplot">[docs]</a>    <span class="k">def</span> <span class="nf">probplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">exceed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">plotkwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Probability plot of the unscaled quantiles of x versus the</span>
<span class="sd">        probabilities of a distibution (not to be confused with a P-P plot).</span>

<span class="sd">        The x-axis is scaled linearly with the quantiles, but the probabilities</span>
<span class="sd">        are used to label the axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xlabel, ylabel : str or None, optional</span>
<span class="sd">            User-provided lables for the x-axis and y-axis. If None (default),</span>
<span class="sd">            other values are used depending on the status of the kwarg `other`.</span>
<span class="sd">        line : str {&#39;45&#39;, &#39;s&#39;, &#39;r&#39;, q&#39;} or None, optional</span>
<span class="sd">            Options for the reference line to which the data is compared:</span>

<span class="sd">            - &#39;45&#39; - 45-degree line</span>
<span class="sd">            - &#39;s&#39; - standardized line, the expected order statistics are scaled</span>
<span class="sd">              by the standard deviation of the given sample and have the mean</span>
<span class="sd">              added to them</span>
<span class="sd">            - &#39;r&#39; - A regression line is fit</span>
<span class="sd">            - &#39;q&#39; - A line is fit through the quartiles.</span>
<span class="sd">            - None - by default no reference line is added to the plot.</span>

<span class="sd">        exceed : boolean, optional</span>

<span class="sd">             - If False (default) the raw sample quantiles are plotted against</span>
<span class="sd">               the theoretical quantiles, show the probability that a sample</span>
<span class="sd">               will not exceed a given value</span>
<span class="sd">             - If True, the theoretical quantiles are flipped such that the</span>
<span class="sd">               figure displays the probability that a sample will exceed a</span>
<span class="sd">               given value.</span>
<span class="sd">        ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">            If given, this subplot is used to plot in instead of a new figure</span>
<span class="sd">            being created.</span>
<span class="sd">        **plotkwargs : additional matplotlib arguments to be passed to the</span>
<span class="sd">            `plot` command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib figure instance</span>
<span class="sd">            If `ax` is None, the created figure.  Otherwise the figure to which</span>
<span class="sd">            `ax` is connected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exceed</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_do_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theoretical_quantiles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">sorted_data</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Probability of Exceedance (%)&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_do_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theoretical_quantiles</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">sorted_data</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                               <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Non-exceedance Probability (%)&#39;</span>

        <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Sample Quantiles&quot;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">_fmt_probplot_axis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="qqplot"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.qqplot.html#statsmodels.graphics.gofplots.qqplot">[docs]</a><span class="k">def</span> <span class="nf">qqplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span> <span class="n">distargs</span><span class="o">=</span><span class="p">(),</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">plotkwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Q-Q plot of the quantiles of x versus the quantiles/ppf of a distribution.</span>

<span class="sd">    Can take arguments specifying the parameters for dist or fit them</span>
<span class="sd">    automatically. (See fit under Parameters.)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array-like</span>
<span class="sd">        1d data array</span>
<span class="sd">    dist : A scipy.stats or statsmodels distribution</span>
<span class="sd">        Compare x against dist. The default</span>
<span class="sd">        is scipy.stats.distributions.norm (a standard normal).</span>
<span class="sd">    distargs : tuple</span>
<span class="sd">        A tuple of arguments passed to dist to specify it fully</span>
<span class="sd">        so dist.ppf may be called.</span>
<span class="sd">    loc : float</span>
<span class="sd">        Location parameter for dist</span>
<span class="sd">    a : float</span>
<span class="sd">        Offset for the plotting position of an expected order statistic, for</span>
<span class="sd">        example. The plotting positions are given by (i - a)/(nobs - 2*a + 1)</span>
<span class="sd">        for i in range(0,nobs+1)</span>
<span class="sd">    scale : float</span>
<span class="sd">        Scale parameter for dist</span>
<span class="sd">    fit : boolean</span>
<span class="sd">        If fit is false, loc, scale, and distargs are passed to the</span>
<span class="sd">        distribution. If fit is True then the parameters for dist</span>
<span class="sd">        are fit automatically using dist.fit. The quantiles are formed</span>
<span class="sd">        from the standardized data, after subtracting the fitted loc</span>
<span class="sd">        and dividing by the fitted scale.</span>
<span class="sd">    line : str {&#39;45&#39;, &#39;s&#39;, &#39;r&#39;, q&#39;} or None</span>
<span class="sd">        Options for the reference line to which the data is compared:</span>

<span class="sd">        - &#39;45&#39; - 45-degree line</span>
<span class="sd">        - &#39;s&#39; - standardized line, the expected order statistics are scaled</span>
<span class="sd">          by the standard deviation of the given sample and have the mean</span>
<span class="sd">          added to them</span>
<span class="sd">        - &#39;r&#39; - A regression line is fit</span>
<span class="sd">        - &#39;q&#39; - A line is fit through the quartiles.</span>
<span class="sd">        - None - by default no reference line is added to the plot.</span>

<span class="sd">    ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">        If given, this subplot is used to plot in instead of a new figure being</span>
<span class="sd">        created.</span>
<span class="sd">    **plotkwargs : additional matplotlib arguments to be passed to the</span>
<span class="sd">            `plot` command.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Matplotlib figure instance</span>
<span class="sd">        If `ax` is None, the created figure.  Otherwise the figure to which</span>
<span class="sd">        `ax` is connected.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats.probplot</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">    &gt;&gt;&gt; from matplotlib import pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; data = sm.datasets.longley.load(as_pandas=False)</span>
<span class="sd">    &gt;&gt;&gt; data.exog = sm.add_constant(data.exog)</span>
<span class="sd">    &gt;&gt;&gt; mod_fit = sm.OLS(data.endog, data.exog).fit()</span>
<span class="sd">    &gt;&gt;&gt; res = mod_fit.resid # residuals</span>
<span class="sd">    &gt;&gt;&gt; fig = sm.qqplot(res)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    qqplot of the residuals against quantiles of t-distribution with 4 degrees</span>
<span class="sd">    of freedom:</span>

<span class="sd">    &gt;&gt;&gt; import scipy.stats as stats</span>
<span class="sd">    &gt;&gt;&gt; fig = sm.qqplot(res, stats.t, distargs=(4,))</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    qqplot against same as above, but with mean 3 and std 10:</span>

<span class="sd">    &gt;&gt;&gt; fig = sm.qqplot(res, stats.t, distargs=(4,), loc=3, scale=10)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    Automatically determine parameters for t distribution including the</span>
<span class="sd">    loc and scale:</span>

<span class="sd">    &gt;&gt;&gt; fig = sm.qqplot(res, stats.t, fit=True, line=&#39;45&#39;)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    The following plot displays some options, follow the link to see the code.</span>

<span class="sd">    .. plot:: plots/graphics_gofplots_qqplot.py</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Depends on matplotlib. If `fit` is True then the parameters are fit using</span>
<span class="sd">    the distribution&#39;s fit() method.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">probplot</span> <span class="o">=</span> <span class="n">ProbPlot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">distargs</span><span class="o">=</span><span class="n">distargs</span><span class="p">,</span>
                         <span class="n">fit</span><span class="o">=</span><span class="n">fit</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">probplot</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="o">**</span><span class="n">plotkwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="qqplot_2samples"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.qqplot_2samples.html#statsmodels.graphics.gofplots.qqplot_2samples">[docs]</a><span class="k">def</span> <span class="nf">qqplot_2samples</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Q-Q Plot of two samples&#39; quantiles.</span>

<span class="sd">    Can take either two `ProbPlot` instances or two array-like objects. In the</span>
<span class="sd">    case of the latter, both inputs will be converted to `ProbPlot` instances</span>
<span class="sd">    using only the default values - so use `ProbPlot` instances if</span>
<span class="sd">    finer-grained control of the quantile computations is required.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data1, data2 : array-like (1d) or `ProbPlot` instances</span>
<span class="sd">    xlabel, ylabel : str or None</span>
<span class="sd">        User-provided labels for the x-axis and y-axis. If None (default),</span>
<span class="sd">        other values are used.</span>
<span class="sd">    line : str {&#39;45&#39;, &#39;s&#39;, &#39;r&#39;, q&#39;} or None</span>
<span class="sd">        Options for the reference line to which the data is compared:</span>

<span class="sd">        - &#39;45&#39; - 45-degree line</span>
<span class="sd">        - &#39;s&#39; - standardized line, the expected order statistics are scaled</span>
<span class="sd">          by the standard deviation of the given sample and have the mean</span>
<span class="sd">          added to them</span>
<span class="sd">        - &#39;r&#39; - A regression line is fit</span>
<span class="sd">        - &#39;q&#39; - A line is fit through the quartiles.</span>
<span class="sd">        - None - by default no reference line is added to the plot.</span>

<span class="sd">    ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">        If given, this subplot is used to plot in instead of a new figure being</span>
<span class="sd">        created.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Matplotlib figure instance</span>
<span class="sd">        If `ax` is None, the created figure.  Otherwise the figure to which</span>
<span class="sd">        `ax` is connected.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats.probplot</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; from statsmodels.graphics.gofplots import qqplot_2samples</span>
<span class="sd">    &gt;&gt;&gt; x = np.random.normal(loc=8.5, scale=2.5, size=37)</span>
<span class="sd">    &gt;&gt;&gt; y = np.random.normal(loc=8.0, scale=3.0, size=37)</span>
<span class="sd">    &gt;&gt;&gt; pp_x = sm.ProbPlot(x)</span>
<span class="sd">    &gt;&gt;&gt; pp_y = sm.ProbPlot(y)</span>
<span class="sd">    &gt;&gt;&gt; qqplot_2samples(pp_x, pp_y)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    .. plot:: plots/graphics_gofplots_qqplot_2samples.py</span>

<span class="sd">    &gt;&gt;&gt; fig = qqplot_2samples(pp_x, pp_y, xlabel=None, ylabel=None, \</span>
<span class="sd">    ...                       line=None, ax=None)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1) Depends on matplotlib.</span>
<span class="sd">    2) If `data1` and `data2` are not `ProbPlot` instances, instances will be</span>
<span class="sd">       created using the default parameters. Therefore, it is recommended to use</span>
<span class="sd">       `ProbPlot` instance if fine-grained control is needed in the computation</span>
<span class="sd">       of the quantiles.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">ProbPlot</span><span class="p">):</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">ProbPlot</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">ProbPlot</span><span class="p">):</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">ProbPlot</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
                       <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">data2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="qqline"><a class="viewcode-back" href="../../../generated/statsmodels.graphics.gofplots.qqline.html#statsmodels.graphics.gofplots.qqline">[docs]</a><span class="k">def</span> <span class="nf">qqline</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a reference line for a qqplot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axes instance</span>
<span class="sd">        The axes on which to plot the line</span>
<span class="sd">    line : str {&#39;45&#39;,&#39;r&#39;,&#39;s&#39;,&#39;q&#39;}</span>
<span class="sd">        Options for the reference line to which the data is compared.:</span>

<span class="sd">        - &#39;45&#39; - 45-degree line</span>
<span class="sd">        - &#39;s&#39;  - standardized line, the expected order statistics are scaled by</span>
<span class="sd">                 the standard deviation of the given sample and have the mean</span>
<span class="sd">                 added to them</span>
<span class="sd">        - &#39;r&#39;  - A regression line is fit</span>
<span class="sd">        - &#39;q&#39;  - A line is fit through the quartiles.</span>
<span class="sd">        - None - By default no reference line is added to the plot.</span>

<span class="sd">    x : array</span>
<span class="sd">        X data for plot. Not needed if line is &#39;45&#39;.</span>
<span class="sd">    y : array</span>
<span class="sd">        Y data for plot. Not needed if line is &#39;45&#39;.</span>
<span class="sd">    dist : scipy.stats.distribution</span>
<span class="sd">        A scipy.stats distribution, needed if line is &#39;q&#39;.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    There is no return value. The line is plotted on the given `ax`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Import the food expenditure dataset.  Plot annual food expendeture on x-axis</span>
<span class="sd">    and household income on y-axis.  Use qqline to add regression line into the</span>
<span class="sd">    plot.</span>

<span class="sd">    &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; from statsmodels.graphics.gofplots import qqline</span>

<span class="sd">    &gt;&gt;&gt; foodexp = sm.datasets.engel.load(as_pandas=False)</span>
<span class="sd">    &gt;&gt;&gt; x = foodexp.exog</span>
<span class="sd">    &gt;&gt;&gt; y = foodexp.endog</span>
<span class="sd">    &gt;&gt;&gt; ax = plt.subplot(111)</span>
<span class="sd">    &gt;&gt;&gt; plt.scatter(x, y)</span>
<span class="sd">    &gt;&gt;&gt; ax.set_xlabel(foodexp.exog_name[0])</span>
<span class="sd">    &gt;&gt;&gt; ax.set_ylabel(foodexp.endog_name)</span>
<span class="sd">    &gt;&gt;&gt; qqline(ax, &#39;r&#39;, x, y)</span>
<span class="sd">    &gt;&gt;&gt; plt.show()</span>

<span class="sd">    .. plot:: plots/graphics_gofplots_qqplot_qqline.py</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;45&#39;</span><span class="p">:</span>
        <span class="n">end_pts</span> <span class="o">=</span> <span class="n">lzip</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="n">end_pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end_pts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">end_pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">end_pts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">end_pts</span><span class="p">,</span> <span class="n">end_pts</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">end_pts</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">end_pts</span><span class="p">)</span>
        <span class="k">return</span> <span class="c1"># does this have any side effects?</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If line is not 45, x and y cannot be None.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
        <span class="c1"># could use ax.lines[0].get_xdata(), get_ydata(),</span>
        <span class="c1"># but don&#39;t know axes are &#39;clean&#39;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">fittedvalues</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
        <span class="n">m</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">ref_line</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ref_line</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="n">_check_for_ppf</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="n">q25</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">q75</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
        <span class="n">theoretical_quartiles</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">q75</span> <span class="o">-</span> <span class="n">q25</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">theoretical_quartiles</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">q25</span> <span class="o">-</span> <span class="n">m</span><span class="o">*</span><span class="n">theoretical_quartiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span></div>


<span class="c1"># about 10x faster than plotting_position in sandbox and mstats</span>
<span class="k">def</span> <span class="nf">plotting_pos</span><span class="p">(</span><span class="n">nobs</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates sequence of plotting positions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nobs : int</span>
<span class="sd">        Number of probability points to plot</span>
<span class="sd">    a : float</span>
<span class="sd">        Offset for the plotting position of an expected order statistic, for</span>
<span class="sd">        example.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    plotting_positions : array</span>
<span class="sd">        The plotting positions</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The plotting positions are given by (i - a)/(nobs - 2*a + 1) for i in</span>
<span class="sd">    range(0,nobs+1)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats.mstats.plotting_positions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">nobs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nobs</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_fmt_probplot_axis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">nobs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formats a theoretical quantile axis to display the corresponding</span>
<span class="sd">    probabilities on the quantiles&#39; scale.</span>

<span class="sd">    Parameteters</span>
<span class="sd">    ------------</span>
<span class="sd">    ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">        The axis to be formatted</span>
<span class="sd">    nobs : scalar</span>
<span class="sd">        Numbero of observations in the sample</span>
<span class="sd">    dist : scipy.stats.distribution</span>
<span class="sd">        A scipy.stats distribution sufficiently specified to impletment its</span>
<span class="sd">        ppf() method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    There is no return value. This operates on `ax` in place</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_check_for_ppf</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nobs</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="n">axis_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span>
                               <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="p">])</span> <span class="o">/</span> <span class="mf">100.0</span>
    <span class="k">elif</span> <span class="n">nobs</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="n">axis_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span>
                               <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">,</span> <span class="mf">99.8</span><span class="p">,</span>
                               <span class="mf">99.9</span><span class="p">])</span> <span class="o">/</span> <span class="mf">100.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axis_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
                               <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>
                               <span class="mf">99.5</span><span class="p">,</span> <span class="mf">99.8</span><span class="p">,</span> <span class="mf">99.9</span><span class="p">,</span> <span class="mf">99.95</span><span class="p">,</span> <span class="mf">99.98</span><span class="p">,</span> <span class="mf">99.99</span><span class="p">])</span> <span class="o">/</span> <span class="mf">100.0</span>
    <span class="n">axis_qntls</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">axis_probs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">axis_qntls</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">axis_probs</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                       <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">,</span>
                       <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                       <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">axis_qntls</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">axis_qntls</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>


<span class="k">def</span> <span class="nf">_do_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Boiler plate plotting function for the `ppplot`, `qqplot`, and</span>
<span class="sd">    `probplot` methods of the `ProbPlot` class</span>

<span class="sd">    Parameteters</span>
<span class="sd">    ------------</span>
<span class="sd">    x, y : array-like</span>
<span class="sd">        Data to be plotted</span>
<span class="sd">    dist : scipy.stats.distribution</span>
<span class="sd">        A scipy.stats distribution, needed if `line` is &#39;q&#39;.</span>
<span class="sd">    line : str {&#39;45&#39;, &#39;s&#39;, &#39;r&#39;, q&#39;} or None</span>
<span class="sd">        Options for the reference line to which the data is compared.</span>
<span class="sd">    ax : Matplotlib AxesSubplot instance, optional</span>
<span class="sd">        If given, this subplot is used to plot in instead of a new figure being</span>
<span class="sd">        created.</span>
<span class="sd">    fmt : str, optional</span>
<span class="sd">        matplotlib-compatible formatting string for the data markers</span>
<span class="sd">    kwargs : keywords</span>
<span class="sd">        These are passed to matplotlib.plot</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Matplotlib Figure instance</span>
<span class="sd">    ax : Matplotlib AxesSubplot instance (see Parameters)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">create_mpl_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xmargin</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;45&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> option for line not understood&quot;</span> <span class="o">%</span> <span class="n">line</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">qqline</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">_check_for_ppf</span><span class="p">(</span><span class="n">dist</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="s1">&#39;ppf&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;distribution must have a ppf method&quot;</span><span class="p">)</span>
</pre></div>




          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2018, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>