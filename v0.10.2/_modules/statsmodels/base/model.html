

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>statsmodels.base.model &#8212; statsmodels v0.10.2 documentation</title>
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/statsmodels_hybi_favico.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<link rel="stylesheet" href="../../../_static/examples.css" type="text/css" />
<link rel="stylesheet" href="../../../_static/facebox.css" type="text/css" />
<script type="text/javascript" src="../../../_static/scripts.js">
</script>
<script type="text/javascript" src="../../../_static/facebox.js">
</script>
<script type="text/javascript">
$.facebox.settings.closeImage = "../../../_static/closelabel.png"
$.facebox.settings.loadingImage = "../../../_static/loading.gif"
</script>

<script>
$(document).ready(function() {
  $.getJSON("../../../../versions.json", function(versions) {
    var dropdown = document.createElement("div");
    dropdown.className = "dropdown";
    var button = document.createElement("button");
    button.className = "dropbtn";
    button.innerHTML = "Other Versions";
    var content = document.createElement("div");
    content.className = "dropdown-content";
    dropdown.appendChild(button);
    dropdown.appendChild(content);
    $(".header").prepend(dropdown);
    for (var i = 0; i < versions.length; i++) {
      if (versions[i].substring(0, 1) == "v") {
        versions[i] = [versions[i], versions[i].substring(1)];
      } else {
        versions[i] = [versions[i], versions[i]];
      };
    };
    for (var i = 0; i < versions.length; i++) {
      var a = document.createElement("a");
      a.innerHTML = versions[i][1];
      a.href = "../../../../" + versions[i][0] + "/index.html";
      a.title = versions[i][1];
      $(".dropdown-content").append(a);
    };
  });
});
</script>


  </head><body>
<div class="headerwrap">
    <div class = "header">
        
        <a href = "../../../index.html">
<img src="../../../_static/statsmodels_hybi_banner.png" alt="Logo"
    style="padding-left: 15px"/></a>
        
    </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
<li><a href ="../../../install.html">Install</a></li> &nbsp;|&nbsp;
<li><a href="https://groups.google.com/forum/?hl=en#!forum/pystatsmodels">Support</a></li> &nbsp;|&nbsp;
<li><a href="https://github.com/statsmodels/statsmodels/issues">Bugs</a></li> &nbsp;|&nbsp;
<li><a href="../../../dev/index.html">Develop</a></li> &nbsp;|&nbsp;
<li><a href="../../../examples/index.html">Examples</a></li> &nbsp;|&nbsp;
<li><a href="../../../faq.html">FAQ</a></li> &nbsp;|&nbsp;

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> |</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            




  <h1>Source code for statsmodels.base.model</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">statsmodels.compat.python</span> <span class="k">import</span> <span class="n">lzip</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">statsmodels.base.data</span> <span class="k">import</span> <span class="n">handle_data</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.data</span> <span class="k">import</span> <span class="n">_is_using_pandas</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.tools</span> <span class="k">import</span> <span class="n">recipr</span><span class="p">,</span> <span class="n">nan_dot</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.contrast</span> <span class="k">import</span> <span class="p">(</span><span class="n">ContrastResults</span><span class="p">,</span> <span class="n">WaldTestResults</span><span class="p">,</span>
                                        <span class="n">t_test_pairwise</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.decorators</span> <span class="k">import</span> <span class="n">cache_readonly</span>
<span class="kn">import</span> <span class="nn">statsmodels.base.wrapper</span> <span class="k">as</span> <span class="nn">wrap</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.numdiff</span> <span class="k">import</span> <span class="n">approx_fprime</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.sm_exceptions</span> <span class="k">import</span> <span class="n">ValueWarning</span><span class="p">,</span> \
    <span class="n">HessianInversionWarning</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula</span> <span class="k">import</span> <span class="n">handle_formula_data</span>
<span class="kn">from</span> <span class="nn">statsmodels.base.optimizer</span> <span class="k">import</span> <span class="n">Optimizer</span>


<span class="n">_model_params_doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Parameters</span>
<span class="s2">    ----------</span>
<span class="s2">    endog : array-like</span>
<span class="s2">        1-d endogenous response variable. The dependent variable.</span>
<span class="s2">    exog : array-like</span>
<span class="s2">        A nobs x k array where `nobs` is the number of observations and `k`</span>
<span class="s2">        is the number of regressors. An intercept is not included by default</span>
<span class="s2">        and should be added by the user. See</span>
<span class="s2">        :func:`statsmodels.tools.add_constant`.&quot;&quot;&quot;</span>

<span class="n">_missing_param_doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">missing : str</span>
<span class="s2">        Available options are &#39;none&#39;, &#39;drop&#39;, and &#39;raise&#39;. If &#39;none&#39;, no nan</span>
<span class="s2">        checking is done. If &#39;drop&#39;, any observations with nans are dropped.</span>
<span class="s2">        If &#39;raise&#39;, an error is raised. Default is &#39;none.&#39;&quot;&quot;&quot;</span>
<span class="n">_extra_param_doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    hasconst : None or bool</span>
<span class="s2">        Indicates whether the RHS includes a user-supplied constant. If True,</span>
<span class="s2">        a constant is not checked for and k_constant is set to 1 and all</span>
<span class="s2">        result statistics are calculated as if a constant is present. If</span>
<span class="s2">        False, a constant is not checked for and k_constant is set to 0.</span>
<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Model.html#statsmodels.base.model.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    A (predictive) statistical model. Intended to be subclassed not used.</span>

<span class="s2">    </span><span class="si">%(params_doc)s</span><span class="s2"></span>
<span class="s2">    </span><span class="si">%(extra_params_doc)s</span><span class="s2"></span>

<span class="s2">    Attributes</span>
<span class="s2">    ----------</span>
<span class="s2">    exog_names</span>
<span class="s2">    endog_names</span>

<span class="s2">    Notes</span>
<span class="s2">    -----</span>
<span class="s2">    `endog` and `exog` are references to any data provided.  So if the data is</span>
<span class="s2">    already stored in numpy arrays and it is changed then `endog` and `exog`</span>
<span class="s2">    will change as well.</span>
<span class="s2">    &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;params_doc&#39;</span><span class="p">:</span> <span class="n">_model_params_doc</span><span class="p">,</span>
           <span class="s1">&#39;extra_params_doc&#39;</span><span class="p">:</span> <span class="n">_missing_param_doc</span> <span class="o">+</span> <span class="n">_extra_param_doc</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">hasconst</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hasconst&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_data</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">hasconst</span><span class="p">,</span>
                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_constant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">k_constant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">exog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">endog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_attr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_attr</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;exog&#39;</span><span class="p">,</span> <span class="s1">&#39;endog&#39;</span><span class="p">,</span> <span class="s1">&#39;data.exog&#39;</span><span class="p">,</span> <span class="s1">&#39;data.endog&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;formula&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># won&#39;t be able to unpickle without these</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_attr</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;data.orig_endog&#39;</span><span class="p">,</span> <span class="s1">&#39;data.orig_exog&#39;</span><span class="p">])</span>
        <span class="c1"># store keys for extras if we need to recreate model instance</span>
        <span class="c1"># we don&#39;t need &#39;missing&#39;, maybe we need &#39;hasconst&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">hasconst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;hasconst&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_init_kwds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return dictionary with extra keys used in model.__init__</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwds</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                     <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_keys</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">kwds</span>

    <span class="k">def</span> <span class="nf">_handle_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">hasconst</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">handle_data</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">hasconst</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># kwargs arrays could have changed, easier to just attach here</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;design_info&#39;</span><span class="p">,</span> <span class="s1">&#39;formula&#39;</span><span class="p">]:</span>  <span class="c1"># leave attached to data</span>
                <span class="k">continue</span>
            <span class="c1"># pop so we don&#39;t start keeping all these twice or references</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># panel already pops keys in data handling</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">data</span>

<div class="viewcode-block" id="Model.from_formula"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Model.from_formula.html#statsmodels.base.model.Model.from_formula">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_formula</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a Model from a formula and dataframe.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        formula : str or generic Formula object</span>
<span class="sd">            The formula specifying the model</span>
<span class="sd">        data : array-like</span>
<span class="sd">            The data for the model. See Notes.</span>
<span class="sd">        subset : array-like</span>
<span class="sd">            An array-like object of booleans, integers, or index values that</span>
<span class="sd">            indicate the subset of df to use in the model. Assumes df is a</span>
<span class="sd">            `pandas.DataFrame`</span>
<span class="sd">        drop_cols : array-like</span>
<span class="sd">            Columns to drop from the design matrix.  Cannot be used to</span>
<span class="sd">            drop terms involving categoricals.</span>
<span class="sd">        args : extra arguments</span>
<span class="sd">            These are passed to the model</span>
<span class="sd">        kwargs : extra keyword arguments</span>
<span class="sd">            These are passed to the model with one exception. The</span>
<span class="sd">            ``eval_env`` keyword is passed to patsy. It can be either a</span>
<span class="sd">            :class:`patsy:patsy.EvalEnvironment` object or an integer</span>
<span class="sd">            indicating the depth of the namespace to use. For example, the</span>
<span class="sd">            default ``eval_env=0`` uses the calling namespace. If you wish</span>
<span class="sd">            to use a &quot;clean&quot; environment set ``eval_env=-1``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        model : Model instance</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        data must define __getitem__ with the keys in the formula terms</span>
<span class="sd">        args and kwargs are passed on to the model instantiation. E.g.,</span>
<span class="sd">        a numpy structured or rec array, a dictionary, or a pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: provide a docs template for args/kwargs from child models</span>
        <span class="c1"># TODO: subset could use syntax. issue #469.</span>
        <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span>
        <span class="n">eval_env</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;eval_env&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eval_env</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eval_env</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">eval_env</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">patsy</span> <span class="k">import</span> <span class="n">EvalEnvironment</span>
            <span class="n">eval_env</span> <span class="o">=</span> <span class="n">EvalEnvironment</span><span class="p">({})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eval_env</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># we&#39;re going down the stack again</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="s1">&#39;drop&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">missing</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>  <span class="c1"># with patsy it&#39;s drop or raise. let&#39;s raise.</span>
            <span class="n">missing</span> <span class="o">=</span> <span class="s1">&#39;raise&#39;</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="n">handle_formula_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">formula</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">eval_env</span><span class="p">,</span>
                                  <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">)</span>
        <span class="p">((</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">),</span> <span class="n">missing_idx</span><span class="p">,</span> <span class="n">design_info</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span>

        <span class="k">if</span> <span class="n">drop_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">drop_cols</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">design_info</span><span class="o">.</span><span class="n">term_names</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">drop_cols</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>  <span class="c1"># OK if not present</span>
                <span class="n">design_info</span> <span class="o">=</span> <span class="n">design_info</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;missing_idx&#39;</span><span class="p">:</span> <span class="n">missing_idx</span><span class="p">,</span>
                       <span class="s1">&#39;missing&#39;</span><span class="p">:</span> <span class="n">missing</span><span class="p">,</span>
                       <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="n">formula</span><span class="p">,</span>  <span class="c1"># attach formula for unpckling</span>
                       <span class="s1">&#39;design_info&#39;</span><span class="p">:</span> <span class="n">design_info</span><span class="p">})</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">mod</span><span class="o">.</span><span class="n">formula</span> <span class="o">=</span> <span class="n">formula</span>

        <span class="c1"># since we got a dataframe, attach the original</span>
        <span class="n">mod</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">mod</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endog_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Names of endogenous variables&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ynames</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exog_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Names of exogenous variables&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">xnames</span>

<div class="viewcode-block" id="Model.fit"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Model.fit.html#statsmodels.base.model.Model.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit a model to data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Model.predict"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Model.predict.html#statsmodels.base.model.Model.predict">[docs]</a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        After a model has been fit predict returns the fitted values.</span>

<span class="sd">        This is a placeholder intended to be overwritten by individual models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="LikelihoodModel"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.html#statsmodels.base.model.LikelihoodModel">[docs]</a><span class="k">class</span> <span class="nc">LikelihoodModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Likelihood model is a subclass of Model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LikelihoodModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<div class="viewcode-block" id="LikelihoodModel.initialize"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.initialize.html#statsmodels.base.model.LikelihoodModel.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize (possibly re-initialize) a Model instance. For</span>
<span class="sd">        instance, the design matrix of a linear model may change</span>
<span class="sd">        and some things must be recomputed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1"># TODO: if the intent is to re-initialize the model with new data then this</span>
    <span class="c1"># method needs to take inputs...</span>

<div class="viewcode-block" id="LikelihoodModel.loglike"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.loglike.html#statsmodels.base.model.LikelihoodModel.loglike">[docs]</a>    <span class="k">def</span> <span class="nf">loglike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log-likelihood of model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="LikelihoodModel.score"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.score.html#statsmodels.base.model.LikelihoodModel.score">[docs]</a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Score vector of model.</span>

<span class="sd">        The gradient of logL with respect to each parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="LikelihoodModel.information"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.information.html#statsmodels.base.model.LikelihoodModel.information">[docs]</a>    <span class="k">def</span> <span class="nf">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fisher information matrix of model</span>

<span class="sd">        Returns -Hessian of loglike evaluated at params.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="LikelihoodModel.hessian"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.hessian.html#statsmodels.base.model.LikelihoodModel.hessian">[docs]</a>    <span class="k">def</span> <span class="nf">hessian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Hessian matrix of the model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="LikelihoodModel.fit"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModel.fit.html#statsmodels.base.model.LikelihoodModel.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;newton&#39;</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fargs</span><span class="o">=</span><span class="p">(),</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retall</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">skip_hessian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit method for likelihood based models</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start_params : array-like, optional</span>
<span class="sd">            Initial guess of the solution for the loglikelihood maximization.</span>
<span class="sd">            The default is an array of zeros.</span>
<span class="sd">        method : str, optional</span>
<span class="sd">            The `method` determines which solver from `scipy.optimize`</span>
<span class="sd">            is used, and it can be chosen from among the following strings:</span>

<span class="sd">            - &#39;newton&#39; for Newton-Raphson, &#39;nm&#39; for Nelder-Mead</span>
<span class="sd">            - &#39;bfgs&#39; for Broyden-Fletcher-Goldfarb-Shanno (BFGS)</span>
<span class="sd">            - &#39;lbfgs&#39; for limited-memory BFGS with optional box constraints</span>
<span class="sd">            - &#39;powell&#39; for modified Powell&#39;s method</span>
<span class="sd">            - &#39;cg&#39; for conjugate gradient</span>
<span class="sd">            - &#39;ncg&#39; for Newton-conjugate gradient</span>
<span class="sd">            - &#39;basinhopping&#39; for global basin-hopping solver</span>
<span class="sd">            - &#39;minimize&#39; for generic wrapper of scipy minimize (BFGS by default)</span>

<span class="sd">            The explicit arguments in `fit` are passed to the solver,</span>
<span class="sd">            with the exception of the basin-hopping solver. Each</span>
<span class="sd">            solver has several optional arguments that are not the same across</span>
<span class="sd">            solvers. See the notes section below (or scipy.optimize) for the</span>
<span class="sd">            available arguments and for the list of explicit arguments that the</span>
<span class="sd">            basin-hopping solver supports.</span>
<span class="sd">        maxiter : int, optional</span>
<span class="sd">            The maximum number of iterations to perform.</span>
<span class="sd">        full_output : bool, optional</span>
<span class="sd">            Set to True to have all available output in the Results object&#39;s</span>
<span class="sd">            mle_retvals attribute. The output is dependent on the solver.</span>
<span class="sd">            See LikelihoodModelResults notes section for more information.</span>
<span class="sd">        disp : bool, optional</span>
<span class="sd">            Set to True to print convergence messages.</span>
<span class="sd">        fargs : tuple, optional</span>
<span class="sd">            Extra arguments passed to the likelihood function, i.e.,</span>
<span class="sd">            loglike(x,*args)</span>
<span class="sd">        callback : callable callback(xk), optional</span>
<span class="sd">            Called after each iteration, as callback(xk), where xk is the</span>
<span class="sd">            current parameter vector.</span>
<span class="sd">        retall : bool, optional</span>
<span class="sd">            Set to True to return list of solutions at each iteration.</span>
<span class="sd">            Available in Results object&#39;s mle_retvals attribute.</span>
<span class="sd">        skip_hessian : bool, optional</span>
<span class="sd">            If False (default), then the negative inverse hessian is calculated</span>
<span class="sd">            after the optimization. If True, then the hessian will not be</span>
<span class="sd">            calculated. However, it will be available in methods that use the</span>
<span class="sd">            hessian in the optimization (currently only with `&quot;newton&quot;`).</span>
<span class="sd">        kwargs : keywords</span>
<span class="sd">            All kwargs are passed to the chosen solver with one exception. The</span>
<span class="sd">            following keyword controls what happens after the fit::</span>

<span class="sd">                warn_convergence : bool, optional</span>
<span class="sd">                    If True, checks the model for the converged flag. If the</span>
<span class="sd">                    converged flag is False, a ConvergenceWarning is issued.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The &#39;basinhopping&#39; solver ignores `maxiter`, `retall`, `full_output`</span>
<span class="sd">        explicit arguments.</span>

<span class="sd">        Optional arguments for solvers (see returned Results.mle_settings)::</span>

<span class="sd">            &#39;newton&#39;</span>
<span class="sd">                tol : float</span>
<span class="sd">                    Relative error in params acceptable for convergence.</span>
<span class="sd">            &#39;nm&#39; -- Nelder Mead</span>
<span class="sd">                xtol : float</span>
<span class="sd">                    Relative error in params acceptable for convergence</span>
<span class="sd">                ftol : float</span>
<span class="sd">                    Relative error in loglike(params) acceptable for</span>
<span class="sd">                    convergence</span>
<span class="sd">                maxfun : int</span>
<span class="sd">                    Maximum number of function evaluations to make.</span>
<span class="sd">            &#39;bfgs&#39;</span>
<span class="sd">                gtol : float</span>
<span class="sd">                    Stop when norm of gradient is less than gtol.</span>
<span class="sd">                norm : float</span>
<span class="sd">                    Order of norm (np.Inf is max, -np.Inf is min)</span>
<span class="sd">                epsilon</span>
<span class="sd">                    If fprime is approximated, use this value for the step</span>
<span class="sd">                    size. Only relevant if LikelihoodModel.score is None.</span>
<span class="sd">            &#39;lbfgs&#39;</span>
<span class="sd">                m : int</span>
<span class="sd">                    This many terms are used for the Hessian approximation.</span>
<span class="sd">                factr : float</span>
<span class="sd">                    A stop condition that is a variant of relative error.</span>
<span class="sd">                pgtol : float</span>
<span class="sd">                    A stop condition that uses the projected gradient.</span>
<span class="sd">                epsilon</span>
<span class="sd">                    If fprime is approximated, use this value for the step</span>
<span class="sd">                    size. Only relevant if LikelihoodModel.score is None.</span>
<span class="sd">                maxfun : int</span>
<span class="sd">                    Maximum number of function evaluations to make.</span>
<span class="sd">                bounds : sequence</span>
<span class="sd">                    (min, max) pairs for each element in x,</span>
<span class="sd">                    defining the bounds on that parameter.</span>
<span class="sd">                    Use None for one of min or max when there is no bound</span>
<span class="sd">                    in that direction.</span>
<span class="sd">            &#39;cg&#39;</span>
<span class="sd">                gtol : float</span>
<span class="sd">                    Stop when norm of gradient is less than gtol.</span>
<span class="sd">                norm : float</span>
<span class="sd">                    Order of norm (np.Inf is max, -np.Inf is min)</span>
<span class="sd">                epsilon : float</span>
<span class="sd">                    If fprime is approximated, use this value for the step</span>
<span class="sd">                    size. Can be scalar or vector.  Only relevant if</span>
<span class="sd">                    Likelihoodmodel.score is None.</span>
<span class="sd">            &#39;ncg&#39;</span>
<span class="sd">                fhess_p : callable f&#39;(x,*args)</span>
<span class="sd">                    Function which computes the Hessian of f times an arbitrary</span>
<span class="sd">                    vector, p.  Should only be supplied if</span>
<span class="sd">                    LikelihoodModel.hessian is None.</span>
<span class="sd">                avextol : float</span>
<span class="sd">                    Stop when the average relative error in the minimizer</span>
<span class="sd">                    falls below this amount.</span>
<span class="sd">                epsilon : float or ndarray</span>
<span class="sd">                    If fhess is approximated, use this value for the step size.</span>
<span class="sd">                    Only relevant if Likelihoodmodel.hessian is None.</span>
<span class="sd">            &#39;powell&#39;</span>
<span class="sd">                xtol : float</span>
<span class="sd">                    Line-search error tolerance</span>
<span class="sd">                ftol : float</span>
<span class="sd">                    Relative error in loglike(params) for acceptable for</span>
<span class="sd">                    convergence.</span>
<span class="sd">                maxfun : int</span>
<span class="sd">                    Maximum number of function evaluations to make.</span>
<span class="sd">                start_direc : ndarray</span>
<span class="sd">                    Initial direction set.</span>
<span class="sd">            &#39;basinhopping&#39;</span>
<span class="sd">                niter : integer</span>
<span class="sd">                    The number of basin hopping iterations.</span>
<span class="sd">                niter_success : integer</span>
<span class="sd">                    Stop the run if the global minimum candidate remains the</span>
<span class="sd">                    same for this number of iterations.</span>
<span class="sd">                T : float</span>
<span class="sd">                    The &quot;temperature&quot; parameter for the accept or reject</span>
<span class="sd">                    criterion. Higher &quot;temperatures&quot; mean that larger jumps</span>
<span class="sd">                    in function value will be accepted. For best results</span>
<span class="sd">                    `T` should be comparable to the separation (in function</span>
<span class="sd">                    value) between local minima.</span>
<span class="sd">                stepsize : float</span>
<span class="sd">                    Initial step size for use in the random displacement.</span>
<span class="sd">                interval : integer</span>
<span class="sd">                    The interval for how often to update the `stepsize`.</span>
<span class="sd">                minimizer : dict</span>
<span class="sd">                    Extra keyword arguments to be passed to the minimizer</span>
<span class="sd">                    `scipy.optimize.minimize()`, for example &#39;method&#39; - the</span>
<span class="sd">                    minimization method (e.g. &#39;L-BFGS-B&#39;), or &#39;tol&#39; - the</span>
<span class="sd">                    tolerance for termination. Other arguments are mapped from</span>
<span class="sd">                    explicit argument of `fit`:</span>
<span class="sd">                      - `args` &lt;- `fargs`</span>
<span class="sd">                      - `jac` &lt;- `score`</span>
<span class="sd">                      - `hess` &lt;- `hess`</span>
<span class="sd">            &#39;minimize&#39;</span>
<span class="sd">                min_method : str, optional</span>
<span class="sd">                    Name of minimization method to use.</span>
<span class="sd">                    Any method specific arguments can be passed directly.</span>
<span class="sd">                    For a list of methods and their arguments, see</span>
<span class="sd">                    documentation of `scipy.optimize.minimize`.</span>
<span class="sd">                    If no method is specified, then BFGS is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Hinv</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># JP error if full_output=0, Hinv not defined</span>

        <span class="k">if</span> <span class="n">start_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;start_params&#39;</span><span class="p">):</span>
                <span class="n">start_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_params</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># fails for shape (K,)?</span>
                <span class="n">start_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If exog is None, then start_params should &quot;</span>
                                 <span class="s2">&quot;be specified&quot;</span><span class="p">)</span>

        <span class="c1"># TODO: separate args from nonarg taking score and hessian, ie.,</span>
        <span class="c1"># user-supplied and numerically evaluated estimate frprime doesn&#39;t take</span>
        <span class="c1"># args in most (any?) of the optimize function</span>

        <span class="n">nobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># f = lambda params, *args: -self.loglike(params, *args) / nobs</span>

        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;newton&#39;</span><span class="p">:</span>
            <span class="c1"># TODO: why are score and hess positive?</span>
            <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span>

            <span class="k">def</span> <span class="nf">hess</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span>

            <span class="k">def</span> <span class="nf">hess</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span>

        <span class="n">warn_convergence</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;warn_convergence&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">Optimizer</span><span class="p">()</span>
        <span class="n">xopt</span><span class="p">,</span> <span class="n">retvals</span><span class="p">,</span> <span class="n">optim_settings</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">start_params</span><span class="p">,</span>
                                                       <span class="n">fargs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span>
                                                       <span class="n">hessian</span><span class="o">=</span><span class="n">hess</span><span class="p">,</span>
                                                       <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                                                       <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span>
                                                       <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
                                                       <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                                                       <span class="n">retall</span><span class="o">=</span><span class="n">retall</span><span class="p">,</span>
                                                       <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">)</span>

        <span class="c1"># NOTE: this is for fit_regularized and should be generalized</span>
        <span class="n">cov_params_func</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;cov_params_func&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cov_params_func</span><span class="p">:</span>
            <span class="n">Hinv</span> <span class="o">=</span> <span class="n">cov_params_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">retvals</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;newton&#39;</span> <span class="ow">and</span> <span class="n">full_output</span><span class="p">:</span>
            <span class="n">Hinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="o">-</span><span class="n">retvals</span><span class="p">[</span><span class="s1">&#39;Hessian&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">nobs</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">skip_hessian</span><span class="p">:</span>
            <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">xopt</span><span class="p">)</span>
            <span class="n">invertible</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">H</span><span class="p">)):</span>
                <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invertible</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">invertible</span><span class="p">:</span>
                <span class="n">Hinv</span> <span class="o">=</span> <span class="n">eigvecs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">eigvals</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">eigvecs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="n">Hinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">((</span><span class="n">Hinv</span> <span class="o">+</span> <span class="n">Hinv</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span>
                <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Inverting hessian failed, no bse or cov_params &#39;</span>
                     <span class="s1">&#39;available&#39;</span><span class="p">,</span> <span class="n">HessianInversionWarning</span><span class="p">)</span>
                <span class="n">Hinv</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s1">&#39;cov_type&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">cov_kwds</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cov_kwds&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cov_type&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cov_type&#39;</span><span class="p">],</span> <span class="s1">&#39;cov_kwds&#39;</span><span class="p">:</span> <span class="n">cov_kwds</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kwds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s1">&#39;use_t&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwds</span><span class="p">[</span><span class="s1">&#39;use_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_t&#39;</span><span class="p">]</span>
        <span class="c1"># TODO: add Hessian approximation and change the above if needed</span>
        <span class="n">mlefit</span> <span class="o">=</span> <span class="n">LikelihoodModelResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xopt</span><span class="p">,</span> <span class="n">Hinv</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="c1"># TODO: hardcode scale?</span>
        <span class="n">mlefit</span><span class="o">.</span><span class="n">mle_retvals</span> <span class="o">=</span> <span class="n">retvals</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">retvals</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">warn_convergence</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">retvals</span><span class="p">[</span><span class="s1">&#39;converged&#39;</span><span class="p">]:</span>
                <span class="kn">from</span> <span class="nn">warnings</span> <span class="k">import</span> <span class="n">warn</span>
                <span class="kn">from</span> <span class="nn">statsmodels.tools.sm_exceptions</span> <span class="k">import</span> <span class="n">ConvergenceWarning</span>
                <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Maximum Likelihood optimization failed to converge. &quot;</span>
                     <span class="s2">&quot;Check mle_retvals&quot;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>

        <span class="n">mlefit</span><span class="o">.</span><span class="n">mle_settings</span> <span class="o">=</span> <span class="n">optim_settings</span>
        <span class="k">return</span> <span class="n">mlefit</span></div>

    <span class="k">def</span> <span class="nf">_fit_zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">return_auxiliary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">k_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;experimental, fit the model subject to zero constraints</span>

<span class="sd">        Intended for internal use cases until we know what we need.</span>
<span class="sd">        API will need to change to handle models with two exog.</span>
<span class="sd">        This is not yet supported by all model subclasses.</span>

<span class="sd">        This is essentially a simplified version of `fit_constrained`, and</span>
<span class="sd">        does not need to use `offset`.</span>

<span class="sd">        The estimation creates a new model with transformed design matrix,</span>
<span class="sd">        exog, and converts the results back to the original parameterization.</span>

<span class="sd">        Some subclasses could use a more efficient calculation than using a</span>
<span class="sd">        new model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keep_index : array_like (int or bool) or slice</span>
<span class="sd">            variables that should be dropped.</span>
<span class="sd">        start_params : None or array_like</span>
<span class="sd">            starting values for the optimization. `start_params` needs to be</span>
<span class="sd">            given in the original parameter space and are internally</span>
<span class="sd">            transformed.</span>
<span class="sd">        k_params : int or None</span>
<span class="sd">            If None, then we try to infer from start_params or model.</span>
<span class="sd">        **fit_kwds : keyword arguments</span>
<span class="sd">            fit_kwds are used in the optimization of the transformed model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        results : Results instance</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we need to append index of extra params to keep_index as in</span>
        <span class="c1"># NegativeBinomial</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;k_extra&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_extra</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># we cannot change the original, TODO: should we add keep_index_params?</span>
            <span class="n">keep_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">keep_index</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">extra_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_extra</span><span class="p">)</span>
            <span class="n">keep_index_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">keep_index</span><span class="p">,</span> <span class="n">extra_index</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keep_index_p</span> <span class="o">=</span> <span class="n">keep_index</span>

        <span class="c1"># not all models support start_params, drop if None, hide them in fit_kwds</span>
        <span class="k">if</span> <span class="n">start_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fit_kwds</span><span class="p">[</span><span class="s1">&#39;start_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_params</span><span class="p">[</span><span class="n">keep_index_p</span><span class="p">]</span>
            <span class="n">k_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_params</span><span class="p">)</span>
            <span class="c1"># ignore k_params in this case, or verify consisteny?</span>

        <span class="c1"># build auxiliary model and fit</span>
        <span class="n">init_kwds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_init_kwds</span><span class="p">()</span>
        <span class="n">mod_constr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endog</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="p">[:,</span> <span class="n">keep_index</span><span class="p">],</span>
                                    <span class="o">**</span><span class="n">init_kwds</span><span class="p">)</span>
        <span class="n">res_constr</span> <span class="o">=</span> <span class="n">mod_constr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">**</span><span class="n">fit_kwds</span><span class="p">)</span>
        <span class="c1"># switch name, only need keep_index for params below</span>
        <span class="n">keep_index</span> <span class="o">=</span> <span class="n">keep_index_p</span>

        <span class="k">if</span> <span class="n">k_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">k_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">k_params</span> <span class="o">+=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;k_extra&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">params_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k_params</span><span class="p">)</span>
        <span class="n">params_full</span><span class="p">[</span><span class="n">keep_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">params</span>

        <span class="c1"># create dummy results Instance, TODO: wire up properly</span>
        <span class="c1"># TODO: this could be moved into separate private method if needed</span>
        <span class="c1"># discrete L1 fit_regularized doens&#39;t reestimate AFAICS</span>
        <span class="c1"># RLM doesn&#39;t have method, disp nor warn_convergence keywords</span>
        <span class="c1"># OLS, WLS swallows extra kwds with **kwargs, but doesn&#39;t have method=&#39;nm&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Note: addding full_output=False causes exceptions</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span> <span class="n">skip_hessian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">warn_convergence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_params</span><span class="o">=</span><span class="n">params_full</span><span class="p">)</span>
            <span class="c1"># we get a wrapper back</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

        <span class="c1"># Warning: make sure we are not just changing the wrapper instead of</span>
        <span class="c1"># results #2400</span>
        <span class="c1"># TODO: do we need to change res._results.scale in some models?</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_constr</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">):</span>
            <span class="c1"># Note: res.model is self</span>
            <span class="c1"># GLM problem, see #2399,</span>
            <span class="c1"># TODO: remove from model if not needed anymore</span>
            <span class="n">res</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">scale</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_constr</span><span class="p">,</span> <span class="s1">&#39;mle_retvals&#39;</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">mle_retvals</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">mle_retvals</span>
            <span class="c1"># not available for not scipy optimization, e.g. glm irls</span>
            <span class="c1"># TODO: what retvals should be required?</span>
            <span class="c1"># res.mle_retvals[&#39;fcall&#39;] = res_constr.mle_retvals.get(&#39;fcall&#39;, np.nan)</span>
            <span class="c1"># res.mle_retvals[&#39;iterations&#39;] = res_constr.mle_retvals.get(</span>
            <span class="c1">#                                                 &#39;iterations&#39;, np.nan)</span>
            <span class="c1"># res.mle_retvals[&#39;converged&#39;] = res_constr.mle_retvals[&#39;converged&#39;]</span>
        <span class="c1"># overwrite all mle_settings</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_constr</span><span class="p">,</span> <span class="s1">&#39;mle_settings&#39;</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">mle_settings</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">mle_settings</span>

        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params_full</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s1">&#39;normalized_cov_params&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k_params</span><span class="p">,</span> <span class="n">k_params</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">normalized_cov_params</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># fancy indexing requires integer array</span>
        <span class="n">keep_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">keep_index</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">normalized_cov_params</span><span class="p">[</span><span class="n">keep_index</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">keep_index</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">res_constr</span><span class="o">.</span><span class="n">normalized_cov_params</span>
        <span class="n">k_constr</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">df_resid</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_constr</span><span class="p">,</span> <span class="s1">&#39;cov_params_default&#39;</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">cov_params_default</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k_params</span><span class="p">,</span> <span class="n">k_params</span><span class="p">))</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">cov_params_default</span><span class="p">[</span><span class="n">keep_index</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">keep_index</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">res_constr</span><span class="o">.</span><span class="n">cov_params_default</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_constr</span><span class="p">,</span> <span class="s1">&#39;cov_type&#39;</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">cov_type</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">cov_type</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">cov_kwds</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">cov_kwds</span>

        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">keep_index</span> <span class="o">=</span> <span class="n">keep_index</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">df_resid</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">df_model</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">df_model</span>

        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">k_constr</span> <span class="o">=</span> <span class="n">k_constr</span>
        <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">results_constrained</span> <span class="o">=</span> <span class="n">res_constr</span>

        <span class="c1"># special temporary workaround for RLM</span>
        <span class="c1"># need to be able to override robust covariances</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;resid&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;fittedvalues&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;sresid&#39;</span><span class="p">]</span>
            <span class="n">cov</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="s1">&#39;bcov_scaled&#39;</span><span class="p">]</span>
            <span class="c1"># inplace adjustment</span>
            <span class="n">cov</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">cov</span><span class="p">[</span><span class="n">keep_index</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">keep_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_constr</span><span class="o">.</span><span class="n">bcov_scaled</span>
            <span class="n">res</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">cov_params_default</span> <span class="o">=</span> <span class="n">cov</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">_fit_collinear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;experimental, fit of the model without collinear variables</span>

<span class="sd">        This currently uses QR to drop variables based on the given</span>
<span class="sd">        sequence.</span>
<span class="sd">        Options will be added in future, when the supporting functions</span>
<span class="sd">        to identify collinear variables become available.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># ------ copied from PR #2380 remove when merged</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="n">atol</span> <span class="o">+</span> <span class="n">rtol</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">diagonal</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>
        <span class="c1"># TODO add to results instance</span>
        <span class="c1"># idx_collinear = np.where(mask)[0]</span>
        <span class="n">idx_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_zeros</span><span class="p">(</span><span class="n">keep_index</span><span class="o">=</span><span class="n">idx_keep</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span></div>


<span class="c1"># TODO: the below is unfinished</span>
<div class="viewcode-block" id="GenericLikelihoodModel"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.html#statsmodels.base.model.GenericLikelihoodModel">[docs]</a><span class="k">class</span> <span class="nc">GenericLikelihoodModel</span><span class="p">(</span><span class="n">LikelihoodModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows the fitting of any likelihood function via maximum likelihood.</span>

<span class="sd">    A subclass needs to specify at least the log-likelihood</span>
<span class="sd">    If the log-likelihood is specified for each observation, then results that</span>
<span class="sd">    require the Jacobian will be available. (The other case is not tested yet.)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Optimization methods that require only a likelihood function are &#39;nm&#39; and</span>
<span class="sd">    &#39;powell&#39;</span>

<span class="sd">    Optimization methods that require a likelihood function and a</span>
<span class="sd">    score/gradient are &#39;bfgs&#39;, &#39;cg&#39;, and &#39;ncg&#39;. A function to compute the</span>
<span class="sd">    Hessian is optional for &#39;ncg&#39;.</span>

<span class="sd">    Optimization method that require a likelihood function, a score/gradient,</span>
<span class="sd">    and a Hessian is &#39;newton&#39;</span>

<span class="sd">    If they are not overwritten by a subclass, then numerical gradient,</span>
<span class="sd">    Jacobian and Hessian of the log-likelihood are caclulated by numerical</span>
<span class="sd">    forward differentiation. This might results in some cases in precision</span>
<span class="sd">    problems, and the Hessian might not be positive definite. Even if the</span>
<span class="sd">    Hessian is not positive definite the covariance matrix of the parameter</span>
<span class="sd">    estimates based on the outer product of the Jacobian might still be valid.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    see also subclasses in directory miscmodels</span>

<span class="sd">    import statsmodels.api as sm</span>
<span class="sd">    data = sm.datasets.spector.load(as_pandas=False)</span>
<span class="sd">    data.exog = sm.add_constant(data.exog)</span>
<span class="sd">    # in this dir</span>
<span class="sd">    from model import GenericLikelihoodModel</span>
<span class="sd">    probit_mod = sm.Probit(data.endog, data.exog)</span>
<span class="sd">    probit_res = probit_mod.fit()</span>
<span class="sd">    loglike = probit_mod.loglike</span>
<span class="sd">    score = probit_mod.score</span>
<span class="sd">    mod = GenericLikelihoodModel(data.endog, data.exog, loglike, score)</span>
<span class="sd">    res = mod.fit(method=&quot;nm&quot;, maxiter = 500)</span>
<span class="sd">    import numpy as np</span>
<span class="sd">    np.allclose(res.params, probit_res.params)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loglike</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">hessian</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">extra_params_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="c1"># let them be none in case user wants to use inheritance</span>
        <span class="k">if</span> <span class="n">loglike</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loglike</span> <span class="o">=</span> <span class="n">loglike</span>
        <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">score</span>
        <span class="k">if</span> <span class="n">hessian</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hessian</span> <span class="o">=</span> <span class="n">hessian</span>

        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds</span><span class="p">)</span>

        <span class="c1"># TODO: data structures?</span>

        <span class="c1"># TODO temporary solution, force approx normal</span>
        <span class="c1"># self.df_model = 9999</span>
        <span class="c1"># somewhere: CacheWriteWarning: &#39;df_model&#39; cannot be overwritten</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GenericLikelihoodModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span>
                                                     <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">)</span>

        <span class="c1"># this won&#39;t work for ru2nmnl, maybe np.ndim of a dict?</span>
        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nparams</span> <span class="o">=</span> <span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">extra_params_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_extra_params_names</span><span class="p">(</span><span class="n">extra_params_names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_extra_params_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra_params_names</span><span class="p">):</span>
        <span class="c1"># check param_names</span>
        <span class="k">if</span> <span class="n">extra_params_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exog_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extra_params_names</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">xnames</span> <span class="o">=</span> <span class="n">extra_params_names</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nparams</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names</span><span class="p">)</span>

    <span class="c1"># this is redundant and not used when subclassing</span>
<div class="viewcode-block" id="GenericLikelihoodModel.initialize"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.initialize.html#statsmodels.base.model.GenericLikelihoodModel.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize (possibly re-initialize) a Model instance. For</span>
<span class="sd">        instance, the design matrix of a linear model may change</span>
<span class="sd">        and some things must be recomputed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">:</span>  <span class="c1"># right now score is not optional</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">approx_fprime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglike</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c1"># can use approx_hess_p if we have a gradient</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessian</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="c1"># Initialize is called by</span>
        <span class="c1"># statsmodels.model.LikelihoodModel.__init__</span>
        <span class="c1"># and should contain any preprocessing that needs to be done for a model</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># assume constant</span>
            <span class="n">er</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">er</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">er</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GenericLikelihoodModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.expandparams"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.expandparams.html#statsmodels.base.model.GenericLikelihoodModel.expandparams">[docs]</a>    <span class="k">def</span> <span class="nf">expandparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        expand to full parameter array when some parameters are fixed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : array</span>
<span class="sd">            reduced parameter array</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        paramsfull : array</span>
<span class="sd">            expanded parameter array where fixed parameters are included</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Calling this requires that self.fixed_params and self.fixed_paramsmask</span>
<span class="sd">        are defined.</span>

<span class="sd">        *developer notes:*</span>

<span class="sd">        This can be used in the log-likelihood to ...</span>

<span class="sd">        this could also be replaced by a more general parameter</span>
<span class="sd">        transformation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paramsfull</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">paramsfull</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_paramsmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">return</span> <span class="n">paramsfull</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.reduceparams"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.reduceparams.html#statsmodels.base.model.GenericLikelihoodModel.reduceparams">[docs]</a>    <span class="k">def</span> <span class="nf">reduceparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reduce parameters&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">params</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_paramsmask</span><span class="p">]</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.loglike"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.loglike.html#statsmodels.base.model.GenericLikelihoodModel.loglike">[docs]</a>    <span class="k">def</span> <span class="nf">loglike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log-likelihood of model at params&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglikeobs</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.nloglike"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.nloglike.html#statsmodels.base.model.GenericLikelihoodModel.nloglike">[docs]</a>    <span class="k">def</span> <span class="nf">nloglike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Negative log-likelihood of model at params&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">loglikeobs</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.loglikeobs"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.loglikeobs.html#statsmodels.base.model.GenericLikelihoodModel.loglikeobs">[docs]</a>    <span class="k">def</span> <span class="nf">loglikeobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log-likelihood of individual observations at params&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nloglikeobs</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.score"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.score.html#statsmodels.base.model.GenericLikelihoodModel.score">[docs]</a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gradient of log-likelihood evaluated at params</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">approx_fprime</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglike</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.score_obs"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.score_obs.html#statsmodels.base.model.GenericLikelihoodModel.score_obs">[docs]</a>    <span class="k">def</span> <span class="nf">score_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Jacobian/Gradient of log-likelihood evaluated at params for each</span>
<span class="sd">        observation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># kwds.setdefault(&#39;epsilon&#39;, 1e-4)</span>
        <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">approx_fprime</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglikeobs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.hessian"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.hessian.html#statsmodels.base.model.GenericLikelihoodModel.hessian">[docs]</a>    <span class="k">def</span> <span class="nf">hessian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hessian of log-likelihood evaluated at params</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">statsmodels.tools.numdiff</span> <span class="k">import</span> <span class="n">approx_hess</span>
        <span class="c1"># need options for hess (epsilon)</span>
        <span class="k">return</span> <span class="n">approx_hess</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglike</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.hessian_factor"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.hessian_factor.html#statsmodels.base.model.GenericLikelihoodModel.hessian_factor">[docs]</a>    <span class="k">def</span> <span class="nf">hessian_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Weights for calculating Hessian</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : ndarray</span>
<span class="sd">            parameter at which Hessian is evaluated</span>
<span class="sd">        scale : None or float</span>
<span class="sd">            If scale is None, then the default scale will be calculated.</span>
<span class="sd">            Default scale is defined by `self.scaletype` and set in fit.</span>
<span class="sd">            If scale is not None, then it is used as a fixed scale.</span>
<span class="sd">        observed : bool</span>
<span class="sd">            If True, then the observed Hessian is returned. If false then the</span>
<span class="sd">            expected information matrix is returned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hessian_factor : ndarray, 1d</span>
<span class="sd">            A 1d weight vector used in the calculation of the Hessian.</span>
<span class="sd">            The hessian is obtained by `(exog.T * hessian_factor).dot(exog)`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="GenericLikelihoodModel.fit"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModel.fit.html#statsmodels.base.model.GenericLikelihoodModel.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">disp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retall</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit the model using maximum likelihood.</span>

<span class="sd">        The rest of the docstring is from</span>
<span class="sd">        statsmodels.LikelihoodModel.fit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;start_params&#39;</span><span class="p">):</span>
                <span class="n">start_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_params</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">start_params</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nparams</span><span class="p">)</span>

        <span class="n">fit_method</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">GenericLikelihoodModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span>
        <span class="n">mlefit</span> <span class="o">=</span> <span class="n">fit_method</span><span class="p">(</span><span class="n">start_params</span><span class="o">=</span><span class="n">start_params</span><span class="p">,</span>
                            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
                            <span class="n">full_output</span><span class="o">=</span><span class="n">full_output</span><span class="p">,</span>
                            <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">genericmlefit</span> <span class="o">=</span> <span class="n">GenericLikelihoodModelResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mlefit</span><span class="p">)</span>

        <span class="c1"># amend param names</span>
        <span class="n">exog_names</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names</span>
        <span class="n">k_miss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">mlefit</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">k_miss</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k_miss</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_extra_params_names</span><span class="p">([</span><span class="s1">&#39;par</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span>
                                              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">k_miss</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># I don&#39;t want to raise after we have already fit()</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;more exog_names than parameters&#39;</span><span class="p">,</span> <span class="n">ValueWarning</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">genericmlefit</span></div></div>
    <span class="c1"># fit.__doc__ += LikelihoodModel.fit.__doc__</span>


<div class="viewcode-block" id="Results"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Results.html#statsmodels.base.model.Results">[docs]</a><span class="k">class</span> <span class="nc">Results</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to contain model results</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : class instance</span>
<span class="sd">        the previously specified model instance</span>
<span class="sd">    params : array</span>
<span class="sd">        parameter estimates from the fit model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwd</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_attr</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="Results.initialize"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Results.initialize.html#statsmodels.base.model.Results.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize (possibly re-initialize) a Results instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;k_constant&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_constant</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">k_constant</span></div>

<div class="viewcode-block" id="Results.predict"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Results.predict.html#statsmodels.base.model.Results.predict">[docs]</a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call self.model.predict with self.params as the first argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exog : array-like, optional</span>
<span class="sd">            The values for which you want to predict. see Notes below.</span>
<span class="sd">        transform : bool, optional</span>
<span class="sd">            If the model was fit via a formula, do you want to pass</span>
<span class="sd">            exog through the formula. Default is True. E.g., if you fit</span>
<span class="sd">            a model y ~ log(x1) + log(x2), and transform is True, then</span>
<span class="sd">            you can pass a data structure that contains x1 and x2 in</span>
<span class="sd">            their original form. Otherwise, you&#39;d need to log the data</span>
<span class="sd">            first.</span>
<span class="sd">        args, kwargs :</span>
<span class="sd">            Some models can take additional arguments or keywords, see the</span>
<span class="sd">            predict method of the model for the details.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        prediction : ndarray, pandas.Series or pandas.DataFrame</span>
<span class="sd">            See self.model.predict</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The types of exog that are supported depends on whether a formula</span>
<span class="sd">        was used in the specification of the model.</span>

<span class="sd">        If a formula was used, then exog is processed in the same way as</span>
<span class="sd">        the original data. This transformation needs to have key access to the</span>
<span class="sd">        same variable names, and can be a pandas DataFrame or a dict like</span>
<span class="sd">        object that contains numpy arrays.</span>

<span class="sd">        If no formula was used, then the provided exog needs to have the</span>
<span class="sd">        same number of columns as the original exog in the model. No</span>
<span class="sd">        transformation of the data is performed except converting it to</span>
<span class="sd">        a numpy array.</span>

<span class="sd">        Row indices as in pandas data frames are supported, and added to the</span>
<span class="sd">        returned prediction.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="n">is_pandas</span> <span class="o">=</span> <span class="n">_is_using_pandas</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">exog_index</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">is_pandas</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">transform</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;formula&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">design_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">design_info</span>
            <span class="kn">from</span> <span class="nn">patsy</span> <span class="k">import</span> <span class="n">dmatrix</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="c1"># we are guessing whether it should be column or row</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="n">exog</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">design_info</span><span class="o">.</span><span class="n">describe</span><span class="p">()):</span>
                    <span class="c1"># assume we need one column</span>
                    <span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># assume we need a row</span>
                    <span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="n">orig_exog_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
            <span class="n">is_dict</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exog</span> <span class="o">=</span> <span class="n">dmatrix</span><span class="p">(</span><span class="n">design_info</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;dataframe&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;predict requires that you use a DataFrame when &#39;</span>
                       <span class="s1">&#39;predicting from a model</span><span class="se">\n</span><span class="s1">that was created using the &#39;</span>
                       <span class="s1">&#39;formula api.&#39;</span>
                       <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">The original error message returned by patsy is:</span><span class="se">\n</span><span class="s1">&#39;</span>
                       <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))))</span>
                <span class="k">raise</span> <span class="n">exc</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">orig_exog_len</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_dict</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="k">if</span> <span class="n">exog_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;nan values have been dropped&#39;</span><span class="p">,</span> <span class="n">ValueWarning</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">exog_index</span><span class="p">)</span>
            <span class="n">exog_index</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>

        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">exog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>  <span class="c1"># needed in count model shape[1]</span>

        <span class="n">predict_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exog_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">predict_results</span><span class="p">,</span>
                                                  <span class="s1">&#39;predicted_values&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">predict_results</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">predict_results</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">exog_index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predict_results</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">exog_index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">predict_results</span></div>

<div class="viewcode-block" id="Results.summary"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.Results.summary.html#statsmodels.base.model.Results.summary">[docs]</a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Summary</span>

<span class="sd">        Not implemented</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<span class="c1"># TODO: public method?</span>
<div class="viewcode-block" id="LikelihoodModelResults"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.html#statsmodels.base.model.LikelihoodModelResults">[docs]</a><span class="k">class</span> <span class="nc">LikelihoodModelResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to contain results from likelihood models</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : LikelihoodModel instance or subclass instance</span>
<span class="sd">        LikelihoodModelResults holds a reference to the model that is fit.</span>
<span class="sd">    params : 1d array_like</span>
<span class="sd">        parameter estimates from estimated model</span>
<span class="sd">    normalized_cov_params : 2d array</span>
<span class="sd">       Normalized (before scaling) covariance of params. (dot(X.T,X))**-1</span>
<span class="sd">    scale : float</span>
<span class="sd">        For (some subset of models) scale will typically be the</span>
<span class="sd">        mean square error from the estimated model (sigma^2)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    mle_retvals : dict</span>
<span class="sd">        Contains the values returned from the chosen optimization method if</span>
<span class="sd">        full_output is True during the fit.  Available only if the model</span>
<span class="sd">        is fit by maximum likelihood.  See notes below for the output from</span>
<span class="sd">        the different methods.</span>
<span class="sd">    mle_settings : dict</span>
<span class="sd">        Contains the arguments passed to the chosen optimization method.</span>
<span class="sd">        Available if the model is fit by maximum likelihood.  See</span>
<span class="sd">        LikelihoodModel.fit for more information.</span>
<span class="sd">    model : model instance</span>
<span class="sd">        LikelihoodResults contains a reference to the model that is fit.</span>
<span class="sd">    params : ndarray</span>
<span class="sd">        The parameters estimated for the model.</span>
<span class="sd">    scale : float</span>
<span class="sd">        The scaling factor of the model given during instantiation.</span>
<span class="sd">    tvalues : array</span>
<span class="sd">        The t-values of the standard errors.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The covariance of params is given by scale times normalized_cov_params.</span>

<span class="sd">    Return values by solver if full_output is True during fit:</span>

<span class="sd">        &#39;newton&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                The value of the (negative) loglikelihood at its</span>
<span class="sd">                minimum.</span>
<span class="sd">            iterations : int</span>
<span class="sd">                Number of iterations performed.</span>
<span class="sd">            score : ndarray</span>
<span class="sd">                The score vector at the optimum.</span>
<span class="sd">            Hessian : ndarray</span>
<span class="sd">                The Hessian at the optimum.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                1 if maxiter is exceeded. 0 if successful convergence.</span>
<span class="sd">            converged : bool</span>
<span class="sd">                True: converged. False: did not converge.</span>
<span class="sd">            allvecs : list</span>
<span class="sd">                List of solutions at each iteration.</span>
<span class="sd">        &#39;nm&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                The value of the (negative) loglikelihood at its</span>
<span class="sd">                minimum.</span>
<span class="sd">            iterations : int</span>
<span class="sd">                Number of iterations performed.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                1: Maximum number of function evaluations made.</span>
<span class="sd">                2: Maximum number of iterations reached.</span>
<span class="sd">            converged : bool</span>
<span class="sd">                True: converged. False: did not converge.</span>
<span class="sd">            allvecs : list</span>
<span class="sd">                List of solutions at each iteration.</span>
<span class="sd">        &#39;bfgs&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                Value of the (negative) loglikelihood at its minimum.</span>
<span class="sd">            gopt : float</span>
<span class="sd">                Value of gradient at minimum, which should be near 0.</span>
<span class="sd">            Hinv : ndarray</span>
<span class="sd">                value of the inverse Hessian matrix at minimum.  Note</span>
<span class="sd">                that this is just an approximation and will often be</span>
<span class="sd">                different from the value of the analytic Hessian.</span>
<span class="sd">            fcalls : int</span>
<span class="sd">                Number of calls to loglike.</span>
<span class="sd">            gcalls : int</span>
<span class="sd">                Number of calls to gradient/score.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                1: Maximum number of iterations exceeded. 2: Gradient</span>
<span class="sd">                and/or function calls are not changing.</span>
<span class="sd">            converged : bool</span>
<span class="sd">                True: converged.  False: did not converge.</span>
<span class="sd">            allvecs : list</span>
<span class="sd">                Results at each iteration.</span>
<span class="sd">        &#39;lbfgs&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                Value of the (negative) loglikelihood at its minimum.</span>
<span class="sd">            gopt : float</span>
<span class="sd">                Value of gradient at minimum, which should be near 0.</span>
<span class="sd">            fcalls : int</span>
<span class="sd">                Number of calls to loglike.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                Warning flag:</span>

<span class="sd">                - 0 if converged</span>
<span class="sd">                - 1 if too many function evaluations or too many iterations</span>
<span class="sd">                - 2 if stopped for another reason</span>

<span class="sd">            converged : bool</span>
<span class="sd">                True: converged.  False: did not converge.</span>
<span class="sd">        &#39;powell&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                Value of the (negative) loglikelihood at its minimum.</span>
<span class="sd">            direc : ndarray</span>
<span class="sd">                Current direction set.</span>
<span class="sd">            iterations : int</span>
<span class="sd">                Number of iterations performed.</span>
<span class="sd">            fcalls : int</span>
<span class="sd">                Number of calls to loglike.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                1: Maximum number of function evaluations. 2: Maximum number</span>
<span class="sd">                of iterations.</span>
<span class="sd">            converged : bool</span>
<span class="sd">                True : converged. False: did not converge.</span>
<span class="sd">            allvecs : list</span>
<span class="sd">                Results at each iteration.</span>
<span class="sd">        &#39;cg&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                Value of the (negative) loglikelihood at its minimum.</span>
<span class="sd">            fcalls : int</span>
<span class="sd">                Number of calls to loglike.</span>
<span class="sd">            gcalls : int</span>
<span class="sd">                Number of calls to gradient/score.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                1: Maximum number of iterations exceeded. 2: Gradient and/</span>
<span class="sd">                or function calls not changing.</span>
<span class="sd">            converged : bool</span>
<span class="sd">                True: converged. False: did not converge.</span>
<span class="sd">            allvecs : list</span>
<span class="sd">                Results at each iteration.</span>
<span class="sd">        &#39;ncg&#39;</span>
<span class="sd">            fopt : float</span>
<span class="sd">                Value of the (negative) loglikelihood at its minimum.</span>
<span class="sd">            fcalls : int</span>
<span class="sd">                Number of calls to loglike.</span>
<span class="sd">            gcalls : int</span>
<span class="sd">                Number of calls to gradient/score.</span>
<span class="sd">            hcalls : int</span>
<span class="sd">                Number of calls to hessian.</span>
<span class="sd">            warnflag : int</span>
<span class="sd">                1: Maximum number of iterations exceeded.</span>
<span class="sd">            converged : bool</span>
<span class="sd">                True: converged. False: did not converge.</span>
<span class="sd">            allvecs : list</span>
<span class="sd">                Results at each iteration.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="c1"># by default we use normal distribution</span>
    <span class="c1"># can be overwritten by instances or subclasses</span>
    <span class="n">use_t</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">normalized_cov_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LikelihoodModelResults</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="o">=</span> <span class="n">normalized_cov_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

        <span class="c1"># robust covariance</span>
        <span class="c1"># We put cov_type in kwargs so subclasses can decide in fit whether to</span>
        <span class="c1"># use this generic implementation</span>
        <span class="k">if</span> <span class="s1">&#39;use_t&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">use_t</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;use_t&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">use_t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_t</span> <span class="o">=</span> <span class="n">use_t</span>
        <span class="k">if</span> <span class="s1">&#39;cov_type&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">cov_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cov_type&#39;</span><span class="p">,</span> <span class="s1">&#39;nonrobust&#39;</span><span class="p">)</span>
            <span class="n">cov_kwds</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cov_kwds&#39;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="k">if</span> <span class="n">cov_type</span> <span class="o">==</span> <span class="s1">&#39;nonrobust&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cov_type</span> <span class="o">=</span> <span class="s1">&#39;nonrobust&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cov_kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Standard Errors assume that the &#39;</span> <span class="o">+</span>
                                 <span class="s1">&#39;covariance matrix of the errors is correctly &#39;</span> <span class="o">+</span>
                                 <span class="s1">&#39;specified.&#39;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">statsmodels.base.covtype</span> <span class="k">import</span> <span class="n">get_robustcov_results</span>
                <span class="k">if</span> <span class="n">cov_kwds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cov_kwds</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">use_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_t</span>
                <span class="c1"># TODO: we shouldn&#39;t need use_t in get_robustcov_results</span>
                <span class="n">get_robustcov_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cov_type</span><span class="o">=</span><span class="n">cov_type</span><span class="p">,</span> <span class="n">use_self</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">use_t</span><span class="o">=</span><span class="n">use_t</span><span class="p">,</span> <span class="o">**</span><span class="n">cov_kwds</span><span class="p">)</span>

<div class="viewcode-block" id="LikelihoodModelResults.normalized_cov_params"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.normalized_cov_params.html#statsmodels.base.model.LikelihoodModelResults.normalized_cov_params">[docs]</a>    <span class="k">def</span> <span class="nf">normalized_cov_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See specific model class docstring&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="k">def</span> <span class="nf">_get_robustcov_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;nonrobust&#39;</span><span class="p">,</span> <span class="n">use_self</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">use_t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">cov_kwds</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">use_self</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;use_self should have been removed long ago.  &quot;</span>
                             <span class="s2">&quot;See GH#4401&quot;</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">statsmodels.base.covtype</span> <span class="k">import</span> <span class="n">get_robustcov_results</span>
        <span class="k">if</span> <span class="n">cov_kwds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cov_kwds</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">cov_type</span> <span class="o">==</span> <span class="s1">&#39;nonrobust&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cov_type</span> <span class="o">=</span> <span class="s1">&#39;nonrobust&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cov_kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Standard Errors assume that the &#39;</span> <span class="o">+</span>
                             <span class="s1">&#39;covariance matrix of the errors is correctly &#39;</span> <span class="o">+</span>
                             <span class="s1">&#39;specified.&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: we shouldn&#39;t need use_t in get_robustcov_results</span>
            <span class="n">get_robustcov_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cov_type</span><span class="o">=</span><span class="n">cov_type</span><span class="p">,</span> <span class="n">use_self</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">use_t</span><span class="o">=</span><span class="n">use_t</span><span class="p">,</span> <span class="o">**</span><span class="n">cov_kwds</span><span class="p">)</span>

<div class="viewcode-block" id="LikelihoodModelResults.llf"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.llf.html#statsmodels.base.model.LikelihoodModelResults.llf">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">llf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log-likelihood of model&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.bse"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.bse.html#statsmodels.base.model.LikelihoodModelResults.bse">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">bse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The standard errors of the parameter estimates.&quot;&quot;&quot;</span>
        <span class="c1"># Issue 3299</span>
        <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cov_params_default&#39;</span><span class="p">))</span> <span class="ow">and</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">bse_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">))</span>
            <span class="n">bse_</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bse_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cov_params</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">bse_</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.tvalues"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.tvalues.html#statsmodels.base.model.LikelihoodModelResults.tvalues">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">tvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the t-statistic for a given parameter estimate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bse</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.pvalues"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.pvalues.html#statsmodels.base.model.LikelihoodModelResults.pvalues">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">pvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The two-tailed p values for the t-stats of the params.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_t</span><span class="p">:</span>
            <span class="n">df_resid</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;df_resid_inference&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvalues</span><span class="p">),</span> <span class="n">df_resid</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvalues</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.cov_params"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.cov_params.html#statsmodels.base.model.LikelihoodModelResults.cov_params">[docs]</a>    <span class="k">def</span> <span class="nf">cov_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the variance/covariance matrix.</span>

<span class="sd">        The variance/covariance matrix can be of a linear contrast</span>
<span class="sd">        of the estimates of params or all params multiplied by scale which</span>
<span class="sd">        will usually be an estimate of sigma^2.  Scale is assumed to be</span>
<span class="sd">        a scalar.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r_matrix : array-like</span>
<span class="sd">            Can be 1d, or 2d.  Can be used alone or with other.</span>
<span class="sd">        column :  array-like, optional</span>
<span class="sd">            Must be used on its own.  Can be 0d or 1d see below.</span>
<span class="sd">        scale : float, optional</span>
<span class="sd">            Can be specified or not.  Default is None, which means that</span>
<span class="sd">            the scale argument is taken from the model.</span>
<span class="sd">        other : array-like, optional</span>
<span class="sd">            Can be used when r_matrix is specified.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cov : ndarray</span>
<span class="sd">            covariance matrix of the parameter estimates or of linear</span>
<span class="sd">            combination of parameter estimates. See Notes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        (The below are assumed to be in matrix notation.)</span>

<span class="sd">        If no argument is specified returns the covariance matrix of a model</span>
<span class="sd">        ``(scale)*(X.T X)^(-1)``</span>

<span class="sd">        If contrast is specified it pre and post-multiplies as follows</span>
<span class="sd">        ``(scale) * r_matrix (X.T X)^(-1) r_matrix.T``</span>

<span class="sd">        If contrast and other are specified returns</span>
<span class="sd">        ``(scale) * r_matrix (X.T X)^(-1) other.T``</span>

<span class="sd">        If column is specified returns</span>
<span class="sd">        ``(scale) * (X.T X)^(-1)[column,column]`` if column is 0d</span>

<span class="sd">        OR</span>

<span class="sd">        ``(scale) * (X.T X)^(-1)[column][:,column]`` if column is 1d</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;mle_settings&#39;</span><span class="p">)</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mle_settings</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l1_cvxopt_cp&#39;</span><span class="p">]):</span>
            <span class="n">dot_fun</span> <span class="o">=</span> <span class="n">nan_dot</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dot_fun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">cov_p</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cov_params_default&#39;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;need covariance of parameters for computing &#39;</span>
                             <span class="s1">&#39;(unnormalized) covariances&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">r_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">other</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Column should be specified without other &#39;</span>
                             <span class="s1">&#39;arguments.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">r_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other can only be specified with r_matrix&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cov_p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cov_params_default&#39;</span><span class="p">):</span>
                <span class="n">cov_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cov_params_default</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span>
                <span class="n">cov_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="o">*</span> <span class="n">scale</span>

        <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
                <span class="k">return</span> <span class="n">cov_p</span><span class="p">[</span><span class="n">column</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cov_p</span><span class="p">[</span><span class="n">column</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">column</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">r_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">r_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r_matrix</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;r_matrix should be 1d or 2d&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">r_matrix</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">dot_fun</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">,</span> <span class="n">dot_fun</span><span class="p">(</span><span class="n">cov_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">tmp</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if r_matrix is None and column is None:</span>
            <span class="k">return</span> <span class="n">cov_p</span></div>

    <span class="c1"># TODO: make sure this works as needed for GLMs</span>
<div class="viewcode-block" id="LikelihoodModelResults.t_test"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.t_test.html#statsmodels.base.model.LikelihoodModelResults.t_test">[docs]</a>    <span class="k">def</span> <span class="nf">t_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_t</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute a t-test for a each linear hypothesis of the form Rb = q</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r_matrix : array-like, str, tuple</span>
<span class="sd">            - array : If an array is given, a p x k 2d array or length k 1d</span>
<span class="sd">              array specifying the linear restrictions. It is assumed</span>
<span class="sd">              that the linear combination is equal to zero.</span>
<span class="sd">            - str : The full hypotheses to test can be given as a string.</span>
<span class="sd">              See the examples.</span>
<span class="sd">            - tuple : A tuple of arrays in the form (R, q). If q is given,</span>
<span class="sd">              can be either a scalar or a length p row vector.</span>
<span class="sd">        cov_p : array-like, optional</span>
<span class="sd">            An alternative estimate for the parameter covariance matrix.</span>
<span class="sd">            If None is given, self.normalized_cov_params is used.</span>
<span class="sd">        scale : float, optional</span>

<span class="sd">            .. deprecated:: 0.10.0</span>

<span class="sd">            An optional `scale` to use.  Default is the scale specified</span>
<span class="sd">            by the model fit.</span>
<span class="sd">        use_t : bool, optional</span>
<span class="sd">            If use_t is None, then the default of the model is used.</span>
<span class="sd">            If use_t is True, then the p-values are based on the t</span>
<span class="sd">            distribution.</span>
<span class="sd">            If use_t is False, then the p-values are based on the normal</span>
<span class="sd">            distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        res : ContrastResults instance</span>
<span class="sd">            The results for the test are attributes of this results instance.</span>
<span class="sd">            The available results have the same elements as the parameter table</span>
<span class="sd">            in `summary()`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">        &gt;&gt;&gt; data = sm.datasets.longley.load(as_pandas=False)</span>
<span class="sd">        &gt;&gt;&gt; data.exog = sm.add_constant(data.exog)</span>
<span class="sd">        &gt;&gt;&gt; results = sm.OLS(data.endog, data.exog).fit()</span>
<span class="sd">        &gt;&gt;&gt; r = np.zeros_like(results.params)</span>
<span class="sd">        &gt;&gt;&gt; r[5:] = [1,-1]</span>
<span class="sd">        &gt;&gt;&gt; print(r)</span>
<span class="sd">        [ 0.  0.  0.  0.  0.  1. -1.]</span>

<span class="sd">        r tests that the coefficients on the 5th and 6th independent</span>
<span class="sd">        variable are the same.</span>

<span class="sd">        &gt;&gt;&gt; T_test = results.t_test(r)</span>
<span class="sd">        &gt;&gt;&gt; print(T_test)</span>
<span class="sd">                                     Test for Constraints</span>
<span class="sd">        ==============================================================================</span>
<span class="sd">                         coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="sd">        ------------------------------------------------------------------------------</span>
<span class="sd">        c0         -1829.2026    455.391     -4.017      0.003   -2859.368    -799.037</span>
<span class="sd">        ==============================================================================</span>
<span class="sd">        &gt;&gt;&gt; T_test.effect</span>
<span class="sd">        -1829.2025687192481</span>
<span class="sd">        &gt;&gt;&gt; T_test.sd</span>
<span class="sd">        455.39079425193762</span>
<span class="sd">        &gt;&gt;&gt; T_test.tvalue</span>
<span class="sd">        -4.0167754636411717</span>
<span class="sd">        &gt;&gt;&gt; T_test.pvalue</span>
<span class="sd">        0.0015163772380899498</span>

<span class="sd">        Alternatively, you can specify the hypothesis tests using a string</span>

<span class="sd">        &gt;&gt;&gt; from statsmodels.formula.api import ols</span>
<span class="sd">        &gt;&gt;&gt; dta = sm.datasets.longley.load_pandas().data</span>
<span class="sd">        &gt;&gt;&gt; formula = &#39;TOTEMP ~ GNPDEFL + GNP + UNEMP + ARMED + POP + YEAR&#39;</span>
<span class="sd">        &gt;&gt;&gt; results = ols(formula, dta).fit()</span>
<span class="sd">        &gt;&gt;&gt; hypotheses = &#39;GNPDEFL = GNP, UNEMP = 2, YEAR/1829 = 1&#39;</span>
<span class="sd">        &gt;&gt;&gt; t_test = results.t_test(hypotheses)</span>
<span class="sd">        &gt;&gt;&gt; print(t_test)</span>
<span class="sd">                                     Test for Constraints</span>
<span class="sd">        ==============================================================================</span>
<span class="sd">                         coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<span class="sd">        ------------------------------------------------------------------------------</span>
<span class="sd">        c0            15.0977     84.937      0.178      0.863    -177.042     207.238</span>
<span class="sd">        c1            -2.0202      0.488     -8.231      0.000      -3.125      -0.915</span>
<span class="sd">        c2             1.0001      0.249      0.000      1.000       0.437       1.563</span>
<span class="sd">        ==============================================================================</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        tvalues : individual t statistics</span>
<span class="sd">        f_test : for F tests</span>
<span class="sd">        patsy.DesignInfo.linear_constraint</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">warnings</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;scale is has no effect and is deprecated. It will&#39;</span>
                          <span class="s1">&#39;be removed in the next version.&#39;</span><span class="p">,</span>
                          <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">patsy</span> <span class="k">import</span> <span class="n">DesignInfo</span>
        <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">param_names</span>
        <span class="n">LC</span> <span class="o">=</span> <span class="n">DesignInfo</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">linear_constraint</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">)</span>
        <span class="n">r_matrix</span><span class="p">,</span> <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">LC</span><span class="o">.</span><span class="n">coefs</span><span class="p">,</span> <span class="n">LC</span><span class="o">.</span><span class="n">constants</span>
        <span class="n">num_ttests</span> <span class="o">=</span> <span class="n">r_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_params</span> <span class="o">=</span> <span class="n">r_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">cov_p</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cov_params_default&#39;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Need covariance of parameters for computing &#39;</span>
                             <span class="s1">&#39;T statistics&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_params</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;r_matrix and params are not aligned&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">q_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_ttests</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_matrix</span><span class="p">)</span>
            <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">q_matrix</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">q_matrix</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">q_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">num_ttests</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;r_matrix and q_matrix must have the same &quot;</span>
                                 <span class="s2">&quot;number of rows&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># switch to use_t false if undefined</span>
            <span class="n">use_t</span> <span class="o">=</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;use_t&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_t</span><span class="p">)</span>

        <span class="n">_t</span> <span class="o">=</span> <span class="n">_sd</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">_effect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="c1"># nan_dot multiplies with the convention nan * 0 = 0</span>

        <span class="c1"># Perform the test</span>
        <span class="k">if</span> <span class="n">num_ttests</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">_sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cov_params</span><span class="p">(</span>
                <span class="n">r_matrix</span><span class="o">=</span><span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="n">cov_p</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cov_params</span><span class="p">(</span><span class="n">r_matrix</span><span class="o">=</span><span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="n">cov_p</span><span class="p">))</span>
        <span class="n">_t</span> <span class="o">=</span> <span class="p">(</span><span class="n">_effect</span> <span class="o">-</span> <span class="n">q_matrix</span><span class="p">)</span> <span class="o">*</span> <span class="n">recipr</span><span class="p">(</span><span class="n">_sd</span><span class="p">)</span>

        <span class="n">df_resid</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;df_resid_inference&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_t</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContrastResults</span><span class="p">(</span><span class="n">effect</span><span class="o">=</span><span class="n">_effect</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">_t</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="n">_sd</span><span class="p">,</span>
                                   <span class="n">df_denom</span><span class="o">=</span><span class="n">df_resid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContrastResults</span><span class="p">(</span><span class="n">effect</span><span class="o">=</span><span class="n">_effect</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="n">_t</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="n">_sd</span><span class="p">,</span>
                                   <span class="n">df_denom</span><span class="o">=</span><span class="n">df_resid</span><span class="p">,</span>
                                   <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.f_test"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.f_test.html#statsmodels.base.model.LikelihoodModelResults.f_test">[docs]</a>    <span class="k">def</span> <span class="nf">f_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">invcov</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the F-test for a joint linear hypothesis.</span>

<span class="sd">        This is a special case of `wald_test` that always uses the F</span>
<span class="sd">        distribution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r_matrix : array-like, str, or tuple</span>
<span class="sd">            - array : An r x k array where r is the number of restrictions to</span>
<span class="sd">              test and k is the number of regressors. It is assumed</span>
<span class="sd">              that the linear combination is equal to zero.</span>
<span class="sd">            - str : The full hypotheses to test can be given as a string.</span>
<span class="sd">              See the examples.</span>
<span class="sd">            - tuple : A tuple of arrays in the form (R, q), ``q`` can be</span>
<span class="sd">              either a scalar or a length k row vector.</span>
<span class="sd">        cov_p : array-like, optional</span>
<span class="sd">            An alternative estimate for the parameter covariance matrix.</span>
<span class="sd">            If None is given, self.normalized_cov_params is used.</span>
<span class="sd">        scale : float, optional</span>

<span class="sd">            .. deprecated:: 0.10.0</span>

<span class="sd">            Default is 1.0 for no scaling.</span>
<span class="sd">        invcov : array-like, optional</span>
<span class="sd">            A q x q array to specify an inverse covariance matrix based on a</span>
<span class="sd">            restrictions matrix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        res : ContrastResults instance</span>
<span class="sd">            The results for the test are attributes of this results instance.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">        &gt;&gt;&gt; data = sm.datasets.longley.load(as_pandas=False)</span>
<span class="sd">        &gt;&gt;&gt; data.exog = sm.add_constant(data.exog)</span>
<span class="sd">        &gt;&gt;&gt; results = sm.OLS(data.endog, data.exog).fit()</span>
<span class="sd">        &gt;&gt;&gt; A = np.identity(len(results.params))</span>
<span class="sd">        &gt;&gt;&gt; A = A[1:,:]</span>

<span class="sd">        This tests that each coefficient is jointly statistically</span>
<span class="sd">        significantly different from zero.</span>

<span class="sd">        &gt;&gt;&gt; print(results.f_test(A))</span>
<span class="sd">        &lt;F test: F=array([[ 330.28533923]]), p=4.984030528700946e-10, df_denom=9, df_num=6&gt;</span>

<span class="sd">        Compare this to</span>

<span class="sd">        &gt;&gt;&gt; results.fvalue</span>
<span class="sd">        330.2853392346658</span>
<span class="sd">        &gt;&gt;&gt; results.f_pvalue</span>
<span class="sd">        4.98403096572e-10</span>

<span class="sd">        &gt;&gt;&gt; B = np.array(([0,0,1,-1,0,0,0],[0,0,0,0,0,1,-1]))</span>

<span class="sd">        This tests that the coefficient on the 2nd and 3rd regressors are</span>
<span class="sd">        equal and jointly that the coefficient on the 5th and 6th regressors</span>
<span class="sd">        are equal.</span>

<span class="sd">        &gt;&gt;&gt; print(results.f_test(B))</span>
<span class="sd">        &lt;F test: F=array([[ 9.74046187]]), p=0.005605288531708235, df_denom=9, df_num=2&gt;</span>

<span class="sd">        Alternatively, you can specify the hypothesis tests using a string</span>

<span class="sd">        &gt;&gt;&gt; from statsmodels.datasets import longley</span>
<span class="sd">        &gt;&gt;&gt; from statsmodels.formula.api import ols</span>
<span class="sd">        &gt;&gt;&gt; dta = longley.load_pandas().data</span>
<span class="sd">        &gt;&gt;&gt; formula = &#39;TOTEMP ~ GNPDEFL + GNP + UNEMP + ARMED + POP + YEAR&#39;</span>
<span class="sd">        &gt;&gt;&gt; results = ols(formula, dta).fit()</span>
<span class="sd">        &gt;&gt;&gt; hypotheses = &#39;(GNPDEFL = GNP), (UNEMP = 2), (YEAR/1829 = 1)&#39;</span>
<span class="sd">        &gt;&gt;&gt; f_test = results.f_test(hypotheses)</span>
<span class="sd">        &gt;&gt;&gt; print(f_test)</span>
<span class="sd">        &lt;F test: F=array([[ 144.17976065]]), p=6.322026217355609e-08, df_denom=9, df_num=3&gt;</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        statsmodels.stats.contrast.ContrastResults</span>
<span class="sd">        wald_test</span>
<span class="sd">        t_test</span>
<span class="sd">        patsy.DesignInfo.linear_constraint</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The matrix `r_matrix` is assumed to be non-singular. More precisely,</span>

<span class="sd">        r_matrix (pX pX.T) r_matrix.T</span>

<span class="sd">        is assumed invertible. Here, pX is the generalized inverse of the</span>
<span class="sd">        design matrix of the model. There can be problems in non-OLS models</span>
<span class="sd">        where the rank of the covariance of the noise is not full.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">warnings</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;scale is has no effect and is deprecated. It will&#39;</span>
                          <span class="s1">&#39;be removed in the next version.&#39;</span><span class="p">,</span>
                          <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wald_test</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="n">cov_p</span><span class="p">,</span> <span class="n">invcov</span><span class="o">=</span><span class="n">invcov</span><span class="p">,</span> <span class="n">use_f</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>

    <span class="c1"># TODO: untested for GLMs?</span>
<div class="viewcode-block" id="LikelihoodModelResults.wald_test"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.wald_test.html#statsmodels.base.model.LikelihoodModelResults.wald_test">[docs]</a>    <span class="k">def</span> <span class="nf">wald_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">invcov</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">use_f</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute a Wald-test for a joint linear hypothesis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r_matrix : array-like, str, or tuple</span>
<span class="sd">            - array : An r x k array where r is the number of restrictions to</span>
<span class="sd">              test and k is the number of regressors. It is assumed that the</span>
<span class="sd">              linear combination is equal to zero.</span>
<span class="sd">            - str : The full hypotheses to test can be given as a string.</span>
<span class="sd">              See the examples.</span>
<span class="sd">            - tuple : A tuple of arrays in the form (R, q), ``q`` can be</span>
<span class="sd">              either a scalar or a length p row vector.</span>
<span class="sd">        cov_p : array-like, optional</span>
<span class="sd">            An alternative estimate for the parameter covariance matrix.</span>
<span class="sd">            If None is given, self.normalized_cov_params is used.</span>
<span class="sd">        scale : float, optional</span>

<span class="sd">            .. deprecated:: 0.10.0</span>

<span class="sd">            Default is 1.0 for no scaling.</span>
<span class="sd">        invcov : array-like, optional</span>
<span class="sd">            A q x q array to specify an inverse covariance matrix based on a</span>
<span class="sd">            restrictions matrix.</span>
<span class="sd">        use_f : bool</span>
<span class="sd">            If True, then the F-distribution is used. If False, then the</span>
<span class="sd">            asymptotic distribution, chisquare is used. If use_f is None, then</span>
<span class="sd">            the F distribution is used if the model specifies that use_t is True.</span>
<span class="sd">            The test statistic is proportionally adjusted for the distribution</span>
<span class="sd">            by the number of constraints in the hypothesis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        res : ContrastResults instance</span>
<span class="sd">            The results for the test are attributes of this results instance.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        statsmodels.stats.contrast.ContrastResults</span>
<span class="sd">        f_test</span>
<span class="sd">        t_test</span>
<span class="sd">        patsy.DesignInfo.linear_constraint</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The matrix `r_matrix` is assumed to be non-singular. More precisely,</span>

<span class="sd">        r_matrix (pX pX.T) r_matrix.T</span>

<span class="sd">        is assumed invertible. Here, pX is the generalized inverse of the</span>
<span class="sd">        design matrix of the model. There can be problems in non-OLS models</span>
<span class="sd">        where the rank of the covariance of the noise is not full.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">warnings</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;scale is has no effect and is deprecated. It will&#39;</span>
                          <span class="s1">&#39;be removed in the next version.&#39;</span><span class="p">,</span>
                          <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># switch to use_t false if undefined</span>
            <span class="n">use_f</span> <span class="o">=</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;use_t&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_t</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">patsy</span> <span class="k">import</span> <span class="n">DesignInfo</span>
        <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">param_names</span>
        <span class="n">LC</span> <span class="o">=</span> <span class="n">DesignInfo</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">linear_constraint</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">)</span>
        <span class="n">r_matrix</span><span class="p">,</span> <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">LC</span><span class="o">.</span><span class="n">coefs</span><span class="p">,</span> <span class="n">LC</span><span class="o">.</span><span class="n">constants</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalized_cov_params</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cov_p</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">invcov</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cov_params_default&#39;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;need covariance of parameters for computing &#39;</span>
                             <span class="s1">&#39;F statistics&#39;</span><span class="p">)</span>

        <span class="n">cparams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
        <span class="n">J</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">r_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># number of restrictions</span>

        <span class="k">if</span> <span class="n">q_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_matrix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">q_matrix</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">q_matrix</span> <span class="o">=</span> <span class="n">q_matrix</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">q_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">J</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;r_matrix and q_matrix must have the same &quot;</span>
                                 <span class="s2">&quot;number of rows&quot;</span><span class="p">)</span>
        <span class="n">Rbq</span> <span class="o">=</span> <span class="n">cparams</span> <span class="o">-</span> <span class="n">q_matrix</span>
        <span class="k">if</span> <span class="n">invcov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cov_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cov_params</span><span class="p">(</span><span class="n">r_matrix</span><span class="o">=</span><span class="n">r_matrix</span><span class="p">,</span> <span class="n">cov_p</span><span class="o">=</span><span class="n">cov_p</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">cov_p</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;r_matrix performs f_test for using &quot;</span>
                                 <span class="s2">&quot;dimensions that are asymptotically &quot;</span>
                                 <span class="s2">&quot;non-normal&quot;</span><span class="p">)</span>
            <span class="n">invcov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">cov_p</span><span class="p">)</span>
            <span class="n">J_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">cov_p</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">J_</span> <span class="o">&lt;</span> <span class="n">J</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;covariance of constraints does not have full &#39;</span>
                              <span class="s1">&#39;rank. The number of constraints is </span><span class="si">%d</span><span class="s1">, but &#39;</span>
                              <span class="s1">&#39;rank is </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">J_</span><span class="p">),</span> <span class="n">ValueWarning</span><span class="p">)</span>
                <span class="n">J</span> <span class="o">=</span> <span class="n">J_</span>

        <span class="c1"># TODO streamline computation, we don&#39;t need to compute J if given</span>
        <span class="k">if</span> <span class="n">df_constraints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># let caller override J by df_constraint</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">df_constraints</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;mle_settings&#39;</span><span class="p">)</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mle_settings</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l1_cvxopt_cp&#39;</span><span class="p">]):</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">nan_dot</span><span class="p">(</span><span class="n">nan_dot</span><span class="p">(</span><span class="n">Rbq</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">invcov</span><span class="p">),</span> <span class="n">Rbq</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Rbq</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">invcov</span><span class="p">),</span> <span class="n">Rbq</span><span class="p">)</span>

        <span class="n">df_resid</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;df_resid_inference&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_f</span><span class="p">:</span>
            <span class="n">F</span> <span class="o">/=</span> <span class="n">J</span>
            <span class="k">return</span> <span class="n">ContrastResults</span><span class="p">(</span><span class="n">F</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">df_denom</span><span class="o">=</span><span class="n">df_resid</span><span class="p">,</span>
                                   <span class="n">df_num</span><span class="o">=</span><span class="n">J</span><span class="p">)</span> <span class="c1">#invcov.shape[0])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ContrastResults</span><span class="p">(</span><span class="n">chi2</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">df_denom</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="n">F</span><span class="p">,</span>
                                   <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;chi2&#39;</span><span class="p">,</span> <span class="n">distargs</span><span class="o">=</span><span class="p">(</span><span class="n">J</span><span class="p">,))</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.wald_test_terms"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.wald_test_terms.html#statsmodels.base.model.LikelihoodModelResults.wald_test_terms">[docs]</a>    <span class="k">def</span> <span class="nf">wald_test_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skip_single</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">extra_constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">combine_terms</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute a sequence of Wald tests for terms over multiple columns</span>

<span class="sd">        This computes joined Wald tests for the hypothesis that all</span>
<span class="sd">        coefficients corresponding to a `term` are zero.</span>

<span class="sd">        `Terms` are defined by the underlying formula or by string matching.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        skip_single : boolean</span>
<span class="sd">            If true, then terms that consist only of a single column and,</span>
<span class="sd">            therefore, refers only to a single parameter is skipped.</span>
<span class="sd">            If false, then all terms are included.</span>
<span class="sd">        extra_constraints : ndarray</span>
<span class="sd">            not tested yet</span>
<span class="sd">        combine_terms : None or list of strings</span>
<span class="sd">            Each string in this list is matched to the name of the terms or</span>
<span class="sd">            the name of the exogenous variables. All columns whose name</span>
<span class="sd">            includes that string are combined in one joint test.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        test_result : result instance</span>
<span class="sd">            The result instance contains `table` which is a pandas DataFrame</span>
<span class="sd">            with the test results: test statistic, degrees of freedom and</span>
<span class="sd">            pvalues.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; res_ols = ols(&quot;np.log(Days+1) ~ C(Duration, Sum)*C(Weight, Sum)&quot;, data).fit()</span>
<span class="sd">        &gt;&gt;&gt; res_ols.wald_test_terms()</span>
<span class="sd">        &lt;class &#39;statsmodels.stats.contrast.WaldTestResults&#39;&gt;</span>
<span class="sd">                                                  F                P&gt;F  df constraint  df denom</span>
<span class="sd">        Intercept                        279.754525  2.37985521351e-22              1        51</span>
<span class="sd">        C(Duration, Sum)                   5.367071    0.0245738436636              1        51</span>
<span class="sd">        C(Weight, Sum)                    12.432445  3.99943118767e-05              2        51</span>
<span class="sd">        C(Duration, Sum):C(Weight, Sum)    0.176002      0.83912310946              2        51</span>

<span class="sd">        &gt;&gt;&gt; res_poi = Poisson.from_formula(&quot;Days ~ C(Weight) * C(Duration)&quot;, \</span>
<span class="sd">                                           data).fit(cov_type=&#39;HC0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; wt = res_poi.wald_test_terms(skip_single=False, \</span>
<span class="sd">                                         combine_terms=[&#39;Duration&#39;, &#39;Weight&#39;])</span>
<span class="sd">        &gt;&gt;&gt; print(wt)</span>
<span class="sd">                                    chi2             P&gt;chi2  df constraint</span>
<span class="sd">        Intercept              15.695625  7.43960374424e-05              1</span>
<span class="sd">        C(Weight)              16.132616  0.000313940174705              2</span>
<span class="sd">        C(Duration)             1.009147     0.315107378931              1</span>
<span class="sd">        C(Weight):C(Duration)   0.216694     0.897315972824              2</span>
<span class="sd">        Duration               11.187849     0.010752286833              3</span>
<span class="sd">        Weight                 30.263368  4.32586407145e-06              4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># lazy import</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="n">extra_constraints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extra_constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">combine_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combine_terms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">design_info</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;design_info&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">design_info</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">extra_constraints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;no constraints, nothing to do&#39;</span><span class="p">)</span>

        <span class="n">identity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">))</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">combined</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">design_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">design_info</span><span class="o">.</span><span class="n">terms</span><span class="p">:</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="n">design_info</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
                <span class="n">constraint_matrix</span> <span class="o">=</span> <span class="n">identity</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

                <span class="c1"># check if in combined</span>
                <span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">combine_terms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                        <span class="n">combined</span><span class="p">[</span><span class="n">cname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint_matrix</span><span class="p">)</span>

                <span class="n">k_constraint</span> <span class="o">=</span> <span class="n">constraint_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">skip_single</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">k_constraint</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">))</span>

            <span class="n">combined_constraints</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">combine_terms</span><span class="p">:</span>
                <span class="n">combined_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cname</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">combined</span><span class="p">[</span><span class="n">cname</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># check by exog/params names if there is no formula info</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">exog_names</span><span class="p">):</span>
                <span class="n">constraint_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">identity</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

                <span class="c1"># check if in combined</span>
                <span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">combine_terms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                        <span class="n">combined</span><span class="p">[</span><span class="n">cname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint_matrix</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">skip_single</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">))</span>

            <span class="n">combined_constraints</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">combine_terms</span><span class="p">:</span>
                <span class="n">combined_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cname</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">combined</span><span class="p">[</span><span class="n">cname</span><span class="p">])))</span>

        <span class="n">use_t</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">use_t</span>
        <span class="n">distribution</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chi2&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="n">use_t</span><span class="p">]</span>

        <span class="n">res_wald</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">constraints</span> <span class="o">+</span> <span class="n">combined_constraints</span> <span class="o">+</span> <span class="n">extra_constraints</span><span class="p">:</span>
            <span class="n">wt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">wald_test</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">wt</span><span class="o">.</span><span class="n">statistic</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">wt</span><span class="o">.</span><span class="n">pvalue</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">constraint</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">use_t</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt</span><span class="o">.</span><span class="n">df_denom</span><span class="p">)</span>
            <span class="n">res_wald</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># distribution nerutral names</span>
        <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">,</span> <span class="s1">&#39;df_constraint&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">use_t</span><span class="p">:</span>
            <span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;df_denom&#39;</span><span class="p">)</span>
        <span class="c1"># TODO: maybe move DataFrame creation to results class</span>
        <span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">DataFrame</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">res_wald</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">WaldTestResults</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
        <span class="c1"># TODO: remove temp again, added for testing</span>
        <span class="n">res</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="n">constraints</span> <span class="o">+</span> <span class="n">combined_constraints</span> <span class="o">+</span> <span class="n">extra_constraints</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.t_test_pairwise"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.t_test_pairwise.html#statsmodels.base.model.LikelihoodModelResults.t_test_pairwise">[docs]</a>    <span class="k">def</span> <span class="nf">t_test_pairwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_name</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hs&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                        <span class="n">factor_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;perform pairwise t_test with multiple testing corrected p-values</span>

<span class="sd">        This uses the formula design_info encoding contrast matrix and should</span>
<span class="sd">        work for all encodings of a main effect.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        result : result instance</span>
<span class="sd">            The results of an estimated model with a categorical main effect.</span>
<span class="sd">        term_name : str</span>
<span class="sd">            name of the term for which pairwise comparisons are computed.</span>
<span class="sd">            Term names for categorical effects are created by patsy and</span>
<span class="sd">            correspond to the main part of the exog names.</span>
<span class="sd">        method : str or list of strings</span>
<span class="sd">            multiple testing p-value correction, default is &#39;hs&#39;,</span>
<span class="sd">            see stats.multipletesting</span>
<span class="sd">        alpha : float</span>
<span class="sd">            significance level for multiple testing reject decision.</span>
<span class="sd">        factor_labels : None, list of str</span>
<span class="sd">            Labels for the factor levels used for pairwise labels. If not</span>
<span class="sd">            provided, then the labels from the formula design_info are used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        results : instance of a simple Results class</span>
<span class="sd">            The results are stored as attributes, the main attributes are the</span>
<span class="sd">            following two. Other attributes are added for debugging purposes</span>
<span class="sd">            or as background information.</span>

<span class="sd">            - result_frame : pandas DataFrame with t_test results and multiple</span>
<span class="sd">              testing corrected p-values.</span>
<span class="sd">            - contrasts : matrix of constraints of the null hypothesis in the</span>
<span class="sd">              t_test.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Status: experimental. Currently only checked for treatment coding with</span>
<span class="sd">        and without specified reference level.</span>

<span class="sd">        Currently there are no multiple testing corrected confidence intervals</span>
<span class="sd">        available.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; res = ols(&quot;np.log(Days+1) ~ C(Weight) + C(Duration)&quot;, data).fit()</span>
<span class="sd">        &gt;&gt;&gt; pw = res.t_test_pairwise(&quot;C(Weight)&quot;)</span>
<span class="sd">        &gt;&gt;&gt; pw.result_frame</span>
<span class="sd">                 coef   std err         t         P&gt;|t|  Conf. Int. Low</span>
<span class="sd">        2-1  0.632315  0.230003  2.749157  8.028083e-03        0.171563</span>
<span class="sd">        3-1  1.302555  0.230003  5.663201  5.331513e-07        0.841803</span>
<span class="sd">        3-2  0.670240  0.230003  2.914044  5.119126e-03        0.209488</span>
<span class="sd">             Conf. Int. Upp.  pvalue-hs reject-hs</span>
<span class="sd">        2-1         1.093067   0.010212      True</span>
<span class="sd">        3-1         1.763307   0.000002      True</span>
<span class="sd">        3-2         1.130992   0.010212      True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">t_test_pairwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_name</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                              <span class="n">factor_labels</span><span class="o">=</span><span class="n">factor_labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.conf_int"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.conf_int.html#statsmodels.base.model.LikelihoodModelResults.conf_int">[docs]</a>    <span class="k">def</span> <span class="nf">conf_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the confidence interval of the fitted parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            The significance level for the confidence interval.</span>
<span class="sd">            ie., The default `alpha` = .05 returns a 95% confidence interval.</span>
<span class="sd">        cols : array-like, optional</span>
<span class="sd">            `cols` specifies which confidence intervals to return</span>
<span class="sd">        method : string</span>
<span class="sd">            Not Implemented Yet</span>
<span class="sd">            Method to estimate the confidence_interval.</span>
<span class="sd">            &quot;Default&quot; : uses self.bse which is based on inverse Hessian for MLE</span>
<span class="sd">            &quot;hjjh&quot; :</span>
<span class="sd">            &quot;jac&quot; :</span>
<span class="sd">            &quot;boot-bse&quot;</span>
<span class="sd">            &quot;boot_quant&quot;</span>
<span class="sd">            &quot;profile&quot;</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        conf_int : array</span>
<span class="sd">            Each row contains [lower, upper] limits of the confidence interval</span>
<span class="sd">            for the corresponding parameter. The first column contains all</span>
<span class="sd">            lower, the second column contains all upper limits.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import statsmodels.api as sm</span>
<span class="sd">        &gt;&gt;&gt; data = sm.datasets.longley.load(as_pandas=False)</span>
<span class="sd">        &gt;&gt;&gt; data.exog = sm.add_constant(data.exog)</span>
<span class="sd">        &gt;&gt;&gt; results = sm.OLS(data.endog, data.exog).fit()</span>
<span class="sd">        &gt;&gt;&gt; results.conf_int()</span>
<span class="sd">        array([[-5496529.48322745, -1467987.78596704],</span>
<span class="sd">               [    -177.02903529,      207.15277984],</span>
<span class="sd">               [      -0.1115811 ,        0.03994274],</span>
<span class="sd">               [      -3.12506664,       -0.91539297],</span>
<span class="sd">               [      -1.5179487 ,       -0.54850503],</span>
<span class="sd">               [      -0.56251721,        0.460309  ],</span>
<span class="sd">               [     798.7875153 ,     2859.51541392]])</span>


<span class="sd">        &gt;&gt;&gt; results.conf_int(cols=(2,3))</span>
<span class="sd">        array([[-0.1115811 ,  0.03994274],</span>
<span class="sd">               [-3.12506664, -0.91539297]])</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The confidence interval is based on the standard normal distribution.</span>
<span class="sd">        Models wish to use a different distribution should overwrite this</span>
<span class="sd">        method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bse</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_t</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span>
            <span class="n">df_resid</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;df_resid_inference&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span><span class="p">)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df_resid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">bse</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">+</span> <span class="n">q</span> <span class="o">*</span> <span class="n">bse</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span> <span class="n">bse</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span> <span class="o">*</span> <span class="n">bse</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lzip</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">))</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.save"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.save.html#statsmodels.base.model.LikelihoodModelResults.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">remove_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save a pickle of this instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname : string or filehandle</span>
<span class="sd">            fname can be a string to a file path or filename, or a filehandle.</span>
<span class="sd">        remove_data : bool</span>
<span class="sd">            If False (default), then the instance is pickled without changes.</span>
<span class="sd">            If True, then all arrays with length nobs are set to None before</span>
<span class="sd">            pickling. See the remove_data method.</span>
<span class="sd">            In some cases not all arrays will be set to None.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If remove_data is true and the model result does not implement a</span>
<span class="sd">        remove_data method then this will raise an exception.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">statsmodels.iolib.smpickle</span> <span class="k">import</span> <span class="n">save_pickle</span>

        <span class="k">if</span> <span class="n">remove_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_data</span><span class="p">()</span>

        <span class="n">save_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.load"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.load.html#statsmodels.base.model.LikelihoodModelResults.load">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        load a pickle, (class method)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname : string or filehandle</span>
<span class="sd">            fname can be a string to a file path or filename, or a filehandle.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        unpickled instance</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">statsmodels.iolib.smpickle</span> <span class="k">import</span> <span class="n">load_pickle</span>
        <span class="k">return</span> <span class="n">load_pickle</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>

<div class="viewcode-block" id="LikelihoodModelResults.remove_data"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.LikelihoodModelResults.remove_data.html#statsmodels.base.model.LikelihoodModelResults.remove_data">[docs]</a>    <span class="k">def</span> <span class="nf">remove_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;remove data arrays, all nobs arrays from result and model</span>

<span class="sd">        This reduces the size of the instance, so it can be pickled with less</span>
<span class="sd">        memory. Currently tested for use with predict from an unpickled</span>
<span class="sd">        results and model instance.</span>

<span class="sd">        .. warning:: Since data and some intermediate results have been removed</span>
<span class="sd">           calculating new statistics that require them will raise exceptions.</span>
<span class="sd">           The exception will occur the first time an attribute is accessed</span>
<span class="sd">           that has been set to None.</span>

<span class="sd">        Not fully tested for time series models, tsa, and might delete too much</span>
<span class="sd">        for prediction or not all that would be possible.</span>

<span class="sd">        The lists of arrays to delete are maintained as attributes of</span>
<span class="sd">        the result and model instance, except for cached values. These</span>
<span class="sd">        lists could be changed before calling remove_data.</span>

<span class="sd">        The attributes to remove are named in:</span>

<span class="sd">        model._data_attr : arrays attached to both the model instance</span>
<span class="sd">            and the results instance with the same attribute name.</span>

<span class="sd">        result.data_in_cache : arrays that may exist as values in</span>
<span class="sd">            result._cache (TODO : should privatize name)</span>

<span class="sd">        result._data_attr_model : arrays attached to the model</span>
<span class="sd">            instance but not to the results instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">wipe</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">att</span><span class="p">):</span>
            <span class="c1"># get to last element in attribute path</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">att</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">att_</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj_</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="nb">getattr</span><span class="p">,</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj_</span><span class="p">,</span> <span class="n">att_</span><span class="p">):</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">obj_</span><span class="p">,</span> <span class="n">att_</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">model_only</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model.&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_data_attr_model&quot;</span><span class="p">,</span> <span class="p">[])]</span>
        <span class="n">model_attr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model.&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_data_attr</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_attr</span> <span class="o">+</span> <span class="n">model_attr</span> <span class="o">+</span> <span class="n">model_only</span><span class="p">:</span>
            <span class="n">wipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">att</span><span class="p">)</span>

        <span class="n">data_in_cache</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data_in_cache&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">data_in_cache</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;fittedvalues&#39;</span><span class="p">,</span> <span class="s1">&#39;resid&#39;</span><span class="p">,</span> <span class="s1">&#39;wresid&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data_in_cache</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
                <span class="k">pass</span></div></div>


<span class="k">class</span> <span class="nc">LikelihoodResultsWrapper</span><span class="p">(</span><span class="n">wrap</span><span class="o">.</span><span class="n">ResultsWrapper</span><span class="p">):</span>
    <span class="n">_attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bse&#39;</span><span class="p">:</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pvalues&#39;</span><span class="p">:</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span>
        <span class="s1">&#39;tvalues&#39;</span><span class="p">:</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resid&#39;</span><span class="p">:</span> <span class="s1">&#39;rows&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fittedvalues&#39;</span><span class="p">:</span> <span class="s1">&#39;rows&#39;</span><span class="p">,</span>
        <span class="s1">&#39;normalized_cov_params&#39;</span><span class="p">:</span> <span class="s1">&#39;cov&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">_wrap_attrs</span> <span class="o">=</span> <span class="n">_attrs</span>
    <span class="n">_wrap_methods</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;cov_params&#39;</span><span class="p">:</span> <span class="s1">&#39;cov&#39;</span><span class="p">,</span>
        <span class="s1">&#39;conf_int&#39;</span><span class="p">:</span> <span class="s1">&#39;columns&#39;</span>
    <span class="p">}</span>

<span class="n">wrap</span><span class="o">.</span><span class="n">populate_wrapper</span><span class="p">(</span><span class="n">LikelihoodResultsWrapper</span><span class="p">,</span>  <span class="c1"># noqa:E305</span>
                      <span class="n">LikelihoodModelResults</span><span class="p">)</span>


<div class="viewcode-block" id="ResultMixin"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.html#statsmodels.base.model.ResultMixin">[docs]</a><span class="k">class</span> <span class="nc">ResultMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<div class="viewcode-block" id="ResultMixin.df_modelwc"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.df_modelwc.html#statsmodels.base.model.ResultMixin.df_modelwc">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">df_modelwc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Model WC&quot;&quot;&quot;</span>
        <span class="c1"># collect different ways of defining the number of parameters, used for</span>
        <span class="c1"># aic, bic</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;df_model&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;hasconst&#39;</span><span class="p">):</span>
                <span class="n">hasconst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasconst</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># default assumption</span>
                <span class="n">hasconst</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span> <span class="o">+</span> <span class="n">hasconst</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">size</span></div>

<div class="viewcode-block" id="ResultMixin.aic"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.aic.html#statsmodels.base.model.ResultMixin.aic">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">aic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Akaike information criterion&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">llf</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_modelwc</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultMixin.bic"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.bic.html#statsmodels.base.model.ResultMixin.bic">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">bic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Bayesian information criterion&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">llf</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_modelwc</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultMixin.score_obsv"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.score_obsv.html#statsmodels.base.model.ResultMixin.score_obsv">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">score_obsv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;cached Jacobian of log-likelihood</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">score_obs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultMixin.hessv"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.hessv.html#statsmodels.base.model.ResultMixin.hessv">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">hessv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;cached Hessian of log-likelihood</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="ResultMixin.covjac"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.covjac.html#statsmodels.base.model.ResultMixin.covjac">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">covjac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        covariance of parameters based on outer product of jacobian of</span>
<span class="sd">        log-likelihood</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#  if not hasattr(self, &#39;_results&#39;):</span>
        <span class="c1">#      raise ValueError(&#39;need to call fit first&#39;)</span>
        <span class="c1">#      #self.fit()</span>
        <span class="c1">#  self.jacv = jacv = self.jac(self._results.params)</span>
        <span class="n">jacv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_obsv</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">jacv</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">jacv</span><span class="p">))</span></div>

<div class="viewcode-block" id="ResultMixin.covjhj"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.covjhj.html#statsmodels.base.model.ResultMixin.covjhj">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">covjhj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;covariance of parameters based on HJJH</span>

<span class="sd">        dot product of Hessian, Jacobian, Jacobian, Hessian of likelihood</span>

<span class="sd">        name should be covhjh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">jacv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_obsv</span>
        <span class="n">hessv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessv</span>
        <span class="n">hessinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">hessv</span><span class="p">)</span>
        <span class="c1">#  self.hessinv = hessin = self.cov_params()</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">hessinv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">jacv</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">jacv</span><span class="p">),</span> <span class="n">hessinv</span><span class="p">))</span></div>

<div class="viewcode-block" id="ResultMixin.bsejhj"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.bsejhj.html#statsmodels.base.model.ResultMixin.bsejhj">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">bsejhj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;standard deviation of parameter estimates based on covHJH</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covjhj</span><span class="p">))</span></div>

<div class="viewcode-block" id="ResultMixin.bsejac"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.bsejac.html#statsmodels.base.model.ResultMixin.bsejac">[docs]</a>    <span class="nd">@cache_readonly</span>
    <span class="k">def</span> <span class="nf">bsejac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;standard deviation of parameter estimates based on covjac</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covjac</span><span class="p">))</span></div>

<div class="viewcode-block" id="ResultMixin.bootstrap"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.bootstrap.html#statsmodels.base.model.ResultMixin.bootstrap">[docs]</a>    <span class="k">def</span> <span class="nf">bootstrap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrep</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;simple bootstrap to get mean and variance of estimator</span>

<span class="sd">        see notes</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrep : int</span>
<span class="sd">            number of bootstrap replications</span>
<span class="sd">        method : str</span>
<span class="sd">            optimization method to use</span>
<span class="sd">        disp : bool</span>
<span class="sd">            If true, then optimization prints results</span>
<span class="sd">        store : bool</span>
<span class="sd">            If true, then parameter estimates for all bootstrap iterations</span>
<span class="sd">            are attached in self.bootstrap_results</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mean : array</span>
<span class="sd">            mean of parameter estimates over bootstrap replications</span>
<span class="sd">        std : array</span>
<span class="sd">            standard deviation of parameter estimates over bootstrap</span>
<span class="sd">            replications</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This was mainly written to compare estimators of the standard errors of</span>
<span class="sd">        the parameter estimates.  It uses independent random sampling from the</span>
<span class="sd">        original endog and exog, and therefore is only correct if observations</span>
<span class="sd">        are independently distributed.</span>

<span class="sd">        This will be moved to apply only to models with independently</span>
<span class="sd">        distributed observations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="n">hascloneattr</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;cloneattr&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrep</span><span class="p">):</span>
            <span class="n">rvsind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span>
            <span class="c1"># this needs to set startparam and get other defining attributes</span>
            <span class="c1"># need a clone method on model</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">exog_resamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog</span><span class="p">[</span><span class="n">rvsind</span><span class="p">,</span> <span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">exog_resamp</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">fitmod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endog</span><span class="p">[</span><span class="n">rvsind</span><span class="p">],</span>
                                          <span class="n">exog</span><span class="o">=</span><span class="n">exog_resamp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hascloneattr</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cloneattr</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">fitmod</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

            <span class="n">fitres</span> <span class="o">=</span> <span class="n">fitmod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="n">disp</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitres</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">store</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_results</span> <span class="o">=</span> <span class="n">results</span>
        <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">results</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">results</span></div>

<div class="viewcode-block" id="ResultMixin.get_nlfun"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.ResultMixin.get_nlfun.html#statsmodels.base.model.ResultMixin.get_nlfun">[docs]</a>    <span class="k">def</span> <span class="nf">get_nlfun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_nlfun</span>

<span class="sd">        This is not Implemented</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># I think this is supposed to get the delta method that is currently</span>
        <span class="c1"># in miscmodels count (as part of Poisson example)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="GenericLikelihoodModelResults"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModelResults.html#statsmodels.base.model.GenericLikelihoodModelResults">[docs]</a><span class="k">class</span> <span class="nc">GenericLikelihoodModelResults</span><span class="p">(</span><span class="n">LikelihoodModelResults</span><span class="p">,</span> <span class="n">ResultMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A results class for the discrete dependent variable models.</span>

<span class="sd">    ..Warning :</span>

<span class="sd">    The following description has not been updated to this version/class.</span>
<span class="sd">    Where are AIC, BIC, ....? docstring looks like copy from discretemod</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : A DiscreteModel instance</span>
<span class="sd">    mlefit : instance of LikelihoodResults</span>
<span class="sd">        This contains the numerical optimization results as returned by</span>
<span class="sd">        LikelihoodModel.fit(), in a superclass of GnericLikelihoodModels</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    aic : float</span>
<span class="sd">        Akaike information criterion.  -2*(`llf` - p) where p is the number</span>
<span class="sd">        of regressors including the intercept.</span>
<span class="sd">    bic : float</span>
<span class="sd">        Bayesian information criterion. -2*`llf` + ln(`nobs`)*p where p is the</span>
<span class="sd">        number of regressors including the intercept.</span>
<span class="sd">    bse : array</span>
<span class="sd">        The standard errors of the coefficients.</span>
<span class="sd">    df_resid : float</span>
<span class="sd">        See model definition.</span>
<span class="sd">    df_model : float</span>
<span class="sd">        See model definition.</span>
<span class="sd">    fitted_values : array</span>
<span class="sd">        Linear predictor XB.</span>
<span class="sd">    llf : float</span>
<span class="sd">        Value of the loglikelihood</span>
<span class="sd">    llnull : float</span>
<span class="sd">        Value of the constant-only loglikelihood</span>
<span class="sd">    llr : float</span>
<span class="sd">        Likelihood ratio chi-squared statistic; -2*(`llnull` - `llf`)</span>
<span class="sd">    llr_pvalue : float</span>
<span class="sd">        The chi-squared probability of getting a log-likelihood ratio</span>
<span class="sd">        statistic greater than llr.  llr has a chi-squared distribution</span>
<span class="sd">        with degrees of freedom `df_model`.</span>
<span class="sd">    prsquared : float</span>
<span class="sd">        McFadden&#39;s pseudo-R-squared. 1 - (`llf`/`llnull`)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">mlefit</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endog</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">endog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">exog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nobs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># TODO: possibly move to model.fit()</span>
        <span class="c1">#       and outsource together with patching names</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;df_model&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">df_model</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mlefit</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="c1"># retrofitting the model, used in t_test TODO: check design</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">df_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;df_resid&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">df_resid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endog</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_model</span>
            <span class="c1"># retrofitting the model, used in t_test TODO: check design</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">df_resid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_resid</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mlefit</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>

<div class="viewcode-block" id="GenericLikelihoodModelResults.summary"><a class="viewcode-back" href="../../../dev/generated/statsmodels.base.model.GenericLikelihoodModelResults.summary.html#statsmodels.base.model.GenericLikelihoodModelResults.summary">[docs]</a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">05</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Summarize the Regression Results</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        yname : string, optional</span>
<span class="sd">            Default is `y`</span>
<span class="sd">        xname : list of strings, optional</span>
<span class="sd">            Default is `var_##` for ## in p the number of regressors</span>
<span class="sd">        title : string, optional</span>
<span class="sd">            Title for the top table. If not None, then this replaces the</span>
<span class="sd">            default title</span>
<span class="sd">        alpha : float</span>
<span class="sd">            significance level for the confidence intervals</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        smry : Summary instance</span>
<span class="sd">            this holds the summary tables and text, which can be printed or</span>
<span class="sd">            converted to various output formats.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        statsmodels.iolib.summary.Summary : class to hold summary results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">top_left</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Dep. Variable:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Model:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Method:&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Maximum Likelihood&#39;</span><span class="p">]),</span>
                    <span class="p">(</span><span class="s1">&#39;Date:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Time:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;No. Observations:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Df Residuals:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;Df Model:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="p">]</span>

        <span class="n">top_right</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Log-Likelihood:&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;AIC:&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%#8.4g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">aic</span><span class="p">]),</span>
                     <span class="p">(</span><span class="s1">&#39;BIC:&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%#8.4g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">bic</span><span class="p">])</span>
                     <span class="p">]</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s2">&quot;Results&quot;</span>

        <span class="c1"># create summary table instance</span>
        <span class="kn">from</span> <span class="nn">statsmodels.iolib.summary</span> <span class="k">import</span> <span class="n">Summary</span>
        <span class="n">smry</span> <span class="o">=</span> <span class="n">Summary</span><span class="p">()</span>
        <span class="n">smry</span><span class="o">.</span><span class="n">add_table_2cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gleft</span><span class="o">=</span><span class="n">top_left</span><span class="p">,</span> <span class="n">gright</span><span class="o">=</span><span class="n">top_right</span><span class="p">,</span>
                             <span class="n">yname</span><span class="o">=</span><span class="n">yname</span><span class="p">,</span> <span class="n">xname</span><span class="o">=</span><span class="n">xname</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
        <span class="n">smry</span><span class="o">.</span><span class="n">add_table_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yname</span><span class="o">=</span><span class="n">yname</span><span class="p">,</span> <span class="n">xname</span><span class="o">=</span><span class="n">xname</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                              <span class="n">use_t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_t</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">smry</span></div></div>
</pre></div>




          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2018, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>