

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Markov switching autoregression models &#8212; statsmodels</title>
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Exponential smoothing" href="exponential_smoothing.html" />
    <link rel="prev" title="Markov switching dynamic regression models" href="markov_regression.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/notebooks/generated/markov_autoregression" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="statsmodels"
           class="md-header-nav__button md-logo">
          
              <img src="../../../_static/statsmodels-logo-v2-bw.svg" height="26"
                   alt="statsmodels logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">statsmodels v0.12.2</span>
          <span class="md-header-nav__topic"> Markov switching autoregression models </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../_static/versions.json",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">Examples</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="statsmodels" class="md-nav__button md-logo">
      
        <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="statsmodels">statsmodels v0.12.2</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../../install.html" class="md-nav__link">Installing statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../gettingstarted.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../user-guide.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html" class="md-nav__link">Examples</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../index.html#linear-regression-models" class="md-nav__link">Linear Regression Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#plotting" class="md-nav__link">Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">Discrete Choice Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">Nonparametric Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">Generalized Linear Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#robust-regression" class="md-nav__link">Robust Regression</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">Generalized Estimating Equations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#statistics" class="md-nav__link">Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#time-series-analysis" class="md-nav__link">Time Series Analysis</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="autoregressions.html" class="md-nav__link">Autoregressions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="autoregressions.html#Forecasting" class="md-nav__link">Forecasting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="deterministics.html" class="md-nav__link">Deterministic Terms in Time Series Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tsa_arma_0.html" class="md-nav__link">Autoregressive Moving Average (ARMA): Sunspots data</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tsa_arma_1.html" class="md-nav__link">Autoregressive Moving Average (ARMA): Artificial data</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tsa_filters.html" class="md-nav__link">Time Series Filters</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="markov_regression.html" class="md-nav__link">Markov switching dynamic regression models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Markov switching autoregression models </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Markov switching autoregression models</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-markov-autoregression--page-root" class="md-nav__link">Markov switching autoregression models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Hamilton-(1989)-switching-model-of-GNP" class="md-nav__link">Hamilton (1989) switching model of GNP</a>
        </li>
        <li class="md-nav__item"><a href="#Kim,-Nelson,-and-Startz-(1998)-Three-state-Variance-Switching" class="md-nav__link">Kim, Nelson, and Startz (1998) Three-state Variance Switching</a>
        </li>
        <li class="md-nav__item"><a href="#Filardo-(1994)-Time-Varying-Transition-Probabilities" class="md-nav__link">Filardo (1994) Time-Varying Transition Probabilities</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/markov_autoregression.ipynb.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="exponential_smoothing.html" class="md-nav__link">Exponential smoothing</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="exponential_smoothing.html#Simulations-and-Confidence-Intervals" class="md-nav__link">Simulations and Confidence Intervals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="stl_decomposition.html" class="md-nav__link">Seasonal-Trend decomposition using LOESS (STL)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="stationarity_detrending_adf_kpss.html" class="md-nav__link">Stationarity and detrending (ADF/KPSS)</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models" class="md-nav__link">State space models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">State space models - Technical notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#forecasting" class="md-nav__link">Forecasting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#multivariate-methods" class="md-nav__link">Multivariate Methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#user-notes" class="md-nav__link">User Notes</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../api.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../about.html" class="md-nav__link">About statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../dev/index.html" class="md-nav__link">Developer Page</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../release/index.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-markov-autoregression--page-root" class="md-nav__link">Markov switching autoregression models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Hamilton-(1989)-switching-model-of-GNP" class="md-nav__link">Hamilton (1989) switching model of GNP</a>
        </li>
        <li class="md-nav__item"><a href="#Kim,-Nelson,-and-Startz-(1998)-Three-state-Variance-Switching" class="md-nav__link">Kim, Nelson, and Startz (1998) Three-state Variance Switching</a>
        </li>
        <li class="md-nav__item"><a href="#Filardo-(1994)-Time-Varying-Transition-Probabilities" class="md-nav__link">Filardo (1994) Time-Varying Transition Probabilities</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/markov_autoregression.ipynb.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>

<h1 id="examples-notebooks-generated-markov-autoregression--page-root">Markov switching autoregression models<a class="headerlink" href="#examples-notebooks-generated-markov-autoregression--page-root" title="Permalink to this headline">¶</a></h1>
<p>This notebook provides an example of the use of Markov switching models in statsmodels to replicate a number of results presented in Kim and Nelson (1999). It applies the Hamilton (1989) filter the Kim (1994) smoother.</p>
<p>This is tested against the Markov-switching models from E-views 8, which can be found at <a class="reference external" href="http://www.eviews.com/EViews8/ev8ecswitch_n.html#MarkovAR">http://www.eviews.com/EViews8/ev8ecswitch_n.html#MarkovAR</a> or the Markov-switching models of Stata 14 which can be found at <a class="reference external" href="http://www.stata.com/manuals14/tsmswitch.pdf">http://www.stata.com/manuals14/tsmswitch.pdf</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="c1"># NBER recessions</span>
<span class="kn">from</span> <span class="nn">pandas_datareader.data</span> <span class="kn">import</span> <span class="n">DataReader</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">usrec</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s1">'USREC'</span><span class="p">,</span> <span class="s1">'fred'</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1947</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>

<h2 id="Hamilton-(1989)-switching-model-of-GNP">Hamilton (1989) switching model of GNP<a class="headerlink" href="#Hamilton-(1989)-switching-model-of-GNP" title="Permalink to this headline">¶</a></h2>
<p>This replicates Hamilton’s (1989) seminal paper introducing Markov-switching models. The model is an autoregressive model of order 4 in which the mean of the process switches between two regimes. It can be written:</p>
<div class="math notranslate nohighlight">
\[y_t = \mu_{S_t} + \phi_1 (y_{t-1} - \mu_{S_{t-1}}) + \phi_2 (y_{t-2} - \mu_{S_{t-2}}) + \phi_3 (y_{t-3} - \mu_{S_{t-3}}) + \phi_4 (y_{t-4} - \mu_{S_{t-4}}) + \varepsilon_t\]</div>
<p>Each period, the regime transitions according to the following matrix of transition probabilities:</p>
<div class="math notranslate nohighlight">
\[\begin{split} P(S_t = s_t | S_{t-1} = s_{t-1}) =
\begin{bmatrix}
p_{00} &amp; p_{10} \\
p_{01} &amp; p_{11}
\end{bmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_{ij}\)</span> is the probability of transitioning <em>from</em> regime <span class="math notranslate nohighlight">\(i\)</span>, <em>to</em> regime <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>The model class is <code class="docutils literal notranslate"><span class="pre">MarkovAutoregression</span></code> in the time-series part of <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. In order to create the model, we must specify the number of regimes with <code class="docutils literal notranslate"><span class="pre">k_regimes=2</span></code>, and the order of the autoregression with <code class="docutils literal notranslate"><span class="pre">order=4</span></code>. The default model also includes switching autoregressive coefficients, so here we also need to specify <code class="docutils literal notranslate"><span class="pre">switching_ar=False</span></code> to avoid that.</p>
<p>After creation, the model is <code class="docutils literal notranslate"><span class="pre">fit</span></code> via maximum likelihood estimation. Under the hood, good starting parameters are found using a number of steps of the expectation maximization (EM) algorithm, and a quasi-Newton (BFGS) algorithm is applied to quickly find the maximum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get the RGNP data to replicate Hamilton</span>
<span class="n">dta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">'https://www.stata-press.com/data/r14/rgnp.dta'</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">dta</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">dta</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'QS'</span><span class="p">)</span>
<span class="n">dta_hamilton</span> <span class="o">=</span> <span class="n">dta</span><span class="o">.</span><span class="n">rgnp</span>

<span class="c1"># Plot the data</span>
<span class="n">dta_hamilton</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Growth rate of Real GNP'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Fit the model</span>
<span class="n">mod_hamilton</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovAutoregression</span><span class="p">(</span><span class="n">dta_hamilton</span><span class="p">,</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">switching_ar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">res_hamilton</span> <span class="o">=</span> <span class="n">mod_hamilton</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_4_0.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_4_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">res_hamilton</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>Markov Switching Model Results</caption>
<tr>
<th>Dep. Variable:</th> <td>rgnp</td> <th>  No. Observations:  </th> <td>131</td>
</tr>
<tr>
<th>Model:</th> <td>MarkovAutoregression</td> <th>  Log Likelihood     </th> <td>-181.263</td>
</tr>
<tr>
<th>Date:</th> <td>Tue, 02 Feb 2021</td> <th>  AIC                </th> <td>380.527</td>
</tr>
<tr>
<th>Time:</th> <td>06:52:20</td> <th>  BIC                </th> <td>406.404</td>
</tr>
<tr>
<th>Sample:</th> <td>04-01-1951</td> <th>  HQIC               </th> <td>391.042</td>
</tr>
<tr>
<th></th> <td>- 10-01-1984</td> <th> </th> <td> </td>
</tr>
<tr>
<th>Covariance Type:</th> <td>approx</td> <th> </th> <td> </td>
</tr>
</table>
<table>
<caption>Regime 0 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>const</th> <td>   -0.3588</td> <td>    0.265</td> <td>   -1.356</td> <td> 0.175</td> <td>   -0.877</td> <td>    0.160</td>
</tr>
</table>
<table>
<caption>Regime 1 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>const</th> <td>    1.1635</td> <td>    0.075</td> <td>   15.614</td> <td> 0.000</td> <td>    1.017</td> <td>    1.310</td>
</tr>
</table>
<table>
<caption>Non-switching parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>sigma2</th> <td>    0.5914</td> <td>    0.103</td> <td>    5.761</td> <td> 0.000</td> <td>    0.390</td> <td>    0.793</td>
</tr>
<tr>
<th>ar.L1</th> <td>    0.0135</td> <td>    0.120</td> <td>    0.112</td> <td> 0.911</td> <td>   -0.222</td> <td>    0.249</td>
</tr>
<tr>
<th>ar.L2</th> <td>   -0.0575</td> <td>    0.138</td> <td>   -0.418</td> <td> 0.676</td> <td>   -0.327</td> <td>    0.212</td>
</tr>
<tr>
<th>ar.L3</th> <td>   -0.2470</td> <td>    0.107</td> <td>   -2.310</td> <td> 0.021</td> <td>   -0.457</td> <td>   -0.037</td>
</tr>
<tr>
<th>ar.L4</th> <td>   -0.2129</td> <td>    0.111</td> <td>   -1.926</td> <td> 0.054</td> <td>   -0.430</td> <td>    0.004</td>
</tr>
</table>
<table>
<caption>Regime transition parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>p[0-&gt;0]</th> <td>    0.7547</td> <td>    0.097</td> <td>    7.819</td> <td> 0.000</td> <td>    0.565</td> <td>    0.944</td>
</tr>
<tr>
<th>p[1-&gt;0]</th> <td>    0.0959</td> <td>    0.038</td> <td>    2.542</td> <td> 0.011</td> <td>    0.022</td> <td>    0.170</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>We plot the filtered and smoothed probabilities of a recession. Filtered refers to an estimate of the probability at time <span class="math notranslate nohighlight">\(t\)</span> based on data up to and including time <span class="math notranslate nohighlight">\(t\)</span> (but excluding time <span class="math notranslate nohighlight">\(t+1, ..., T\)</span>). Smoothed refers to an estimate of the probability at time <span class="math notranslate nohighlight">\(t\)</span> using all the data in the sample.</p>
<p>For reference, the shaded periods represent the NBER recessions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_hamilton</span><span class="o">.</span><span class="n">filtered_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">usrec</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">usrec</span><span class="p">[</span><span class="s1">'USREC'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">dta_hamilton</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">dta_hamilton</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Filtered probability of recession'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_hamilton</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">usrec</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">usrec</span><span class="p">[</span><span class="s1">'USREC'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">dta_hamilton</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">dta_hamilton</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Smoothed probability of recession'</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_7_0.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_7_0.png"/>
</div>
</div>
<p>From the estimated transition matrix we can calculate the expected duration of a recession versus an expansion.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_hamilton</span><span class="o">.</span><span class="n">expected_durations</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 4.07604747 10.42589381]
</pre></div></div>
</div>
<p>In this case, it is expected that a recession will last about one year (4 quarters) and an expansion about two and a half years.</p>


<h2 id="Kim,-Nelson,-and-Startz-(1998)-Three-state-Variance-Switching">Kim, Nelson, and Startz (1998) Three-state Variance Switching<a class="headerlink" href="#Kim,-Nelson,-and-Startz-(1998)-Three-state-Variance-Switching" title="Permalink to this headline">¶</a></h2>
<p>This model demonstrates estimation with regime heteroskedasticity (switching of variances) and no mean effect. The dataset can be reached at <a class="reference external" href="http://econ.korea.ac.kr/~cjkim/MARKOV/data/ew_excs.prn">http://econ.korea.ac.kr/~cjkim/MARKOV/data/ew_excs.prn</a>.</p>
<p>The model in question is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
y_t &amp; = \varepsilon_t \\
\varepsilon_t &amp; \sim N(0, \sigma_{S_t}^2)
\end{align}\end{split}\]</div>
<p>Since there is no autoregressive component, this model can be fit using the <code class="docutils literal notranslate"><span class="pre">MarkovRegression</span></code> class. Since there is no mean effect, we specify <code class="docutils literal notranslate"><span class="pre">trend='nc'</span></code>. There are hypothesized to be three regimes for the switching variances, so we specify <code class="docutils literal notranslate"><span class="pre">k_regimes=3</span></code> and <code class="docutils literal notranslate"><span class="pre">switching_variance=True</span></code> (by default, the variance is assumed to be the same across regimes).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get the dataset</span>
<span class="n">ew_excs</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'http://econ.korea.ac.kr/~cjkim/MARKOV/data/ew_excs.prn'</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">ew_excs</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skipfooter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">'python'</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">'1926-01-01'</span><span class="p">,</span> <span class="s1">'1995-12-01'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'MS'</span><span class="p">)</span>

<span class="n">dta_kns</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">'1986'</span><span class="p">]</span> <span class="o">-</span> <span class="n">raw</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">'1986'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Plot the dataset</span>
<span class="n">dta_kns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Excess returns'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Fit the model</span>
<span class="n">mod_kns</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovRegression</span><span class="p">(</span><span class="n">dta_kns</span><span class="p">,</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">'nc'</span><span class="p">,</span> <span class="n">switching_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">res_kns</span> <span class="o">=</span> <span class="n">mod_kns</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_12_0.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_12_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">res_kns</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>Markov Switching Model Results</caption>
<tr>
<th>Dep. Variable:</th> <td>0</td> <th>  No. Observations:  </th> <td>732</td>
</tr>
<tr>
<th>Model:</th> <td>MarkovRegression</td> <th>  Log Likelihood     </th> <td>1001.895</td>
</tr>
<tr>
<th>Date:</th> <td>Tue, 02 Feb 2021</td> <th>  AIC                </th> <td>-1985.790</td>
</tr>
<tr>
<th>Time:</th> <td>06:52:26</td> <th>  BIC                </th> <td>-1944.428</td>
</tr>
<tr>
<th>Sample:</th> <td>01-01-1926</td> <th>  HQIC               </th> <td>-1969.834</td>
</tr>
<tr>
<th></th> <td>- 12-01-1986</td> <th> </th> <td> </td>
</tr>
<tr>
<th>Covariance Type:</th> <td>approx</td> <th> </th> <td> </td>
</tr>
</table>
<table>
<caption>Regime 0 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>sigma2</th> <td>    0.0012</td> <td>    0.000</td> <td>    7.136</td> <td> 0.000</td> <td>    0.001</td> <td>    0.002</td>
</tr>
</table>
<table>
<caption>Regime 1 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>sigma2</th> <td>    0.0040</td> <td>    0.000</td> <td>    8.489</td> <td> 0.000</td> <td>    0.003</td> <td>    0.005</td>
</tr>
</table>
<table>
<caption>Regime 2 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>sigma2</th> <td>    0.0311</td> <td>    0.006</td> <td>    5.461</td> <td> 0.000</td> <td>    0.020</td> <td>    0.042</td>
</tr>
</table>
<table>
<caption>Regime transition parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>p[0-&gt;0]</th> <td>    0.9747</td> <td>    0.000</td> <td> 7857.416</td> <td> 0.000</td> <td>    0.974</td> <td>    0.975</td>
</tr>
<tr>
<th>p[1-&gt;0]</th> <td>    0.0195</td> <td>    0.010</td> <td>    1.949</td> <td> 0.051</td> <td>   -0.000</td> <td>    0.039</td>
</tr>
<tr>
<th>p[2-&gt;0]</th> <td> 2.354e-08</td> <td>      nan</td> <td>      nan</td> <td>   nan</td> <td>      nan</td> <td>      nan</td>
</tr>
<tr>
<th>p[0-&gt;1]</th> <td>    0.0253</td> <td> 3.97e-05</td> <td>  637.835</td> <td> 0.000</td> <td>    0.025</td> <td>    0.025</td>
</tr>
<tr>
<th>p[1-&gt;1]</th> <td>    0.9688</td> <td>    0.013</td> <td>   75.528</td> <td> 0.000</td> <td>    0.944</td> <td>    0.994</td>
</tr>
<tr>
<th>p[2-&gt;1]</th> <td>    0.0493</td> <td>    0.032</td> <td>    1.551</td> <td> 0.121</td> <td>   -0.013</td> <td>    0.112</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>Below we plot the probabilities of being in each of the regimes; only in a few periods is a high-variance regime probable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_kns</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Smoothed probability of a low-variance regime for stock returns'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_kns</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Smoothed probability of a medium-variance regime for stock returns'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_kns</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Smoothed probability of a high-variance regime for stock returns'</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_15_0.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_15_0.png"/>
</div>
</div>


<h2 id="Filardo-(1994)-Time-Varying-Transition-Probabilities">Filardo (1994) Time-Varying Transition Probabilities<a class="headerlink" href="#Filardo-(1994)-Time-Varying-Transition-Probabilities" title="Permalink to this headline">¶</a></h2>
<p>This model demonstrates estimation with time-varying transition probabilities. The dataset can be reached at <a class="reference external" href="http://econ.korea.ac.kr/~cjkim/MARKOV/data/filardo.prn">http://econ.korea.ac.kr/~cjkim/MARKOV/data/filardo.prn</a>.</p>
<p>In the above models we have assumed that the transition probabilities are constant across time. Here we allow the probabilities to change with the state of the economy. Otherwise, the model is the same Markov autoregression of Hamilton (1989).</p>
<p>Each period, the regime now transitions according to the following matrix of time-varying transition probabilities:</p>
<div class="math notranslate nohighlight">
\[\begin{split} P(S_t = s_t | S_{t-1} = s_{t-1}) =
\begin{bmatrix}
p_{00,t} &amp; p_{10,t} \\
p_{01,t} &amp; p_{11,t}
\end{bmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_{ij,t}\)</span> is the probability of transitioning <em>from</em> regime <span class="math notranslate nohighlight">\(i\)</span>, <em>to</em> regime <span class="math notranslate nohighlight">\(j\)</span> in period <span class="math notranslate nohighlight">\(t\)</span>, and is defined to be:</p>
<div class="math notranslate nohighlight">
\[p_{ij,t} = \frac{\exp\{ x_{t-1}' \beta_{ij} \}}{1 + \exp\{ x_{t-1}' \beta_{ij} \}}\]</div>
<p>Instead of estimating the transition probabilities as part of maximum likelihood, the regression coefficients <span class="math notranslate nohighlight">\(\beta_{ij}\)</span> are estimated. These coefficients relate the transition probabilities to a vector of pre-determined or exogenous regressors <span class="math notranslate nohighlight">\(x_{t-1}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get the dataset</span>
<span class="n">filardo</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'http://econ.korea.ac.kr/~cjkim/MARKOV/data/filardo.prn'</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="n">dta_filardo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">filardo</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">' +'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skipfooter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">'python'</span><span class="p">)</span>
<span class="n">dta_filardo</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'month'</span><span class="p">,</span> <span class="s1">'ip'</span><span class="p">,</span> <span class="s1">'leading'</span><span class="p">]</span>
<span class="n">dta_filardo</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">'1948-01-01'</span><span class="p">,</span> <span class="s1">'1991-04-01'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'MS'</span><span class="p">)</span>

<span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="c1"># Deflated pre-1960 observations by ratio of std. devs.</span>
<span class="c1"># See hmt_tvp.opt or Filardo (1994) p. 302</span>
<span class="n">std_ratio</span> <span class="o">=</span> <span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlip'</span><span class="p">][</span><span class="s1">'1960-01-01'</span><span class="p">:]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlip'</span><span class="p">][:</span><span class="s1">'1959-12-01'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlip'</span><span class="p">][:</span><span class="s1">'1959-12-01'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlip'</span><span class="p">][:</span><span class="s1">'1959-12-01'</span><span class="p">]</span> <span class="o">*</span> <span class="n">std_ratio</span>

<span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlleading'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'leading'</span><span class="p">])</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dmdlleading'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlleading'</span><span class="p">]</span> <span class="o">-</span> <span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlleading'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Plot the data</span>
<span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dlip'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Standardized growth rate of industrial production'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">dta_filardo</span><span class="p">[</span><span class="s1">'dmdlleading'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Leading indicator'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:title={'center':'Leading indicator'}&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_17_1.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_17_1.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_17_2.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_17_2.png"/>
</div>
</div>
<p>The time-varying transition probabilities are specified by the <code class="docutils literal notranslate"><span class="pre">exog_tvtp</span></code> parameter.</p>
<p>Here we demonstrate another feature of model fitting - the use of a random search for MLE starting parameters. Because Markov switching models are often characterized by many local maxima of the likelihood function, performing an initial optimization step can be helpful to find the best parameters.</p>
<p>Below, we specify that 20 random perturbations from the starting parameter vector are examined and the best one used as the actual starting parameters. Because of the random nature of the search, we seed the random number generator beforehand to allow replication of the result.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mod_filardo</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">MarkovAutoregression</span><span class="p">(</span>
    <span class="n">dta_filardo</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:][</span><span class="s1">'dlip'</span><span class="p">],</span> <span class="n">k_regimes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">switching_ar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">exog_tvtp</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">dta_filardo</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">'dmdlleading'</span><span class="p">]))</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">res_filardo</span> <span class="o">=</span> <span class="n">mod_filardo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">search_reps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">res_filardo</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>Markov Switching Model Results</caption>
<tr>
<th>Dep. Variable:</th> <td>dlip</td> <th>  No. Observations:  </th> <td>514</td>
</tr>
<tr>
<th>Model:</th> <td>MarkovAutoregression</td> <th>  Log Likelihood     </th> <td>-586.572</td>
</tr>
<tr>
<th>Date:</th> <td>Tue, 02 Feb 2021</td> <th>  AIC                </th> <td>1195.144</td>
</tr>
<tr>
<th>Time:</th> <td>06:52:39</td> <th>  BIC                </th> <td>1241.808</td>
</tr>
<tr>
<th>Sample:</th> <td>03-01-1948</td> <th>  HQIC               </th> <td>1213.433</td>
</tr>
<tr>
<th></th> <td>- 04-01-1991</td> <th> </th> <td> </td>
</tr>
<tr>
<th>Covariance Type:</th> <td>approx</td> <th> </th> <td> </td>
</tr>
</table>
<table>
<caption>Regime 0 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>const</th> <td>   -0.8659</td> <td>    0.153</td> <td>   -5.658</td> <td> 0.000</td> <td>   -1.166</td> <td>   -0.566</td>
</tr>
</table>
<table>
<caption>Regime 1 parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>const</th> <td>    0.5173</td> <td>    0.077</td> <td>    6.706</td> <td> 0.000</td> <td>    0.366</td> <td>    0.668</td>
</tr>
</table>
<table>
<caption>Non-switching parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>sigma2</th> <td>    0.4844</td> <td>    0.037</td> <td>   13.172</td> <td> 0.000</td> <td>    0.412</td> <td>    0.556</td>
</tr>
<tr>
<th>ar.L1</th> <td>    0.1895</td> <td>    0.050</td> <td>    3.761</td> <td> 0.000</td> <td>    0.091</td> <td>    0.288</td>
</tr>
<tr>
<th>ar.L2</th> <td>    0.0793</td> <td>    0.051</td> <td>    1.552</td> <td> 0.121</td> <td>   -0.021</td> <td>    0.180</td>
</tr>
<tr>
<th>ar.L3</th> <td>    0.1109</td> <td>    0.052</td> <td>    2.136</td> <td> 0.033</td> <td>    0.009</td> <td>    0.213</td>
</tr>
<tr>
<th>ar.L4</th> <td>    0.1223</td> <td>    0.051</td> <td>    2.418</td> <td> 0.016</td> <td>    0.023</td> <td>    0.221</td>
</tr>
</table>
<table>
<caption>Regime transition parameters</caption>
<tr>
<td></td> <th>coef</th> <th>std err</th> <th>z</th> <th>P&gt;|z|</th> <th>[0.025</th> <th>0.975]</th>
</tr>
<tr>
<th>p[0-&gt;0].tvtp0</th> <td>    1.6494</td> <td>    0.446</td> <td>    3.702</td> <td> 0.000</td> <td>    0.776</td> <td>    2.523</td>
</tr>
<tr>
<th>p[1-&gt;0].tvtp0</th> <td>   -4.3595</td> <td>    0.747</td> <td>   -5.833</td> <td> 0.000</td> <td>   -5.824</td> <td>   -2.895</td>
</tr>
<tr>
<th>p[0-&gt;0].tvtp1</th> <td>   -0.9945</td> <td>    0.566</td> <td>   -1.758</td> <td> 0.079</td> <td>   -2.103</td> <td>    0.114</td>
</tr>
<tr>
<th>p[1-&gt;0].tvtp1</th> <td>   -1.7702</td> <td>    0.508</td> <td>   -3.484</td> <td> 0.000</td> <td>   -2.766</td> <td>   -0.775</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using numerical (complex-step) differentiation.</div>
</div>
<p>Below we plot the smoothed probability of the economy operating in a low-production state, and again include the NBER recessions for comparison.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res_filardo</span><span class="o">.</span><span class="n">smoothed_marginal_probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">usrec</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">usrec</span><span class="p">[</span><span class="s1">'USREC'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">dta_filardo</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">dta_filardo</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">'Smoothed probability of a low-production state'</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Text(0.5, 1.0, 'Smoothed probability of a low-production state')]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_22_1.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_22_1.png"/>
</div>
</div>
<p>Using the time-varying transition probabilities, we can see how the expected duration of a low-production state changes over time:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">res_filardo</span><span class="o">.</span><span class="n">expected_durations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">'Expected duration of a low-production state'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:title={'center':'Expected duration of a low-production state'}&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_markov_autoregression_24_1.png" src="../../../_images/examples_notebooks_generated_markov_autoregression_24_1.png"/>
</div>
</div>
<p>During recessions, the expected duration of a low-production state is much higher than in an expansion.</p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="markov_regression.html" title="Markov switching dynamic regression models"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Markov switching dynamic regression models </span>
              </div>
            </a>
          
          
            <a href="exponential_smoothing.html" title="Exponential smoothing"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Exponential smoothing </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2009-2019, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
              
          </div>
            Last updated on
              Feb 02, 2021.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>