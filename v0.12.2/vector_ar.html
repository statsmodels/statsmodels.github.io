

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Vector Autoregressions tsa.vector_ar &#8212; statsmodels</title>
  <link rel="icon" type="image/png" sizes="32x32" href="_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="_static/icons/favicon-16x16.png">
  <link rel="manifest" href="_static/icons/site.webmanifest">
  <link rel="mask-icon" href="_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="_static/stylesheets/examples.css">
  <link rel="stylesheet" href="_static/stylesheets/deprecation.css">
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="statsmodels.tsa.vector_ar.var_model.VAR" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html" />
    <link rel="prev" title="statsmodels.tsa.statespace.tools.validate_vector_shape" href="generated/statsmodels.tsa.statespace.tools.validate_vector_shape.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#vector_ar" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="statsmodels"
           class="md-header-nav__button md-logo">
          
              <img src="_static/statsmodels-logo-v2-bw.svg" height="26"
                   alt="statsmodels logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">statsmodels v0.12.2</span>
          <span class="md-header-nav__topic"> Vector Autoregressions tsa.vector_ar </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "_static/versions.json",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="user-guide.html" class="md-tabs__link">User Guide</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="statsmodels" class="md-nav__button md-logo">
      
        <img src="_static/statsmodels-logo-v2-bw.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="statsmodels">statsmodels v0.12.2</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="install.html" class="md-nav__link">Installing statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="gettingstarted.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html" class="md-nav__link">User Guide</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#background" class="md-nav__link">Background</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#regression-and-linear-models" class="md-nav__link">Regression and Linear Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#time-series-analysis" class="md-nav__link">Time Series Analysis</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="tsa.html" class="md-nav__link">Time Series analysis <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace.html" class="md-nav__link">Time Series Analysis by State Space Methods <code class="xref py py-mod docutils literal notranslate"><span class="pre">statespace</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Vector Autoregressions <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code> </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Vector Autoregressions <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code></a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#vector-ar--page-root" class="md-nav__link">Vector Autoregressions <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#var-p-processes" class="md-nav__link">VAR(p) processes</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#model-fitting" class="md-nav__link">Model fitting</a>
        </li>
        <li class="md-nav__item"><a href="#lag-order-selection" class="md-nav__link">Lag order selection</a>
        </li>
        <li class="md-nav__item"><a href="#forecasting" class="md-nav__link">Forecasting</a>
        </li>
        <li class="md-nav__item"><a href="#module-statsmodels.tsa.vector_ar" class="md-nav__link">Class Reference</a>
        </li>
        <li class="md-nav__item"><a href="#post-estimation-analysis" class="md-nav__link">Post-estimation Analysis</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#impulse-response-analysis" class="md-nav__link">Impulse Response Analysis</a>
        </li>
        <li class="md-nav__item"><a href="#forecast-error-variance-decomposition-fevd" class="md-nav__link">Forecast Error Variance Decomposition (FEVD)</a>
        </li>
        <li class="md-nav__item"><a href="#statistical-tests" class="md-nav__link">Statistical tests</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#granger-causality" class="md-nav__link">Granger causality</a>
        </li>
        <li class="md-nav__item"><a href="#normality" class="md-nav__link">Normality</a>
        </li>
        <li class="md-nav__item"><a href="#whiteness-of-residuals" class="md-nav__link">Whiteness of residuals</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#structural-vector-autoregressions" class="md-nav__link">Structural Vector Autoregressions</a>
        </li>
        <li class="md-nav__item"><a href="#vector-error-correction-models-vecm" class="md-nav__link">Vector Error Correction Models (VECM)</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/vector_ar.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#other-models" class="md-nav__link">Other Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#statistics-and-tools" class="md-nav__link">Statistics and Tools</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#data-sets" class="md-nav__link">Data Sets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user-guide.html#sandbox" class="md-nav__link">Sandbox</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="examples/index.html" class="md-nav__link">Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="about.html" class="md-nav__link">About statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev/index.html" class="md-nav__link">Developer Page</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="release/index.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#vector-ar--page-root" class="md-nav__link">Vector Autoregressions <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#var-p-processes" class="md-nav__link">VAR(p) processes</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#model-fitting" class="md-nav__link">Model fitting</a>
        </li>
        <li class="md-nav__item"><a href="#lag-order-selection" class="md-nav__link">Lag order selection</a>
        </li>
        <li class="md-nav__item"><a href="#forecasting" class="md-nav__link">Forecasting</a>
        </li>
        <li class="md-nav__item"><a href="#module-statsmodels.tsa.vector_ar" class="md-nav__link">Class Reference</a>
        </li>
        <li class="md-nav__item"><a href="#post-estimation-analysis" class="md-nav__link">Post-estimation Analysis</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#impulse-response-analysis" class="md-nav__link">Impulse Response Analysis</a>
        </li>
        <li class="md-nav__item"><a href="#forecast-error-variance-decomposition-fevd" class="md-nav__link">Forecast Error Variance Decomposition (FEVD)</a>
        </li>
        <li class="md-nav__item"><a href="#statistical-tests" class="md-nav__link">Statistical tests</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#granger-causality" class="md-nav__link">Granger causality</a>
        </li>
        <li class="md-nav__item"><a href="#normality" class="md-nav__link">Normality</a>
        </li>
        <li class="md-nav__item"><a href="#whiteness-of-residuals" class="md-nav__link">Whiteness of residuals</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#structural-vector-autoregressions" class="md-nav__link">Structural Vector Autoregressions</a>
        </li>
        <li class="md-nav__item"><a href="#vector-error-correction-models-vecm" class="md-nav__link">Vector Error Correction Models (VECM)</a>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/vector_ar.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <span class="target" id="module-statsmodels.tsa.vector_ar.var_model"></span>
<span id="var"></span><h1 id="vector-ar--page-root">Vector Autoregressions <code class="xref py py-mod docutils literal notranslate"><span class="pre">tsa.vector_ar</span></code><a class="headerlink" href="#vector-ar--page-root" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#module-statsmodels.tsa.vector_ar" title="statsmodels.tsa.vector_ar: Vector autoregressions and related tools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">statsmodels.tsa.vector_ar</span></code></a> contains methods that are useful
for simultaneously modeling and analyzing multiple time series using
<a class="reference internal" href="#var"><span class="std std-ref">Vector Autoregressions (VAR)</span></a> and
<a class="reference internal" href="#vecm"><span class="std std-ref">Vector Error Correction Models (VECM)</span></a>.</p>

<span id="var-process"></span><h2 id="var-p-processes">VAR(p) processes<a class="headerlink" href="#var-p-processes" title="Permalink to this headline">¶</a></h2>
<p>We are interested in modeling a <span class="math notranslate nohighlight">\(T \times K\)</span> multivariate time series
<span class="math notranslate nohighlight">\(Y\)</span>, where <span class="math notranslate nohighlight">\(T\)</span> denotes the number of observations and <span class="math notranslate nohighlight">\(K\)</span> the
number of variables. One way of estimating relationships between the time series
and their lagged values is the <em>vector autoregression process</em>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}Y_t = \nu + A_1 Y_{t-1} + \ldots + A_p Y_{t-p} + u_t\\u_t \sim {\sf Normal}(0, \Sigma_u)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(A_i\)</span> is a <span class="math notranslate nohighlight">\(K \times K\)</span> coefficient matrix.</p>
<p>We follow in large part the methods and notation of <a class="reference external" href="https://www.springer.com/gb/book/9783540401728">Lutkepohl (2005)</a>,
which we will not develop here.</p>

<h3 id="model-fitting">Model fitting<a class="headerlink" href="#model-fitting" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The classes referenced below are accessible via the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">statsmodels.tsa.api</span></code> module.</p>
</div>
<p>To estimate a VAR model, one must first create the model using an <cite>ndarray</cite> of
homogeneous or structured dtype. When using a structured or record array, the
class will use the passed variable names. Otherwise they can be passed
explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># some example data</span>
<span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">VAR</span>

<span class="gp">In [5]: </span><span class="n">mdata</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">macrodata</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>

<span class="go"># prepare the dates index</span>
<span class="gp">In [6]: </span><span class="n">dates</span> <span class="o">=</span> <span class="n">mdata</span><span class="p">[[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'quarter'</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">quarterly</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="s2">"year"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"Q"</span> <span class="o">+</span> <span class="n">dates</span><span class="p">[</span><span class="s2">"quarter"</span><span class="p">]</span>

<span class="gp">In [8]: </span><span class="kn">from</span> <span class="nn">statsmodels.tsa.base.datetools</span> <span class="kn">import</span> <span class="n">dates_from_str</span>

<span class="gp">In [9]: </span><span class="n">quarterly</span> <span class="o">=</span> <span class="n">dates_from_str</span><span class="p">(</span><span class="n">quarterly</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">mdata</span> <span class="o">=</span> <span class="n">mdata</span><span class="p">[[</span><span class="s1">'realgdp'</span><span class="p">,</span><span class="s1">'realcons'</span><span class="p">,</span><span class="s1">'realinv'</span><span class="p">]]</span>

<span class="gp">In [11]: </span><span class="n">mdata</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">quarterly</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mdata</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="go"># make a VAR model</span>
<span class="gp">In [13]: </span><span class="n">model</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAR</span></code></a> class assumes that the passed time series are
stationary. Non-stationary or trending data can often be transformed to be
stationary by first-differencing or some other method. For direct analysis of
non-stationary time series, a standard stable VAR(p) model is not
appropriate.</p>
</div>
<p>To actually do the estimation, call the <cite>fit</cite> method with the desired lag
order. Or you can have the model select a lag order based on a standard
information criterion (see below):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gh">Out[15]: </span><span class="go"></span>
<span class="go">  Summary of Regression Results   </span>
<span class="go">==================================</span>
<span class="go">Model:                         VAR</span>
<span class="go">Method:                        OLS</span>
<span class="go">Date:           Tue, 02, Feb, 2021</span>
<span class="go">Time:                     07:07:31</span>
<span class="gt">--------------------------------------------------------------------</span>
<span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">Equations</span><span class="p">:</span>         <span class="mf">3.00000</span>    <span class="n">BIC</span><span class="p">:</span>                   <span class="o">-</span><span class="mf">27.5830</span>
<span class="ne">Nobs</span>:                     200.000    HQIC:                  -27.7892
<span class="n">Log</span> <span class="n">likelihood</span><span class="p">:</span>           <span class="mf">1962.57</span>    <span class="n">FPE</span><span class="p">:</span>                <span class="mf">7.42129e-13</span>
<span class="ne">AIC</span>:                     -27.9293    Det(Omega_mle):     6.69358e-13
<span class="gt">--------------------------------------------------------------------</span>
<span class="n">Results</span> <span class="k">for</span> <span class="n">equation</span> <span class="n">realgdp</span>
<span class="o">==============================================================================</span>
                 <span class="n">coefficient</span>       <span class="n">std</span><span class="o">.</span> <span class="n">error</span>           <span class="n">t</span><span class="o">-</span><span class="n">stat</span>            <span class="n">prob</span>
<span class="gt">------------------------------------------------------------------------------</span>
<span class="n">const</span>               <span class="mf">0.001527</span>         <span class="mf">0.001119</span>            <span class="mf">1.365</span>           <span class="mf">0.172</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">0.279435</span>         <span class="mf">0.169663</span>           <span class="o">-</span><span class="mf">1.647</span>           <span class="mf">0.100</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.675016</span>         <span class="mf">0.131285</span>            <span class="mf">5.142</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.033219</span>         <span class="mf">0.026194</span>            <span class="mf">1.268</span>           <span class="mf">0.205</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realgdp</span>          <span class="mf">0.008221</span>         <span class="mf">0.173522</span>            <span class="mf">0.047</span>           <span class="mf">0.962</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.290458</span>         <span class="mf">0.145904</span>            <span class="mf">1.991</span>           <span class="mf">0.047</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realinv</span>         <span class="o">-</span><span class="mf">0.007321</span>         <span class="mf">0.025786</span>           <span class="o">-</span><span class="mf">0.284</span>           <span class="mf">0.776</span>
<span class="o">==============================================================================</span>

<span class="n">Results</span> <span class="k">for</span> <span class="n">equation</span> <span class="n">realcons</span>
<span class="o">==============================================================================</span>
                 <span class="n">coefficient</span>       <span class="n">std</span><span class="o">.</span> <span class="n">error</span>           <span class="n">t</span><span class="o">-</span><span class="n">stat</span>            <span class="n">prob</span>
<span class="gt">------------------------------------------------------------------------------</span>
<span class="n">const</span>               <span class="mf">0.005460</span>         <span class="mf">0.000969</span>            <span class="mf">5.634</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">0.100468</span>         <span class="mf">0.146924</span>           <span class="o">-</span><span class="mf">0.684</span>           <span class="mf">0.494</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.268640</span>         <span class="mf">0.113690</span>            <span class="mf">2.363</span>           <span class="mf">0.018</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.025739</span>         <span class="mf">0.022683</span>            <span class="mf">1.135</span>           <span class="mf">0.257</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">0.123174</span>         <span class="mf">0.150267</span>           <span class="o">-</span><span class="mf">0.820</span>           <span class="mf">0.412</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.232499</span>         <span class="mf">0.126350</span>            <span class="mf">1.840</span>           <span class="mf">0.066</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.023504</span>         <span class="mf">0.022330</span>            <span class="mf">1.053</span>           <span class="mf">0.293</span>
<span class="o">==============================================================================</span>

<span class="n">Results</span> <span class="k">for</span> <span class="n">equation</span> <span class="n">realinv</span>
<span class="o">==============================================================================</span>
                 <span class="n">coefficient</span>       <span class="n">std</span><span class="o">.</span> <span class="n">error</span>           <span class="n">t</span><span class="o">-</span><span class="n">stat</span>            <span class="n">prob</span>
<span class="gt">------------------------------------------------------------------------------</span>
<span class="n">const</span>              <span class="o">-</span><span class="mf">0.023903</span>         <span class="mf">0.005863</span>           <span class="o">-</span><span class="mf">4.077</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realgdp</span>         <span class="o">-</span><span class="mf">1.970974</span>         <span class="mf">0.888892</span>           <span class="o">-</span><span class="mf">2.217</span>           <span class="mf">0.027</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">4.414162</span>         <span class="mf">0.687825</span>            <span class="mf">6.418</span>           <span class="mf">0.000</span>
<span class="n">L1</span><span class="o">.</span><span class="n">realinv</span>          <span class="mf">0.225479</span>         <span class="mf">0.137234</span>            <span class="mf">1.643</span>           <span class="mf">0.100</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realgdp</span>          <span class="mf">0.380786</span>         <span class="mf">0.909114</span>            <span class="mf">0.419</span>           <span class="mf">0.675</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realcons</span>         <span class="mf">0.800281</span>         <span class="mf">0.764416</span>            <span class="mf">1.047</span>           <span class="mf">0.295</span>
<span class="n">L2</span><span class="o">.</span><span class="n">realinv</span>         <span class="o">-</span><span class="mf">0.124079</span>         <span class="mf">0.135098</span>           <span class="o">-</span><span class="mf">0.918</span>           <span class="mf">0.358</span>
<span class="o">==============================================================================</span>

<span class="n">Correlation</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">residuals</span>
             <span class="n">realgdp</span>  <span class="n">realcons</span>   <span class="n">realinv</span>
<span class="n">realgdp</span>     <span class="mf">1.000000</span>  <span class="mf">0.603316</span>  <span class="mf">0.750722</span>
<span class="n">realcons</span>    <span class="mf">0.603316</span>  <span class="mf">1.000000</span>  <span class="mf">0.131951</span>
<span class="n">realinv</span>     <span class="mf">0.750722</span>  <span class="mf">0.131951</span>  <span class="mf">1.000000</span>
</pre></div>
</div>
<p>Several ways to visualize the data using <cite>matplotlib</cite> are available.</p>
<p>Plotting input time series:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[16]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_plot_input.png" src="_images/var_plot_input.png"/>
<p>Plotting time series autocorrelation function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">results</span><span class="o">.</span><span class="n">plot_acorr</span><span class="p">()</span>
<span class="gh">Out[17]: </span><span class="go">&lt;Figure size 1000x1000 with 9 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_plot_acorr.png" src="_images/var_plot_acorr.png"/>


<h3 id="lag-order-selection">Lag order selection<a class="headerlink" href="#lag-order-selection" title="Permalink to this headline">¶</a></h3>
<p>Choice of lag order can be a difficult problem. Standard analysis employs
likelihood test or information criteria-based order selection. We have
implemented the latter, accessible through the <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAR</span></code></a> class:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">model</span><span class="o">.</span><span class="n">select_order</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gh">Out[18]: </span><span class="go">&lt;statsmodels.tsa.vector_ar.var_model.LagOrderResults at 0x7f63ec288f90&gt;</span>
</pre></div>
</div>
<p>When calling the <cite>fit</cite> function, one can pass a maximum number of lags and the
order criterion to use for order selection:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ic</span><span class="o">=</span><span class="s1">'aic'</span><span class="p">)</span>
</pre></div>
</div>


<h3 id="forecasting">Forecasting<a class="headerlink" href="#forecasting" title="Permalink to this headline">¶</a></h3>
<p>The linear predictor is the optimal h-step ahead forecast in terms of
mean-squared error:</p>
<div class="math notranslate nohighlight">
\[y_t(h) = \nu + A_1 y_t(h − 1) + \cdots + A_p y_t(h − p)\]</div>
<p>We can use the <cite>forecast</cite> function to produce this forecast. Note that we have
to specify the “initial value” for the forecast:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">lag_order</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">k_ar</span>

<span class="gp">In [21]: </span><span class="n">results</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="n">lag_order</span><span class="p">:],</span> <span class="mi">5</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go"></span>
<span class="go">array([[ 0.00616044,  0.00500006,  0.00916198],</span>
<span class="go">       [ 0.00427559,  0.00344836, -0.00238478],</span>
<span class="go">       [ 0.00416634,  0.0070728 , -0.01193629],</span>
<span class="go">       [ 0.00557873,  0.00642784,  0.00147152],</span>
<span class="go">       [ 0.00626431,  0.00666715,  0.00379567]])</span>
</pre></div>
</div>
<p>The <cite>forecast_interval</cite> function will produce the above forecast along with
asymptotic standard errors. These can be visualized using the <cite>plot_forecast</cite>
function:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">results</span><span class="o">.</span><span class="n">plot_forecast</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gh">Out[22]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_forecast.png" src="_images/var_forecast.png"/>


<span id="class-reference"></span><h3 id="module-statsmodels.tsa.vector_ar">Class Reference<a class="headerlink" href="#module-statsmodels.tsa.vector_ar" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VAR</span></code></a>(endog[, exog, dates, freq, missing])</p></td>
<td><p>Fit VAR(p) process and do lag order selection</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARProcess.html#statsmodels.tsa.vector_ar.var_model.VARProcess" title="statsmodels.tsa.vector_ar.var_model.VARProcess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VARProcess</span></code></a>(coefs, coefs_exog, sigma_u[, …])</p></td>
<td><p>Class represents a known VAR(p) process</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VARResults</span></code></a>(endog, endog_lagged, params, …)</p></td>
<td><p>Estimate VAR(p) process with fixed number of lags</p></td>
</tr>
</tbody>
</table>


<h3 id="post-estimation-analysis">Post-estimation Analysis<a class="headerlink" href="#post-estimation-analysis" title="Permalink to this headline">¶</a></h3>
<p>Several process properties and additional results after
estimation are available for vector autoregressive processes.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.LagOrderResults.html#statsmodels.tsa.vector_ar.var_model.LagOrderResults" title="statsmodels.tsa.vector_ar.var_model.LagOrderResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LagOrderResults</span></code></a>(ics, selected_orders[, vecm])</p></td>
<td><p>Results class for choosing a model’s lag order.</p></td>
</tr>
</tbody>
</table>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.HypothesisTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.HypothesisTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.HypothesisTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HypothesisTestResults</span></code></a>(test_statistic, …)</p></td>
<td><p>Results class for hypothesis tests.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalityTestResults</span></code></a>(test_statistic, …)</p></td>
<td><p>Results class for the Jarque-Bera-test for nonnormality.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.WhitenessTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.WhitenessTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.WhitenessTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WhitenessTestResults</span></code></a>(test_statistic, …)</p></td>
<td><p>Results class for the Portmanteau-test for residual autocorrelation.</p></td>
</tr>
</tbody>
</table>



<h2 id="impulse-response-analysis">Impulse Response Analysis<a class="headerlink" href="#impulse-response-analysis" title="Permalink to this headline">¶</a></h2>
<p><em>Impulse responses</em> are of interest in econometric studies: they are the
estimated responses to a unit impulse in one of the variables. They are computed
in practice using the MA(<span class="math notranslate nohighlight">\(\infty\)</span>) representation of the VAR(p) process:</p>
<div class="math notranslate nohighlight">
\[Y_t = \mu + \sum_{i=0}^\infty \Phi_i u_{t-i}\]</div>
<p>We can perform an impulse response analysis by calling the <cite>irf</cite> function on a
<cite>VARResults</cite> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">irf</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">irf</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>These can be visualized using the <cite>plot</cite> function, in either orthogonalized or
non-orthogonalized form. Asymptotic standard errors are plotted by default at
the 95% significance level, which can be modified by the user.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Orthogonalization is done using the Cholesky decomposition of the estimated
error covariance matrix <span class="math notranslate nohighlight">\(\hat \Sigma_u\)</span> and hence interpretations may
change depending on variable ordering.</p>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">irf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[24]: </span><span class="go">&lt;Figure size 1000x1000 with 9 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_irf.png" src="_images/var_irf.png"/>
<p>Note the <cite>plot</cite> function is flexible and can plot only variables of interest if
so desired:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">irf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">impulse</span><span class="o">=</span><span class="s1">'realgdp'</span><span class="p">)</span>
<span class="gh">Out[25]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_realgdp.png" src="_images/var_realgdp.png"/>
<p>The cumulative effects <span class="math notranslate nohighlight">\(\Psi_n = \sum_{i=0}^n \Phi_i\)</span> can be plotted with
the long run effects as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">irf</span><span class="o">.</span><span class="n">plot_cum_effects</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[26]: </span><span class="go">&lt;Figure size 1000x1000 with 9 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_irf_cum.png" src="_images/var_irf_cum.png"/>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.irf.IRAnalysis.html#statsmodels.tsa.vector_ar.irf.IRAnalysis" title="statsmodels.tsa.vector_ar.irf.IRAnalysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IRAnalysis</span></code></a>(model[, P, periods, order, svar, …])</p></td>
<td><p>Impulse response analysis class.</p></td>
</tr>
</tbody>
</table>


<h2 id="forecast-error-variance-decomposition-fevd">Forecast Error Variance Decomposition (FEVD)<a class="headerlink" href="#forecast-error-variance-decomposition-fevd" title="Permalink to this headline">¶</a></h2>
<p>Forecast errors of component j on k in an i-step ahead forecast can be
decomposed using the orthogonalized impulse responses <span class="math notranslate nohighlight">\(\Theta_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\omega_{jk, i} = \sum_{i=0}^{h-1} (e_j^\prime \Theta_i e_k)^2 / \mathrm{MSE}_j(h)\\\mathrm{MSE}_j(h) = \sum_{i=0}^{h-1} e_j^\prime \Phi_i \Sigma_u \Phi_i^\prime e_j\end{aligned}\end{align} \]</div>
<p>These are computed via the <cite>fevd</cite> function up through a total number of steps ahead:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">fevd</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">fevd</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [28]: </span><span class="n">fevd</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">FEVD for realgdp</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    1.000000  0.000000  0.000000</span>
<span class="go">1    0.864889  0.129253  0.005858</span>
<span class="go">2    0.816725  0.177898  0.005378</span>
<span class="go">3    0.793647  0.197590  0.008763</span>
<span class="go">4    0.777279  0.208127  0.014594</span>

<span class="go">FEVD for realcons</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    0.359877  0.640123  0.000000</span>
<span class="go">1    0.358767  0.635420  0.005813</span>
<span class="go">2    0.348044  0.645138  0.006817</span>
<span class="go">3    0.319913  0.653609  0.026478</span>
<span class="go">4    0.317407  0.652180  0.030414</span>

<span class="go">FEVD for realinv</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    0.577021  0.152783  0.270196</span>
<span class="go">1    0.488158  0.293622  0.218220</span>
<span class="go">2    0.478727  0.314398  0.206874</span>
<span class="go">3    0.477182  0.315564  0.207254</span>
<span class="go">4    0.466741  0.324135  0.209124</span>
</pre></div>
</div>
<p>They can also be visualized through the returned <code class="xref py py-class docutils literal notranslate"><span class="pre">FEVD</span></code> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">results</span><span class="o">.</span><span class="n">fevd</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gh">Out[29]: </span><span class="go">&lt;Figure size 1000x1000 with 3 Axes&gt;</span>
</pre></div>
</div>
<img alt="_images/var_fevd.png" src="_images/var_fevd.png"/>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.FEVD.html#statsmodels.tsa.vector_ar.var_model.FEVD" title="statsmodels.tsa.vector_ar.var_model.FEVD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FEVD</span></code></a>(model[, P, periods])</p></td>
<td><p>Compute and plot Forecast error variance decomposition and asymptotic standard errors</p></td>
</tr>
</tbody>
</table>


<h2 id="statistical-tests">Statistical tests<a class="headerlink" href="#statistical-tests" title="Permalink to this headline">¶</a></h2>
<p>A number of different methods are provided to carry out hypothesis tests about
the model results and also the validity of the model assumptions (normality,
whiteness / “iid-ness” of errors, etc.).</p>

<h3 id="granger-causality">Granger causality<a class="headerlink" href="#granger-causality" title="Permalink to this headline">¶</a></h3>
<p>One is often interested in whether a variable or group of variables is “causal”
for another variable, for some definition of “causal”. In the context of VAR
models, one can say that a set of variables are Granger-causal within one of the
VAR equations. We will not detail the mathematics or definition of Granger
causality, but leave it to the reader. The <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARResults</span></code></a> object has the
<cite>test_causality</cite> method for performing either a Wald (<span class="math notranslate nohighlight">\(\chi^2\)</span>) test or an
F-test.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">results</span><span class="o">.</span><span class="n">test_causality</span><span class="p">(</span><span class="s1">'realgdp'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'realinv'</span><span class="p">,</span> <span class="s1">'realcons'</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">'f'</span><span class="p">)</span>
<span class="gh">Out[30]: </span><span class="go">&lt;statsmodels.tsa.vector_ar.hypothesis_test_results.CausalityTestResults at 0x7f63e2d0d110&gt;</span>
</pre></div>
</div>


<h3 id="normality">Normality<a class="headerlink" href="#normality" title="Permalink to this headline">¶</a></h3>
<p>As pointed out in the beginning of this document, the white noise component
<span class="math notranslate nohighlight">\(u_t\)</span> is assumed to be normally distributed. While this assumption
is not required for parameter estimates to be consistent or asymptotically
normal, results are generally more reliable in finite samples when residuals
are Gaussian white noise. To test whether this assumption is consistent with
a data set, <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARResults</span></code></a> offers the <cite>test_normality</cite> method.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [31]: </span><span class="n">results</span><span class="o">.</span><span class="n">test_normality</span><span class="p">()</span>
<span class="gh">Out[31]: </span><span class="go">&lt;statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults at 0x7f63e259d150&gt;</span>
</pre></div>
</div>


<h3 id="whiteness-of-residuals">Whiteness of residuals<a class="headerlink" href="#whiteness-of-residuals" title="Permalink to this headline">¶</a></h3>
<p>To test the whiteness of the estimation residuals (this means absence of
significant residual autocorrelations) one can use the <cite>test_whiteness</cite>
method of <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARResults</span></code></a>.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.HypothesisTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.HypothesisTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.HypothesisTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HypothesisTestResults</span></code></a>(test_statistic, …)</p></td>
<td><p>Results class for hypothesis tests.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.CausalityTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.CausalityTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.CausalityTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CausalityTestResults</span></code></a>(causing, caused, …[, …])</p></td>
<td><p>Results class for Granger-causality and instantaneous causality.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.NormalityTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalityTestResults</span></code></a>(test_statistic, …)</p></td>
<td><p>Results class for the Jarque-Bera-test for nonnormality.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.hypothesis_test_results.WhitenessTestResults.html#statsmodels.tsa.vector_ar.hypothesis_test_results.WhitenessTestResults" title="statsmodels.tsa.vector_ar.hypothesis_test_results.WhitenessTestResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WhitenessTestResults</span></code></a>(test_statistic, …)</p></td>
<td><p>Results class for the Portmanteau-test for residual autocorrelation.</p></td>
</tr>
</tbody>
</table>



<span id="svar"></span><h2 id="structural-vector-autoregressions">Structural Vector Autoregressions<a class="headerlink" href="#structural-vector-autoregressions" title="Permalink to this headline">¶</a></h2>
<p>There are a matching set of classes that handle some types of Structural VAR models.</p>
<span class="target" id="module-statsmodels.tsa.vector_ar.svar_model"></span><table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.svar_model.SVAR.html#statsmodels.tsa.vector_ar.svar_model.SVAR" title="statsmodels.tsa.vector_ar.svar_model.SVAR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SVAR</span></code></a>(endog, svar_type[, dates, freq, A, B, …])</p></td>
<td><p>Fit VAR and then estimate structural components of A and B, defined:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.svar_model.SVARProcess.html#statsmodels.tsa.vector_ar.svar_model.SVARProcess" title="statsmodels.tsa.vector_ar.svar_model.SVARProcess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SVARProcess</span></code></a>(coefs, intercept, sigma_u, …)</p></td>
<td><p>Class represents a known SVAR(p) process</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.svar_model.SVARResults.html#statsmodels.tsa.vector_ar.svar_model.SVARResults" title="statsmodels.tsa.vector_ar.svar_model.SVARResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SVARResults</span></code></a>(endog, endog_lagged, params, …)</p></td>
<td><p>Estimate VAR(p) process with fixed number of lags</p></td>
</tr>
</tbody>
</table>


<span id="vecm"></span><h2 id="vector-error-correction-models-vecm">Vector Error Correction Models (VECM)<a class="headerlink" href="#vector-error-correction-models-vecm" title="Permalink to this headline">¶</a></h2>
<p>Vector Error Correction Models are used to study short-run deviations from
one or more permanent stochastic trends (unit roots). A VECM models the
difference of a vector of time series by imposing structure that is implied
by the assumed number of stochastic trends. <code class="xref py py-class docutils literal notranslate"><span class="pre">VECM</span></code> is used to
specify and estimate these models.</p>
<p>A VECM(<span class="math notranslate nohighlight">\(k_{ar}-1\)</span>) has the following form</p>
<div class="math notranslate nohighlight">
\[\Delta y_t = \Pi y_{t-1} + \Gamma_1 \Delta y_{t-1} + \ldots
               + \Gamma_{k_{ar}-1} \Delta y_{t-k_{ar}+1} + u_t\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\Pi = \alpha \beta'\]</div>
<p>as described in chapter 7 of <a class="footnote-reference brackets" href="#id3" id="id1">1</a>.</p>
<p>A VECM(<span class="math notranslate nohighlight">\(k_{ar} - 1\)</span>) with deterministic terms has the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta y_t = \alpha \begin{pmatrix}\beta' &amp; \eta'\end{pmatrix} \begin{pmatrix}y_{t-1} \\
             D^{co}_{t-1}\end{pmatrix} + \Gamma_1 \Delta y_{t-1} + \dots + \Gamma_{k_{ar}-1} \Delta y_{t-k_{ar}+1} + C D_t + u_t.\end{split}\]</div>
<p>In <span class="math notranslate nohighlight">\(D^{co}_{t-1}\)</span> we have the deterministic terms which are inside
the cointegration relation (or restricted to the cointegration relation).
<span class="math notranslate nohighlight">\(\eta\)</span> is the corresponding estimator. To pass a deterministic term
inside the cointegration relation, we can use the <cite>exog_coint</cite> argument.
For the two special cases of an intercept and a linear trend there exists
a simpler way to declare these terms: we can pass <code class="docutils literal notranslate"><span class="pre">"ci"</span></code> and <code class="docutils literal notranslate"><span class="pre">"li"</span></code>
respectively to the <cite>deterministic</cite> argument. So for an intercept inside
the cointegration relation we can either pass <code class="docutils literal notranslate"><span class="pre">"ci"</span></code> as <cite>deterministic</cite>
or <cite>np.ones(len(data))</cite> as <cite>exog_coint</cite> if <cite>data</cite> is passed as the
<cite>endog</cite> argument. This ensures that <span class="math notranslate nohighlight">\(D_{t-1}^{co} = 1\)</span> for all
<span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We can also use deterministic terms outside the cointegration relation.
These are defined in <span class="math notranslate nohighlight">\(D_t\)</span> in the formula above with the
corresponding estimators in the matrix <span class="math notranslate nohighlight">\(C\)</span>. We specify such terms by
passing them to the <cite>exog</cite> argument. For an intercept and/or linear trend
we again have the possibility to use <cite>deterministic</cite> alternatively. For
an intercept we pass <code class="docutils literal notranslate"><span class="pre">"co"</span></code> and for a linear trend we pass <code class="docutils literal notranslate"><span class="pre">"lo"</span></code> where
the <cite>o</cite> stands for <cite>outside</cite>.</p>
<p>The following table shows the five cases considered in <a class="footnote-reference brackets" href="#id4" id="id2">2</a>. The last
column indicates which string to pass to the <cite>deterministic</cite> argument for
each of these cases.</p>
<table>
<colgroup>
<col style="width: 5%"/>
<col style="width: 36%"/>
<col style="width: 41%"/>
<col style="width: 18%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Case</p></th>
<th class="head"><p>Intercept</p></th>
<th class="head"><p>Slope of the linear trend</p></th>
<th class="head"><p><cite>deterministic</cite></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>I</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"nc"</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>II</p></td>
<td><p><span class="math notranslate nohighlight">\(- \alpha \beta^T \mu\)</span></p></td>
<td><p>0</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"ci"</span></code></p></td>
</tr>
<tr class="row-even"><td><p>III</p></td>
<td><p><span class="math notranslate nohighlight">\(\neq 0\)</span></p></td>
<td><p>0</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"co"</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>IV</p></td>
<td><p><span class="math notranslate nohighlight">\(\neq 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(- \alpha \beta^T \gamma\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"coli"</span></code></p></td>
</tr>
<tr class="row-even"><td><p>V</p></td>
<td><p><span class="math notranslate nohighlight">\(\neq 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\neq 0\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"colo"</span></code></p></td>
</tr>
</tbody>
</table>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.VECM.html#statsmodels.tsa.vector_ar.vecm.VECM" title="statsmodels.tsa.vector_ar.vecm.VECM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VECM</span></code></a>(endog[, exog, exog_coint, dates, freq, …])</p></td>
<td><p>Class representing a Vector Error Correction Model (VECM).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.coint_johansen.html#statsmodels.tsa.vector_ar.vecm.coint_johansen" title="statsmodels.tsa.vector_ar.vecm.coint_johansen"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coint_johansen</span></code></a>(endog, det_order, k_ar_diff)</p></td>
<td><p>Johansen cointegration test of the cointegration rank of a VECM</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.JohansenTestResult.html#statsmodels.tsa.vector_ar.vecm.JohansenTestResult" title="statsmodels.tsa.vector_ar.vecm.JohansenTestResult"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JohansenTestResult</span></code></a>(rkt, r0t, eig, evec, lr1, …)</p></td>
<td><p>Results class for Johansen’s cointegration test</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.select_order.html#statsmodels.tsa.vector_ar.vecm.select_order" title="statsmodels.tsa.vector_ar.vecm.select_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_order</span></code></a>(data, maxlags[, deterministic, …])</p></td>
<td><p>Compute lag order selections based on each of the available information criteria.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.select_coint_rank.html#statsmodels.tsa.vector_ar.vecm.select_coint_rank" title="statsmodels.tsa.vector_ar.vecm.select_coint_rank"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_coint_rank</span></code></a>(endog, det_order, k_ar_diff)</p></td>
<td><p>Calculate the cointegration rank of a VECM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.VECMResults.html#statsmodels.tsa.vector_ar.vecm.VECMResults" title="statsmodels.tsa.vector_ar.vecm.VECMResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VECMResults</span></code></a>(endog, exog, exog_coint, k_ar, …)</p></td>
<td><p>Class for holding estimation related results of a vector error correction model (VECM).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.vecm.CointRankResults.html#statsmodels.tsa.vector_ar.vecm.CointRankResults" title="statsmodels.tsa.vector_ar.vecm.CointRankResults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CointRankResults</span></code></a>(rank, neqs, test_stats, …)</p></td>
<td><p>A class for holding the results from testing the cointegration rank.</p></td>
</tr>
</tbody>
</table>


<h2 id="references">References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Lütkepohl, H. 2005. <em>New Introduction to Multiple Time Series Analysis</em>. Springer.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Johansen, S. 1995. <em>Likelihood-Based Inference in Cointegrated *
*Vector Autoregressive Models</em>. Oxford University Press.</p>
</dd>
</dl>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="generated/statsmodels.tsa.statespace.tools.validate_vector_shape.html" title="statsmodels.tsa.statespace.tools.validate_vector_shape"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> statsmodels.tsa.statespace.tools.validate_vector_shape </span>
              </div>
            </a>
          
          
            <a href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html" title="statsmodels.tsa.vector_ar.var_model.VAR"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> statsmodels.tsa.vector_ar.var_model.VAR </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2009-2019, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
              
          </div>
            Last updated on
              Feb 02, 2021.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>