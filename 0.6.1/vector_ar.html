
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Vector Autoregressions tsa.vector_ar &mdash; statsmodels 0.6.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/statsmodels_hybi_favico.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="statsmodels 0.6.1 documentation" href="index.html" />
<link rel="stylesheet" href="../../_static/facebox.css" type="text/css" />
<link rel="stylesheet" href="../_static/examples.css" type="text/css" />
<script type="text/javascript" src="_static/scripts.js">
</script>
<script type="text/javascript" src="_static/facebox.js">
</script>

  </head>
  <body role="document">
<div class="headerwrap">
    <div class = "header">
        
        <a href = "index.html">
<img src="_static/statsmodels_hybi_banner.png" alt="Logo"
    style="padding-left: 15px"/></a>
        
    </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
<li><a href ="install.html">Install</a></li> &nbsp;|&nbsp;
<li><a href="https://groups.google.com/group/pystatsmodels?hl=en">Support</a></li> &nbsp;|&nbsp;
<li><a href="https://github.com/statsmodels/statsmodels/issues">Bugs</a></li> &nbsp;|&nbsp;
<li><a href="dev/index.html">Develop</a></li> &nbsp;|&nbsp;
<li><a href="examples/index.html">Examples</a></li> &nbsp;|&nbsp;
<li><a href="faq.html">FAQ</a></li> &nbsp;|&nbsp;
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            




  <div class="section" id="vector-autoregressions-tsa-vector-ar">
<span id="var"></span><h1>Vector Autoregressions <code class="xref py py-mod docutils literal"><span class="pre">tsa.vector_ar</span></code><a class="headerlink" href="#vector-autoregressions-tsa-vector-ar" title="Permalink to this headline">¶</a></h1>
<div class="section" id="var-p-processes">
<h2>VAR(p) processes<a class="headerlink" href="#var-p-processes" title="Permalink to this headline">¶</a></h2>
<p>We are interested in modeling a <img class="math" src="_images/math/109f11ce65be4bd1c16ab4328964095a415e6d9e.png" alt="T \times K" style="vertical-align: 0px"/> multivariate time series
<img class="math" src="_images/math/00839aaaedc416a533d839086d66341205c7ffc4.png" alt="Y" style="vertical-align: 0px"/>, where <img class="math" src="_images/math/5830b1441ec19bff0c7f338ee28ccd12654c1f69.png" alt="T" style="vertical-align: 0px"/> denotes the number of observations and <img class="math" src="_images/math/e1c28c5aafda6ce10cad81bcc71b15a182ee21cb.png" alt="K" style="vertical-align: 0px"/> the
number of variables. One way of estimating relationships between the time series
and their lagged values is the <em>vector autoregression process</em>:</p>
<div class="math">
<p><img src="_images/math/652bccdc9aa717f450a04ae914ca766207716bf9.png" alt="Y_t = A_1 Y_{t-1} + \ldots + A_p Y_{t-p} + u_t

u_t \sim {\sf Normal}(0, \Sigma_u)"/></p>
</div><p>where <img class="math" src="_images/math/d7462593669cd2b400bdd2cf2700222e12284753.png" alt="A_i" style="vertical-align: -3px"/> is a <img class="math" src="_images/math/9b9bcf0f86862c7e8b96ac2a8aa6f9ba477403fe.png" alt="K \times K" style="vertical-align: 0px"/> coefficient matrix.</p>
<p>We follow in large part the methods and notation of <a class="reference external" href="http://www.springer.com/economics/econometrics/book/978-3-540-40172-8?otherVersion=978-3-540-26239-8">Lutkepohl (2005)</a>,
which we will not develop here.</p>
<div class="section" id="model-fitting">
<h3>Model fitting<a class="headerlink" href="#model-fitting" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The classes referenced below are accessible via the
<code class="xref py py-mod docutils literal"><span class="pre">statsmodels.tsa.api</span></code> module.</p>
</div>
<p>To estimate a VAR model, one must first create the model using an <cite>ndarray</cite> of
homogeneous or structured dtype. When using a structured or record array, the
class will use the passed variable names. Otherwise they can be passed
explicitly:</p>
<div class="highlight-python"><div class="highlight"><pre># some example data
&gt;&gt;&gt; import pandas
&gt;&gt;&gt; mdata = sm.datasets.macrodata.load_pandas().data

# prepare the dates index
&gt;&gt;&gt; dates = mdata[[&#39;year&#39;, &#39;quarter&#39;]].astype(int).astype(str)
&gt;&gt;&gt; quarterly = dates[&quot;year&quot;] + &quot;Q&quot; + dates[&quot;quarter&quot;]
&gt;&gt;&gt; from statsmodels.tsa.base.datetools import dates_from_str
&gt;&gt;&gt; quarterly = dates_from_str(quarterly)

&gt;&gt;&gt; mdata = mdata[[&#39;realgdp&#39;,&#39;realcons&#39;,&#39;realinv&#39;]]
&gt;&gt;&gt; mdata.index = pandas.DatetimeIndex(quarterly)
&gt;&gt;&gt; data = np.log(mdata).diff().dropna()

# make a VAR model
&gt;&gt;&gt; model = VAR(data)
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-class docutils literal"><span class="pre">VAR</span></code></a> class assumes that the passed time series are
stationary. Non-stationary or trending data can often be transformed to be
stationary by first-differencing or some other method. For direct analysis of
non-stationary time series, a standard stable VAR(p) model is not
appropriate.</p>
</div>
<p>To actually do the estimation, call the <cite>fit</cite> method with the desired lag
order. Or you can have the model select a lag order based on a standard
information criterion (see below):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="go">  Summary of Regression Results</span>
<span class="go">==================================</span>
<span class="go">Model:                         VAR</span>
<span class="go">Method:                        OLS</span>
<span class="go">Date:           Fri, 08, Jul, 2011</span>
<span class="go">Time:                     11:30:22</span>
<span class="go">--------------------------------------------------------------------</span>
<span class="go">No. of Equations:         3.00000    BIC:                   -27.5830</span>
<span class="go">Nobs:                     200.000    HQIC:                  -27.7892</span>
<span class="go">Log likelihood:           1962.57    FPE:                7.42129e-13</span>
<span class="go">AIC:                     -27.9293    Det(Omega_mle):     6.69358e-13</span>
<span class="go">--------------------------------------------------------------------</span>
<span class="go">Results for equation realgdp</span>
<span class="go">==============================================================================</span>
<span class="go">                 coefficient       std. error           t-stat            prob</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const               0.001527         0.001119            1.365           0.174</span>
<span class="go">L1.realgdp         -0.279435         0.169663           -1.647           0.101</span>
<span class="go">L1.realcons         0.675016         0.131285            5.142           0.000</span>
<span class="go">L1.realinv          0.033219         0.026194            1.268           0.206</span>
<span class="go">L2.realgdp          0.008221         0.173522            0.047           0.962</span>
<span class="go">L2.realcons         0.290458         0.145904            1.991           0.048</span>
<span class="go">L2.realinv         -0.007321         0.025786           -0.284           0.777</span>
<span class="go">==============================================================================</span>

<span class="go">Results for equation realcons</span>
<span class="go">==============================================================================</span>
<span class="go">                 coefficient       std. error           t-stat            prob</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const               0.005460         0.000969            5.634           0.000</span>
<span class="go">L1.realgdp         -0.100468         0.146924           -0.684           0.495</span>
<span class="go">L1.realcons         0.268640         0.113690            2.363           0.019</span>
<span class="go">L1.realinv          0.025739         0.022683            1.135           0.258</span>
<span class="go">L2.realgdp         -0.123174         0.150267           -0.820           0.413</span>
<span class="go">L2.realcons         0.232499         0.126350            1.840           0.067</span>
<span class="go">L2.realinv          0.023504         0.022330            1.053           0.294</span>
<span class="go">==============================================================================</span>

<span class="go">Results for equation realinv</span>
<span class="go">==============================================================================</span>
<span class="go">                 coefficient       std. error           t-stat            prob</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">const              -0.023903         0.005863           -4.077           0.000</span>
<span class="go">L1.realgdp         -1.970974         0.888892           -2.217           0.028</span>
<span class="go">L1.realcons         4.414162         0.687825            6.418           0.000</span>
<span class="go">L1.realinv          0.225479         0.137234            1.643           0.102</span>
<span class="go">L2.realgdp          0.380786         0.909114            0.419           0.676</span>
<span class="go">L2.realcons         0.800281         0.764416            1.047           0.296</span>
<span class="go">L2.realinv         -0.124079         0.135098           -0.918           0.360</span>
<span class="go">==============================================================================</span>

<span class="go">Correlation matrix of residuals</span>
<span class="go">             realgdp  realcons   realinv</span>
<span class="go">realgdp     1.000000  0.603316  0.750722</span>
<span class="go">realcons    0.603316  1.000000  0.131951</span>
<span class="go">realinv     0.750722  0.131951  1.000000</span>
</pre></div>
</div>
<p>Several ways to visualize the data using <cite>matplotlib</cite> are available.</p>
<p>Plotting input time series:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./plots/var_plot_input.py">Source code</a>, <a class="reference external" href="./plots/var_plot_input.png">png</a>, <a class="reference external" href="./plots/var_plot_input.hires.png">hires.png</a>, <a class="reference external" href="./plots/var_plot_input.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/var_plot_input.png" src="_images/var_plot_input.png" />
</div>
<p>Plotting time series autocorrelation function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">plot_acorr</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./plots/var_plot_acorr.py">Source code</a>, <a class="reference external" href="./plots/var_plot_acorr.png">png</a>, <a class="reference external" href="./plots/var_plot_acorr.hires.png">hires.png</a>, <a class="reference external" href="./plots/var_plot_acorr.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/var_plot_acorr.png" src="_images/var_plot_acorr.png" />
</div>
</div>
<div class="section" id="lag-order-selection">
<h3>Lag order selection<a class="headerlink" href="#lag-order-selection" title="Permalink to this headline">¶</a></h3>
<p>Choice of lag order can be a difficult problem. Standard analysis employs
likelihood test or information criteria-based order selection. We have
implemented the latter, accessable through the <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-class docutils literal"><span class="pre">VAR</span></code></a> class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">select_order</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">                 VAR Order Selection</span>
<span class="go">======================================================</span>
<span class="go">            aic          bic          fpe         hqic</span>
<span class="go">------------------------------------------------------</span>
<span class="go">0        -27.70       -27.65    9.358e-13       -27.68</span>
<span class="go">1        -28.02      -27.82*    6.745e-13      -27.94*</span>
<span class="go">2        -28.03       -27.66    6.732e-13       -27.88</span>
<span class="go">3       -28.04*       -27.52   6.651e-13*       -27.83</span>
<span class="go">4        -28.03       -27.36    6.681e-13       -27.76</span>
<span class="go">5        -28.02       -27.19    6.773e-13       -27.69</span>
<span class="go">6        -27.97       -26.98    7.147e-13       -27.57</span>
<span class="go">7        -27.93       -26.79    7.446e-13       -27.47</span>
<span class="go">8        -27.94       -26.64    7.407e-13       -27.41</span>
<span class="go">9        -27.96       -26.50    7.280e-13       -27.37</span>
<span class="go">10       -27.91       -26.30    7.629e-13       -27.26</span>
<span class="go">11       -27.86       -26.09    8.076e-13       -27.14</span>
<span class="go">12       -27.83       -25.91    8.316e-13       -27.05</span>
<span class="go">13       -27.80       -25.73    8.594e-13       -26.96</span>
<span class="go">14       -27.80       -25.57    8.627e-13       -26.90</span>
<span class="go">15       -27.81       -25.43    8.599e-13       -26.85</span>
<span class="go">======================================================</span>
<span class="go">* Minimum</span>

<span class="go">{&#39;aic&#39;: 3, &#39;bic&#39;: 1, &#39;fpe&#39;: 3, &#39;hqic&#39;: 1}</span>
</pre></div>
</div>
<p>When calling the <cite>fit</cite> function, one can pass a maximum number of lags and the
order criterion to use for order selection:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ic</span><span class="o">=</span><span class="s">&#39;aic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="forecasting">
<h3>Forecasting<a class="headerlink" href="#forecasting" title="Permalink to this headline">¶</a></h3>
<p>The linear predictor is the optimal h-step ahead forecast in terms of
mean-squared error:</p>
<div class="math">
<p><img src="_images/math/d0c9dd82df1d9329aa56db6b07c133976ddd9a9f.png" alt="y_t(h) = \nu + A_1 y_t(h − 1) + \cdots + A_p y_t(h − p)"/></p>
</div><p>We can use the <cite>forecast</cite> function to produce this forecast. Note that we have
to specify the &#8220;initial value&#8221; for the forecast:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">lag_order</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">k_ar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="n">lag_order</span><span class="p">:],</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">array([[ 0.00616044,  0.00500006,  0.00916198],</span>
<span class="go">       [ 0.00427559,  0.00344836, -0.00238478],</span>
<span class="go">       [ 0.00416634,  0.0070728 , -0.01193629],</span>
<span class="go">       [ 0.00557873,  0.00642784,  0.00147152],</span>
<span class="go">       [ 0.00626431,  0.00666715,  0.00379567]])</span>
</pre></div>
</div>
<p>The <cite>forecast_interval</cite> function will produce the above forecast along with
asymptotic standard errors. These can be visualized using the <cite>plot_forecast</cite>
function:</p>
<p>(<a class="reference external" href="./plots/var_plot_forecast.py">Source code</a>, <a class="reference external" href="./plots/var_plot_forecast.png">png</a>, <a class="reference external" href="./plots/var_plot_forecast.hires.png">hires.png</a>, <a class="reference external" href="./plots/var_plot_forecast.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/var_plot_forecast.png" src="_images/var_plot_forecast.png" />
</div>
</div>
</div>
<div class="section" id="impulse-response-analysis">
<h2>Impulse Response Analysis<a class="headerlink" href="#impulse-response-analysis" title="Permalink to this headline">¶</a></h2>
<p><em>Impulse responses</em> are of interest in econometric studies: they are the
estimated responses to a unit impulse in one of the variables. They are computed
in practice using the MA(<img class="math" src="_images/math/21181ff75a9f31fa18367f4502b35d8d8e46dbbd.png" alt="\infty" style="vertical-align: -1px"/>) representation of the VAR(p) process:</p>
<div class="math">
<p><img src="_images/math/3cf758e54efc429484c089b8ddadbcdb2bc5bda0.png" alt="Y_t = \mu + \sum_{i=0}^\infty \Phi_i u_{t-i}"/></p>
</div><p>We can perform an impulse response analysis by calling the <cite>irf</cite> function on a
<cite>VARResults</cite> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">irf</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">irf</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>These can be visualized using the <cite>plot</cite> function, in either orthogonalized or
non-orthogonalized form. Asymptotic standard errors are plotted by default at
the 95% significance level, which can be modified by the user.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Orthogonalization is done using the Cholesky decomposition of the estimated
error covariance matrix <img class="math" src="_images/math/80d76e1d7c93a78bab4aef3b63bf395800583ba3.png" alt="\hat \Sigma_u" style="vertical-align: -3px"/> and hence interpretations may
change depending on variable ordering.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">irf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./plots/var_plot_irf.py">Source code</a>, <a class="reference external" href="./plots/var_plot_irf.png">png</a>, <a class="reference external" href="./plots/var_plot_irf.hires.png">hires.png</a>, <a class="reference external" href="./plots/var_plot_irf.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/var_plot_irf.png" src="_images/var_plot_irf.png" />
</div>
<p>Note the <cite>plot</cite> function is flexible and can plot only variables of interest if
so desired:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">irf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">impulse</span><span class="o">=</span><span class="s">&#39;realgdp&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The cumulative effects <img class="math" src="_images/math/07a36fcab80890ba0b5064f560ed2768a669e01f.png" alt="\Psi_n = \sum_{i=0}^n \Phi_i" style="vertical-align: -5px"/> can be plotted with
the long run effects as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">irf</span><span class="o">.</span><span class="n">plot_cum_effects</span><span class="p">(</span><span class="n">orth</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./plots/var_plot_irf_cum.py">Source code</a>, <a class="reference external" href="./plots/var_plot_irf_cum.png">png</a>, <a class="reference external" href="./plots/var_plot_irf_cum.hires.png">hires.png</a>, <a class="reference external" href="./plots/var_plot_irf_cum.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/var_plot_irf_cum.png" src="_images/var_plot_irf_cum.png" />
</div>
</div>
<div class="section" id="forecast-error-variance-decomposition-fevd">
<h2>Forecast Error Variance Decomposition (FEVD)<a class="headerlink" href="#forecast-error-variance-decomposition-fevd" title="Permalink to this headline">¶</a></h2>
<p>Forecast errors of component j on k in an i-step ahead forecast can be
decomposed using the orthogonalized impulse responses <img class="math" src="_images/math/316dca41cbb7a23462d290fdebca9c58c6f19b15.png" alt="\Theta_i" style="vertical-align: -3px"/>:</p>
<div class="math">
<p><img src="_images/math/8fdc104916082d00d5faccb865bcff0b474e731e.png" alt="\omega_{jk, i} = \sum_{i=0}^{h-1} (e_j^\prime \Theta_i e_k)^2 / \mathrm{MSE}_j(h)

\mathrm{MSE}_j(h) = \sum_{i=0}^{h-1} e_j^\prime \Phi_i \Sigma_u \Phi_i^\prime e_j"/></p>
</div><p>These are computed via the <cite>fevd</cite> function up through a total number of steps ahead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fevd</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">fevd</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fevd</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">FEVD for realgdp</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    1.000000  0.000000  0.000000</span>
<span class="go">1    0.864889  0.129253  0.005858</span>
<span class="go">2    0.816725  0.177898  0.005378</span>
<span class="go">3    0.793647  0.197590  0.008763</span>
<span class="go">4    0.777279  0.208127  0.014594</span>

<span class="go">FEVD for realcons</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    0.359877  0.640123  0.000000</span>
<span class="go">1    0.358767  0.635420  0.005813</span>
<span class="go">2    0.348044  0.645138  0.006817</span>
<span class="go">3    0.319913  0.653609  0.026478</span>
<span class="go">4    0.317407  0.652180  0.030414</span>

<span class="go">FEVD for realinv</span>
<span class="go">      realgdp  realcons   realinv</span>
<span class="go">0    0.577021  0.152783  0.270196</span>
<span class="go">1    0.488158  0.293622  0.218220</span>
<span class="go">2    0.478727  0.314398  0.206874</span>
<span class="go">3    0.477182  0.315564  0.207254</span>
<span class="go">4    0.466741  0.324135  0.209124</span>
</pre></div>
</div>
<p>They can also be visualized through the returned <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.FEVD.html#statsmodels.tsa.vector_ar.var_model.FEVD" title="statsmodels.tsa.vector_ar.var_model.FEVD"><code class="xref py py-class docutils literal"><span class="pre">FEVD</span></code></a> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">fevd</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./plots/var_plot_fevd.py">Source code</a>, <a class="reference external" href="./plots/var_plot_fevd.png">png</a>, <a class="reference external" href="./plots/var_plot_fevd.hires.png">hires.png</a>, <a class="reference external" href="./plots/var_plot_fevd.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/var_plot_fevd.png" src="_images/var_plot_fevd.png" />
</div>
</div>
<div class="section" id="statistical-tests">
<h2>Statistical tests<a class="headerlink" href="#statistical-tests" title="Permalink to this headline">¶</a></h2>
<p>A number of different methods are provided to carry out hypothesis tests about
the model results and also the validity of the model assumptions (normality,
whiteness / &#8220;iid-ness&#8221; of errors, etc.).</p>
<div class="section" id="granger-causality">
<h3>Granger causality<a class="headerlink" href="#granger-causality" title="Permalink to this headline">¶</a></h3>
<p>One is often interested in whether a variable or group of variables is &#8220;causal&#8221;
for another variable, for some definition of &#8220;causal&#8221;. In the context of VAR
models, one can say that a set of variables are Granger-causal within one of the
VAR equations. We will not detail the mathematics or definition of Granger
causality, but leave it to the reader. The <a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-class docutils literal"><span class="pre">VARResults</span></code></a> object has the
<cite>test_causality</cite> method for performing either a Wald (<img class="math" src="_images/math/4dcb4a08df7a8b829443c0b6705fa279c77218c3.png" alt="\chi^2" style="vertical-align: -4px"/>) test or an
F-test.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">test_causality</span><span class="p">(</span><span class="s">&#39;realgdp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;realinv&#39;</span><span class="p">,</span> <span class="s">&#39;realcons&#39;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
<span class="go">Granger causality f-test</span>
<span class="go">=============================================================</span>
<span class="go">   Test statistic   Critical Value          p-value        df</span>
<span class="go">-------------------------------------------------------------</span>
<span class="go">         6.999888         2.114554            0.000  (6, 567)</span>
<span class="go">=============================================================</span>
<span class="go">H_0: [&#39;realinv&#39;, &#39;realcons&#39;] do not Granger-cause realgdp</span>
<span class="go">Conclusion: reject H_0 at 5.00% significance level</span>
<span class="go">[88]:</span>
<span class="go">{&#39;conclusion&#39;: &#39;reject&#39;,</span>
<span class="go"> &#39;crit_value&#39;: 2.1145543864562706,</span>
<span class="go"> &#39;df&#39;: (6, 567),</span>
<span class="go"> &#39;pvalue&#39;: 3.3805963773886478e-07,</span>
<span class="go"> &#39;signif&#39;: 0.05,</span>
<span class="go"> &#39;statistic&#39;: 6.9998875522543473}</span>
</pre></div>
</div>
</div>
<div class="section" id="normality">
<h3>Normality<a class="headerlink" href="#normality" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="whiteness-of-residuals">
<h3>Whiteness of residuals<a class="headerlink" href="#whiteness-of-residuals" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="dynamic-vector-autoregressions">
<h2>Dynamic Vector Autoregressions<a class="headerlink" href="#dynamic-vector-autoregressions" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To use this functionality, <a class="reference external" href="https://pypi.python.org/pypi/pandas">pandas</a>
must be installed. See the <a class="reference external" href="http://pandas.pydata.org">pandas documentation</a> for more information on the below data
structures.</p>
</div>
<p>One is often interested in estimating a moving-window regression on time series
data for the purposes of making forecasts throughout the data sample. For
example, we may wish to produce the series of 2-step-ahead forecasts produced by
a VAR(p) model estimated at each point in time.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="go">Index: 500 entries , 2000-01-03 00:00:00 to 2001-11-30 00:00:00</span>
<span class="go">A    500  non-null values</span>
<span class="go">B    500  non-null values</span>
<span class="go">C    500  non-null values</span>
<span class="go">D    500  non-null values</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">DynamicVAR</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lag_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">window_type</span><span class="o">=</span><span class="s">&#39;expanding&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The estimated coefficients for the dynamic model are returned as a
<code class="xref py py-class docutils literal"><span class="pre">pandas.WidePanel</span></code> object, which can allow you to easily examine, for
example, all of the model coefficients by equation or by date:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">coefs</span>
<span class="go">&lt;class &#39;pandas.core.panel.WidePanel&#39;&gt;</span>
<span class="go">Dimensions: 9 (items) x 489 (major) x 4 (minor)</span>
<span class="go">Items: L1.A to intercept</span>
<span class="go">Major axis: 2000-01-18 00:00:00 to 2001-11-30 00:00:00</span>
<span class="go">Minor axis: A to D</span>

<span class="go"># all estimated coefficients for equation A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">coefs</span><span class="o">.</span><span class="n">minor_xs</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">Index: 489 entries , 2000-01-18 00:00:00 to 2001-11-30 00:00:00</span>
<span class="go">Data columns:</span>
<span class="go">L1.A         489  non-null values</span>
<span class="go">L1.B         489  non-null values</span>
<span class="go">L1.C         489  non-null values</span>
<span class="go">L1.D         489  non-null values</span>
<span class="go">L2.A         489  non-null values</span>
<span class="go">L2.B         489  non-null values</span>
<span class="go">L2.C         489  non-null values</span>
<span class="go">L2.D         489  non-null values</span>
<span class="go">intercept    489  non-null values</span>
<span class="go">dtype: float64(9)</span>

<span class="go"># coefficients on 11/30/2001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">coefs</span><span class="o">.</span><span class="n">major_xs</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="go">             A              B              C              D</span>
<span class="go">L1.A         0.9567         -0.07389       0.0588         -0.02848</span>
<span class="go">L1.B         -0.00839       0.9757         -0.004945      0.005938</span>
<span class="go">L1.C         -0.01824       0.1214         0.8875         0.01431</span>
<span class="go">L1.D         0.09964        0.02951        0.05275        1.037</span>
<span class="go">L2.A         0.02481        0.07542        -0.04409       0.06073</span>
<span class="go">L2.B         0.006359       0.01413        0.02667        0.004795</span>
<span class="go">L2.C         0.02207        -0.1087        0.08282        -0.01921</span>
<span class="go">L2.D         -0.08795       -0.04297       -0.06505       -0.06814</span>
<span class="go">intercept    0.07778        -0.283         -0.1009        -0.6426</span>
</pre></div>
</div>
<p>Dynamic forecasts for a given number of steps ahead can be produced using the
<cite>forecast</cite> function and return a <code class="xref py py-class docutils literal"><span class="pre">pandas.DataMatrix</span></code> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">In</span> <span class="p">[</span><span class="mi">76</span><span class="p">]:</span> <span class="n">var</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">                       A              B              C              D</span>
<span class="go">&lt;snip&gt;</span>
<span class="go">2001-11-23 00:00:00    -6.661         43.18          33.43          -23.71</span>
<span class="go">2001-11-26 00:00:00    -5.942         43.58          34.04          -22.13</span>
<span class="go">2001-11-27 00:00:00    -6.666         43.64          33.99          -22.85</span>
<span class="go">2001-11-28 00:00:00    -6.521         44.2           35.34          -24.29</span>
<span class="go">2001-11-29 00:00:00    -6.432         43.92          34.85          -26.68</span>
<span class="go">2001-11-30 00:00:00    -5.445         41.98          34.87          -25.94</span>
</pre></div>
</div>
<p>The forecasts can be visualized using <cite>plot_forecast</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">plot_forecast</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="class-reference">
<h2>Class Reference<a class="headerlink" href="#class-reference" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VAR.html#statsmodels.tsa.vector_ar.var_model.VAR" title="statsmodels.tsa.vector_ar.var_model.VAR"><code class="xref py py-obj docutils literal"><span class="pre">var_model.VAR</span></code></a>(endog[,&nbsp;dates,&nbsp;freq,&nbsp;missing])</td>
<td>Fit VAR(p) process and do lag order selection</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARProcess.html#statsmodels.tsa.vector_ar.var_model.VARProcess" title="statsmodels.tsa.vector_ar.var_model.VARProcess"><code class="xref py py-obj docutils literal"><span class="pre">var_model.VARProcess</span></code></a>(coefs,&nbsp;intercept,&nbsp;sigma_u)</td>
<td>Class represents a known VAR(p) process</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.VARResults.html#statsmodels.tsa.vector_ar.var_model.VARResults" title="statsmodels.tsa.vector_ar.var_model.VARResults"><code class="xref py py-obj docutils literal"><span class="pre">var_model.VARResults</span></code></a>(endog,&nbsp;endog_lagged,&nbsp;...)</td>
<td>Estimate VAR(p) process with fixed number of lags</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.irf.IRAnalysis.html#statsmodels.tsa.vector_ar.irf.IRAnalysis" title="statsmodels.tsa.vector_ar.irf.IRAnalysis"><code class="xref py py-obj docutils literal"><span class="pre">irf.IRAnalysis</span></code></a>(model[,&nbsp;P,&nbsp;periods,&nbsp;order,&nbsp;svar])</td>
<td>Impulse response analysis class.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.var_model.FEVD.html#statsmodels.tsa.vector_ar.var_model.FEVD" title="statsmodels.tsa.vector_ar.var_model.FEVD"><code class="xref py py-obj docutils literal"><span class="pre">var_model.FEVD</span></code></a>(model[,&nbsp;P,&nbsp;periods])</td>
<td>Compute and plot Forecast error variance decomposition and asymptotic</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/statsmodels.tsa.vector_ar.dynamic.DynamicVAR.html#statsmodels.tsa.vector_ar.dynamic.DynamicVAR" title="statsmodels.tsa.vector_ar.dynamic.DynamicVAR"><code class="xref py py-obj docutils literal"><span class="pre">dynamic.DynamicVAR</span></code></a>(data[,&nbsp;lag_order,&nbsp;...])</td>
<td>Estimates time-varying vector autoregression (VAR(p)) using</td>
</tr>
</tbody>
</table>
</div>
</div>





          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Vector Autoregressions <code class="docutils literal"><span class="pre">tsa.vector_ar</span></code></a><ul>
<li><a class="reference internal" href="#var-p-processes">VAR(p) processes</a><ul>
<li><a class="reference internal" href="#model-fitting">Model fitting</a></li>
<li><a class="reference internal" href="#lag-order-selection">Lag order selection</a></li>
<li><a class="reference internal" href="#forecasting">Forecasting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#impulse-response-analysis">Impulse Response Analysis</a></li>
<li><a class="reference internal" href="#forecast-error-variance-decomposition-fevd">Forecast Error Variance Decomposition (FEVD)</a></li>
<li><a class="reference internal" href="#statistical-tests">Statistical tests</a><ul>
<li><a class="reference internal" href="#granger-causality">Granger causality</a></li>
<li><a class="reference internal" href="#normality">Normality</a></li>
<li><a class="reference internal" href="#whiteness-of-residuals">Whiteness of residuals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynamic-vector-autoregressions">Dynamic Vector Autoregressions</a></li>
<li><a class="reference internal" href="#class-reference">Class Reference</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/vector_ar.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2009-2013, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>