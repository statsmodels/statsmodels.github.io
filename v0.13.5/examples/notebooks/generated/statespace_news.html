

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Forecasting, updating datasets, and the “news” &#8212; statsmodels</title>
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Custom statespace models" href="statespace_custom_models.html" />
    <link rel="prev" title="Fast Bayesian estimation of SARIMAX models" href="statespace_sarimax_pymc3.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/notebooks/generated/statespace_news" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="statsmodels"
           class="md-header-nav__button md-logo">
          
              <img src="../../../_static/statsmodels-logo-v2-bw.svg" height="26"
                   alt="statsmodels logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">statsmodels 0.13.5</span>
          <span class="md-header-nav__topic"> Forecasting, updating datasets, and the “news” </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../../versions-v2.json",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">Examples</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="statsmodels" class="md-nav__button md-logo">
      
        <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="statsmodels">statsmodels 0.13.5</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../../install.html" class="md-nav__link">Installing statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../gettingstarted.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../user-guide.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html" class="md-nav__link">Examples</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../index.html#linear-regression-models" class="md-nav__link">Linear Regression Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#plotting" class="md-nav__link">Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">Discrete Choice Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">Nonparametric Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">Generalized Linear Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#robust-regression" class="md-nav__link">Robust Regression</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">Generalized Estimating Equations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#statistics" class="md-nav__link">Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#time-series-analysis" class="md-nav__link">Time Series Analysis</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models" class="md-nav__link">State space models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="statespace_sarimax_faq.html" class="md-nav__link">SARIMAX and ARIMA: Frequently Asked Questions (FAQ)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_varmax.html" class="md-nav__link">VARMAX models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_dfm_coincident.html" class="md-nav__link">Dynamic factors and coincident indices</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_structural_harvey_jaeger.html" class="md-nav__link">Detrending, Stylized Facts and the Business Cycle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_cycles.html" class="md-nav__link">Trends and cycles in unemployment</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_local_linear_trend.html" class="md-nav__link">State space modeling: Local Linear Trends</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_arma_0.html" class="md-nav__link">Autoregressive Moving Average (ARMA): Sunspots data</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_seasonal.html" class="md-nav__link">Seasonality in time series data</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_fixed_params.html" class="md-nav__link">Estimating or specifying parameters in state space models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_tvpvar_mcmc_cfa.html" class="md-nav__link">TVP-VAR, MCMC, and sparse simulation smoothing</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_sarimax_pymc3.html" class="md-nav__link">Fast Bayesian estimation of SARIMAX models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Forecasting, updating datasets, and the “news” </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Forecasting, updating datasets, and the “news”</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-news--page-root" class="md-nav__link">Forecasting, updating datasets, and the “news”</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Simple-univariate-example:-AR(1)" class="md-nav__link">Simple univariate example: AR(1)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Step-1:-fitting-the-model-on-the-available-dataset" class="md-nav__link">Step 1: fitting the model on the available dataset</a>
        </li>
        <li class="md-nav__item"><a href="#Step-2:-computing-the-“news”-from-a-new-observation" class="md-nav__link">Step 2: computing the “news” from a new observation</a>
        </li>
        <li class="md-nav__item"><a href="#Addendum:-manually-computing-the-news,-weights,-and-impacts" class="md-nav__link">Addendum: manually computing the news, weights, and impacts</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Multivariate-example:-dynamic-factor" class="md-nav__link">Multivariate example: dynamic factor</a>
        </li>
        <li class="md-nav__item"><a href="#Bibliography" class="md-nav__link">Bibliography</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_news.ipynb.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_custom_models.html" class="md-nav__link">Custom statespace models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ets.html" class="md-nav__link">ETS models</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">State space models - Technical notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#forecasting" class="md-nav__link">Forecasting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#multivariate-methods" class="md-nav__link">Multivariate Methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#user-notes" class="md-nav__link">User Notes</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../api.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../about.html" class="md-nav__link">About statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../dev/index.html" class="md-nav__link">Developer Page</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../release/index.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-news--page-root" class="md-nav__link">Forecasting, updating datasets, and the “news”</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Simple-univariate-example:-AR(1)" class="md-nav__link">Simple univariate example: AR(1)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Step-1:-fitting-the-model-on-the-available-dataset" class="md-nav__link">Step 1: fitting the model on the available dataset</a>
        </li>
        <li class="md-nav__item"><a href="#Step-2:-computing-the-“news”-from-a-new-observation" class="md-nav__link">Step 2: computing the “news” from a new observation</a>
        </li>
        <li class="md-nav__item"><a href="#Addendum:-manually-computing-the-news,-weights,-and-impacts" class="md-nav__link">Addendum: manually computing the news, weights, and impacts</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Multivariate-example:-dynamic-factor" class="md-nav__link">Multivariate example: dynamic factor</a>
        </li>
        <li class="md-nav__item"><a href="#Bibliography" class="md-nav__link">Bibliography</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_news.ipynb.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Forecasting,-updating-datasets,-and-the-“news”">
<h1 id="examples-notebooks-generated-statespace-news--page-root">Forecasting, updating datasets, and the “news”<a class="headerlink" href="#examples-notebooks-generated-statespace-news--page-root" title="Permalink to this heading">¶</a></h1>
<p>In this notebook, we describe how to use Statsmodels to compute the impacts of updated or revised datasets on out-of-sample forecasts or in-sample estimates of missing data. We follow the approach of the “Nowcasting” literature (see references at the end), by using a state space model to compute the “news” and impacts of incoming data.</p>
<p><strong>Note</strong>: this notebook applies to Statsmodels v0.12+. In addition, it only applies to the state space models or related classes, which are: <code class="docutils literal notranslate"><span class="pre">sm.tsa.statespace.ExponentialSmoothing</span></code>, <code class="docutils literal notranslate"><span class="pre">sm.tsa.arima.ARIMA</span></code>, <code class="docutils literal notranslate"><span class="pre">sm.tsa.SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">sm.tsa.UnobservedComponents</span></code>, <code class="docutils literal notranslate"><span class="pre">sm.tsa.VARMAX</span></code>, and <code class="docutils literal notranslate"><span class="pre">sm.tsa.DynamicFactor</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">macrodata</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">macrodata</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="n">macrodata</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">'1959Q1'</span><span class="p">,</span> <span class="s1">'2009Q3'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'Q'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Forecasting exercises often start with a fixed set of historical data that is used for model selection and parameter estimation. Then, the fitted selected model (or models) can be used to create out-of-sample forecasts. Most of the time, this is not the end of the story. As new data comes in, you may need to evaluate your forecast errors, possibly update your models, and create updated out-of-sample forecasts. This is sometimes called a “real-time” forecasting exercise (by contrast, a pseudo
real-time exercise is one in which you simulate this procedure).</p>
<p>If all that matters is minimizing some loss function based on forecast errors (like MSE), then when new data comes in you may just want to completely redo model selection, parameter estimation and out-of-sample forecasting, using the updated datapoints. If you do this, your new forecasts will have changed for two reasons:</p>
<ol class="arabic simple">
<li><p>You have received new data that gives you new information</p></li>
<li><p>Your forecasting model or the estimated parameters are different</p></li>
</ol>
<p>In this notebook, we focus on methods for isolating the first effect. The way we do this comes from the so-called “nowcasting” literature, and in particular Bańbura, Giannone, and Reichlin (2011), Bańbura and Modugno (2014), and Bańbura et al. (2014). They describe this exercise as computing the “<strong>news</strong>”, and we follow them in using this language in Statsmodels.</p>
<p>These methods are perhaps most useful with multivariate models, since there multiple variables may update at the same time, and it is not immediately obvious what forecast change was created by what updated variable. However, they can still be useful for thinking about forecast revisions in univariate models. We will therefore start with the simpler univariate case to explain how things work, and then move to the multivariate case afterwards.</p>
<p><strong>Note on revisions</strong>: the framework that we are using is designed to decompose changes to forecasts from newly observed datapoints. It can also take into account <em>revisions</em> to previously published datapoints, but it does not decompose them separately. Instead, it only shows the aggregate effect of “revisions”.</p>
<p><strong>Note on ``exog`` data</strong>: the framework that we are using only decomposes changes to forecasts from newly observed datapoints for <em>modeled</em> variables. These are the “left-hand-side” variables that in Statsmodels are given in the <code class="docutils literal notranslate"><span class="pre">endog</span></code> arguments. This framework does not decompose or account for changes to unmodeled “right-hand-side” variables, like those included in the <code class="docutils literal notranslate"><span class="pre">exog</span></code> argument.</p>
<section id="Simple-univariate-example:-AR(1)">
<h2 id="Simple-univariate-example:-AR(1)">Simple univariate example: AR(1)<a class="headerlink" href="#Simple-univariate-example:-AR(1)" title="Permalink to this heading">¶</a></h2>
<p>We will begin with a simple autoregressive model, an AR(1):</p>
<div class="math notranslate nohighlight">
\[y_t = \phi y_{t-1} + \varepsilon_t\]</div>
<ul class="simple">
<li><p>The parameter <span class="math notranslate nohighlight">\(\phi\)</span> captures the persistence of the series</p></li>
</ul>
<p>We will use this model to forecast inflation.</p>
<p>To make it simpler to describe the forecast updates in this notebook, we will work with inflation data that has been de-meaned, but it is straightforward in practice to augment the model with a mean term.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># De-mean the inflation series</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">macrodata</span><span class="p">[</span><span class="s1">'infl'</span><span class="p">]</span> <span class="o">-</span> <span class="n">macrodata</span><span class="p">[</span><span class="s1">'infl'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="Step-1:-fitting-the-model-on-the-available-dataset">
<h3 id="Step-1:-fitting-the-model-on-the-available-dataset">Step 1: fitting the model on the available dataset<a class="headerlink" href="#Step-1:-fitting-the-model-on-the-available-dataset" title="Permalink to this heading">¶</a></h3>
<p>Here, we’ll simulate an out-of-sample exercise, by constructing and fitting our model using all of the data except the last five observations. We’ll assume that we haven’t observed these values yet, and then in subsequent steps we’ll add them back into the analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pre</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>
<span class="n">y_pre</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">'Inflation'</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_news_9_0.png" src="../../../_images/examples_notebooks_generated_statespace_news_9_0.png"/>
</div>
</div>
<p>To construct forecasts, we first estimate the parameters of the model. This returns a results object that we will be able to use produce forecasts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod_pre</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">y_pre</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">'n'</span><span class="p">)</span>
<span class="n">res_pre</span> <span class="o">=</span> <span class="n">mod_pre</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_pre</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                   infl   No. Observations:                  198
Model:                 ARIMA(1, 0, 0)   Log Likelihood                -446.407
Date:                Wed, 02 Nov 2022   AIC                            896.813
Time:                        17:10:08   BIC                            903.390
Sample:                    03-31-1959   HQIC                           899.475
                         - 06-30-2008
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ar.L1          0.6751      0.043     15.858      0.000       0.592       0.759
sigma2         5.3027      0.367     14.459      0.000       4.584       6.022
===================================================================================
Ljung-Box (L1) (Q):                  15.65   Jarque-Bera (JB):                43.04
Prob(Q):                              0.00   Prob(JB):                         0.00
Heteroskedasticity (H):               0.85   Skew:                             0.18
Prob(H) (two-sided):                  0.50   Kurtosis:                         5.26
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>Creating the forecasts from the results object <code class="docutils literal notranslate"><span class="pre">res</span></code> is easy - you can just call the <code class="docutils literal notranslate"><span class="pre">forecast</span></code> method with the number of forecasts you want to construct. In this case, we’ll construct four out-of-sample forecasts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the forecasts</span>
<span class="n">forecasts_pre</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Plot the last 3 years of data and the four out-of-sample forecasts</span>
<span class="n">y_pre</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Data'</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">forecasts_pre</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">'Forecast'</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_news_13_0.png" src="../../../_images/examples_notebooks_generated_statespace_news_13_0.png"/>
</div>
</div>
<p>For the AR(1) model, it is also easy to manually construct the forecasts. Denoting the last observed variable as <span class="math notranslate nohighlight">\(y_T\)</span> and the <span class="math notranslate nohighlight">\(h\)</span>-step-ahead forecast as <span class="math notranslate nohighlight">\(y_{T+h|T}\)</span>, we have:</p>
<div class="math notranslate nohighlight">
\[y_{T+h|T} = \hat \phi^h y_T\]</div>
<p>Where <span class="math notranslate nohighlight">\(\hat \phi\)</span> is our estimated value for the AR(1) coefficient. From the summary output above, we can see that this is the first parameter of the model, which we can access from the <code class="docutils literal notranslate"><span class="pre">params</span></code> attribute of the results object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the estimated AR(1) coefficient</span>
<span class="n">phi_hat</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Get the last observed value of the variable</span>
<span class="n">y_T</span> <span class="o">=</span> <span class="n">y_pre</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Directly compute the forecasts at the horizons h=1,2,3,4</span>
<span class="n">manual_forecasts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">phi_hat</span> <span class="o">*</span> <span class="n">y_T</span><span class="p">,</span> <span class="n">phi_hat</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_T</span><span class="p">,</span>
                              <span class="n">phi_hat</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">y_T</span><span class="p">,</span> <span class="n">phi_hat</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">y_T</span><span class="p">],</span>
                             <span class="n">index</span><span class="o">=</span><span class="n">forecasts_pre</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># We'll print the two to double-check that they're the same</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">forecasts_pre</span><span class="p">,</span> <span class="n">manual_forecasts</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        predicted_mean         0
2008Q3        3.084388  3.084388
2008Q4        2.082323  2.082323
2009Q1        1.405812  1.405812
2009Q2        0.949088  0.949088
</pre></div></div>
</div>
</section>
<section id="Step-2:-computing-the-“news”-from-a-new-observation">
<h3 id="Step-2:-computing-the-“news”-from-a-new-observation">Step 2: computing the “news” from a new observation<a class="headerlink" href="#Step-2:-computing-the-“news”-from-a-new-observation" title="Permalink to this heading">¶</a></h3>
<p>Suppose that time has passed, and we have now received another observation. Our dataset is now larger, and we can evaluate our forecast error and produce updated forecasts for the subsequent quarters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the next observation after the "pre" dataset</span>
<span class="n">y_update</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># Print the forecast error</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Forecast error: </span><span class="si">%.2f</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">y_update</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">forecasts_pre</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Forecast error: -10.21
</pre></div></div>
</div>
<p>To compute forecasts based on our updated dataset, we will create an updated results object <code class="docutils literal notranslate"><span class="pre">res_post</span></code> using the <code class="docutils literal notranslate"><span class="pre">append</span></code> method, to append on our new observation to the previous dataset.</p>
<p>Note that by default, the <code class="docutils literal notranslate"><span class="pre">append</span></code> method does not re-estimate the parameters of the model. This is exactly what we want here, since we want to isolate the effect on the forecasts of the new information only.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new results object by passing the new observations to the `append` method</span>
<span class="n">res_post</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_update</span><span class="p">)</span>

<span class="c1"># Since we now know the value for 2008Q3, we will only use `res_post` to</span>
<span class="c1"># produce forecasts for 2008Q4 through 2009Q2</span>
<span class="n">forecasts_post</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y_update</span><span class="p">,</span> <span class="n">res_post</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="s1">'2009Q2'</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">forecasts_post</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2008Q3   -7.121330
2008Q4   -4.807732
2009Q1   -3.245783
2009Q2   -2.191284
Freq: Q-DEC, dtype: float64
</pre></div></div>
</div>
<p>In this case, the forecast error is quite large - inflation was more than 10 percentage points below the AR(1) models’ forecast. (This was largely because of large swings in oil prices around the global financial crisis).</p>
<p>To analyse this in more depth, we can use Statsmodels to isolate the effect of the new information - or the “<strong>news</strong>” - on our forecasts. This means that we do not yet want to change our model or re-estimate the parameters. Instead, we will use the <code class="docutils literal notranslate"><span class="pre">news</span></code> method that is available in the results objects of state space models.</p>
<p>Computing the news in Statsmodels always requires a <em>previous</em> results object or dataset, and an <em>updated</em> results object or dataset. Here we will use the original results object <code class="docutils literal notranslate"><span class="pre">res_pre</span></code> as the previous results and the <code class="docutils literal notranslate"><span class="pre">res_post</span></code> results object that we just created as the updated results.</p>
<p>Once we have previous and updated results objects or datasets, we can compute the news by calling the <code class="docutils literal notranslate"><span class="pre">news</span></code> method. Here, we will call <code class="docutils literal notranslate"><span class="pre">res_pre.news</span></code>, and the first argument will be the updated results, <code class="docutils literal notranslate"><span class="pre">res_post</span></code> (however, if you have two results objects, the <code class="docutils literal notranslate"><span class="pre">news</span></code> method could can be called on either one).</p>
<p>In addition to specifying the comparison object or dataset as the first argument, there are a variety of other arguments that are accepted. The most important specify the “impact periods” that you want to consider. These “impact periods” correspond to the forecasted periods of interest; i.e. these dates specify with periods will have forecast revisions decomposed.</p>
<p>To specify the impact periods, you must pass two of <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">end</span></code>, and <code class="docutils literal notranslate"><span class="pre">periods</span></code> (similar to the Pandas <code class="docutils literal notranslate"><span class="pre">date_range</span></code> method). If your time series was a Pandas object with an associated date or period index, then you can pass dates as values for <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code>, as we do below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the impact of the news on the four periods that we previously</span>
<span class="c1"># forecasted: 2008Q3 through 2009Q2</span>
<span class="n">news</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">news</span><span class="p">(</span><span class="n">res_post</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">'2008Q3'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">'2009Q2'</span><span class="p">)</span>
<span class="c1"># Note: one alternative way to specify these impact dates is</span>
<span class="c1"># `start='2008Q3', periods=4`</span>
</pre></div>
</div>
</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">news</span></code> is an object of the class <code class="docutils literal notranslate"><span class="pre">NewsResults</span></code>, and it contains details about the updates to the data in <code class="docutils literal notranslate"><span class="pre">res_post</span></code> compared to <code class="docutils literal notranslate"><span class="pre">res_pre</span></code>, the new information in the updated dataset, and the impact that the new information had on the forecasts in the period between <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code>.</p>
<p>One easy way to summarize the results are with the <code class="docutils literal notranslate"><span class="pre">summary</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">news</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                                     News
==============================================================================
Model:                          ARIMA   Original sample:                1959Q1
Date:                Wed, 02 Nov 2022                                 - 2008Q2
Time:                        17:10:08   Update through:                 2008Q3
                                        No. Revisions:                       0
                                        No. New datapoints:                  1
          Impacts for [impacted variable = infl]
=========================================================
impact date estimate (prev) impact of news estimate (new)
---------------------------------------------------------
     2008Q3            3.08         -10.21          -7.12
     2008Q4            2.08          -6.89          -4.81
     2009Q1            1.41          -4.65          -3.25
     2009Q2            0.95          -3.14          -2.19
                  News from updated observations:
===================================================================
update date updated variable   observed forecast (prev)        news
-------------------------------------------------------------------
     2008Q3             infl      -7.12            3.08      -10.21
           Details for [updated variable = infl, impacted variable = infl]
=====================================================================================
update date   observed forecast (prev) impact date        news      weight     impact
-------------------------------------------------------------------------------------
     2008Q3      -7.12            3.08      2008Q3      -10.21         1.0     -10.21
                                            2008Q4      -10.21        0.68      -6.89
                                            2009Q1      -10.21        0.46      -4.65
                                            2009Q2      -10.21        0.31      -3.14
=====================================================================================
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.8/x64/lib/python3.10/site-packages/statsmodels/tsa/statespace/news.py:591: FutureWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  impacts.iloc[:, 0] = impacts.iloc[:, 0].map(str)
</pre></div></div>
</div>
<p><strong>Summary output</strong>: the default summary for this news results object printed four tables:</p>
<ol class="arabic simple">
<li><p>Summary of the model and datasets</p></li>
<li><p>Details of the news from updated data</p></li>
<li><p>Summary of the impacts of the new information on the forecasts between <code class="docutils literal notranslate"><span class="pre">start='2008Q3'</span></code> and <code class="docutils literal notranslate"><span class="pre">end='2009Q2'</span></code></p></li>
<li><p>Details of how the updated data led to the impacts on the forecasts between <code class="docutils literal notranslate"><span class="pre">start='2008Q3'</span></code> and <code class="docutils literal notranslate"><span class="pre">end='2009Q2'</span></code></p></li>
</ol>
<p>These are described in more detail below.</p>
<p><em>Notes</em>:</p>
<ul class="simple">
<li><p>There are a number of arguments that can be passed to the <code class="docutils literal notranslate"><span class="pre">summary</span></code> method to control this output. Check the documentation / docstring for details.</p></li>
<li><p>Table (4), showing details of the updates and impacts, can become quite large if the model is multivariate, there are multiple updates, or a large number of impact dates are selected. It is only shown by default for univariate models.</p></li>
</ul>
<p><strong>First table: summary of the model and datasets</strong></p>
<p>The first table, above, shows:</p>
<ul class="simple">
<li><p>The type of model from which the forecasts were made. Here this is an ARIMA model, since an AR(1) is a special case of an ARIMA(p,d,q) model.</p></li>
<li><p>The date and time at which the analysis was computed.</p></li>
<li><p>The original sample period, which here corresponds to <code class="docutils literal notranslate"><span class="pre">y_pre</span></code></p></li>
<li><p>The endpoint of the updated sample period, which here is the last date in <code class="docutils literal notranslate"><span class="pre">y_post</span></code></p></li>
</ul>
<p><strong>Second table: the news from updated data</strong></p>
<p>This table simply shows the forecasts from the previous results for observations that were updated in the updated sample.</p>
<p><em>Notes</em>:</p>
<ul class="simple">
<li><p>Our updated dataset <code class="docutils literal notranslate"><span class="pre">y_post</span></code> did not contain any <em>revisions</em> to previously observed datapoints. If it had, there would be an additional table showing the previous and updated values of each such revision.</p></li>
</ul>
<p><strong>Third table: summary of the impacts of the new information</strong></p>
<p><em>Columns</em>:</p>
<p>The third table, above, shows:</p>
<ul class="simple">
<li><p>The previous forecast for each of the impact dates, in the “estimate (prev)” column</p></li>
<li><p>The impact that the new information (the “news”) had on the forecasts for each of the impact dates, in the “impact of news” column</p></li>
<li><p>The updated forecast for each of the impact dates, in the “estimate (new)” column</p></li>
</ul>
<p><em>Notes</em>:</p>
<ul class="simple">
<li><p>In multivariate models, this table contains additional columns describing the relevant impacted variable for each row.</p></li>
<li><p>Our updated dataset <code class="docutils literal notranslate"><span class="pre">y_post</span></code> did not contain any <em>revisions</em> to previously observed datapoints. If it had, there would be additional columns in this table showing the impact of those revisions on the forecasts for the impact dates.</p></li>
<li><p>Note that <code class="docutils literal notranslate"><span class="pre">estimate</span> <span class="pre">(new)</span> <span class="pre">=</span> <span class="pre">estimate</span> <span class="pre">(prev)</span> <span class="pre">+</span> <span class="pre">impact</span> <span class="pre">of</span> <span class="pre">news</span></code></p></li>
<li><p>This table can be accessed independently using the <code class="docutils literal notranslate"><span class="pre">summary_impacts</span></code> method.</p></li>
</ul>
<p><em>In our example</em>:</p>
<p>Notice that in our example, the table shows the values that we computed earlier:</p>
<ul class="simple">
<li><p>The “estimate (prev)” column is identical to the forecasts from our previous model, contained in the <code class="docutils literal notranslate"><span class="pre">forecasts_pre</span></code> variable.</p></li>
<li><p>The “estimate (new)” column is identical to our <code class="docutils literal notranslate"><span class="pre">forecasts_post</span></code> variable, which contains the observed value for 2008Q3 and the forecasts from the updated model for 2008Q4 - 2009Q2.</p></li>
</ul>
<p><strong>Fourth table: details of updates and their impacts</strong></p>
<p>The fourth table, above, shows how each new observation translated into specific impacts at each impact date.</p>
<p><em>Columns</em>:</p>
<p>The first three columns table described the relevant <strong>update</strong> (an “updated” is a new observation):</p>
<ul class="simple">
<li><p>The first column (“update date”) shows the date of the variable that was updated.</p></li>
<li><p>The second column (“forecast (prev)”) shows the value that would have been forecasted for the update variable at the update date based on the previous results / dataset.</p></li>
<li><p>The third column (“observed”) shows the actual observed value of that updated variable / update date in the updated results / dataset.</p></li>
</ul>
<p>The last four columns described the <strong>impact</strong> of a given update (an impact is a changed forecast within the “impact periods”).</p>
<ul class="simple">
<li><p>The fourth column (“impact date”) gives the date at which the given update made an impact.</p></li>
<li><p>The fifth column (“news”) shows the “news” associated with the given update (this is the same for each impact of a given update, but is just not sparsified by default)</p></li>
<li><p>The sixth column (“weight”) describes the weight that the “news” from the given update has on the impacted variable at the impact date. In general, weights will be different between each “updated variable” / “update date” / “impacted variable” / “impact date” combination.</p></li>
<li><p>The seventh column (“impact”) shows the impact that the given update had on the given “impacted variable” / “impact date”.</p></li>
</ul>
<p><em>Notes</em>:</p>
<ul class="simple">
<li><p>In multivariate models, this table contains additional columns to show the relevant variable that was updated and variable that was impacted for each row. Here, there is only one variable (“infl”), so those columns are suppressed to save space.</p></li>
<li><p>By default, the updates in this table are “sparsified” with blanks, to avoid repeating the same values for “update date”, “forecast (prev)”, and “observed” for each row of the table. This behavior can be overridden using the <code class="docutils literal notranslate"><span class="pre">sparsify</span></code> argument.</p></li>
<li><p>Note that <code class="docutils literal notranslate"><span class="pre">impact</span> <span class="pre">=</span> <span class="pre">news</span> <span class="pre">*</span> <span class="pre">weight</span></code>.</p></li>
<li><p>This table can be accessed independently using the <code class="docutils literal notranslate"><span class="pre">summary_details</span></code> method.</p></li>
</ul>
<p><em>In our example</em>:</p>
<ul class="simple">
<li><p>For the update to 2008Q3 and impact date 2008Q3, the weight is equal to 1. This is because we only have one variable, and once we have incorporated the data for 2008Q3, there is no no remaining ambiguity about the “forecast” for this date. Thus all of the “news” about this variable at 2008Q3 passes through to the “forecast” directly.</p></li>
</ul>
</section>
<section id="Addendum:-manually-computing-the-news,-weights,-and-impacts">
<h3 id="Addendum:-manually-computing-the-news,-weights,-and-impacts">Addendum: manually computing the news, weights, and impacts<a class="headerlink" href="#Addendum:-manually-computing-the-news,-weights,-and-impacts" title="Permalink to this heading">¶</a></h3>
<p>For this simple example with a univariate model, it is straightforward to compute all of the values shown above by hand. First, recall the formula for forecasting <span class="math notranslate nohighlight">\(y_{T+h|T} = \phi^h y_T\)</span>, and note that it follows that we also have <span class="math notranslate nohighlight">\(y_{T+h|T+1} = \phi^h y_{T+1}\)</span>. Finally, note that <span class="math notranslate nohighlight">\(y_{T|T+1} = y_T\)</span>, because if we know the value of the observations through <span class="math notranslate nohighlight">\(T+1\)</span>, we know the value of <span class="math notranslate nohighlight">\(y_T\)</span>.</p>
<p><strong>News</strong>: The “news” is nothing more than the forecast error associated with one of the new observations. So the news associated with observation <span class="math notranslate nohighlight">\(T+1\)</span> is:</p>
<div class="math notranslate nohighlight">
\[n_{T+1} = y_{T+1} - y_{T+1|T} = Y_{T+1} - \phi Y_T\]</div>
<p><strong>Impacts</strong>: The impact of the news is the difference between the updated and previous forecasts, <span class="math notranslate nohighlight">\(i_h \equiv y_{T+h|T+1} - y_{T+h|T}\)</span>.</p>
<ul class="simple">
<li><p>The previous forecasts for <span class="math notranslate nohighlight">\(h=1, \dots, 4\)</span> are: <span class="math notranslate nohighlight">\(\begin{pmatrix} \phi y_T &amp; \phi^2 y_T &amp; \phi^3 y_T &amp; \phi^4 y_T \end{pmatrix}'\)</span>.</p></li>
<li><p>The updated forecasts for <span class="math notranslate nohighlight">\(h=1, \dots, 4\)</span> are: <span class="math notranslate nohighlight">\(\begin{pmatrix} y_{T+1} &amp; \phi y_{T+1} &amp; \phi^2 y_{T+1} &amp; \phi^3 y_{T+1} \end{pmatrix}'\)</span>.</p></li>
</ul>
<p>The impacts are therefore:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\{ i_h \}_{h=1}^4 = \begin{pmatrix} y_{T+1} - \phi y_T \\ \phi (Y_{T+1} - \phi y_T) \\ \phi^2 (Y_{T+1} - \phi y_T) \\ \phi^3 (Y_{T+1} - \phi y_T) \end{pmatrix}\end{split}\]</div>
<p><strong>Weights</strong>: To compute the weights, we just need to note that it is immediate that we can rewrite the impacts in terms of the forecast errors, <span class="math notranslate nohighlight">\(n_{T+1}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\{ i_h \}_{h=1}^4 = \begin{pmatrix} 1 \\ \phi \\ \phi^2 \\ \phi^3 \end{pmatrix} n_{T+1}\end{split}\]</div>
<p>The weights are then simply <span class="math notranslate nohighlight">\(w = \begin{pmatrix} 1 \\ \phi \\ \phi^2 \\ \phi^3 \end{pmatrix}\)</span></p>
<p>We can check that this is what the <code class="docutils literal notranslate"><span class="pre">news</span></code> method has computed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the news, computed by the `news` method</span>
<span class="nb">print</span><span class="p">(</span><span class="n">news</span><span class="o">.</span><span class="n">news</span><span class="p">)</span>

<span class="c1"># Manually compute the news</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">((</span><span class="n">y_update</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">phi_hat</span> <span class="o">*</span> <span class="n">y_pre</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
update date  updated variable
2008Q3       infl               -10.205718
Name: news, dtype: float64

-10.205718
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the total impacts, computed by the `news` method</span>
<span class="c1"># (Note: news.total_impacts = news.revision_impacts + news.update_impacts, but</span>
<span class="c1"># here there are no data revisions, so total and update impacts are the same)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">news</span><span class="o">.</span><span class="n">total_impacts</span><span class="p">)</span>

<span class="c1"># Manually compute the impacts</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">forecasts_post</span> <span class="o">-</span> <span class="n">forecasts_pre</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
             infl
2008Q3 -10.205718
2008Q4  -6.890055
2009Q1  -4.651595
2009Q2  -3.140371

2008Q3   -10.205718
2008Q4    -6.890055
2009Q1    -4.651595
2009Q2    -3.140371
Freq: Q-DEC, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the weights, computed by the `news` method</span>
<span class="nb">print</span><span class="p">(</span><span class="n">news</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># Manually compute the weights</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi_hat</span><span class="p">,</span> <span class="n">phi_hat</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">phi_hat</span><span class="o">**</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
impact date                  2008Q3    2008Q4    2009Q1    2009Q2
impacted variable              infl      infl      infl      infl
update date updated variable
2008Q3      infl                1.0  0.675117  0.455783  0.307707

[1.       0.675117 0.455783 0.307707]
</pre></div></div>
</div>
</section>
</section>
<section id="Multivariate-example:-dynamic-factor">
<h2 id="Multivariate-example:-dynamic-factor">Multivariate example: dynamic factor<a class="headerlink" href="#Multivariate-example:-dynamic-factor" title="Permalink to this heading">¶</a></h2>
<p>In this example, we’ll consider forecasting monthly core price inflation based on the Personal Consumption Expenditures (PCE) price index and the Consumer Price Index (CPI), using a Dynamic Factor model. Both of these measures track prices in the US economy and are based on similar source data, but they have a number of definitional differences. Nonetheless, they track each other relatively well, so modeling them jointly using a single dynamic factor seems reasonable.</p>
<p>One reason that this kind of approach can be useful is that the CPI is released earlier in the month than the PCE. One the CPI is released, therefore, we can update our dynamic factor model with that additional datapoint, and obtain an improved forecast for that month’s PCE release. A more involved version of this kind of analysis is available in Knotek and Zaman (2017).</p>
<p>We start by downloading the core CPI and PCE price index data from <a class="reference external" href="https://fred.stlouisfed.org/">FRED</a>, converting them to annualized monthly inflation rates, removing two outliers, and de-meaning each series (the dynamic factor model does not</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_fred</span><span class="p">([</span><span class="s1">'PCEPILFE'</span><span class="p">,</span> <span class="s1">'CPILFESL'</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="s1">'1999'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">'2019'</span><span class="p">)</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">'M'</span><span class="p">)</span>
<span class="n">infl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="mi">1200</span>
<span class="n">infl</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'PCE'</span><span class="p">,</span> <span class="s1">'CPI'</span><span class="p">]</span>

<span class="c1"># Remove two outliers and de-mean the series</span>
<span class="n">infl</span><span class="p">[</span><span class="s1">'PCE'</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'2001-09'</span><span class="p">:</span><span class="s1">'2001-10'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<p>To show how this works, we’ll imagine that it is April 14, 2017, which is the data of the March 2017 CPI release. So that we can show the effect of multiple updates at once, we’ll assume that we haven’t updated our data since the end of January, so that:</p>
<ul class="simple">
<li><p>Our <strong>previous dataset</strong> will consist of all values for the PCE and CPI through January 2017</p></li>
<li><p>Our <strong>updated dataset</strong> will additionally incorporate the CPI for February and March 2017 and the PCE data for February 2017. But it will not yet the PCE (the March 2017 PCE price index was not released until May 1, 2017).</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Previous dataset runs through 2017-02</span>
<span class="n">y_pre</span> <span class="o">=</span> <span class="n">infl</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">'2017-01'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">const_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pre</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_pre</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
              PCE       CPI
DATE
2016-09  1.385688  2.022262
2016-10  1.777645  1.445830
2016-11  0.584472  1.631694
2016-12  1.572165  2.109728
2017-01  3.093392  2.623570
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For the updated dataset, we'll just add in the</span>
<span class="c1"># CPI value for 2017-03</span>
<span class="n">y_post</span> <span class="o">=</span> <span class="n">infl</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">'2017-03'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_post</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'2017-03'</span><span class="p">,</span> <span class="s1">'PCE'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">const_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_post</span><span class="p">))</span>

<span class="c1"># Notice the missing value for PCE in 2017-03</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_post</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
              PCE       CPI
DATE
2016-11  0.584472  1.631694
2016-12  1.572165  2.109728
2017-01  3.093392  2.623570
2017-02  2.337166  2.541355
2017-03       NaN -0.258197
</pre></div></div>
</div>
<p>We chose this particular example because in March 2017, core CPI prices fell for the first time since 2010, and this information may be useful in forecast core PCE prices for that month. The graph below shows the CPI and PCE price data as it would have been observed on April 14th<span class="math notranslate nohighlight">\(^\dagger\)</span>.</p>
<hr class="docutils"/>
<p><span class="math notranslate nohighlight">\(\dagger\)</span> This statement is not entirely true, because both the CPI and PCE price indexes can be revised to a certain extent after the fact. As a result, the series that we’re pulling are not exactly like those observed on April 14, 2017. This could be fixed by pulling the archived data from <a class="reference external" href="https://alfred.stlouisfed.org/">ALFRED</a> instead of <a class="reference external" href="https://fred.stlouisfed.org/">FRED</a>, but the data we have is good enough for this tutorial.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the updated dataset</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y_post</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'2009'</span><span class="p">,</span> <span class="s1">'2017-06'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="s1">'2009'</span><span class="p">,</span> <span class="s1">'2017-06'</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_news_43_0.png" src="../../../_images/examples_notebooks_generated_statespace_news_43_0.png"/>
</div>
</div>
<p>To perform the exercise, we first construct and fit a <code class="docutils literal notranslate"><span class="pre">DynamicFactor</span></code> model. Specifically:</p>
<ul class="simple">
<li><p>We are using a single dynamic factor (<code class="docutils literal notranslate"><span class="pre">k_factors=1</span></code>)</p></li>
<li><p>We are modeling the factor’s dynamics with an AR(6) model (<code class="docutils literal notranslate"><span class="pre">factor_order=6</span></code>)</p></li>
<li><p>We have included a vector of ones as an exogenous variable (<code class="docutils literal notranslate"><span class="pre">exog=const_pre</span></code>), because the inflation series we are working with are not mean-zero.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod_pre</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">DynamicFactor</span><span class="p">(</span><span class="n">y_pre</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">const_pre</span><span class="p">,</span> <span class="n">k_factors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">factor_order</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">res_pre</span> <span class="o">=</span> <span class="n">mod_pre</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_pre</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =           12     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  4.82073D+00    |proj g|=  3.19124D-01
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

At iterate    5    f=  4.63641D+00    |proj g|=  3.14144D-01
  ys=-8.605E-01  -gs= 5.450E-01 BFGS update SKIPPED

At iterate   10    f=  2.95557D+00    |proj g|=  2.77682D-01

At iterate   15    f=  2.57945D+00    |proj g|=  2.07981D-01

At iterate   20    f=  2.43842D+00    |proj g|=  8.68367D-02

At iterate   25    f=  2.43091D+00    |proj g|=  1.15711D-02

At iterate   30    f=  2.42946D+00    |proj g|=  8.06022D-03

At iterate   35    f=  2.42937D+00    |proj g|=  8.24406D-05

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
   12     37     51      1     1     0   2.265D-05   2.429D+00
  F =   2.4293664173073029

CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
                                   Statespace Model Results
=============================================================================================
Dep. Variable:                        ['PCE', 'CPI']   No. Observations:                  216
Model:             DynamicFactor(factors=1, order=6)   Log Likelihood                -524.743
                                      + 1 regressors   AIC                           1073.486
Date:                               Wed, 02 Nov 2022   BIC                           1113.990
Time:                                       17:10:11   HQIC                          1089.850
Sample:                                   02-28-1999
                                        - 01-31-2017
Covariance Type:                                 opg
===================================================================================
Ljung-Box (L1) (Q):             4.33, 0.55   Jarque-Bera (JB):         12.52, 10.68
Prob(Q):                        0.04, 0.46   Prob(JB):                   0.00, 0.00
Heteroskedasticity (H):         0.57, 0.47   Skew:                      0.16, -0.14
Prob(H) (two-sided):            0.02, 0.00   Kurtosis:                   4.13, 4.05
                           Results for equation PCE
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
loading.f1     0.5407      0.061      8.836      0.000       0.421       0.661
beta.const     1.7154      0.094     18.269      0.000       1.531       1.899
                           Results for equation CPI
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
loading.f1     0.9033      0.104      8.717      0.000       0.700       1.106
beta.const     1.9620      0.136     14.375      0.000       1.694       2.230
                        Results for factor equation f1
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
L1.f1          0.1246      0.069      1.805      0.071      -0.011       0.260
L2.f1          0.1823      0.072      2.543      0.011       0.042       0.323
L3.f1          0.0177      0.073      0.244      0.807      -0.125       0.160
L4.f1         -0.0700      0.078     -0.893      0.372      -0.224       0.084
L5.f1          0.1561      0.068      2.304      0.021       0.023       0.289
L6.f1          0.1376      0.075      1.838      0.066      -0.009       0.284
                           Error covariance matrix
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
sigma2.PCE     0.5517      0.066      8.381      0.000       0.423       0.681
sigma2.CPI  3.132e-10      0.149   2.11e-09      1.000      -0.291       0.291
==============================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>With the fitted model in hand, we now construct the news and impacts associated with observing the CPI for March 2017. The updated data is for February 2017 and part of March 2017, and we’ll examining the impacts on both March and April.</p>
<p>In the univariate example, we first created an updated results object, and then passed that to the <code class="docutils literal notranslate"><span class="pre">news</span></code> method. Here, we’re creating the news by directly passing the updated dataset.</p>
<p>Notice that:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">y_post</span></code> contains the entire updated dataset (not just the new datapoints)</p></li>
<li><p>We also had to pass an updated <code class="docutils literal notranslate"><span class="pre">exog</span></code> array. This array must cover <strong>both</strong>:</p>
<ul class="simple">
<li><p>The entire period associated with <code class="docutils literal notranslate"><span class="pre">y_post</span></code></p></li>
<li><p>Any additional datapoints after the end of <code class="docutils literal notranslate"><span class="pre">y_post</span></code> through the last impact date, specified by <code class="docutils literal notranslate"><span class="pre">end</span></code></p></li>
</ul>
<p>Here, <code class="docutils literal notranslate"><span class="pre">y_post</span></code> ends in March 2017, so we needed our <code class="docutils literal notranslate"><span class="pre">exog</span></code> to extend one more period, to April 2017.</p>
</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the news results</span>
<span class="c1"># Note</span>
<span class="n">const_post_plus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_post</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">news</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">news</span><span class="p">(</span><span class="n">y_post</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">const_post_plus1</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">'2017-03'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">'2017-04'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p><strong>Note</strong>:</p>
<p>In the univariate example, above, we first constructed a new results object, and then passed that to the <code class="docutils literal notranslate"><span class="pre">news</span></code> method. We could have done that here too, although there is an extra step required. Since we are requesting an impact for a period beyond the end of <code class="docutils literal notranslate"><span class="pre">y_post</span></code>, we would still need to pass the additional value for the <code class="docutils literal notranslate"><span class="pre">exog</span></code> variable during that period to <code class="docutils literal notranslate"><span class="pre">news</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res_post</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">y_post</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">const_post</span><span class="p">)</span>
<span class="n">news</span> <span class="o">=</span> <span class="n">res_pre</span><span class="o">.</span><span class="n">news</span><span class="p">(</span><span class="n">res_post</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="s1">'2017-03'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">'2017-04'</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Now that we have computed the <code class="docutils literal notranslate"><span class="pre">news</span></code>, printing <code class="docutils literal notranslate"><span class="pre">summary</span></code> is a convenient way to see the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the summary of the news results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">news</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                                     News
==============================================================================
Model:                  DynamicFactor   Original sample:               1999-02
Date:                Wed, 02 Nov 2022                                - 2017-01
Time:                        17:10:11   Update through:                2017-04
                                        No. Revisions:                       0
                                        No. New datapoints:                  3
                                  Impacts
===========================================================================
impact date impacted variable estimate (prev) impact of news estimate (new)
---------------------------------------------------------------------------
    2017-03               CPI            2.07          -2.33          -0.26
                          PCE            1.78          -1.39           0.39
    2017-04               CPI            1.90          -0.23           1.67
                          PCE            1.68          -0.14           1.54
                  News from updated observations:
===================================================================
update date updated variable   observed forecast (prev)        news
-------------------------------------------------------------------
    2017-02              CPI       2.54            2.24        0.30
                         PCE       2.34            1.88        0.46
    2017-03              CPI      -0.26            2.07       -2.33
===================================================================
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.10.8/x64/lib/python3.10/site-packages/statsmodels/tsa/statespace/news.py:594: FutureWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  impacts.iloc[:, :2] = impacts.iloc[:, :2].applymap(str)
</pre></div></div>
</div>
<p>Because we have multiple variables, by default the summary only shows the news from updated data along and the total impacts.</p>
<p>From the first table, we can see that our updated dataset contains three new data points, with most of the “news” from these data coming from the very low reading in March 2017.</p>
<p>The second table shows that these three datapoints substantially impacted the estimate for PCE in March 2017 (which was not yet observed). This estimate revised down by nearly 1.5 percentage points.</p>
<p>The updated data also impacted the forecasts in the first out-of-sample month, April 2017. After incorporating the new data, the model’s forecasts for CPI and PCE inflation in that month revised down 0.29 and 0.17 percentage point, respectively.</p>
<p>While these tables show the “news” and the total impacts, they do not show how much of each impact was caused by each updated datapoint. To see that information, we need to look at the details tables.</p>
<p>One way to see the details tables is to pass <code class="docutils literal notranslate"><span class="pre">include_details=True</span></code> to the <code class="docutils literal notranslate"><span class="pre">summary</span></code> method. To avoid repeating the tables above, however, we’ll just call the <code class="docutils literal notranslate"><span class="pre">summary_details</span></code> method directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">news</span><span class="o">.</span><span class="n">summary_details</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                                 Details for [updated variable = CPI]
======================================================================================================
update date   observed forecast (prev) impact date impacted variable        news     weight     impact
------------------------------------------------------------------------------------------------------
    2017-02       2.54            2.24     2017-04               CPI        0.30       0.18       0.06
                                                                 PCE        0.30       0.11       0.03
    2017-03      -0.26            2.07     2017-03               CPI       -2.33       1.00      -2.33
                                                                 PCE       -2.33       0.60      -1.39
                                           2017-04               CPI       -2.33       0.12      -0.29
                                                                 PCE       -2.33       0.07      -0.17
======================================================================================================
</pre></div></div>
</div>
<p>This table shows that most of the revisions to the estimate of PCE in April 2017, described above, came from the news associated with the CPI release in March 2017. By contrast, the CPI release in February had only a little effect on the April forecast, and the PCE release in February had essentially no effect.</p>
</section>
<section id="Bibliography">
<h2 id="Bibliography">Bibliography<a class="headerlink" href="#Bibliography" title="Permalink to this heading">¶</a></h2>
<p>Bańbura, Marta, Domenico Giannone, and Lucrezia Reichlin. “Nowcasting.” The Oxford Handbook of Economic Forecasting. July 8, 2011.</p>
<p>Bańbura, Marta, Domenico Giannone, Michele Modugno, and Lucrezia Reichlin. “Now-casting and the real-time data flow.” In Handbook of economic forecasting, vol. 2, pp. 195-237. Elsevier, 2013.</p>
<p>Bańbura, Marta, and Michele Modugno. “Maximum likelihood estimation of factor models on datasets with arbitrary pattern of missing data.” Journal of Applied Econometrics 29, no. 1 (2014): 133-160.</p>
<p>Knotek, Edward S., and Saeed Zaman. “Nowcasting US headline and core inflation.” Journal of Money, Credit and Banking 49, no. 5 (2017): 931-968.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="statespace_sarimax_pymc3.html" title="Fast Bayesian estimation of SARIMAX models"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Fast Bayesian estimation of SARIMAX models </span>
              </div>
            </a>
          
          
            <a href="statespace_custom_models.html" title="Custom statespace models"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Custom statespace models </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2009-2019, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
              
          </div>
            Last updated on
              Nov 02, 2022.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>