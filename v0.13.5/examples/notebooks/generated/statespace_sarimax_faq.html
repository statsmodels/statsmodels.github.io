

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>SARIMAX and ARIMA: Frequently Asked Questions (FAQ) &#8212; statsmodels</title>
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="VARMAX models" href="statespace_varmax.html" />
    <link rel="prev" title="Stationarity and detrending (ADF/KPSS)" href="stationarity_detrending_adf_kpss.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/notebooks/generated/statespace_sarimax_faq" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="statsmodels"
           class="md-header-nav__button md-logo">
          
              <img src="../../../_static/statsmodels-logo-v2-bw.svg" height="26"
                   alt="statsmodels logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">statsmodels 0.13.5</span>
          <span class="md-header-nav__topic"> SARIMAX and ARIMA: Frequently Asked Questions (FAQ) </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../../versions-v2.json",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">Examples</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="statsmodels" class="md-nav__button md-logo">
      
        <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="statsmodels">statsmodels 0.13.5</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../../install.html" class="md-nav__link">Installing statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../gettingstarted.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../user-guide.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html" class="md-nav__link">Examples</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../index.html#linear-regression-models" class="md-nav__link">Linear Regression Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#plotting" class="md-nav__link">Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">Discrete Choice Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">Nonparametric Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">Generalized Linear Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#robust-regression" class="md-nav__link">Robust Regression</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">Generalized Estimating Equations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#statistics" class="md-nav__link">Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#time-series-analysis" class="md-nav__link">Time Series Analysis</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models" class="md-nav__link">State space models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> SARIMAX and ARIMA: Frequently Asked Questions (FAQ) </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">SARIMAX and ARIMA: Frequently Asked Questions (FAQ)</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-sarimax-faq--page-root" class="md-nav__link">SARIMAX and ARIMA: Frequently Asked Questions (FAQ)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" class="md-nav__link">Comparing trends and exogenous variables in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Differences-between-trend-and-exog-in-SARIMAX" class="md-nav__link">Differences between trend and exog in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#Using-exog-in-SARIMAX-and-ARIMA" class="md-nav__link">Using <code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#SARIMAX" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#ARIMA" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#exog-in-AutoReg" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#AutoReg" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Using-the-correct-DGP-with-AutoReg" class="md-nav__link">Using the correct DGP with <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#AutoReg-with-correct-DGP" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> with correct DGP</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA" class="md-nav__link">Reconstructing residuals, fitted values and forecasts in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Prediction-with-MA-components" class="md-nav__link">Prediction with MA components</a>
        </li>
        <li class="md-nav__item"><a href="#Prediction-differences-in-SARIMAX-and-ARIMA" class="md-nav__link">Prediction differences in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Initial-residuals-SARIMAX-and-ARIMA" class="md-nav__link">Initial residuals <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_sarimax_faq.ipynb.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_varmax.html" class="md-nav__link">VARMAX models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_dfm_coincident.html" class="md-nav__link">Dynamic factors and coincident indices</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_structural_harvey_jaeger.html" class="md-nav__link">Detrending, Stylized Facts and the Business Cycle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_cycles.html" class="md-nav__link">Trends and cycles in unemployment</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_local_linear_trend.html" class="md-nav__link">State space modeling: Local Linear Trends</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_arma_0.html" class="md-nav__link">Autoregressive Moving Average (ARMA): Sunspots data</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_seasonal.html" class="md-nav__link">Seasonality in time series data</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_fixed_params.html" class="md-nav__link">Estimating or specifying parameters in state space models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_tvpvar_mcmc_cfa.html" class="md-nav__link">TVP-VAR, MCMC, and sparse simulation smoothing</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_sarimax_pymc3.html" class="md-nav__link">Fast Bayesian estimation of SARIMAX models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_news.html" class="md-nav__link">Forecasting, updating datasets, and the “news”</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="statespace_custom_models.html" class="md-nav__link">Custom statespace models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ets.html" class="md-nav__link">ETS models</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">State space models - Technical notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#forecasting" class="md-nav__link">Forecasting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#multivariate-methods" class="md-nav__link">Multivariate Methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#user-notes" class="md-nav__link">User Notes</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../api.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../about.html" class="md-nav__link">About statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../dev/index.html" class="md-nav__link">Developer Page</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../release/index.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-sarimax-faq--page-root" class="md-nav__link">SARIMAX and ARIMA: Frequently Asked Questions (FAQ)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" class="md-nav__link">Comparing trends and exogenous variables in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Differences-between-trend-and-exog-in-SARIMAX" class="md-nav__link">Differences between trend and exog in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#Using-exog-in-SARIMAX-and-ARIMA" class="md-nav__link">Using <code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#SARIMAX" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#ARIMA" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#exog-in-AutoReg" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#AutoReg" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Using-the-correct-DGP-with-AutoReg" class="md-nav__link">Using the correct DGP with <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#AutoReg-with-correct-DGP" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> with correct DGP</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA" class="md-nav__link">Reconstructing residuals, fitted values and forecasts in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Prediction-with-MA-components" class="md-nav__link">Prediction with MA components</a>
        </li>
        <li class="md-nav__item"><a href="#Prediction-differences-in-SARIMAX-and-ARIMA" class="md-nav__link">Prediction differences in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Initial-residuals-SARIMAX-and-ARIMA" class="md-nav__link">Initial residuals <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_sarimax_faq.ipynb.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="SARIMAX-and-ARIMA:-Frequently-Asked-Questions-(FAQ)">
<h1 id="examples-notebooks-generated-statespace-sarimax-faq--page-root">SARIMAX and ARIMA: Frequently Asked Questions (FAQ)<a class="headerlink" href="#examples-notebooks-generated-statespace-sarimax-faq--page-root" title="Permalink to this heading">¶</a></h1>
<p>This notebook contains explanations for frequently asked questions.</p>
<ul class="simple">
<li><p>Comparing trends and exogenous variables in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code></p></li>
<li><p>Reconstructing residuals, fitted values and forecasts in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></p></li>
<li><p>Initial residuals in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code></p></li>
</ul>
<section id="Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg">
<h2 id="Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg">Comparing trends and exogenous variables in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#Comparing-trends-and-exogenous-variables-in-SARIMAX,-ARIMA-and-AutoReg" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> are formally OLS with ARMA errors. A basic AR(1) in the OLS with ARMA errors is described as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \delta + \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>In large samples, <span class="math notranslate nohighlight">\(\hat{\delta}\stackrel{p}{\rightarrow} E[Y]\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> uses a different representation, so that the model when estimated using <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \phi + \rho Y_{t-1} + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>This is the same representation that is used when the model is estimated using OLS (<code class="docutils literal notranslate"><span class="pre">AutoReg</span></code>). In large samples, <span class="math notranslate nohighlight">\(\hat{\phi}\stackrel{p}{\rightarrow} E[Y](1-\rho)\)</span>.</p>
<p>In the next cell, we simulate a large sample and verify that these relationship hold in practice.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">20210819</span><span class="p">)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">5200</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">SARIMAX</span><span class="p">,</span> <span class="n">AutoReg</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
</pre></div>
</div>
</div>
<p>The three models are specified and estimated in the next cell. An AR(0) is included as a reference. The AR(0) is identical using all three estimators.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ar0_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">sarimax_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">arima_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">autoreg_res</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            2     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  1.91760D+00    |proj g|=  3.68860D-06

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    2      0      1      0     0     0   3.689D-06   1.918D+00
  F =   1.9175996129577773

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  1.41373D+00    |proj g|=  9.51828D-04

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      2      5      1     0     0   4.516D-05   1.414D+00
  F =   1.4137311050015484

CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
</pre></div></div>
</div>
<p>The table below contains the estimated parameter in the model, the estimated AR(1) coefficient, and the long-run mean which is either equal to the estimated parameters (AR(0) or <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>), or depends on the ratio of the intercept to 1 minus the AR(1) parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intercept</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ar0_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">sarimax_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">arima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">autoreg_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">rho_hat</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sarimax_res</span><span class="p">,</span> <span class="n">arima_res</span><span class="p">,</span> <span class="n">autoreg_res</span><span class="p">)]</span>
<span class="n">long_run</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ar0_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">sarimax_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sarimax_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="n">arima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">autoreg_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">autoreg_res</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="p">]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"AR(0)"</span><span class="p">,</span> <span class="s2">"SARIMAX"</span><span class="p">,</span> <span class="s2">"ARIMA"</span><span class="p">,</span> <span class="s2">"AutoReg"</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span><span class="n">intercept</span><span class="p">,</span> <span class="n">rho_hat</span><span class="p">,</span> <span class="n">long_run</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">"delta-or-phi"</span><span class="p">,</span> <span class="s2">"rho"</span><span class="p">,</span> <span class="s2">"long-run mean"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>AR(0)</th>
<th>SARIMAX</th>
<th>ARIMA</th>
<th>AutoReg</th>
</tr>
</thead>
<tbody>
<tr>
<th>delta-or-phi</th>
<td>9.7745</td>
<td>1.985714</td>
<td>9.774498</td>
<td>1.985790</td>
</tr>
<tr>
<th>rho</th>
<td>0.0000</td>
<td>0.796846</td>
<td>0.796875</td>
<td>0.796882</td>
</tr>
<tr>
<th>long-run mean</th>
<td>9.7745</td>
<td>9.774424</td>
<td>9.774498</td>
<td>9.776537</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<section id="Differences-between-trend-and-exog-in-SARIMAX">
<h3 id="Differences-between-trend-and-exog-in-SARIMAX">Differences between trend and exog in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code><a class="headerlink" href="#Differences-between-trend-and-exog-in-SARIMAX" title="Permalink to this heading">¶</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> includes <code class="docutils literal notranslate"><span class="pre">exog</span></code> variables, then the <code class="docutils literal notranslate"><span class="pre">exog</span></code> are treated as OLS regressors, so that the model estimated is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t - X_t \beta &amp; = \delta + \rho (Y_{t-1} - X_{t-1}\beta) + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>In the next example, we omit the trend and instead include a column of 1, which produces a model that is equivalent, in large samples, to the case with no exogenous regressor and <code class="docutils literal notranslate"><span class="pre">trend="c"</span></code>. Here the estimated value of <code class="docutils literal notranslate"><span class="pre">const</span></code> matches the value estimated using <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. This happens since both exog in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and the trend in <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> are treated as linear regression models with ARMA errors.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sarimax_exog_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"n"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sarimax_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  1.41373D+00    |proj g|=  1.06920D-04
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      1      4      1     0     0   4.752D-05   1.414D+00
  F =   1.4137311099487531

CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:               SARIMAX(1, 0, 0)   Log Likelihood               -7068.656
Date:                Wed, 02 Nov 2022   AIC                          14143.311
Time:                        17:05:13   BIC                          14162.863
Sample:                             0   HQIC                         14150.164
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          9.7745      0.069    141.177      0.000       9.639       9.910
ar.L1          0.7969      0.009     93.691      0.000       0.780       0.814
sigma2         0.9894      0.020     49.921      0.000       0.951       1.028
===================================================================================
Ljung-Box (L1) (Q):                   0.42   Jarque-Bera (JB):                 0.08
Prob(Q):                              0.51   Prob(JB):                         0.96
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.47   Kurtosis:                         2.99
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
</section>
<section id="Using-exog-in-SARIMAX-and-ARIMA">
<h3 id="Using-exog-in-SARIMAX-and-ARIMA">Using <code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Using-exog-in-SARIMAX-and-ARIMA" title="Permalink to this heading">¶</a></h3>
<p>While <code class="docutils literal notranslate"><span class="pre">exog</span></code> are treated the same in both models, the intercept continues to differ. Below we add an exogenous regressor to <code class="docutils literal notranslate"><span class="pre">y</span></code> and then fit the model using all three methods. The data generating process is now</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \delta + X_t \beta + \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">full_x</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
<span class="n">y</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sarimax_exog_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">arima_exog_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            4     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  1.42683D+00    |proj g|=  2.05943D-01
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

At iterate    5    f=  1.41332D+00    |proj g|=  1.60874D-03

At iterate   10    f=  1.41329D+00    |proj g|=  3.11658D-05

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    4     11     15      1     0     0   1.796D-06   1.413D+00
  F =   1.4132928400115972

CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
</pre></div></div>
</div>
<p>Examining the parameter tables, we see that the parameter estimates on <code class="docutils literal notranslate"><span class="pre">x1</span></code> are identical while the estimates of the <code class="docutils literal notranslate"><span class="pre">intercept</span></code> continue to differ due to the differences in the treatment of trends in these estimators.</p>
<section id="SARIMAX">
<h4 id="SARIMAX"><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code><a class="headerlink" href="#SARIMAX" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_params</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_csv</span><span class="p">()),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">print_params</span><span class="p">(</span><span class="n">sarimax_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>intercept</th>
<td>1.9849</td>
<td>0.085</td>
<td>23.484</td>
<td>0.0</td>
<td>1.819</td>
<td>2.151</td>
</tr>
<tr>
<th>x1</th>
<td>3.0231</td>
<td>0.011</td>
<td>277.150</td>
<td>0.0</td>
<td>3.002</td>
<td>3.044</td>
</tr>
<tr>
<th>ar.L1</th>
<td>0.7969</td>
<td>0.009</td>
<td>93.735</td>
<td>0.0</td>
<td>0.780</td>
<td>0.814</td>
</tr>
<tr>
<th>sigma2</th>
<td>0.9886</td>
<td>0.020</td>
<td>49.941</td>
<td>0.0</td>
<td>0.950</td>
<td>1.027</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="ARIMA">
<h4 id="ARIMA"><code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#ARIMA" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_params</span><span class="p">(</span><span class="n">arima_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>const</th>
<td>9.7741</td>
<td>0.069</td>
<td>141.201</td>
<td>0.0</td>
<td>9.638</td>
<td>9.910</td>
</tr>
<tr>
<th>x1</th>
<td>3.0231</td>
<td>0.011</td>
<td>277.140</td>
<td>0.0</td>
<td>3.002</td>
<td>3.044</td>
</tr>
<tr>
<th>ar.L1</th>
<td>0.7969</td>
<td>0.009</td>
<td>93.728</td>
<td>0.0</td>
<td>0.780</td>
<td>0.814</td>
</tr>
<tr>
<th>sigma2</th>
<td>0.9886</td>
<td>0.020</td>
<td>49.941</td>
<td>0.0</td>
<td>0.950</td>
<td>1.027</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="exog-in-AutoReg">
<h3 id="exog-in-AutoReg"><code class="docutils literal notranslate"><span class="pre">exog</span></code> in <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#exog-in-AutoReg" title="Permalink to this heading">¶</a></h3>
<p>When using <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> to estimate a model using OLS, the model differs from both <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. The <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> specification with exogenous variables is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t &amp; = \phi + \rho Y_{t-1} + X_{t}\beta + \eta_t \\
\eta_t &amp; \sim WN(0,\sigma^2) \\
\end{align}\end{split}\]</div>
<p>This specification is not equivalent to the specification estimated in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>. Here the difference is non-trivial, and naive estimation on the same time series results in different parameter values, even in large samples (and the limit). Estimating this model changes the parameter estimates on the AR(1) coefficient.</p>
<section id="AutoReg">
<h4 id="AutoReg"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#AutoReg" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">autoreg_exog_res</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">autoreg_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>const</th>
<td>7.9714</td>
<td>0.064</td>
<td>124.525</td>
<td>0.0</td>
<td>7.846</td>
<td>8.097</td>
</tr>
<tr>
<th>y.L1</th>
<td>0.1838</td>
<td>0.006</td>
<td>29.890</td>
<td>0.0</td>
<td>0.172</td>
<td>0.196</td>
</tr>
<tr>
<th>x1</th>
<td>3.0311</td>
<td>0.021</td>
<td>142.513</td>
<td>0.0</td>
<td>2.989</td>
<td>3.073</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>The key difference can be seen by writing the model in lag operator notation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
(1-\phi L ) Y_t &amp; = X_{t}\beta + \eta_t \Rightarrow \\
Y_t &amp; = (1-\phi L )^{-1}\left(X_{t}\beta + \eta_t\right) \\
Y_t &amp; = \sum_{i=0}^{\infty} \phi^i \left(X_{t-i}\beta + \eta_{t-i}\right)
\end{align}\end{split}\]</div>
<p>where it is is assumed that <span class="math notranslate nohighlight">\(|\phi|&lt;1\)</span>. Here we see that <span class="math notranslate nohighlight">\(Y_t\)</span> depends on all lagged values of <span class="math notranslate nohighlight">\(X_t\)</span> and <span class="math notranslate nohighlight">\(\eta_t\)</span>. This differs from the specification estimated by <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>, which can be seen to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
Y_t - X_t \beta &amp; = \delta + \rho (Y_{t-1} - X_{t-1}\beta) + \eta_t \\
\left(1-\rho L \right)\left(Y_t - X_t  \beta\right) &amp; = \delta +  \eta_t \\
Y_t - X_t  \beta &amp; = \frac{\delta}{1-\rho} +  \left(1-\rho L \right)^{-1}\eta_t \\
Y_t - X_t  \beta &amp; = \frac{\delta}{1-\rho} +  \sum_{i=0}^\infty \rho^i \eta_{t-i} \\
Y_t  &amp; = \frac{\delta}{1-\rho} + X_t  \beta +  \sum_{i=0}^\infty \rho^i \eta_{t-i} \\
\end{align}\end{split}\]</div>
<p>In this specification, <span class="math notranslate nohighlight">\(Y_t\)</span> only depends on <span class="math notranslate nohighlight">\(X_t\)</span> and no other lags.</p>
</section>
</section>
<section id="Using-the-correct-DGP-with-AutoReg">
<h3 id="Using-the-correct-DGP-with-AutoReg">Using the correct DGP with <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code><a class="headerlink" href="#Using-the-correct-DGP-with-AutoReg" title="Permalink to this heading">¶</a></h3>
<p>Simulating the process that is estimated in <code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> shows that the parameters are recovered from the true model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">eta</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="p">)</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">full_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<section id="AutoReg-with-correct-DGP">
<h4 id="AutoReg-with-correct-DGP"><code class="docutils literal notranslate"><span class="pre">AutoReg</span></code> with correct DGP<a class="headerlink" href="#AutoReg-with-correct-DGP" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">autoreg_alt_exog_res</span> <span class="o">=</span> <span class="n">AutoReg</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">autoreg_alt_exog_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>const</th>
<td>1.9870</td>
<td>0.030</td>
<td>66.526</td>
<td>0.0</td>
<td>1.928</td>
<td>2.046</td>
</tr>
<tr>
<th>y.L1</th>
<td>0.7968</td>
<td>0.003</td>
<td>300.382</td>
<td>0.0</td>
<td>0.792</td>
<td>0.802</td>
</tr>
<tr>
<th>x1</th>
<td>3.0263</td>
<td>0.014</td>
<td>217.034</td>
<td>0.0</td>
<td>2.999</td>
<td>3.054</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
</section>
<section id="Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA">
<h2 id="Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA">Reconstructing residuals, fitted values and forecasts in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Reconstructing-residuals,-fitted-values-and-forecasts-in-SARIMAX-and-ARIMA" title="Permalink to this heading">¶</a></h2>
<p>In models that contain only autoregressive terms, trends and exogenous variables, fitted values and forecasts can be easily reconstructed once the maximum lag length in the model has been reached. In practice, this means after <span class="math notranslate nohighlight">\((P+D)s+p+d\)</span> periods. Earlier predictions and residuals are harder to reconstruct since the model builds the best prediction for <span class="math notranslate nohighlight">\(Y_t|Y_{t-1},Y_{t-2},...\)</span>. When the number of lags of <span class="math notranslate nohighlight">\(Y\)</span> is less than the autoregressive order, then the expression for the
optimal prediction differs from the model. For example, when predicting the very first value, <span class="math notranslate nohighlight">\(Y_1\)</span>, there is no information available from the history of <span class="math notranslate nohighlight">\(Y\)</span>, and so the best prediction is the unconditional mean. In the case of an AR(1), the second prediction will follow the model, so that when using <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>, the prediction is</p>
<div class="math notranslate nohighlight">
\[Y_2 = \hat{\delta} + \hat{\rho} \left(Y_1 - \hat{\delta}\right)\]</div>
<p>since <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> treats both exogenous and trend terms as regression with ARMA errors.</p>
<p>This can be seen in the next set of cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arima_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">arima_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>const</th>
<td>9.9346</td>
<td>0.222</td>
<td>44.667</td>
<td>0.0</td>
<td>9.499</td>
<td>10.371</td>
</tr>
<tr>
<th>ar.L1</th>
<td>0.7957</td>
<td>0.009</td>
<td>92.515</td>
<td>0.0</td>
<td>0.779</td>
<td>0.813</td>
</tr>
<tr>
<th>sigma2</th>
<td>10.3015</td>
<td>0.204</td>
<td>50.496</td>
<td>0.0</td>
<td>9.902</td>
<td>10.701</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arima_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.93458658, 10.91088035, 11.80415747])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_hat</span><span class="p">,</span> <span class="n">rho_hat</span> <span class="o">=</span> <span class="n">arima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10.910880346330751
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> treats trend terms differently, and so the one-step forecast from a model estimated using <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> is</p>
<div class="math notranslate nohighlight">
\[Y_2 = \hat\delta + \hat\rho Y_1\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sarima_res</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">sarima_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
 This problem is unconstrained.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =            3     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.58518D+00    |proj g|=  5.99456D-05

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
    3      3      5      1     0     0   3.347D-05   2.585D+00
  F =   2.5851830060985752

CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>intercept</th>
<td>2.0283</td>
<td>0.097</td>
<td>20.841</td>
<td>0.0</td>
<td>1.838</td>
<td>2.219</td>
</tr>
<tr>
<th>ar.L1</th>
<td>0.7959</td>
<td>0.009</td>
<td>92.536</td>
<td>0.0</td>
<td>0.779</td>
<td>0.813</td>
</tr>
<tr>
<th>sigma2</th>
<td>10.3007</td>
<td>0.204</td>
<td>50.500</td>
<td>0.0</td>
<td>9.901</td>
<td>10.700</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sarima_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.93588659, 10.91128867, 11.80469658])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_hat</span><span class="p">,</span> <span class="n">rho_hat</span> <span class="o">=</span> <span class="n">sarima_res</span><span class="o">.</span><span class="n">params</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10.911288670367867
</pre></div></div>
</div>
<section id="Prediction-with-MA-components">
<h3 id="Prediction-with-MA-components">Prediction with MA components<a class="headerlink" href="#Prediction-with-MA-components" title="Permalink to this heading">¶</a></h3>
<p>When a model contains a MA component, the prediction is more complicated since errors are never directly observable. The prediction is still <span class="math notranslate nohighlight">\(Y_t|Y_{t-1},Y_{t-2},...\)</span>, and when the MA component is invertible, then the optimal prediction can be represented as a <span class="math notranslate nohighlight">\(t\)</span>-lag AR process. When <span class="math notranslate nohighlight">\(t\)</span> is large, this should be very close to the prediction as if the errors were observable. For short lags, this can differ markedly.</p>
<p>In the next cell we simulate an MA(1) process, and fit an MA model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>

<span class="n">ma_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">print_params</span><span class="p">(</span><span class="n">ma_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>coef</th>
<th>std err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>[0.025</th>
<th>0.975]</th>
</tr>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>const</th>
<td>9.9185</td>
<td>0.025</td>
<td>391.129</td>
<td>0.0</td>
<td>9.869</td>
<td>9.968</td>
</tr>
<tr>
<th>ma.L1</th>
<td>0.8025</td>
<td>0.009</td>
<td>93.864</td>
<td>0.0</td>
<td>0.786</td>
<td>0.819</td>
</tr>
<tr>
<th>sigma2</th>
<td>0.9904</td>
<td>0.020</td>
<td>49.925</td>
<td>0.0</td>
<td>0.951</td>
<td>1.029</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>We start by looking at predictions near the beginning of the sample corresponding <code class="docutils literal notranslate"><span class="pre">y[1]</span></code>, …, <code class="docutils literal notranslate"><span class="pre">y[5]</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 8.57011015,  9.19907188,  8.96971353,  9.78987115, 11.11984478])
</pre></div></div>
</div>
<p>and the corresponding residuals that are needed to produce the “direct” forecasts</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-2.7621904 , -1.12255005, -1.33557621, -0.17206944,  1.5634041 ])
</pre></div></div>
</div>
<p>Using the model parameters, we can produce the “direct” forecasts using the MA(1) specification</p>
<div class="math notranslate nohighlight">
\[\hat Y_t = \hat\delta + \hat\rho \hat\epsilon_{t-1}\]</div>
<p>We see that these are not especially close to the actual model predictions for the initial forecasts, but that the gap quickly reduces.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_hat</span><span class="p">,</span> <span class="n">rho_hat</span> <span class="o">=</span> <span class="n">ma_res</span><span class="o">.</span><span class="n">params</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">direct</span> <span class="o">=</span> <span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">direct</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 7.70168405,  9.01756049,  8.84659855,  9.7803589 , 11.17314527])
</pre></div></div>
</div>
<p>The difference is nearly a standard deviation for the first but declines as the index increases.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">direct</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.8684261 ,  0.18151139,  0.12311499,  0.00951225, -0.05330049])
</pre></div></div>
</div>
<p>We next look at the end of the sample and the final three predictions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.79692804, 10.51272714, 10.55855562])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.15142355,  0.74049384,  0.79759816])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="n">delta_hat</span> <span class="o">+</span> <span class="n">rho_hat</span> <span class="o">*</span> <span class="n">ma_res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">direct</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 9.79692804, 10.51272714, 10.55855562])
</pre></div></div>
</div>
<p>The “direct” forecasts are identical. This happens since the effect of the short sample has disappeared by the end of the sample (In practice it is negligible by observations 100 or so, and numerically absent by around observation 160).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ma_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">direct</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0., 0., 0.])
</pre></div></div>
</div>
<p>The same principle applies in more complicated model that include multiple lags or seasonal term - predictions in AR models are simple once the effective lag length has been reached, while predictions in models that contains MA components are only simple once the maximum root of the MA lag polynomial is sufficiently small so that the residuals are close to the true residuals.</p>
</section>
<section id="Prediction-differences-in-SARIMAX-and-ARIMA">
<h3 id="Prediction-differences-in-SARIMAX-and-ARIMA">Prediction differences in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Prediction-differences-in-SARIMAX-and-ARIMA" title="Permalink to this heading">¶</a></h3>
<p>The formulas used to make predictions from <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> models differ in one key aspect - <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> treats all trend terms, e.g, the intercept or time trend, as part of the exogenous regressors. For example, an AR(1) model with an intercept and linear time trend estimated using <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> has the specification</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t - \delta_0 - \delta_1 t &amp; = \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t
\end{align*}\end{split}\]</div>
<p>When the same model is estimated using <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>, the specification is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t &amp; = \epsilon_t \\
\epsilon_t &amp; =  \delta_0 + \delta_1 t  + \rho \epsilon_{t-1} + \eta_t
\end{align*}\end{split}\]</div>
<p>The differences are more apparent when the model contains exogenous regressors, <span class="math notranslate nohighlight">\(X_t\)</span>. The <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> specification is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t - \delta_0 - \delta_1 t - X_t \beta &amp; = \epsilon_t \\
\epsilon_t &amp; = \rho \epsilon_{t-1} + \eta_t \\
           &amp; = \rho \left(Y_{t-1} - \delta_0 - \delta_1 (t-1) - X_{t-1} \beta\right) + \eta_t
\end{align*}\end{split}\]</div>
<p>while the <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> specification is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y_t &amp; =  X_t \beta + \epsilon_t \\
\epsilon_t &amp; =  \delta_0 + \delta_1 t  + \rho \epsilon_{t-1} + \eta_t \\
           &amp; = \delta_0 + \delta_1 t  + \rho \left(Y_{t-1} - X_{t-1}\beta\right) + \eta_t
\end{align*}\end{split}\]</div>
<p>The key difference between these two is that the intercept and the trend are effectively equivalent to exogenous regressions in <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> while they are more like standard ARMA terms in <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code>.</p>
<p>The next cell simulates an ARX with a time trend using the specification in <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code> and estimates the parameters using both estimators.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">delta0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">delta1</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">epsilon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">delta0</span> <span class="o">+</span> <span class="n">delta1</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">full_x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">110</span><span class="p">,</span> <span class="n">delta1</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">arx_res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"ct"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"ct"</span><span class="p">)</span>
<span class="n">start</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span>
<span class="n">sarimax_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">start_params</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"bfgs"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimization terminated successfully.
         Current function value: 1.413691
         Iterations: 46
         Function evaluations: 58
         Gradient evaluations: 58
</pre></div></div>
</div>
<p>The two estimators fit similarly, although there is a small difference in the log-likelihood. This is a numerical issue and should not materially affect the predictions. Importantly the two trend parameters, <code class="docutils literal notranslate"><span class="pre">const</span></code> and <code class="docutils literal notranslate"><span class="pre">x1</span></code> (unfortunately named for the time trend), differ between the two. The other parameters are effectively identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">arx_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:                 ARIMA(1, 0, 0)   Log Likelihood               -7069.171
Date:                Wed, 02 Nov 2022   AIC                          14148.343
Time:                        17:05:25   BIC                          14180.928
Sample:                             0   HQIC                         14159.763
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const        109.2112      0.137    796.186      0.000     108.942     109.480
x1             0.5000   4.78e-05   1.05e+04      0.000       0.500       0.500
x2             2.0495      0.011    187.517      0.000       2.028       2.071
ar.L1          0.7965      0.009     93.669      0.000       0.780       0.813
sigma2         0.9897      0.020     49.854      0.000       0.951       1.029
===================================================================================
Ljung-Box (L1) (Q):                   0.33   Jarque-Bera (JB):                 0.15
Prob(Q):                              0.57   Prob(JB):                         0.93
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.53   Kurtosis:                         3.00
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sarimax_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:               SARIMAX(1, 0, 0)   Log Likelihood               -7068.457
Date:                Wed, 02 Nov 2022   AIC                          14146.914
Time:                        17:05:25   BIC                          14179.500
Sample:                             0   HQIC                         14158.335
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
intercept     22.7438      0.929     24.481      0.000      20.923      24.565
drift          0.1019      0.004     23.985      0.000       0.094       0.110
x1             2.0230      0.011    185.290      0.000       2.002       2.044
ar.L1          0.7963      0.008     93.745      0.000       0.780       0.813
sigma2         0.9894      0.020     49.899      0.000       0.951       1.028
===================================================================================
Ljung-Box (L1) (Q):                   0.47   Jarque-Bera (JB):                 0.13
Prob(Q):                              0.49   Prob(JB):                         0.94
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.47   Kurtosis:                         3.00
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
</section>
</section>
<section id="Initial-residuals-SARIMAX-and-ARIMA">
<h2 id="Initial-residuals-SARIMAX-and-ARIMA">Initial residuals <code class="docutils literal notranslate"><span class="pre">SARIMAX</span></code> and <code class="docutils literal notranslate"><span class="pre">ARIMA</span></code><a class="headerlink" href="#Initial-residuals-SARIMAX-and-ARIMA" title="Permalink to this heading">¶</a></h2>
<p>Residuals for observations before the maximal model order, which depends on the AR, MA, Seasonal AR, Seasonal MA and differencing parameters, are not reliable and should not be used for performance assessment. In general, in an ARIMA with orders <span class="math notranslate nohighlight">\((p,d,q)\times(P,D,Q,s)\)</span>, the formula for residuals that are less well behaved is:</p>
<div class="math notranslate nohighlight">
\[\max((P+D)s+p+d,Qs+q)\]</div>
<p>We can simulate some data from an ARIMA(1,0,0)(1,0,0,12) and examine the residuals.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">psi</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="o">+</span> <span class="n">psi</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">12</span><span class="p">]</span>
        <span class="o">-</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">psi</span><span class="p">)</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">13</span><span class="p">]</span>
        <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<p>With a large sample, the parameter estimates are very close to the DGP parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"c"</span><span class="p">,</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                                    SARIMAX Results
========================================================================================
Dep. Variable:                                y   No. Observations:                 5000
Model:             ARIMA(1, 0, 0)x(1, 0, 0, 12)   Log Likelihood               -7076.266
Date:                          Wed, 02 Nov 2022   AIC                          14160.532
Time:                                  17:05:28   BIC                          14186.600
Sample:                                       0   HQIC                         14169.668
                                         - 5000
Covariance Type:                            opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const         19.8586      0.043    458.609      0.000      19.774      19.943
ar.L1          0.7972      0.008     93.925      0.000       0.781       0.814
ar.S.L12      -0.6044      0.011    -53.280      0.000      -0.627      -0.582
sigma2         0.9914      0.020     49.899      0.000       0.952       1.030
===================================================================================
Ljung-Box (L1) (Q):                   0.50   Jarque-Bera (JB):                 0.11
Prob(Q):                              0.48   Prob(JB):                         0.95
Heteroskedasticity (H):               0.96   Skew:                            -0.01
Prob(H) (two-sided):                  0.40   Kurtosis:                         2.99
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>We can first examine the initial 13 residuals by plotting against the actual shocks in the model. While there is a correspondence, it is fairly weak and the correlation is much less than 1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">"figure"</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">"font"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">13</span><span class="p">],</span> <span class="n">eta</span><span class="p">[</span><span class="mi">200</span> <span class="p">:</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">13</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_63_0.png" src="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_63_0.png"/>
</div>
</div>
<p>Looking at the next 24 residuals and shocks, we see there is nearly perfect correlation. This is expected in large samples once the less accurate residuals are ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">37</span><span class="p">],</span> <span class="n">eta</span><span class="p">[</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">13</span> <span class="p">:</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">37</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_65_0.png" src="../../../_images/examples_notebooks_generated_statespace_sarimax_faq_65_0.png"/>
</div>
</div>
<p>Next, we simulate an ARIMA(1,1,0), and include a time trend.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">20210819</span><span class="p">)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">5200</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">eta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">eta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rho</span><span class="p">)</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">epsilon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">200</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<p>Again the parameter estimates are very close to the DGP parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s2">"t"</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                               SARIMAX Results
==============================================================================
Dep. Variable:                      y   No. Observations:                 5000
Model:                 ARIMA(1, 1, 0)   Log Likelihood               -7067.739
Date:                Wed, 02 Nov 2022   AIC                          14141.479
Time:                        17:05:29   BIC                          14161.030
Sample:                             0   HQIC                         14148.331
                               - 5000
Covariance Type:                  opg
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
x1             1.7747      0.069     25.642      0.000       1.639       1.910
ar.L1          0.7968      0.009     93.658      0.000       0.780       0.813
sigma2         0.9896      0.020     49.908      0.000       0.951       1.028
===================================================================================
Ljung-Box (L1) (Q):                   0.43   Jarque-Bera (JB):                 0.09
Prob(Q):                              0.51   Prob(JB):                         0.96
Heteroskedasticity (H):               0.97   Skew:                            -0.01
Prob(H) (two-sided):                  0.47   Kurtosis:                         2.99
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>The residuals are not accurate, and the first residual is approximately 500. The others are closer, although in this model the first 2 should usually be ignored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 5.08403002e+02, -1.58904197e+00, -1.54902445e+00,  1.04992619e-01,
        1.33644383e+00])
</pre></div></div>
</div>
<p>The reason why the first residual is so large is that the optimal prediction of this value is the mean of the difference, which is 1.77. Once the first value is known, the second value makes use of the first value in its prediction and the prediction is substantially closer to the truth.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([  1.77472563, 511.95355129, 510.87392196, 508.85708934,
       509.03356182, 511.85245439])
</pre></div></div>
</div>
<p>It is worth noting that the results class contains two parameters than can be helpful in understanding which residuals are problematic, <code class="docutils literal notranslate"><span class="pre">loglikelihood_burn</span></code> and <code class="docutils literal notranslate"><span class="pre">nobs_diffuse</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">loglikelihood_burn</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">nobs_diffuse</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 0)
</pre></div></div>
</div>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="stationarity_detrending_adf_kpss.html" title="Stationarity and detrending (ADF/KPSS)"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Stationarity and detrending (ADF/KPSS) </span>
              </div>
            </a>
          
          
            <a href="statespace_varmax.html" title="VARMAX models"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> VARMAX models </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2009-2019, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
              
          </div>
            Last updated on
              Nov 02, 2022.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>