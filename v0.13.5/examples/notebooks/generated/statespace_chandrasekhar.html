

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>State space models - Chandrasekhar recursions &#8212; statsmodels</title>
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
  <link rel="stylesheet" href="../../../_static/stylesheets/deprecation.css">
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="The Theta Model" href="theta-model.html" />
    <link rel="prev" title="State space models - concentrating the scale out of the likelihood function" href="statespace_concentrated_scale.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/notebooks/generated/statespace_chandrasekhar" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="statsmodels"
           class="md-header-nav__button md-logo">
          
              <img src="../../../_static/statsmodels-logo-v2-bw.svg" height="26"
                   alt="statsmodels logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">statsmodels 0.13.5</span>
          <span class="md-header-nav__topic"> State space models - Chandrasekhar recursions </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../../versions-v2.json",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">Examples</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="statsmodels" class="md-nav__button md-logo">
      
        <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="statsmodels">statsmodels 0.13.5</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../../install.html" class="md-nav__link">Installing statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../gettingstarted.html" class="md-nav__link">Getting started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../user-guide.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html" class="md-nav__link">Examples</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../index.html#linear-regression-models" class="md-nav__link">Linear Regression Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#plotting" class="md-nav__link">Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">Discrete Choice Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">Nonparametric Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">Generalized Linear Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#robust-regression" class="md-nav__link">Robust Regression</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">Generalized Estimating Equations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#statistics" class="md-nav__link">Statistics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#time-series-analysis" class="md-nav__link">Time Series Analysis</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models" class="md-nav__link">State space models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">State space models - Technical notes</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="statespace_concentrated_scale.html" class="md-nav__link">State space models - concentrating the scale out of the likelihood function</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> State space models - Chandrasekhar recursions </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">State space models - Chandrasekhar recursions</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-chandrasekhar--page-root" class="md-nav__link">State space models - Chandrasekhar recursions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#State-space-models-and-the-Kalman-filter" class="md-nav__link">State space models and the Kalman filter</a>
        </li>
        <li class="md-nav__item"><a href="#Example:-seasonal-autoregression" class="md-nav__link">Example: seasonal autoregression</a>
        </li>
        <li class="md-nav__item"><a href="#State-space-models-and-the-Chandrasekhar-recursions" class="md-nav__link">State space models and the Chandrasekhar recursions</a>
        </li>
        <li class="md-nav__item"><a href="#Convergence" class="md-nav__link">Convergence</a>
        </li>
        <li class="md-nav__item"><a href="#Practical-example" class="md-nav__link">Practical example</a>
        </li>
        <li class="md-nav__item"><a href="#Aside-on-multithreaded-matrix-algebra-routines" class="md-nav__link">Aside on multithreaded matrix algebra routines</a>
        </li>
        <li class="md-nav__item"><a href="#Chandrasekhar-recursions-and-the-univariate-filtering-approach" class="md-nav__link">Chandrasekhar recursions and the univariate filtering approach</a>
        </li>
        <li class="md-nav__item"><a href="#Bibliography" class="md-nav__link">Bibliography</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_chandrasekhar.ipynb.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#forecasting" class="md-nav__link">Forecasting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#multivariate-methods" class="md-nav__link">Multivariate Methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../index.html#user-notes" class="md-nav__link">User Notes</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../api.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../about.html" class="md-nav__link">About statsmodels</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../dev/index.html" class="md-nav__link">Developer Page</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../release/index.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-chandrasekhar--page-root" class="md-nav__link">State space models - Chandrasekhar recursions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#State-space-models-and-the-Kalman-filter" class="md-nav__link">State space models and the Kalman filter</a>
        </li>
        <li class="md-nav__item"><a href="#Example:-seasonal-autoregression" class="md-nav__link">Example: seasonal autoregression</a>
        </li>
        <li class="md-nav__item"><a href="#State-space-models-and-the-Chandrasekhar-recursions" class="md-nav__link">State space models and the Chandrasekhar recursions</a>
        </li>
        <li class="md-nav__item"><a href="#Convergence" class="md-nav__link">Convergence</a>
        </li>
        <li class="md-nav__item"><a href="#Practical-example" class="md-nav__link">Practical example</a>
        </li>
        <li class="md-nav__item"><a href="#Aside-on-multithreaded-matrix-algebra-routines" class="md-nav__link">Aside on multithreaded matrix algebra routines</a>
        </li>
        <li class="md-nav__item"><a href="#Chandrasekhar-recursions-and-the-univariate-filtering-approach" class="md-nav__link">Chandrasekhar recursions and the univariate filtering approach</a>
        </li>
        <li class="md-nav__item"><a href="#Bibliography" class="md-nav__link">Bibliography</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_chandrasekhar.ipynb.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="State-space-models---Chandrasekhar-recursions">
<h1 id="examples-notebooks-generated-statespace-chandrasekhar--page-root">State space models - Chandrasekhar recursions<a class="headerlink" href="#examples-notebooks-generated-statespace-chandrasekhar--page-root" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">pandas_datareader.data</span> <span class="kn">import</span> <span class="n">DataReader</span>
</pre></div>
</div>
</div>
<p>Although most operations related to state space models rely on the Kalman filtering recursions, in some special cases one can use a separate method often called “Chandrasekhar recursions”. These provide an alternative way to iteratively compute the conditional moments of the state vector, and in some cases they can be substantially less computationally intensive than the Kalman filter recursions. For complete details, see the paper “Using the ‘Chandrasekhar Recursions’ for Likelihood Evaluation
of DSGE Models” (Herbst, 2015). Here we just sketch the basic idea.</p>
<section id="State-space-models-and-the-Kalman-filter">
<h2 id="State-space-models-and-the-Kalman-filter">State space models and the Kalman filter<a class="headerlink" href="#State-space-models-and-the-Kalman-filter" title="Permalink to this heading">¶</a></h2>
<p>Recall that a time-invariant state space model can be written:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp;= Z \alpha_t + \varepsilon_t, \qquad \varepsilon_t \sim N(0, H) \\
\alpha_{t+1} &amp; = T \alpha_t + R \eta_t, \qquad \eta_t \sim N(0, Q) \\
\alpha_1 &amp; \sim N(a_1, P_1)
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_t\)</span> is a <span class="math notranslate nohighlight">\(p \times 1\)</span> vector and <span class="math notranslate nohighlight">\(\alpha_t\)</span> is an <span class="math notranslate nohighlight">\(m \times 1\)</span> vector.</p>
<p>Each iteration of the Kalman filter, say at time <span class="math notranslate nohighlight">\(t\)</span>, can be split into three parts:</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong>: specification of <span class="math notranslate nohighlight">\(a_t\)</span> and <span class="math notranslate nohighlight">\(P_t\)</span> that define the conditional state distribution, <span class="math notranslate nohighlight">\(\alpha_t \mid y^{t-1} \sim N(a_t, P_t)\)</span>.</p></li>
<li><p><strong>Updating</strong>: computation of <span class="math notranslate nohighlight">\(a_{t|t}\)</span> and <span class="math notranslate nohighlight">\(P_{t|t}\)</span> that define the conditional state distribution, <span class="math notranslate nohighlight">\(\alpha_t \mid y^{t} \sim N(a_{t|t}, P_{t|t})\)</span>.</p></li>
<li><p><strong>Prediction</strong>: computation of <span class="math notranslate nohighlight">\(a_{t+1}\)</span> and <span class="math notranslate nohighlight">\(P_{t+1}\)</span> that define the conditional state distribution, <span class="math notranslate nohighlight">\(\alpha_{t+1} \mid y^{t} \sim N(a_{t+1}, P_{t+1})\)</span>.</p></li>
</ol>
<p>Of course after the first iteration, the prediction part supplies the values required for initialization of the next step.</p>
<p>Focusing on the prediction step, the Kalman filter recursions yield:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
a_{t+1} &amp; = T a_{t|t} \\
P_{t+1} &amp; = T P_{t|t} T' + R Q R' \\
\end{aligned}\end{split}\]</div>
<p>where the matrices <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_{t|t}\)</span> are each <span class="math notranslate nohighlight">\(m \times m\)</span>, where <span class="math notranslate nohighlight">\(m\)</span> is the size of the state vector <span class="math notranslate nohighlight">\(\alpha\)</span>. In some cases, the state vector can become extremely large, which can imply that the matrix multiplications required to produce <span class="math notranslate nohighlight">\(P_{t+1}\)</span> can be become computationally intensive.</p>
</section>
<section id="Example:-seasonal-autoregression">
<h2 id="Example:-seasonal-autoregression">Example: seasonal autoregression<a class="headerlink" href="#Example:-seasonal-autoregression" title="Permalink to this heading">¶</a></h2>
<p>As an example, notice that an AR(r) model (we use <span class="math notranslate nohighlight">\(r\)</span> here since we already used <span class="math notranslate nohighlight">\(p\)</span> as the dimension of the observation vector) can be put into state space form as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
y_t &amp;= \alpha_t \\
\alpha_{t+1} &amp; = T \alpha_t + R \eta_t, \qquad \eta_t \sim N(0, Q)
\end{aligned}\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
T = \begin{bmatrix}
\phi_1 &amp; \phi_2 &amp; \dots &amp; \phi_r \\
1 &amp; 0 &amp; &amp; 0 \\
\vdots &amp; \ddots &amp; &amp; \vdots \\
0 &amp;  &amp; 1 &amp; 0 \\
\end{bmatrix} \qquad
R = \begin{bmatrix}
1 \\
0 \\
\vdots \\
0
\end{bmatrix} \qquad
Q = \begin{bmatrix}
\sigma^2
\end{bmatrix}
\end{aligned}\end{split}\]</div>
<p>In an AR model with daily data that exhibits annual seasonality, we might want to fit a model that incorporates lags up to <span class="math notranslate nohighlight">\(r=365\)</span>, in which case the state vector would be at least <span class="math notranslate nohighlight">\(m = 365\)</span>. The matrices <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(P_{t|t}\)</span> then each have <span class="math notranslate nohighlight">\(365^2 = 133225\)</span> elements, and so most of the time spent computing the likelihood function (via the Kalman filter) can become dominated by the matrix multiplications in the prediction step.</p>
</section>
<section id="State-space-models-and-the-Chandrasekhar-recursions">
<h2 id="State-space-models-and-the-Chandrasekhar-recursions">State space models and the Chandrasekhar recursions<a class="headerlink" href="#State-space-models-and-the-Chandrasekhar-recursions" title="Permalink to this heading">¶</a></h2>
<p>The Chandrasekhar recursions replace equation <span class="math notranslate nohighlight">\(P_{t+1} = T P_{t|t} T' + R Q R'\)</span> with a different recursion:</p>
<div class="math notranslate nohighlight">
\[P_{t+1} = P_t + W_t M_t W_t'\]</div>
<p>but where <span class="math notranslate nohighlight">\(W_t\)</span> is a matrix with dimension <span class="math notranslate nohighlight">\(m \times p\)</span> and <span class="math notranslate nohighlight">\(M_t\)</span> is a matrix with dimension <span class="math notranslate nohighlight">\(p \times p\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the dimension of the observed vector <span class="math notranslate nohighlight">\(y_t\)</span>. These matrices themselves have recursive formulations. For more general details and for the formulas for computing <span class="math notranslate nohighlight">\(W_t\)</span> and <span class="math notranslate nohighlight">\(M_t\)</span>, see Herbst (2015).</p>
<p><strong>Important note</strong>: unlike the Kalman filter, the Chandrasekhar recursions can not be used for every state space model. In particular, the latter has the following restrictions (that are not required for the use of the former):</p>
<ul class="simple">
<li><p>The model must be time-invariant, except that time-varying intercepts are permitted.</p></li>
<li><p>Stationary initialization of the state vector must be used (this rules out all models in non-stationary components)</p></li>
<li><p>Missing data is not permitted</p></li>
</ul>
<p>To understand why this formula can imply more efficient computations, consider again the SARIMAX case, above. In this case, <span class="math notranslate nohighlight">\(p = 1\)</span>, so that <span class="math notranslate nohighlight">\(M_t\)</span> is a scalar and we can rewrite the Chandrasekhar recursion as:</p>
<div class="math notranslate nohighlight">
\[P_{t+1} = P_t + M_t \times W_t W_t'\]</div>
<p>The matrices being multiplied, <span class="math notranslate nohighlight">\(W_t\)</span>, are then of dimension <span class="math notranslate nohighlight">\(m \times 1\)</span>, and in the case <span class="math notranslate nohighlight">\(r=365\)</span>, they each only have <span class="math notranslate nohighlight">\(365\)</span> elements, rather than <span class="math notranslate nohighlight">\(365^2\)</span> elements. This implies substantially fewer computations are required to complete the prediction step.</p>
</section>
<section id="Convergence">
<h2 id="Convergence">Convergence<a class="headerlink" href="#Convergence" title="Permalink to this heading">¶</a></h2>
<p>A factor that complicates a straightforward discussion of performance implications is the well-known fact that in time-invariant models, the predicted state covariance matrix will converge to a constant matrix. This implies that there exists an <span class="math notranslate nohighlight">\(S\)</span> such that, for every <span class="math notranslate nohighlight">\(t &gt; S\)</span>, <span class="math notranslate nohighlight">\(P_t = P_{t+1}\)</span>. Once convergence has been achieved, we can eliminate the equation for <span class="math notranslate nohighlight">\(P_{t+1}\)</span> from the prediction step altogether.</p>
<p>In simple time series models, like AR(r) models, convergence is achieved fairly quickly, and this can limit the performance benefit to using the Chandrasekhar recursions. Herbst (2015) focuses instead on DSGE (Dynamic Stochastic General Equilibrium) models instead, which often have a large state vector and often a large number of periods to achieve convergence. In these cases, the performance gains can be quite substantial.</p>
</section>
<section id="Practical-example">
<h2 id="Practical-example">Practical example<a class="headerlink" href="#Practical-example" title="Permalink to this heading">¶</a></h2>
<p>As a practical example, we will consider monthly data that has a clear seasonal component. In this case, we look at the inflation rate of apparel, as measured by the consumer price index. A graph of the data indicates strong seasonality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpi_apparel</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s1">'CPIAPPNS'</span><span class="p">,</span> <span class="s1">'fred'</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">'1986'</span><span class="p">)</span>
<span class="n">cpi_apparel</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">cpi_apparel</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'MS'</span><span class="p">)</span>
<span class="n">inf_apparel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">cpi_apparel</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="mi">1200</span>
<span class="n">inf_apparel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_chandrasekhar_10_0.png" src="../../../_images/examples_notebooks_generated_statespace_chandrasekhar_10_0.png"/>
</div>
</div>
<p>We will construct two model instances. The first will be set to use the Kalman filter recursions, while the second will be set to use the Chandrasekhar recursions. This setting is controlled by the <code class="docutils literal notranslate"><span class="pre">ssm.filter_chandrasekhar</span></code> property, as shown below.</p>
<p>The model we have in mind is a seasonal autoregression, where we include the first 6 months as lags as well as the given month in each of the previous 15 years as lags. This implies that the state vector has dimension <span class="math notranslate nohighlight">\(m = 186\)</span>, which is large enough that we might expect to see some substantial performance gains by using the Chandrasekhar recursions.</p>
<p><strong>Remark</strong>: We set <code class="docutils literal notranslate"><span class="pre">tolerance=0</span></code> in each model - this has the effect of preventing the filter from ever recognizing that the prediction covariance matrix has converged. <em>This is not recommended in practice</em>. We do this here to highlight the superior performance of the Chandrasekhar recursions when they are used in every period instead of the typical Kalman filter recursions. Later, we will show the performance in a more realistic setting that we do allow for convergence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model that will apply Kalman filter recursions</span>
<span class="n">mod_kf</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">k_states</span><span class="p">)</span>

<span class="c1"># Model that will apply Chandrasekhar recursions</span>
<span class="n">mod_ch</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mod_ch</span><span class="o">.</span><span class="n">ssm</span><span class="o">.</span><span class="n">filter_chandrasekhar</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
186
</pre></div></div>
</div>
<p>We time computation of the log-likelihood function, using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="n">mod_kf</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">mod_ch</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_ch</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
</pre></div>
</div>
<p>This results in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>171 ms ± 19.7 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
85 ms ± 4.97 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>The implication is that in this experiment, the Chandrasekhar recursions improved performance by about a factor of 2.</p>
<p>As we mentioned above, in the previous experiment we disabled convergence of the predicted covariance matrices, so the results there are an upper bound. Now we allow for convergence, as usual, by removing the <code class="docutils literal notranslate"><span class="pre">tolerance=0</span></code> argument:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model that will apply Kalman filter recursions</span>
<span class="n">mod_kf</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">k_states</span><span class="p">)</span>

<span class="c1"># Model that will apply Chandrasekhar recursions</span>
<span class="n">mod_ch</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">inf_apparel</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">mod_ch</span><span class="o">.</span><span class="n">ssm</span><span class="o">.</span><span class="n">filter_chandrasekhar</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
186
</pre></div></div>
</div>
<p>Again, we time computation of the log-likelihood function, using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="n">mod_kf</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">mod_ch</span><span class="o">.</span><span class="n">loglike</span><span class="p">(</span><span class="n">mod_ch</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
</pre></div>
</div>
<p>This results in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>114 ms ± 7.64 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
70.5 ms ± 2.43 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>The Chandrasekhar recursions still improve performance, but now only by about 33%. The reason for this is that after convergence, we no longer need to compute the predicted covariance matrices, so that for those post-convergence periods, there will be no difference in computation time between the two approaches. Below we check the period in which convergence was achieved:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_kf</span> <span class="o">=</span> <span class="n">mod_kf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">mod_kf</span><span class="o">.</span><span class="n">start_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Convergence at t=</span><span class="si">%d</span><span class="s1">, of T=</span><span class="si">%d</span><span class="s1"> total observations'</span> <span class="o">%</span>
      <span class="p">(</span><span class="n">res_kf</span><span class="o">.</span><span class="n">filter_results</span><span class="o">.</span><span class="n">period_converged</span><span class="p">,</span> <span class="n">res_kf</span><span class="o">.</span><span class="n">nobs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Convergence at t=186, of T=440 total observations
</pre></div></div>
</div>
<p>Since convergence happened relatively early, we are already avoiding the expensive matrix multiplications in more than half of the periods.</p>
<p>However, as mentioned above, larger DSGE models may not achieve convergence for most or all of the periods in the sample, and so we could perhaps expect to achieve performance gains more similar to the first example. In their 2019 paper “Euro area real-time density forecasting with financial or labor market frictions”, McAdam and Warne note that in their applications, “Compared with the standard Kalman filter, it is our experience that these recursions speed up the calculation of the
log-likelihood for the three models by roughly 50 percent”. This is about the same result as we found in our first example.</p>
</section>
<section id="Aside-on-multithreaded-matrix-algebra-routines">
<h2 id="Aside-on-multithreaded-matrix-algebra-routines">Aside on multithreaded matrix algebra routines<a class="headerlink" href="#Aside-on-multithreaded-matrix-algebra-routines" title="Permalink to this heading">¶</a></h2>
<p>The timings above are based on the Numpy installation installed via Anaconda, which uses Intel’s MKL BLAS and LAPACK libraries. These implement multithreaded processing to speed up matrix algebra, which can be particularly helpful for operations on the larger matrices we’re working with here. To get a sense of how this affects results, we could turn off multithreading by putting the following in the first cell of this notebook.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"MKL_NUM_THREADS"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"1"</span>
</pre></div>
</div>
<p>When we do this, the timings of the first example change to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>307 ms ± 3.08 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
97.5 ms ± 1.64 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>and the timings of the second example change to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>178 ms ± 2.78 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
78.9 ms ± 950 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>Both are slower, but the typical Kalman filter is affected much more.</p>
<p>This is not unexpected; the performance differential between single and multithreaded linear algebra is much greater in the typical Kalman filter case, because the whole point of the Chandrasekhar recursions is to reduce the size of the matrix operations. It means that if multithreaded linear algebra is unavailable, the Chandrasekhar recursions offer even greater performance gains.</p>
</section>
<section id="Chandrasekhar-recursions-and-the-univariate-filtering-approach">
<h2 id="Chandrasekhar-recursions-and-the-univariate-filtering-approach">Chandrasekhar recursions and the univariate filtering approach<a class="headerlink" href="#Chandrasekhar-recursions-and-the-univariate-filtering-approach" title="Permalink to this heading">¶</a></h2>
<p>It is also possible to combine the Chandrasekhar recursions with the univariate filtering approach of Koopman and Durbin (2000), by making use of the results of Aknouche and Hamdi in their 2007 paper “Periodic Chandrasekhar recursions”. An initial implementation of this combination is included in Statsmodels. However, experiments suggest that this tends to degrade performance compared to even the usual Kalman filter. This accords with the computational savings reported for the univariate
filtering method, which suggest that savings are highest when the state vector is small relative to the observation vector.</p>
</section>
<section id="Bibliography">
<h2 id="Bibliography">Bibliography<a class="headerlink" href="#Bibliography" title="Permalink to this heading">¶</a></h2>
<p>Aknouche, Abdelhakim, and Fayçal Hamdi. “Periodic Chandrasekhar recursions.” arXiv preprint arXiv:0711.3857 (2007).</p>
<p>Herbst, Edward. “Using the “Chandrasekhar Recursions” for likelihood evaluation of DSGE models.” Computational Economics 45, no. 4 (2015): 693-705.</p>
<p>Koopman, Siem J., and James Durbin. “Fast filtering and smoothing for multivariate state space models.” Journal of Time Series Analysis 21, no. 3 (2000): 281-296.</p>
<p>McAdam, Peter, and Anders Warne. “Euro area real-time density forecasting with financial or labor market frictions.” International Journal of Forecasting 35, no. 2 (2019): 580-600.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="statespace_concentrated_scale.html" title="State space models - concentrating the scale out of the likelihood function"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> State space models - concentrating the scale out of the likelihood function </span>
              </div>
            </a>
          
          
            <a href="theta-model.html" title="The Theta Model"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> The Theta Model </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2009-2019, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
              
          </div>
            Last updated on
              Nov 02, 2022.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>