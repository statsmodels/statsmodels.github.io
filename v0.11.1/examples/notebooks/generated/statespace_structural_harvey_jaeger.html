

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Detrending, Stylized Facts and the Business Cycle &#8212; statsmodels</title>
  <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/icons/favicon-16x16.png">
  <link rel="manifest" href="../../../_static/icons/site.webmanifest">
  <link rel="mask-icon" href="../../../_static/icons/safari-pinned-tab.svg" color="#919191">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="../../../_static/icons/browserconfig.xml">
  <link rel="stylesheet" href="../../../_static/stylesheets/examples.css">
    <link rel="stylesheet" href="../../../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Trends and cycles in unemployment" href="statespace_cycles.html" />
    <link rel="prev" title="Dynamic factors and coincident indices" href="statespace_dfm_coincident.html" />
  
   
  
  <script src="../../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../_static/versions.json",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>


  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/notebooks/generated/statespace_structural_harvey_jaeger" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="statsmodels"
           class="md-header-nav__button md-logo">
          
              <img src="../../../_static/statsmodels-logo-v2-bw.svg" height="26"
                   alt="statsmodels logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">statsmodels v0.11.1</span>
          <span class="md-header-nav__topic"> Detrending, Stylized Facts and the Business Cycle </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">Examples</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="statsmodels" class="md-nav__button md-logo">
      
        <img src="../../../_static/statsmodels-logo-v2-bw.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="statsmodels">statsmodels v0.11.1</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/statsmodels/statsmodels" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    statsmodels
  </div>
</a>
    </div>
  
  

  
  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <a href="../../../install.html" class="md-nav__link">Installing statsmodels</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../../gettingstarted.html" class="md-nav__link">Getting started</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../../user-guide.html" class="md-nav__link">User Guide</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html" class="md-nav__link">Examples</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="../../index.html#linear-regression-models" class="md-nav__link">Linear Regression Models</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#plotting" class="md-nav__link">Plotting</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#discrete-choice-models" class="md-nav__link">Discrete Choice Models</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#nonparametric-statistics" class="md-nav__link">Nonparametric Statistics</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#generalized-linear-models" class="md-nav__link">Generalized Linear Models</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#robust-regression" class="md-nav__link">Robust Regression</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#generalized-estimating-equations" class="md-nav__link">Generalized Estimating Equations</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#statistics" class="md-nav__link">Statistics</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#time-series-analysis" class="md-nav__link">Time Series Analysis</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#state-space-models" class="md-nav__link">State space models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="statespace_sarimax_stata.html" class="md-nav__link">SARIMAX: Introduction</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_sarimax_internet.html" class="md-nav__link">SARIMAX: Model selection, missing data</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_varmax.html" class="md-nav__link">VARMAX models</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_dfm_coincident.html" class="md-nav__link">Dynamic factors and coincident indices</a>
      
    </li>
    <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Detrending, Stylized Facts and the Business Cycle </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Detrending, Stylized Facts and the Business Cycle</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-structural-harvey-jaeger--page-root" class="md-nav__link">Detrending, Stylized Facts and the Business Cycle</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Unobserved-Components" class="md-nav__link">Unobserved Components</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Trend" class="md-nav__link">Trend</a>
        </li>
        <li class="md-nav__item"><a href="#Seasonal" class="md-nav__link">Seasonal</a>
        </li>
        <li class="md-nav__item"><a href="#Cycle" class="md-nav__link">Cycle</a>
        </li>
        <li class="md-nav__item"><a href="#Irregular" class="md-nav__link">Irregular</a>
        </li>
        <li class="md-nav__item"><a href="#Regression-effects" class="md-nav__link">Regression effects</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Data" class="md-nav__link">Data</a>
        </li>
        <li class="md-nav__item"><a href="#Model" class="md-nav__link">Model</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_structural_harvey_jaeger.ipynb.txt">Show Source</a> </li>

  </ul>
</nav>
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_cycles.html" class="md-nav__link">Trends and cycles in unemployment</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_local_linear_trend.html" class="md-nav__link">State space modeling: Local Linear Trends</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_arma_0.html" class="md-nav__link">Autoregressive Moving Average (ARMA): Sunspots data</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_seasonal.html" class="md-nav__link">Seasonality in time series data</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="statespace_fixed_params.html" class="md-nav__link">Estimating or specifying parameters in state space models</a>
      
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#state-space-models-technical-notes" class="md-nav__link">State space models - Technical notes</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#multivariate-methods" class="md-nav__link">Multivariate Methods</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../index.html#user-notes" class="md-nav__link">User Notes</a>
      
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="../../../api.html" class="md-nav__link">API Reference</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../../about.html" class="md-nav__link">About statsmodels</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../../dev/index.html" class="md-nav__link">Developer Page</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../../release/index.html" class="md-nav__link">Release Notes</a>
      
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-notebooks-generated-statespace-structural-harvey-jaeger--page-root" class="md-nav__link">Detrending, Stylized Facts and the Business Cycle</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Unobserved-Components" class="md-nav__link">Unobserved Components</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Trend" class="md-nav__link">Trend</a>
        </li>
        <li class="md-nav__item"><a href="#Seasonal" class="md-nav__link">Seasonal</a>
        </li>
        <li class="md-nav__item"><a href="#Cycle" class="md-nav__link">Cycle</a>
        </li>
        <li class="md-nav__item"><a href="#Irregular" class="md-nav__link">Irregular</a>
        </li>
        <li class="md-nav__item"><a href="#Regression-effects" class="md-nav__link">Regression effects</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Data" class="md-nav__link">Data</a>
        </li>
        <li class="md-nav__item"><a href="#Model" class="md-nav__link">Model</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../_sources/examples/notebooks/generated/statespace_structural_harvey_jaeger.ipynb.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>

<h1 id="examples-notebooks-generated-statespace-structural-harvey-jaeger--page-root">Detrending, Stylized Facts and the Business Cycle<a class="headerlink" href="#examples-notebooks-generated-statespace-structural-harvey-jaeger--page-root" title="Permalink to this headline">¶</a></h1>
<p>In an influential article, Harvey and Jaeger (1993) described the use of unobserved components models (also known as “structural time series models”) to derive stylized facts of the business cycle.</p>
<p>Their paper begins:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"Establishing the 'stylized facts' associated with a set of time series is widely considered a crucial step</span>
<span class="ow">in</span> <span class="n">macroeconomic</span> <span class="n">research</span> <span class="o">...</span> <span class="n">For</span> <span class="n">such</span> <span class="n">facts</span> <span class="n">to</span> <span class="n">be</span> <span class="n">useful</span> <span class="n">they</span> <span class="n">should</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">be</span> <span class="n">consistent</span> <span class="k">with</span> <span class="n">the</span> <span class="n">stochastic</span>
<span class="n">properties</span> <span class="n">of</span> <span class="n">the</span> <span class="n">data</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">present</span> <span class="n">meaningful</span> <span class="n">information</span><span class="o">.</span><span class="s2">"</span>
</pre></div>
</div>
<p>In particular, they make the argument that these goals are often better met using the unobserved components approach rather than the popular Hodrick-Prescott filter or Box-Jenkins ARIMA modeling techniques.</p>
<p>statsmodels has the ability to perform all three types of analysis, and below we follow the steps of their paper, using a slightly updated dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Latex</span>
</pre></div>
</div>
</div>

<h2 id="Unobserved-Components">Unobserved Components<a class="headerlink" href="#Unobserved-Components" title="Permalink to this headline">¶</a></h2>
<p>The unobserved components model available in statsmodels can be written as:</p>
<div class="math notranslate nohighlight">
\[y_t = \underbrace{\mu_{t}}_{\text{trend}} + \underbrace{\gamma_{t}}_{\text{seasonal}} + \underbrace{c_{t}}_{\text{cycle}} + \sum_{j=1}^k \underbrace{\beta_j x_{jt}}_{\text{explanatory}} + \underbrace{\varepsilon_t}_{\text{irregular}}\]</div>
<p>see Durbin and Koopman 2012, Chapter 3 for notation and additional details. Notice that different specifications for the different individual components can support a wide range of models. The specific models considered in the paper and below are specializations of this general equation.</p>

<h3 id="Trend">Trend<a class="headerlink" href="#Trend" title="Permalink to this headline">¶</a></h3>
<p>The trend component is a dynamic extension of a regression model that includes an intercept and linear time-trend.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\underbrace{\mu_{t+1}}_{\text{level}} &amp; = \mu_t + \nu_t + \eta_{t+1} \qquad &amp; \eta_{t+1} \sim N(0, \sigma_\eta^2) \\\\
\underbrace{\nu_{t+1}}_{\text{trend}} &amp; = \nu_t + \zeta_{t+1} &amp; \zeta_{t+1} \sim N(0, \sigma_\zeta^2) \\
\end{align}\end{split}\]</div>
<p>where the level is a generalization of the intercept term that can dynamically vary across time, and the trend is a generalization of the time-trend such that the slope can dynamically vary across time.</p>
<p>For both elements (level and trend), we can consider models in which:</p>
<ul class="simple">
<li><p>The element is included vs excluded (if the trend is included, there must also be a level included).</p></li>
<li><p>The element is deterministic vs stochastic (i.e. whether or not the variance on the error term is confined to be zero or not)</p></li>
</ul>
<p>The only additional parameters to be estimated via MLE are the variances of any included stochastic components.</p>
<p>This leads to the following specifications:</p>
<table>
<colgroup>
<col style="width: 53%"/>
<col style="width: 7%"/>
<col style="width: 7%"/>
<col style="width: 16%"/>
<col style="width: 16%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Level</p></th>
<th class="head"><p>Trend</p></th>
<th class="head"><p>Stochastic Level</p></th>
<th class="head"><p>Stochastic Trend</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Constant</p></td>
<td><p>✓</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Local Level (random walk)</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>✓</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Deterministic trend</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Local level with deterministic trend (random walk with drift)</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Local linear trend</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p>Smooth trend (integrated random walk)</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>✓</p></td>
</tr>
</tbody>
</table>


<h3 id="Seasonal">Seasonal<a class="headerlink" href="#Seasonal" title="Permalink to this headline">¶</a></h3>
<p>The seasonal component is written as:</p>
<div class="math notranslate nohighlight">
\[\gamma_t = - \sum_{j=1}^{s-1} \gamma_{t+1-j} + \omega_t \qquad \omega_t \sim N(0, \sigma_\omega^2)\]</div>
<p>The periodicity (number of seasons) is <code class="docutils literal notranslate"><span class="pre">s</span></code>, and the defining character is that (without the error term), the seasonal components sum to zero across one complete cycle. The inclusion of an error term allows the seasonal effects to vary over time.</p>
<p>The variants of this model are:</p>
<ul class="simple">
<li><p>The periodicity <code class="docutils literal notranslate"><span class="pre">s</span></code></p></li>
<li><p>Whether or not to make the seasonal effects stochastic.</p></li>
</ul>
<p>If the seasonal effect is stochastic, then there is one additional parameter to estimate via MLE (the variance of the error term).</p>


<h3 id="Cycle">Cycle<a class="headerlink" href="#Cycle" title="Permalink to this headline">¶</a></h3>
<p>The cyclical component is intended to capture cyclical effects at time frames much longer than captured by the seasonal component. For example, in economics the cyclical term is often intended to capture the business cycle, and is then expected to have a period between “1.5 and 12 years” (see Durbin and Koopman).</p>
<p>The cycle is written as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
c_{t+1} &amp; = c_t \cos \lambda_c + c_t^* \sin \lambda_c + \tilde \omega_t \qquad &amp; \tilde \omega_t \sim N(0, \sigma_{\tilde \omega}^2) \\\\
c_{t+1}^* &amp; = -c_t \sin \lambda_c + c_t^* \cos \lambda_c + \tilde \omega_t^* &amp; \tilde \omega_t^* \sim N(0, \sigma_{\tilde \omega}^2)
\end{align}\end{split}\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(\lambda_c\)</span> (the frequency of the cycle) is an additional parameter to be estimated by MLE. If the seasonal effect is stochastic, then there is one another parameter to estimate (the variance of the error term - note that both of the error terms here share the same variance, but are assumed to have independent draws).</p>


<h3 id="Irregular">Irregular<a class="headerlink" href="#Irregular" title="Permalink to this headline">¶</a></h3>
<p>The irregular component is assumed to be a white noise error term. Its variance is a parameter to be estimated by MLE; i.e.</p>
<div class="math notranslate nohighlight">
\[\varepsilon_t \sim N(0, \sigma_\varepsilon^2)\]</div>
<p>In some cases, we may want to generalize the irregular component to allow for autoregressive effects:</p>
<div class="math notranslate nohighlight">
\[\varepsilon_t = \rho(L) \varepsilon_{t-1} + \epsilon_t, \qquad \epsilon_t \sim N(0, \sigma_\epsilon^2)\]</div>
<p>In this case, the autoregressive parameters would also be estimated via MLE.</p>


<h3 id="Regression-effects">Regression effects<a class="headerlink" href="#Regression-effects" title="Permalink to this headline">¶</a></h3>
<p>We may want to allow for explanatory variables by including additional terms</p>
<div class="math notranslate nohighlight">
\[\sum_{j=1}^k \beta_j x_{jt}\]</div>
<p>or for intervention effects by including</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\delta w_t \qquad \text{where} \qquad w_t &amp; = 0, \qquad t &lt; \tau, \\\\
&amp; = 1, \qquad t \ge \tau
\end{align}\end{split}\]</div>
<p>These additional parameters could be estimated via MLE or by including them as components of the state space formulation.</p>



<h2 id="Data">Data<a class="headerlink" href="#Data" title="Permalink to this headline">¶</a></h2>
<p>Following Harvey and Jaeger, we will consider the following time series:</p>
<ul class="simple">
<li><p>US real GNP, “output”, (<a class="reference external" href="https://research.stlouisfed.org/fred2/series/GNPC96">GNPC96</a>)</p></li>
<li><p>US GNP implicit price deflator, “prices”, (<a class="reference external" href="https://research.stlouisfed.org/fred2/series/GNPDEF">GNPDEF</a>)</p></li>
<li><p>US monetary base, “money”, (<a class="reference external" href="https://research.stlouisfed.org/fred2/series/AMBSL">AMBSL</a>)</p></li>
</ul>
<p>The time frame in the original paper varied across series, but was broadly 1954-1989. Below we use data from the period 1948-2008 for all series. Although the unobserved components approach allows isolating a seasonal component within the model, the series considered in the paper, and here, are already seasonally adjusted.</p>
<p>All data series considered here are taken from <a class="reference external" href="https://research.stlouisfed.org/fred2/">Federal Reserve Economic Data (FRED)</a>. Conveniently, the Python library <a class="reference external" href="https://pandas.pydata.org/">Pandas</a> has the ability to download data from FRED directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Datasets</span>
<span class="kn">from</span> <span class="nn">pandas_datareader.data</span> <span class="kn">import</span> <span class="n">DataReader</span>

<span class="c1"># Get the raw data</span>
<span class="n">start</span> <span class="o">=</span> <span class="s1">'1948-01'</span>
<span class="n">end</span> <span class="o">=</span> <span class="s1">'2008-01'</span>
<span class="n">us_gnp</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s1">'GNPC96'</span><span class="p">,</span> <span class="s1">'fred'</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">us_gnp_deflator</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s1">'GNPDEF'</span><span class="p">,</span> <span class="s1">'fred'</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
<span class="n">us_monetary_base</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s1">'AMBSL'</span><span class="p">,</span> <span class="s1">'fred'</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">'QS'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">recessions</span> <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s1">'USRECQ'</span><span class="p">,</span> <span class="s1">'fred'</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">'QS'</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Construct the dataframe</span>
<span class="n">dta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="p">(</span><span class="n">us_gnp</span><span class="p">,</span> <span class="n">us_gnp_deflator</span><span class="p">,</span> <span class="n">us_monetary_base</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dta</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'US GNP'</span><span class="p">,</span><span class="s1">'US Prices'</span><span class="p">,</span><span class="s1">'US monetary base'</span><span class="p">]</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">dta</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">_mpl_repr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/travis/miniconda/envs/statsmodels-test/lib/python3.7/site-packages/pandas_datareader/compat/__init__.py:7: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
  from pandas.util.testing import assert_frame_equal
</pre></div></div>
</div>
<p>To get a sense of these three variables over the timeframe, we can plot them:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the data</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">dta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">recessions</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_structural_harvey_jaeger_6_0.png" src="../../../_images/examples_notebooks_generated_statespace_structural_harvey_jaeger_6_0.png"/>
</div>
</div>


<h2 id="Model">Model<a class="headerlink" href="#Model" title="Permalink to this headline">¶</a></h2>
<p>Since the data is already seasonally adjusted and there are no obvious explanatory variables, the generic model considered is:</p>
<div class="math notranslate nohighlight">
\[y_t = \underbrace{\mu_{t}}_{\text{trend}} + \underbrace{c_{t}}_{\text{cycle}} + \underbrace{\varepsilon_t}_{\text{irregular}}\]</div>
<p>The irregular will be assumed to be white noise, and the cycle will be stochastic and damped. The final modeling choice is the specification to use for the trend component. Harvey and Jaeger consider two models:</p>
<ol class="arabic simple">
<li><p>Local linear trend (the “unrestricted” model)</p></li>
<li><p>Smooth trend (the “restricted” model, since we are forcing <span class="math notranslate nohighlight">\(\sigma_\eta = 0\)</span>)</p></li>
</ol>
<p>Below, we construct <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> dictionaries for each of these model types. Notice that rather that there are two ways to specify the models. One way is to specify components directly, as in the table above. The other way is to use string names which map to various specifications.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model specifications</span>

<span class="c1"># Unrestricted model, using string specification</span>
<span class="n">unrestricted_model</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'level'</span><span class="p">:</span> <span class="s1">'local linear trend'</span><span class="p">,</span> <span class="s1">'cycle'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'damped_cycle'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'stochastic_cycle'</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="c1"># Unrestricted model, setting components directly</span>
<span class="c1"># This is an equivalent, but less convenient, way to specify a</span>
<span class="c1"># local linear trend model with a stochastic damped cycle:</span>
<span class="c1"># unrestricted_model = {</span>
<span class="c1">#     'irregular': True, 'level': True, 'stochastic_level': True, 'trend': True, 'stochastic_trend': True,</span>
<span class="c1">#     'cycle': True, 'damped_cycle': True, 'stochastic_cycle': True</span>
<span class="c1"># }</span>

<span class="c1"># The restricted model forces a smooth trend</span>
<span class="n">restricted_model</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'level'</span><span class="p">:</span> <span class="s1">'smooth trend'</span><span class="p">,</span> <span class="s1">'cycle'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'damped_cycle'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'stochastic_cycle'</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="c1"># Restricted model, setting components directly</span>
<span class="c1"># This is an equivalent, but less convenient, way to specify a</span>
<span class="c1"># smooth trend model with a stochastic damped cycle. Notice</span>
<span class="c1"># that the difference from the local linear trend model is that</span>
<span class="c1"># `stochastic_level=False` here.</span>
<span class="c1"># unrestricted_model = {</span>
<span class="c1">#     'irregular': True, 'level': True, 'stochastic_level': False, 'trend': True, 'stochastic_trend': True,</span>
<span class="c1">#     'cycle': True, 'damped_cycle': True, 'stochastic_cycle': True</span>
<span class="c1"># }</span>
</pre></div>
</div>
</div>
<p>We now fit the following models:</p>
<ol class="arabic simple">
<li><p>Output, unrestricted model</p></li>
<li><p>Prices, unrestricted model</p></li>
<li><p>Prices, restricted model</p></li>
<li><p>Money, unrestricted model</p></li>
<li><p>Money, restricted model</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Output</span>
<span class="n">output_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">dta</span><span class="p">[</span><span class="s1">'US GNP'</span><span class="p">],</span> <span class="o">**</span><span class="n">unrestricted_model</span><span class="p">)</span>
<span class="n">output_res</span> <span class="o">=</span> <span class="n">output_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'powell'</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Prices</span>
<span class="n">prices_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">dta</span><span class="p">[</span><span class="s1">'US Prices'</span><span class="p">],</span> <span class="o">**</span><span class="n">unrestricted_model</span><span class="p">)</span>
<span class="n">prices_res</span> <span class="o">=</span> <span class="n">prices_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'powell'</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">prices_restricted_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">dta</span><span class="p">[</span><span class="s1">'US Prices'</span><span class="p">],</span> <span class="o">**</span><span class="n">restricted_model</span><span class="p">)</span>
<span class="n">prices_restricted_res</span> <span class="o">=</span> <span class="n">prices_restricted_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'powell'</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Money</span>
<span class="n">money_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">dta</span><span class="p">[</span><span class="s1">'US monetary base'</span><span class="p">],</span> <span class="o">**</span><span class="n">unrestricted_model</span><span class="p">)</span>
<span class="n">money_res</span> <span class="o">=</span> <span class="n">money_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'powell'</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">money_restricted_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">dta</span><span class="p">[</span><span class="s1">'US monetary base'</span><span class="p">],</span> <span class="o">**</span><span class="n">restricted_model</span><span class="p">)</span>
<span class="n">money_restricted_res</span> <span class="o">=</span> <span class="n">money_restricted_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">'powell'</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/base/tsa_model.py:162: ValueWarning: No frequency information was provided, so inferred frequency QS-OCT will be used.
  % freq, ValueWarning)
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/base/tsa_model.py:162: ValueWarning: No frequency information was provided, so inferred frequency QS-OCT will be used.
  % freq, ValueWarning)
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/base/tsa_model.py:162: ValueWarning: No frequency information was provided, so inferred frequency QS-OCT will be used.
  % freq, ValueWarning)
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/base/tsa_model.py:162: ValueWarning: No frequency information was provided, so inferred frequency QS-OCT will be used.
  % freq, ValueWarning)
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/base/tsa_model.py:162: ValueWarning: No frequency information was provided, so inferred frequency QS-OCT will be used.
  % freq, ValueWarning)
</pre></div></div>
</div>
<p>Once we have fit these models, there are a variety of ways to display the information. Looking at the model of US GNP, we can summarize the fit of the model using the <code class="docutils literal notranslate"><span class="pre">summary</span></code> method on the fit object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">output_res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            Unobserved Components Results
=====================================================================================
Dep. Variable:                        US GNP   No. Observations:                  241
Model:                    local linear trend   Log Likelihood                 769.632
                   + damped stochastic cycle   AIC                          -1527.263
Date:                       Fri, 21 Feb 2020   BIC                          -1506.455
Time:                               13:56:31   HQIC                         -1518.876
Sample:                           01-01-1948
                                - 01-01-2008
Covariance Type:                         opg
====================================================================================
                       coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------
sigma2.irregular   1.09e-06   7.29e-06      0.149      0.881   -1.32e-05    1.54e-05
sigma2.level      4.075e-06   4.93e-05      0.083      0.934   -9.26e-05       0.000
sigma2.trend      2.962e-06    1.4e-06      2.112      0.035    2.14e-07    5.71e-06
sigma2.cycle      3.911e-05   2.57e-05      1.524      0.127   -1.12e-05    8.94e-05
frequency.cycle      0.4453      0.047      9.476      0.000       0.353       0.537
damping.cycle        0.8684      0.042     20.731      0.000       0.786       0.951
===================================================================================
Ljung-Box (Q):                       43.93   Jarque-Bera (JB):                 9.29
Prob(Q):                              0.31   Prob(JB):                         0.01
Heteroskedasticity (H):               0.27   Skew:                            -0.05
Prob(H) (two-sided):                  0.00   Kurtosis:                         3.96
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</pre></div></div>
</div>
<p>For unobserved components models, and in particular when exploring stylized facts in line with point (2) from the introduction, it is often more instructive to plot the estimated unobserved components (e.g. the level, trend, and cycle) themselves to see if they provide a meaningful description of the data.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">plot_components</span></code> method of the fit object can be used to show plots and confidence intervals of each of the estimated states, as well as a plot of the observed data versus the one-step-ahead predictions of the model to assess fit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">output_res</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">legend_loc</span><span class="o">=</span><span class="s1">'lower right'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/statespace/structural.py:1723: RuntimeWarning: invalid value encountered in sqrt
  std_errors = np.sqrt(component_bunch['%s_cov' % which])
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/statespace/structural.py:1723: RuntimeWarning: invalid value encountered in sqrt
  std_errors = np.sqrt(component_bunch['%s_cov' % which])
/home/travis/build/statsmodels/statsmodels/statsmodels/tsa/statespace/structural.py:1723: RuntimeWarning: invalid value encountered in sqrt
  std_errors = np.sqrt(component_bunch['%s_cov' % which])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_notebooks_generated_statespace_structural_harvey_jaeger_14_1.png" src="../../../_images/examples_notebooks_generated_statespace_structural_harvey_jaeger_14_1.png"/>
</div>
</div>
<p>Finally, Harvey and Jaeger summarize the models in another way to highlight the relative importances of the trend and cyclical components; below we replicate their Table I. The values we find are broadly consistent with, but different in the particulars from, the values from their table.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create Table I</span>
<span class="n">table_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">dta</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">dta</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">time_range</span> <span class="o">=</span> <span class="s1">'</span><span class="si">%d</span><span class="s1">:</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">:</span><span class="si">%d</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">quarter</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">quarter</span><span class="p">)</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">'US GNP'</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'US Prices'</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'US Prices'</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\sigma_\eta^2 = 0$'</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'US monetary base'</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'US monetary base'</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\sigma_\eta^2 = 0$'</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Series'</span><span class="p">,</span> <span class="s1">'Time range'</span><span class="p">,</span> <span class="s1">'Restrictions'</span><span class="p">])</span>
<span class="n">parameter_symbols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">r</span><span class="s1">'$\sigma_\zeta^2$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\sigma_\eta^2$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\sigma_\kappa^2$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\rho$'</span><span class="p">,</span>
    <span class="sa">r</span><span class="s1">'$2 \pi / \lambda_c$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\sigma_\varepsilon^2$'</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="p">(</span><span class="n">output_res</span><span class="p">,</span> <span class="n">prices_res</span><span class="p">,</span> <span class="n">prices_restricted_res</span><span class="p">,</span> <span class="n">money_res</span><span class="p">,</span> <span class="n">money_restricted_res</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">stochastic_level</span><span class="p">:</span>
        <span class="p">(</span><span class="n">sigma_irregular</span><span class="p">,</span> <span class="n">sigma_level</span><span class="p">,</span> <span class="n">sigma_trend</span><span class="p">,</span>
         <span class="n">sigma_cycle</span><span class="p">,</span> <span class="n">frequency_cycle</span><span class="p">,</span> <span class="n">damping_cycle</span><span class="p">)</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="p">(</span><span class="n">sigma_irregular</span><span class="p">,</span> <span class="n">sigma_level</span><span class="p">,</span>
         <span class="n">sigma_cycle</span><span class="p">,</span> <span class="n">frequency_cycle</span><span class="p">,</span> <span class="n">damping_cycle</span><span class="p">)</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">params</span>
        <span class="n">sigma_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">period_cycle</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">frequency_cycle</span>

    <span class="n">table_i</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">sigma_level</span><span class="o">*</span><span class="mf">1e7</span><span class="p">,</span> <span class="n">sigma_trend</span><span class="o">*</span><span class="mf">1e7</span><span class="p">,</span>
        <span class="n">sigma_cycle</span><span class="o">*</span><span class="mf">1e7</span><span class="p">,</span> <span class="n">damping_cycle</span><span class="p">,</span> <span class="n">period_cycle</span><span class="p">,</span>
        <span class="n">sigma_irregular</span><span class="o">*</span><span class="mf">1e7</span>
    <span class="p">]</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'float_format'</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'</span><span class="si">%.4g</span><span class="s1">'</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="s1">'-'</span><span class="p">)</span>
<span class="n">table_i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">table_i</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">parameter_symbols</span><span class="p">)</span>
<span class="n">table_i</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th></th>
<th>$\sigma_\zeta^2$</th>
<th>$\sigma_\eta^2$</th>
<th>$\sigma_\kappa^2$</th>
<th>$\rho$</th>
<th>$2 \pi / \lambda_c$</th>
<th>$\sigma_\varepsilon^2$</th>
</tr>
<tr>
<th>Series</th>
<th>Time range</th>
<th>Restrictions</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>US GNP</th>
<th>1948:1-2008:1</th>
<th>None</th>
<td>40.75</td>
<td>29.62</td>
<td>391.1</td>
<td>0.87</td>
<td>14.11</td>
<td>10.9</td>
</tr>
<tr>
<th rowspan="2" valign="top">US Prices</th>
<th rowspan="2" valign="top">1948:1-2008:1</th>
<th>None</th>
<td>46.08</td>
<td>29.76</td>
<td>0</td>
<td>0.92</td>
<td>10.01</td>
<td>7.2</td>
</tr>
<tr>
<th>$\sigma_\eta^2 = 0$</th>
<td>21.94</td>
<td>-</td>
<td>49.52</td>
<td>0.89</td>
<td>15.36</td>
<td>4.84</td>
</tr>
<tr>
<th rowspan="2" valign="top">US monetary base</th>
<th rowspan="2" valign="top">1948:1-2008:1</th>
<th>None</th>
<td>69.39</td>
<td>18.81</td>
<td>192.6</td>
<td>0.89</td>
<td>23.2</td>
<td>0</td>
</tr>
<tr>
<th>$\sigma_\eta^2 = 0$</th>
<td>18.94</td>
<td>-</td>
<td>247</td>
<td>0.89</td>
<td>23.81</td>
<td>0</td>
</tr>
</tbody>
</table>
</div></div>
</div>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="statespace_dfm_coincident.html" title="Material"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Dynamic factors and coincident indices </span>
              </div>
            </a>
          
          
            <a href="statespace_cycles.html" title="Admonition"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Trends and cycles in unemployment </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2009-2019, Josef Perktold, Skipper Seabold, Jonathan Taylor, statsmodels-developers.
              
          </div>
            Last updated on
              Feb 21, 2020.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 2.4.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>